# Предисловие. От автора 

Работа над книгой началась осенью 2009 года с записи курса лекции для 211 группы мат-меха СПбГУ. Это был так называемый ПОМИ-поток, в группе были собраны сильные студенты и я читал им обзорный курс теории графов под названием "Дискретная математика". Этот курс мне очень нравился и нравится до сих пор. Кто-то из студентов сказал мне а почему бы этот курс не записать? И в самом деле, им легче готовиться, а мне потом будет легче читать, подумал я, с этого книга и началась. В основном, с классических фактов, общеизвестных и не очень.

Потом мне захотелось записать туда еще много чего другого, и так в книге постепенно появлялись совсем уже не общеизвестные факты, понять которые не так-то просто (а исходниками многих из них являлись статьи, которые и мне было совсем непросто понять!). Книга становилась больше и больше. В 2010-2013 годах это происходило благодаря моим ученикам Глебу Ненашеву и Александру Глазману. Когда ты имеешь хороших учеников, все время хочется прочитать им на спецкурсах что-то новое! В книге есть доказательства, предложенные Глебом и Александром. Более того, все эти годы лежавшая в интернете версия книги была живой, постоянно меняющейся - как только я узнавал доказательство, более красивое с моей точки зрения чем то, что было записано, я менял текст. Ну и конечно что-то дописывал.

В книге после большинства теорем указаны их авторы и год, когда эта теорема впервые была доказана. Как уже сказано выше, часто записаны не первоначальные доказательства, а придуманные позже более красивые, иногда в скобках указаны их авторы (а иногда я авторов красивых доказательств не знаю, так как они стали фольклорными).

Где-то в 2014 году я стал работать над диссертацией и забросил книгу. Иногда меня спрашивали - а как поживает твоя книга? И я отвечал да ладно, лежит себе на моей страничке. Меня одолевали сомнения а нужна ли новая книга по теории графов? С удивлением я заметил, что при попытке найти первоисточники некоторых теорем в поисковиках одной из первых ссылок вылезает эта книга! Ее явно знают и скачивают не только мои студенты. Может быть из-за того, что она написана по-русски, а некоторым лень читать по-ангилийски? Но сейчас хватает переводов на русский язык учебников по теории графов, в первую очередь, замечательной книги Дистеля [8]. И, увы, только книги Дистеля. Конечно, книга Харари [63] мне всегда очень нравилась, с нее начался мой путь в теорию графов много лет назад. А ведь есть еще книги Оре, Бержа, Зыкова. Но это было давно, теория графов - молодая, динамично развивающаяся наука, за последние 40-50 лет появилось много нового

и интересного (в том числе весьма простого, что способен понять даже сильный школьник).

Именно работа над переводом 5 издания книги Дистеля стимулировала продолжение работы над моей книгой в 2017 году после долгого перерыва. Я заметил, насколько велика "симметрическая разность" его книги и моей. А прочитав некоторые теоремы в книге Дистеля, мне захотелось изложить их в своей книге, причем по-другому (в основном это касается некоторых теорем из главы Планарные графы, где мне хотелось подчеркнуть комбинаторную составляющую и опустить все топологические моменты). Затем, раз уж я вспомнил про книгу, вспомнились и многие результаты, которые я хотел давно туда записать, но руки не доходили. Это не так просто, ведь иногда доказательства очень простых и красивых на вид фактов в статьях записаны понятно автору, но не каждому читателю, даже специалисту в теории графов, и над ними надо как следует подумать.

Работая над книгой, я узнал много нового и интересного. В результате теория графов стала для меня более целостной наукой, выявились связи между разными ее частями. Иногда доказательства из разных частей теории графов так цеплялись друг за друга, что было совсем непросто придумать порядок изложения материала. Все-таки, не хочется ссылаться на то, что в книге будет впереди и кажется, мне удалось этого избежать.

Я желаю читателю не только найти в книге то, что ему понадобится, но также узнать много нового и интересного. В книге есть и хорошо известная классика, и гораздо более сложные теоремы. Как правило, каждая глава начинается с простого материала, а заканчивается весьма непростым (кроме, разве что, введения - там все элементарно). Я считаю, что все доказательства в книге изложены полно. Но подробностей в доказательствах простых фактах, разумеется, гораздо больше - ведь эти теоремы расчитаны на неподготовленного читателя, и ему должно быть все понятно. В сложных теоремах с доказательствами более 10 страниц вряд ли все будет с ходу понятно даже продвинутому читателю, такие вещи нужно внимательно прочитать и обдумать. И тогда получится их понять.

Я не ставил специальных пометок на сложных разделах, потому что они и так хорошо выделяются. Большинству читателей будет сложно их понять, как многое из этого материала первый раз сложно было понять и мне. Но сложно не значит невозможно! Я желаю читателю выйти за границы очевидного и понять что-то совсем непростое и неэлементарное, для каждого эта граница - своя.

Никаких знаний по теории графов не подразумевается. Все, что нуж-

но, есть в книге. В некоторых разделах подразумевается знание теории чисел (например, квадратичных вычетов) - все необходимое содержится в элементарной книге Виноградова "Основы теории чисел". В некоторых разделах нужны знания по алгебре, но тоже весьма элементарные: многочлены (в том числе от нескольких переменных), идеалы, линейная алгебра на начальном уровне (линеные пространства, их линейные и аффинные подпространства, матрицы и системы линейных уравнений). Этот материал можно найти в любом стандартном учебнике алгебры (совсем не обязательно продвинутом). Знания по математическому анализу практически не нужны, за исключением понимания того, что такое предел и производная. Утешением любителям чистой комбинаторики должно послужить то, что это нужно лишь в отдельных частях книги, а в большинстве мест представлены чисто комбинаторные доказательства. Именно в этом и была цель - изложить теорию графов с чисто графскими доказательствами. Никакой теории вероятности тут нет, для изучения вероятностной комбинаторики есть много хороших книг, авторы которых знают и любят эту науку. Это же касается алгебраических вопросов теории графов. Хотя некоторое количество алгебры тут есть, наверное, здесь сказался многолетний опыт автора по преподаванию алгебры. Знаний топологии в рассказе о планарных графах не требуется. Убежден, что это сделано не в ущерб строгости изложения - просто некоторые топологические факты (например, теорема Жордана) подразумеваются известными.

Итак, вперед! Первая глава - Введение - содержит основные обозначения и самые простые факты из теории графов. Это далеко не самая интересная часть книги. Ни для автора, ни для продвинутого читателя, который вполне может эту часть прочитать по диагонали. Но просмотреть все же стоит, или нужно посматривать в соответвтвующие разделы введения каждый раз, когда это необходимо.

# Благодарности 

Автор благодарен своим ученикам 2009-2017 годов, благодаря которым появилась эта книга. Кроме упомянутых выше Александра Глазмана и Глеба Ненашева, в работе над книгой мне помогла Надежда Власова, благодаря которой в книге стало меньше ошибок и больше правильных доказательств.

Отдельная благодарность А. М.Райгородскому, объяснившему мне, что эта книга нужна. Иначе в интернете так и лежала бы старая версия (по сути, версия 2013 года), в которой было достаточно много ошибок и неточностей и значительно меньше материала.

А еще - благодарность моей жене Алёне, которую я встретил как раз в 2009 году, перед началом этой длинной и непростой работы. Без Алёны у меня ничего не получалось!

6

# Оглавление 

1 Введение ..... 13
1.1 Вершины и рёбра ..... 14
1.2 Подграфы ..... 15
1.3 Некоторые операции над графами ..... 16
1.4 Маршруты, пути и циклы ..... 18
1.5 Связность ..... 21
1.5.1 Компоненты связности ..... 22
1.5.2 Дерево ..... 22
1.5.3 Разделяющие множества ..... 23
1.5.4 Части разбиения ..... 24
1.5.5 Точки сочленения и блоки в связном графе ..... 25
1.6 Двудольные графы ..... 26
1.7 Орграфы и ориентации ..... 27
1.7.1 Стрелки ..... 27
1.7.2 Подграфы, степени и окрестности ..... 28
1.7.3 Пути и циклы в орграфе ..... 28
1.7.4 Некоторые операции над орграфами ..... 30
1.7.5 Ориентация графа ..... 30
1.8 Корневые деревья ..... 31
1.8.1 Дерево поиска в ширину ..... 31
1.8.2 Нормальное дерево ..... 31
1.9 Эйлеров цикл и покрытие рёбер путями ..... 32
1.10 Гиперграф ..... 35
1.11 Изоморфизм графов ..... 36
1.12 Рёберный граф ..... 36
2 Паросочетания ..... 39
2.1 Чередующиеся и дополняющие пути ..... 39
2.2 Паросочетания в двудольном графе ..... 40
2.3 Соотношения между $\alpha, \beta, \alpha^{\prime}$ и $\beta^{\prime}$ ..... 43
2.4 Паросочетания с предпочтениями ..... 44

2.5 Паросочетания в произвольном графе ..... 45
2.5.1 Теорема Татта о совершенном паросочетании ..... 45
2.5.2 Совершенное паросочетание в регулярном графе ..... 47
2.5.3 Факторы регулярного графа ..... 49
2.5.4 Дефицит графа. Формула Бержа ..... 52
2.5.5 Фактор-критические графы ..... 53
2.5.6 Структурная теорема Галлан-Эдмондса ..... 54
2.5.7 Барьеры ..... 58
2.5.8 Критерии существования совершенного паросочета- ния ..... 62
2.6 Факторы ..... 64
2.6.1 Факторы и паросочетания ..... 64
2.6.2 Нормальные множества ..... 66
2.6.3 $f$-дефицит. Теорема Татта о факторе ..... 68
2.6.4 Еще раз про факторы регулярного графа ..... 75
2.6.5 Жесткость и $k$-факторы ..... 78
2.7 Графы с единственным паросочетанием ..... 84
2.8 Комментарии ..... 86
3 Пути и циклы ..... 89
3.1 Гамильтонов путь и цикл ..... 89
3.1.1 Классические критерии Дирака и Оре ..... 89
3.1.2 Замыкание. Метод Хватала ..... 90
3.1.3 Связность и гамильтоновы циклы ..... 91
3.1.4 Гамильтоновы последовательности ..... 93
3.1.5 Гамильтонов цикл в степени графа ..... 95
3.2 Панциклические графы ..... 105
3.3 Окружение графа ..... 106
3.4 Циклы четной длины ..... 109
3.5 Обхват ..... 114
3.6 Комментарии ..... 116
4 Раскраски ..... 117
4.1 Хроматическое число ..... 117
4.2 Теорема Брукса ..... 118
4.3 Гипотеза Хайоша ..... 123
4.3.1 Критические графы ..... 123
4.3.2 Гипотеза Хайоша, случай $k=4$ ..... 127
4.4 Конструируемые графы ..... 128
4.5 Обхват и хроматическое число ..... 134
4.6 Совершенные графы ..... 137

4.7 Раскраски рёбер ..... 142
4.7.1 Оптимальные раскраски ..... 143
4.7.2 Теорема Визинга ..... 146
4.7.3 Покрывающие раскраски рёбер ..... 148
4.8 Списочные раскраски ..... 151
4.9 Раскраски гиперграфов ..... 154
4.9.1 Аналог теоремы Брукса ..... 154
4.9.2 Правильные раскраски гиперграфов в два цвета ..... 161
4.10 Теорема о чередующемся цикле ..... 167
4.11 Комментарии ..... 170
5 Связность ..... 175
5.1 Теорема Менгера ..... 175
5.2 Разделяющие множества в $k$-связном графе ..... 179
5.2.1 Части разбиения, граница и внутренность ..... 179
5.2.2 Зависимые и независимые разделяющие множества ..... 183
5.3 Удаление вершин с сохранением $k$-связности ..... 185
5.4 Удаление ребер с сохранением $k$-связности ..... 188
5.5 Деревья разбиения ..... 193
5.5.1 Точки сочленения и блоки в связном графе ..... 193
5.5.2 Дерево разбиения ..... 194
5.5.3 Дерево разбиения двусвязного графа ..... 197
5.5.4 Применение дерева разбиения двусвязного графа ..... 202
5.6 Стягивание рёбер в $k$-связном графе ..... 207
5.6.1 Двусвязные и трёхсвязные графы ..... 207
5.6.2 Минимальные по стягиванию 4-связные графы ..... 209
5.6.3 Трёхсвязные графы: происхождение от колеса ..... 218
5.7 Разбиение вершин на связные множества ..... 220
5.8 Комментарии ..... 225
6 Планарные графы ..... 229
6.1 Плоские и планарные графы ..... 229
6.1.1 Грань и её граница ..... 229
6.1.2 Разные изображения одного графа ..... 230
6.1.3 Плоскость и сфера ..... 231
6.2 Формула Эйлера ..... 232
6.3 Теорема Куратовского ..... 233
6.3.1 Части разбиения и планарность ..... 238
6.4 Изображения трёхсвязного графа ..... 239
6.5 Двойственный граф ..... 241
6.6 Триангуляции ..... 244

6.7 Вокруг 4CC ..... 248
6.8 Списочные раскраски планарных графов ..... 256
6.9 Пути и циклы в планарном графе ..... 269
6.9.1 Негамильтоновы планарные графы ..... 269
6.9.2 Теорема Томассена о пути в планарном графе ..... 270
6.9.3 Теорема Татта о цикле в планарном графе ..... 283
6.10 $K$-планарные графы ..... 286
6.11 Комментарии ..... 293
7 Циклическое пространство графа ..... 297
7.1 Пространство разрезов ..... 298
7.2 Бонды ..... 301
7.3 Пространство трёхсвязного графа ..... 304
7.4 Циклическое пространство и планарность ..... 306
7.5 Циклическое пространство и двойственность ..... 309
7.6 Комментарии ..... 311
8 Ориентированные графы ..... 313
8.1 Сильная связность ..... 313
8.2 Входящее и исходящее дерево ..... 315
8.3 Сильная $k$-связность ..... 317
8.4 Гамильтоновы циклы в орграфе ..... 320
8.5 Турниры ..... 322
8.5.1 Циклы в сильно связных турнирах ..... 324
8.5.2 Гамильтоновы пути в турнирном графе ..... 325
8.6 Независимые множества вершин в орграфе ..... 334
8.6.1 Теорема Хватала-Ловаса ..... 334
8.6.2 Покрытие вершин путями ..... 335
8.7 Ориентации графа и его раскраски ..... 337
8.7.1 Теорема Роя-Галлаи ..... 337
8.7.2 Ядро орграфа и списочные раскраски рёбер ..... 338
8.8 Орграфы исходящей степени не менее 2 ..... 342
8.9 Циклический базис орграфа ..... 347
8.10 Четные орграфы ..... 348
8.10.1 Циклический базис орграфа и четные циклы ..... 352
8.10.2 Редукция ..... 353
8.10.3 Основная теорема ..... 355
8.10.4 Условия существования слабого двойного треуголь- ника ..... 361
8.10.5 Критерии четности орграфа ..... 377
8.11 Снова о раскрасках гиперграфа в два цвета ..... 378

8.12 Комментарии ..... 380
9 Остовные деревья ..... 383
9.1 Количество остовных деревьев ..... 383
9.2 Матричная теорема о деревьях ..... 385
9.3 Количество висячих вершин ..... 390
9.3.1 Теорема о промежуточных значениях ..... 390
9.3.2 Минимальная степень и количество висячих вершин ..... 391
9.3.3 Остовные деревья в графах с вершинами степеней 1 и 2 ..... 395
9.3.4 Экстремальные примеры ..... 400
9.4 Непересекающиеся остовные деревья ..... 401
9.5 Комментарии ..... 404
10 Потоки ..... 407
10.1 Поток в сети ..... 407
10.1.1 Теорема Форда-Фалкерсона ..... 409
10.1.2 Целочисленные сети ..... 410
10.1.3 Рёберная теорема Менгера ..... 410
10.1.4 Максимальный поток в произвольной сети ..... 412
10.2 Поток в графе ..... 413
10.2.1 $K$-поток и $\mathbb{Z}_{k}$-поток ..... 415
10.2.2 $2, \mathbb{Z}_{2}, 3$ и $\mathbb{Z}_{3}$-потоки ..... 417
10.2.3 Существование 6 -потока ..... 419
10.3 Комментарии ..... 422
11 Теория Рамсея ..... 425
11.1 Числа Рамсея ..... 425
11.1.1 Существование. Оценки сверху ..... 425
11.1.2 Экстремальные примеры и оценки снизу ..... 427
11.1.3 Числа Рамсея для раскрасок в несколько цветов ..... 429
11.2 Числа Рамсея больших размерностей ..... 430
11.3 Числа Рамсея для произвольных графов ..... 431
11.4 Индуцированная теорема Рамсея ..... 433
11.4.1 Случай двудольного графа ..... 433
11.4.2 Случай произвольного графа ..... 435
11.5 Комментарии ..... 437
12 Экстремальные графы ..... 439
12.1 Наследственное свойство ..... 439
12.2 Задача о запрещенном подграфе ..... 440

12.2.1 Теорема Турана ..... 440
12.2.2 Графы без $K_{m, n}$ : оценка ..... 442
12.2.3 Проективная плоскость и графы без $K_{2,2}$ ..... 444
12.2.4 Корни из единицы в $\mathbb{F}_{q}$ и графы без $K_{2, n+1}$ ..... 450
12.2.5 Графы без $K_{3,3}$ ..... 452
12.3 Комментарии ..... 455
13 Графы и многочлены ..... 457
13.1 Хроматический многочлен ..... 457
13.1.1 Корни хроматического многочлена ..... 459
13.2 Потоковый многочлен ..... 461
13.2.1 Существование потокового многочлена ..... 461
13.2.2 4 и $\mathbb{Z}_{2} \times \mathbb{Z}_{2}$-потоки ..... 464
13.2.3 Двойственность потоков и раскрасок ..... 465
13.2.4 Вычисление хроматического многочлена через по- токовый ..... 469
13.3 Многочлен Татта ..... 471
13.3.1 Многочлен Татта и ранговый многочлен ..... 472
13.3.2 Многочлен Татта и компоненты графа ..... 475
13.3.3 Универсальное свойство многочлена Татта ..... 477
13.3.4 Многочлен Татта двойственного графа ..... 483
13.4 Дискриминант графа ..... 484
13.4.1 Дискриминант плоской триангуляции ..... 486
13.5 Комментарии ..... 490

# Глава 1 

## Введение

В основном, мы придерживаемся стандартных обозначений. Начнем с используемых в книге "неграфских" понятий и обозначений.

Числовые множества мы будем обозначать так:
$\mathbb{N}$ - множество натуральных чисел;
$\mathbb{N}_{0}$ - множество, состоящее из натуральных чисел и 0 ;
$\mathbb{Z}$ - множество целых чисел;
$\mathbb{P}$ - множество простых чисел;
$\mathbb{Z}_{m}$ - кольцо вычетов по модулю натурального числа $m$;
$\mathbb{F}_{q}$ - конечное поле с $q=p^{n}$ элементами (где $q \in \mathbb{P}$ );
$\mathbb{R}$ - множество вещественных чисел;
$\mathbb{C}$ - множество комплексных чисел;
$[k . . n]$ (для $k, n \in \mathbb{Z}, k \leq n$ ) - множество всех целых чисел, не меньших $k$ и не больших $n$.

Отметим, что при $p \in \mathbb{P}$ мы имеем $\mathbb{Z}_{p}=\mathbb{F}_{p}$. В работе с множествами мы будем использовать стандартные операции:
$A \cap B$ - пересечение множеств, то есть, множество, состоящее из элементов, входящих и в $A$, и в $B$;
$A \cup B$ - обвединение множеств, то есть, множество, состоящее из элементов, входящих хотя бы в одно из множеств $A$ и $B$;
$A \backslash B$ - разность множеств, то есть, множество, состоящее из элементов, входящих в $A$, но не входящих в $B$;
$A \triangle B$ - симметрическая разность множеств, то есть, множество, состоящее из элементов, входящих ровно в одно из множеств $A$ и $B$.

# 1.1 Вершины и рёбра 

Пусть $G$ - граф. Что это такое в нашем понимании? Все как обычно, $G=(V(G), E(G))$, где $V(G)$ - множество вершин графа $G$, а $E(G)$ множество ребер графа $G$. В этой книге рассматриваются только конечные графы, множества вершин и рёбер всегда конечны. Количество вершин графа $G$ мы будем обозначать через $v(G)$, а количество ребер через $e(G)$.

Если не упоминается обратное, граф считается неориентированным, тогда каждое его ребро имеет два кониа, порядок которых не имеет значения. Ребро $e$ называется петлёй, если начало и конец $e$ совпадают. Рёбра $e$ и $e^{\prime}$ называются кратными, если множества их концов совпадают.

Запись $e=x y$ будет обозначать, что вершины $x$ и $y$ - концы ребра $e$. В случае, когда граф не имеет кратных рёбер, концы ребра его однозначно задают. Если же кратные рёбра допустимы, возможны несколько рёбер с концами $x$ и $y$ и запись $e=x y$ допускает наличие другого ребра $e^{\prime}=x y$.

Как правило, мы будем рассматривать графы без петель и кратных рёбер. В случаях, когда кратные рёбра или петли допускаются, об этом будет сказано.

Про концы ребра $e=x y$ - вершины $x$ и $y$ - мы будем говорить, что они соединены ребром $e$. Соединённые ребром вершины мы будем называть смежными. Кроме того, мы будем называть смежными рёбра, имеющие общий конец. Если вершина $x$ - конец ребра $e$, то мы будем говорить, что $x$ и $e$ иниидентны.

Определение 1.1. 1) Вершина $u \in V(G)$ и множество $W \subset V(G)$ смежны, если $u \notin W$ и множество $W$ содержит вершину, смежную с $u$.
1) Два непересекающихся множества $U, W \subset V(G)$ смежны, если существуют смежные вершины $u \in U$ и $w \in W$.

Определение 1.2. Для двух непересекающихся множеств $X, Y \subset V(G)$ мы обозначим через $E_{G}(X, Y)$ множество, состоящее из всех таких рёбер $e \in E(G)$, что $e=x y, x \in X, y \in Y$. Пусть $e_{G}(X, Y)=\left|E_{G}(X, Y)\right|$.

Определение 1.3. 1) Для любой вершины $v \in V(G)$ через $\mathrm{N}_{G}(v)$ мы будем обозначать окрестность вершины $v$ - множество всех вершин графа $G$, смежных с $v$.

Определение 1.4. Пусть $U \subset V(G)$.

1) Через $\mathrm{N}_{G}^{\prime}(U)$ мы будем обозначать множество всех вершин графа $G$, смежных с $U$.

2) Окрестность множества $U-$ это $\mathrm{N}_{G}(U)=\mathrm{N}_{G}^{\prime}(U) \backslash U$.
3) Вершины из $\mathrm{N}_{G}(U)$ мы будем называть контактами множества $U$.

Определение 1.5. 1) Через $K_{n}$ мы будем обозначать полный граф на $n$ вершинах - граф, у которого любые две различные вершины соединены одним ребром.
1) Через $\bar{G}$ мы будем обозначать дополнение графа $G$, то есть, граф на вершинах из $V(G)$, ребра которого дополняют $E(G)$ до множества ребер полного графа.
2) Граф $\bar{K}_{n}$ мы будем называть пустым.
3) Множество $U \subset V(G)$, любые две из которых смежны в графе $G$, называется кликой.

Отметим, что пустой граф - это не пустое множество, а граф без рёбер.

Определение 1.6. 1) Для вершины $x \in V(G)$ через $d_{G}(x)$ обозначим степень вершины $x$ в графе $G$, то есть, количество рёбер графа $G$, инцидентных $x$.
1) Минимальную степень вершины графа $G$ обозначим через $\delta(G)$.
2) Максимальную степень вершины графа $G$ обозначим через $\Delta(G)$.

Лемма 1.1. 1) Сумма степеней всех вериин графа $G$ равна $2 \mathrm{e}(G)$.
1) Количество вериин нечетной степени в любом графе четно.

Первое утверждение очевидно следует из того, что любое ребро имеет ровно два конца, а второе - из первого.

Определение 1.7. Граф $G$ называется регулярным, если степени всех его вершин одинаковы.

Если все эти степени равны $k$, мы также будем называть $G$ регулярным графом степени $k$, или $k$-регулярным графом.

3 -регулярный граф также принято называть кубическим.

# 1.2 Подграфы 

Определение 1.8. 1) Граф $H$ является подграфом графа $G$, если $V(H) \subset V(G)$ и $E(H) \subset E(G)$.
1) Подграф $H$ графа $G-$ остовный, если $V(H)=V(G)$.
2) Пусть $U \subset V(G)$. Через $G(U)$ мы обозначим индуцированный подграф на множестве вершин $U$. Эта запись означает, что $V(G(U))=U$, а $E(G(U))$ состоит из всех рёбер множества $E(G)$, оба конца которых лежат в $U$.

3) Пусть $F \subset E(G)$. Через $G(F)$ мы обозначим индуцированный подграф на множестве рёбер $F$. Это значит, что $E(G(F))=F$, а $V(G(F))$ состоит из всех вершин множества $V(G)$, инцидентных хотя бы одному ребру из $F$.
4) Мы будем использовать обозначение $G[F]$ для графа $(V(G), F)$.
5) Собственный подграф графа $G$ - это подграф, отличный от $G$.

В дальнейшем, говоря "индуцированный подграф графа $G$ ", мы всегда будем подразумевать подграф, индуцированный на некотором множестве вершин $U \subseteq V(G)$.

# 1.3 Некоторые операции над графами 

В этом разделе мы опишем основные операции над графами, которые будут использоваться в дальнейшем. Начнем с простейшей.

Определение 1.9. Пусть $G_{1}$ и $G_{2}$ - два графа. Тогда их объединение $G_{1} \cup G_{2}$ - это граф с множеством вершин $V\left(G_{1}\right) \cup V\left(G_{2}\right)$ и множеством рёбер $E\left(G_{1}\right) \cup E\left(G_{2}\right)$.

Перейдем к самым, наверное, часто встречающимся в теории графов операциям - удаления вершин и рёбер.

Определение 1.10. 1) Для любого множества $R \subset E(G) \cup V(G)$ обозначим через $G-R$ граф, полученный из $G$ в результате удаления всех вершин и рёбер ребер множества $R$, а также всех рёбер, инцидентных вершинам из $R$.
1) Для $x \in E(G) \cup V(G)$ положим $G-x=G-\{x\}$.
2) Пусть $e$ - ребро, соединяющее пару вершин из $V(G)$, не обязательно входящее в $E(G)$. Если $e \notin E(G)$, то через $G+e$ мы будем обозначать граф, полученный из $G$ в результате добавления ребра $e$ (то есть, $G+e=(V(G), E(G) \cup\{e\}))$. Если $e \in E(G)$, то $G+e=G$.

Определим гораздо более сложно описываемую операцию - стягивание ребра. В большинстве глав мы имеем дело с графами без петель и кратных рёбер и эту операцию удобно определить следующим образом.

Определение 1.11. Для ребра $e \in E(G)$ через $G \cdot e$ мы обозначим граф, полученный в результате стягивания ребра $e=x y$. Это означает, что граф $G \cdot e$ получается из графа $G-x-y$ добавлением новой вершины $w$, которая будет смежна в графе $G \cdot e$ со всеми вершинами графа $G$, смежными в $G$ хотя бы с одной из вершин $x$ и $y$. Мы будем применять обозначение $w=x \cdot y$.

В результате описанной операции концы $x$ и $y$ ребра $e$ стягиваются в новую вершину $w$. При определенном таким образом стягивании ребра не возникают ни петли, ни кратные рёбра. Для тех случаях, когда они нам понадобятся, мы дадим более сложное определение стягивания ребра (название операции мы не будем менять, но изменим обозначение).
Определение 1.12. Пусть $G$ - граф, в котором допустимы петли и кратные рёбра, а $e=x y \in E(G)$, причем $x \neq y$. Положим

$$
V(G * e)=(V(G) \backslash\{x, y\}) \cup\{w\}
$$

Отображение $\varphi: V(G) \rightarrow V(G * e)$ задано так, что $\varphi(x)=\varphi(y)=w$ и $\varphi(z)=z$ для остальных вершин $z$.

Для любого ребра $f=a b \in E(G-e)$ пусть $\varphi(f)$ - ребро графа $G * e$ с концами $\varphi(a)$ и $\varphi(b)$, а других рёбер в определяемом графе нет.

Будем говорить, что граф $G * e$ получен из $G$ в результате стягивания ребра $e$ и применять обозначение $w=x * y$.
Замечание 1.1. Отображение $\varphi: E(G-e) \rightarrow E(G * e)$, определенное выше - биекция. Далее мы будем отождествлять соответствующие друг другу при этой биекции рёбра, и работать с множеством рёбер $E(G * e)$ как с $E(G-e)$.

Следующая операция - слияние вершин - фактически то же самое, что стягивание двух несмежных вершин.
Определение 1.13. Пусть $x, y \in V(G)$ - две несмежные вершины. Определим операцию слияния вершин $x$ и $y$ графа $G$ следующим образом: эти вершины объединяются в одну новую вершину $x \# y$, которая будет смежна со всеми вершинами, смежными в графе $G$ хотя бы с одной из вершин $x$ и $y$. Полученный граф обозначим через $G \# x y$.
Замечание 1.2. Результат слияния вершин $x$ и $y$ можно записать с помощью добавления и стягивания рёбер: $G \# x y=(G+x y) \cdot x y$.
Определение 1.14. 1) Граф $H^{\prime}$ называется подразбиением графа $H$, если $H^{\prime}$ может быть получен из $H$ заменой некоторых рёбер на простые пути. При этом, все добавлямые вершины различны и имеют степень 2.
1) Вершины графа $H^{\prime}$, являющиеся вершинами графа $H$ (то есть, не являющиеся внутренними вершинами добавленных путей), называются главными.
2) Через $G \supset H$ будем обозначать, что граф $G$ содержит в качестве подграфа подразбиение графа $H$.

Подразбиение графа - одна из основных операций для работы с планарными графами, которая появляется в знаменитой теореме Куратовского 6.2. Однако, эта операция применяется и в других главах.

# 1.4 Маршруты, пути и циклы 

Определение 1.15. 1) Последовательность вершин $a_{1} a_{2} \ldots a_{n}$ и рёбер $e_{1}, \ldots, e_{n-1}$ графа $G$, где $e_{i}=a_{i} a_{i+1}$ для всех $i \in[1 . . n-1]$, называется маршрутом.
1) Мы будем говорить, что определенный выше маршрут проходит по рёбрам $e_{1}, \ldots, e_{n-1}$ и по вершинам $a_{1}, a_{2}, \ldots, a_{n}$.
2) Маршрут называется замкнутым, если $a_{1}=a_{n}$.

Отметим, что вершины маршрута не обязательно различны. Более того, рёбра, по которым проходит маршрут, не обязательно различны.

Определение 1.16. 1) Путь - это маршрут $a_{1} a_{2} \ldots a_{n}$, не проходящий ни по какому ребру дважды. Кроме того, мы будем говорить, что путь это подграф графа $G$, состоящий из вершин и рёбер, по которым этот путь проходит.
1) Вершину $a_{1}$ назовём началом, а вершину $a_{n}$ - концом пути.
2) Путь называется простым, если все вершины $a_{1}, \ldots, a_{n}$ различны.
3) Длина пути - это количество его рёбер.
4) Если граф $P$ - простой путь, то его внутренность $\operatorname{Int}(P)$ - это множество всех вершин $P$, отличных от концов этого пути. Вершины из $\operatorname{Int}(P)$ называются внутренними вершинами пути $P$.

Итак, путь у нас - это одновременно последовательность вершин, в которой все пары соседних вершин соединены ребрами, а также подграф из этих вершин и рёбер. Эта двусмысленность в дальнейшем нисколько не помешает изложению материала.
Замечание 1.3. 1) Строго говоря, путь - неориентированный граф. Но при работе с путями удобно вводить направление прохода по пути, отличать начало и конец пути друг от друга. При замене направления на противоположное путь как граф не изменяется.
1) Говоря "путь от $x$ до $y$ " мы будем подразумевать простой путь с началом $x$ и концом $y$.

Определение 1.17. 1) Пусть $x, y \in V(G)$. Назовем $x y$-путем любой простой путь от $x$ до $y$.
1) Пусть $X, Y \subset V(G)$. Назовем $X Y$-путем любой простой путь с началом в множестве $X$ и концом в множестве $Y$, внутренние вершины которого не принадлежат множествам $X$ и $Y$.
2) Расстоянием между вершинами $x$ и $y$ графа $G$ называется длина наименьшего $x y$-пути. Обозначение: $\operatorname{dist}_{G}(x, y)$.

Отметим, что если $u \in X \cap Y$, то мы считаем вершину $u X Y$-путем.

Определение 1.18. Пусть $x, y \in V(G)$. Назовем $x y$-пути $P_{1}, \ldots, P_{k}$ независимыми, если $\operatorname{Int}\left(P_{i}\right) \cap \operatorname{Int}\left(P_{j}\right)=\varnothing$, для любых $i, j \in[1 . . k]$.

Как правило, мы будем подразумевать, что рассматриваемый путь простой, и задавать его как последовательность вершин: $a_{1} a_{2} \ldots a_{n}$. Конечно, при наличии кратных рёбер можно выбрать разные рёбра, соединяющие пары соседних вершин пути, но, как правило, это в наших рассуждениях не будет иметь значения.

Определение 1.19. 1) Если $P$ - это путь, а $x, y \in V(P)$, мы будем через $x P y$ обозначать участок пути $P$ от вершины $x$ до вершины $y$.
1) Через $x P$ и $P y$ мы будет обозначать участки пути $P$ от $x$ до конца и от начала до $y$, сооответственно.

Мы будем использовать введенные выше обозначения и для стыковки разных путей: так, например, $x P y Q z$ - это путь, проходящий сначала участок пути $P$ от $x$ до $y$, а затем участок пути $Q$ от $y$ до $z$.
Замечание 1.4. Как правило, мы для удобства фиксируем направление прохода пути $P$. На участке $x P y$ это направление задано порядком вершин $x$ и $y$ и может отличаться от заданного ранее направления прохода пути $P$.

Определение 1.20. 1) Цикл - это последовательность вершин $a_{1} a_{2} \ldots a_{n}$ и различных рёбер $e_{1}, \ldots, e_{n}$ графа $G$, где $e_{i}=a_{i} a_{i+1}$ для всех $i \in[1 . . n]$.
1) Мы будем говорить, что определенный выше цикл проходит по рёбрам $e_{1}, \ldots, e_{n}$ и по вершинам $a_{1}, a_{2}, \ldots, a_{n}$.
2) Кроме того, мы будем говорить, что цикл - это подграф графа $G$, состоящий из вершин и рёбер, по которым этот цикл проходит.
3) Цикл называется простым, если все вершины $a_{1}, \ldots, a_{n}$ различны.
4) Длина цикла - это количество его рёбер.
5) Простой цикл из трёх вершин мы будем называть треугольником.

Как и в ситуации с путём, цикл - это одновременно последовательность вершин и подграф. Мы будем считать, что цикл не изменяется при циклической перестановке его вершин.

Определение 1.21. Пусть $C$ - цикл, а $x, y$ - две его несоседние вершины.

1) Вершины $x$ и $y$ делят цикл $C$ на два пути с концами $x$ и $y$, которые мы будем называть дугами.
2) Если $x y \in E(G)$, назовем ребро $x y$ хордой или (что то же самое) диагональю цикла $C$.

Как правило, для удобства задано направление обхода цикла (хотя смена направления обхода на противоположное и не меняет цикл как граф). В этом случае для обозначения дуги цикла $C$ с началом $x$ и концом $y$ (то есть, от $x$ до $y$ по направлению обхода цикла) мы также будем применять обозначение $x C y$.

Дуга цикла является простым путем. Поэтому, в частности, у дуги определены концы и внутренность.

Определение 1.22. Индуцированный иикл графа $G$ - это простой цикл, не имеющий диагоналей.

Это определение логично в свете сказанного ранее: очевидно, индуцированные циклы графа - это как раз те циклы, что являются его индуцированными подграфами.

Определение 1.23. Пусть $C$ - простой цикл. Простой путь $L$ называется трансверсалъю цикла $C$, если концы пути $L$ - различные вершины $C$, а внутренние вершины не принадлежат циклу $C$. Длиной трансверсали назовём длину пути $L$.

Замечание 1.5. Отметим, что диагональ цикла - это трансверсаль длины 1.

Лемма 1.2. 1) Для любого иикла $Z$ существует такой простой иикл $Z^{\prime}$, что $V\left(Z^{\prime}\right) \subset V(Z)$ и $E\left(Z^{\prime}\right) \subset E(Z)$.
1) Если в графе есть нечетный иикл, то есть и простой нечетный иикл.

Доказательство. 1) Рассмотрим любую вершину $a$ нашего цикла и пойдем от нее до тех пор, пока не окажемся в вершине, в которой уже были. Это, очевидно, произойдет (мы должны вернуться в $a$ ). Пусть первая повторившаяся вершина - это $b$. Тогда в вершине $b$ мы закончим, получив простой цикл, все вершины и ребра которого входят в исходный цикл.
1) Предположим, что наш цикл - не простой и начнем как в предыдущем пункте: найдем первую повторившуюся вершину $b$. Тогда можно изменить порядок обхода нашего большого цикла $Z$ в вершине $b$ и разомкнуть его на два цикла: простой цикл $Z^{\prime}$, описанный в пункте 1 и цикл $Z_{1}$ из оставшихся рёбер цикла $Z$. Эти циклы имеют общую вершину $v$ и $e(Z)=e\left(Z_{1}\right)+e\left(Z^{\prime}\right)$, а значит, либо $e\left(Z^{\prime}\right)$ нечетно (тогда цикл $Z^{\prime}-$ искомый), либо $e\left(Z_{1}\right)$ нечетно, тогда продолжим рассуждения с меньшим нечетным циклом $Z_{1}$.

Лемма 1.3. Если $\delta(G) \geq 2$, то в графе $G$ есть простой путь длины хотя бы $\delta(G)$ и простой иикл длины хотя бы $\delta(G)+1$.

Доказательство. Рассмотрим путь максимальной длины $P=a_{1} a_{2} \ldots a_{n}$ в нашем графе $G$. Из его последней вершины $a_{n}$ выходит хотя бы $\delta(G)-1$ ребер в вершины, отличные от $a_{n-1}$. Так как путь $P$ нельзя продлить, вершина $a_{n}$ смежна только с вершинами пути $P$. Пусть $a_{m}$ - вершина наименьшего номера, смежная с $a_{n}$. Тогда в множестве $\left\{a_{m}, \ldots, a_{n-1}\right\}$ лежат не менее $d_{G}\left(a_{n}\right) \geq \delta(G) \geq 2$ концов выходящих из $a_{n}$ ребер. Следовательно $a_{m} \neq a_{n-1}$ и мы получаем цикл $a_{m} \ldots a_{n-1} a_{n}$, в котором не менее $\delta(G)+1$ вершин. Теперь наличие пути длины хотя бы $\delta(G)$ очевидно.

Лемма 1.4. Пусть $t \in \mathbb{N}$. Для любого графа $G$ с $e(G) \geq t \cdot v(G)$ существует подграф $G^{\prime}$ с $\delta\left(G^{\prime}\right) \geq t+1$.

Доказательство. Предположим, что $\delta(G)<t+1$. Тогда в графе есть вершина $v_{1}$ степени не более $t$. Пусть $G_{1}=G-v_{1}$, тогда

$$
v\left(G_{1}\right)=v(G)-1, \quad e\left(G_{1}\right)=e(G)-d_{G}\left(v_{1}\right) \geq t \cdot(v(G)-1)=t \cdot v\left(G_{1}\right)
$$

Аналогично, на $i$ шаге мы будем удалять из графа $G_{i}$ очередную вершину степени не более $t$ и получать такой подграф $G_{i+1}$, что

$$
v\left(G_{i+1}\right)=v\left(G_{i}\right)-1 \quad \text { и } \quad e\left(G_{i+1}\right) \geq t \cdot v\left(G_{i+1}\right)
$$

Поскольку такое неравенство на количество рёбер очевидно не выполнено для графа на одной вершине, то процесс удаления вершин окончится и на некотором шаге мы получим такой граф $G_{k}$, что $\delta\left(G_{k}\right) \geq t+1$.

Непосредственно из этих двух лемм выводится следующее утверждение.

Следствие 1.1. Пусть $t \in \mathbb{N}$. Если $e(G) \geq t \cdot v(G)$, то в графе $G$ есть простой путь длины хотя бы $t+1$ и простой цикл длины хотя бы $t+2$.

# 1.5 Связность 

Приступим к самому неэлементарному разделу введения. Подробнее о связности мы поговорим в соответствующей главе. Сейчас же мы лишь дадим определения и расскажем о деревьях, а также о блоках и точках сочленения.

# 1.5.1 Компоненты связности 

Определение 1.24. 1) Вершины $a$ и $b$ графа $G$ называются связанными, если в графе существует путь между ними.
1) Граф называется связным, если любые две его вершины связаны.
2) Очевидно, связанность вершин - отношение эквивалентности, и все вершины графа по этому отношению разбиваются на классы эквивалентности - множества попарно связанных вершин. Эти классы эквивалентности мы будем называть компонентами связности графа $G$.
3) Будем называть компонентами графа $G$ подграфы, индуцированные на его компонентах связности.
4) Через $c(G)$ обозначим количество компонент связности графа $G$.
5) Множество $U \subset V(G)$ называется связным, если граф $G(U)$ связен.

Таким образом, компонента связности - это максимальное по включению связное множество вершин графа. Часто под компонентами связности графа $G$ подразумевают максимальные связные подграфы этого графа, которые мы называем просто компонентами. Разница в определениях обусловлена тем, что оба эти понятия весьма часто встречаются в книге, а называть их одним и тем же термином все же нехорошо.

### 1.5.2 Дерево

Определение 1.25. 1) Дерево - это связный граф без циклов.
1) Лес - это граф без циклов.
2) Вершина $x$ графа $G$, имеющая степень 1 , называется висячей вершиной или листом.

Разумеется, все компоненты леса - это деревья. Таким образом, лес, как и положено, состоит из нескольких деревьев. Название "лист" для вершины степени 1 применяют, как правило, только в случае, когда граф - дерево.

Лемма 1.5. 1) В дереве с $n$ вершинами ровно $n-1$ ребро.
1) У любого связного графа существует остовное дерево (то есть, остовный подграф, являющийся деревом).

Доказательство. 1) Докажем утверждение индукцией по количеству вершин в дереве. База для дерева с одной вершиной очевидна. Рассмотрим дерево $T$ с $n \geq 2$ вершинами. По лемме 1.3 в графе, степени всех вершин которого не менее 2 , есть цикл. Очевидно, у связного графа $T$ на $n \geq 2$ вершинах не может быть вершин степени 0 . Значит, у дерева $T$ есть висячая вершина $a$. Понятно, что граф $T-a$ также связен и не

имеет циклов, то есть, это дерево на $n-1$ вершинах. По индукционному предположению мы имеем $e(T-a)=n-2$, откуда очевидно следует, что $e(T)=n-1$.
1) Если в графе есть цикл, то можно удалить из этого цикла ребро. Граф, очевидно, останется связным. Продолжим такие действия до тех пор, пока циклы не исчезнут. Понятно, что рано или поздно это произойдет, так как с каждым шагом уменьшается количество рёбер, а оно изначально конечно. В результате мы получим связный граф без циклов, являющийся остовным подграфом исходного графа, то есть, остовное дерево этого графа.

Следствие 1.2. 1) Дерево с более чем одной вершиной имеет не менее двух висячих вершин.
1) Для любого графа $G$ выполнено $e(G) \geq v(G)-c(G)$.

Доказательство. 1) Если в дереве $T$ не более одной висячей вершины, то остальные имеют степень хотя бы 2 и сумма степеней вершин не менее, чем $2 v(T)-1$. Однако, она же равна $2 e(G)=2 v(G)-2$ по пункту 1 леммы 1.5 , противоречие.
1) По лемме 1.5 каждая компонента графа $G$ имеет остовное дерево, у которого рёбер ровно на одно меньше чем вершин.

Лемма 1.6. Граф $G$ является деревом тогда только тогда, когда для любых двух вершин существует единственный простой путь, соединяющий их.

Доказательство. «. Предположим, что в графе $G$ существует единственный простой путь между любыми двумя вершинами. Тогда граф, очевидно, связан. Если в графе есть цикл, то легко получить противоречие: между любыми двумя вершинами цикла существуют как минимум два простых пути. Значит, $G$ - дерево.
$\Rightarrow$. Пусть $G$ - дерево, тогда понятно, что между любыми двумя его вершинами есть путь. Пусть существует два разных простых $a b$-пути $P_{1}$ и $P_{2}$. Отрежем общие начала этих путей: предположим, что они начинаются в вершине $c$ и их первые рёбра не совпадают. Пойдем по этим путям до их первого пересечения в вершине $d$ (понятно, что такая вершина есть, так как у путей общий конец $b$ ). Мы получили два простых $c d$-пути без общих внутренних вершин, которые, очевидно, образуют цикл. Противоречие.

# 1.5.3 Разделяющие множества 

Определение 1.26. Пусть $X, Y \subset V(G), R \subset V(G) \cup E(G)$.

1) Назовем множество $R$ разделяющим, если граф $G-R$ несвязен.
2) Пусть $X \not \subset R, Y \not \subset R$. Будем говорить, что $R$ разделяет множества $X$ и $Y$ (или, что то же самое, отделяет множества $X$ и $Y$ друг от друга), если никакие две вершины $v_{x} \in X$ и $v_{y} \in Y$ не лежат в одной компоненте связности графа $G-R$.

Здесь и далее мы будем для $x \in V(G)$ отождествлять обозначения $x$ и $\{x\}$. Соответственно, предыдущее определение переносится и на вершины графа $G$ (как одновершинные множества).

Определение 1.27. 1) Вершинная связность $\kappa(G)$ - это минимальное количество вершин в разделяющем множестве $R \subset V(G)$ графа $G$.
1) Будем говорить, что граф $G$ является $k$-связным, если $v(G) \geq k+1$ и $\kappa(G) \geq k$ (то есть, минимальное вершинное разделяющее множество в графе $G$ содержит хотя бы $k$ вершин).

Определение 1.28. 1) Рёберная связность $\lambda(G)$ - это минимальное количество рёбер в разделяющем множестве $R \subset E(G)$ графа $G$.
1) Будем говорить, что граф $G$ является рёберно $k$-связным, если $\lambda(G) \geq k$ (то есть, минимальное рёберное разделяющее множество в графе $G$ содержит хотя бы $k$ рёбер).

Определение 1.29. Ребро $e \in V(G)$ называется мостом, если граф $G-e$ имеет больше компонент связности чем граф $G$.

Замечание 1.6. 1) Ребро графа является мостом тогда и только тогда, когда оно не входит ни в один цикл.
1) Если $e=x y$ - мост связного графа $G$, то нетрудно понять, что в графе $G-e$ ровно две компоненты связности: $U_{x} \ni x$ и $U_{y} \ni y$.
2) Более того, если $F$ - минимальное по включению разделяющее множество связного графа $G$, содержащее хотя бы одно ребро, то $G-F$ имеет ровно две компоненты связности, причем концы каждого ребра множества $F$ принадлежат разным компонентам связности.

# 1.5.4 Части разбиения 

Определение 1.30. Пусть $S$ - разделяющее множество графа $G$. Множество $A \subset V(G)$ назовем частью $S$-разбиения, если никакие две вершины из $A$ нельзя разделить множеством $S$, но любая другая вершина графа $G$ отделена от $A$ множеством $S$.

Множество всех частей разбиения графа $G$ разделяющим множеством $S$ мы будем обозначать через $\operatorname{Part}(S)$.

Нетрудно понять, что часть $A \in \operatorname{Part}(S)$ есть объединение компоненты связности графа $G-S$ и самого множества $S$. В главе 5 мы обобщим это понятие и определим части разбиения графа набором разделяющих множеств. Здесь мы приводим определение части разбиения потому, что это понятие понадобится нам раньше чем в главе 5.
Замечание 1.7. 1) Пусть $H_{1}, \ldots, H_{m}$ - компоненты связности графа $G-S$. Тогда $\operatorname{Part}(S)=\left\{H_{1} \cup S, \ldots, H_{m} \cup S\right\}$.
1) Пусть $S$ - минимальное по включению разделяющее множество. Тогда для любой компоненты связности $H_{i}$ и любой вершины $x \in S$ существует вершина $y \in H_{i}$, смежная с $x$ - иначе множество $S \backslash\{x\}$ было бы разделяющим.
2) Пусть $S$ - минимальное по включению разделяющее множество, $\operatorname{Part}(S)=\left\{F_{1}, \ldots, F_{m}\right\}$. Тогда из первых двух утверждений следует, что граф $G\left(F_{i}\right)$ связен для каждого $i \in[1 . . m]$.

# 1.5.5 Точки сочленения и блоки в связном графе 

В этом разделе пусть $G$ - связный граф.
Определение 1.31. Вершина $a \in V(G)$ называется точкой сочленения, если граф $G-a$ несвязен.

Блоком называется любой максимальный по включению подграф графа $G$, не имеющий точек сочленения.

Замечание 1.8. 1) Блок графа $G$ либо является двусвязным графом, либо блок связен и содержит не более двух вершин.
1) Любое ребро графа входит в блок. Если у связного графа $G$ хотя бы две вершины, то каждая его вершина смежна хотя бы с одной другой вершиной. Следовательно, любой блок графа $G$ содержит хотя бы две вершины.

Определение 1.32. Построим граф $B(G)$, вершины которого соответствуют всем точкам сочленения $a_{1}, \ldots, a_{n}$ графа $G$ и всем его блокам $B_{1}, \ldots, B_{n}$ (мы будем обозначать эти вершины так же, как и блоки). Вершины $a_{i}$ и $B_{j}$ будут смежны, если $a_{i} \in V\left(B_{j}\right)$. Других рёбер в этом графе нет. Граф $B(G)$ называется деревом блоков и точек сочленения.

Теорема 1.1. Дерево блоков и точек сочленения - это действительно дерево, все висячие вершины которого соответствуют блокам.

Доказательство. Связность $B(G)$ очевидно следует из связности графа $G$. Пусть $a$ - точка сочленения, а блоки $B_{1}$ и $B_{2}$ связаны в графе $B(G)-a$. Тогда очевидно, что $a$ не разделяет множество вершин

$V\left(B_{1}\right) \cup V\left(B_{2}\right)$. Таким образом, если висячая вершина графа $B(G)-a$ соответствует точке сочленения, эта точка сочленения не разделяет никакие две вершины графа $G$. Следовательно, все висячие вершины графа $B(G)$ соответствуют блокам графа $G$.

Предположим, что в $B(G)$ есть простой цикл, тогда по доказанному выше все входящие в его блоки (а таких блоков хотя бы два!) вершины невозможно разделить ни одной из точек сочленения, то есть, все они должны входить в один блок, а не в несколько. Таким образом, $B(G)-$ дерево.

Определение 1.33. Назовем блок $B$ крайним, если он соответствует висячей вершине дерева блоков и точек сочленения.

Замечание 1.9. 1) Нетрудно понять, что блок недвусвязного графа $G$ является крайним тогда и только тогда, когда он содержит ровно одну точку сочленения.
1) Если у связного графа $G$ хотя бы две вершины, то каждый его крайний блок содержит вершину, не являющуюся точкой сочленения.
2) Если у связного графа $G$ есть точки сочленения, то он имеет хотя бы два крайних блока. В этом случае крайние блоки содержат ровно по одной точке сочленения.

Определение 1.34. Блоки и точки сочленения несвязного графа - это блоки и точки сочленения его компонент.

# 1.6 Двудольные графы 

Определение 1.35. 1) Раскраской вершин графа $G$ в $k$ цветов называется функция $\rho: V(G) \rightarrow M$, где $|M|=k$. Раскраска $\rho$ называется правильной, если $\rho(v) \neq \rho(u)$ для любой пары смежных вершин $u$ и $v$.
1) Граф называется двудольным, если его вершины можно правильно покрасить в два цвета.

О правильных раскрасках вершин мы подробнее поговорим в соответствующей главе, сейчас же наш предмет изучения - двудольный граф. Часто бывает удобно, говоря от двудольном графе, разбивать его вершины на две доли - множества попарно несмежных вершин, имеющих в правильной двуцветной раскраске один и тот же цвет. Таким образом, двудольный граф $G$ представим в виде $\left(V_{1}(G), V_{2}(G), E(G)\right)$, где рёбра соединяют вершины из разных долей. Такое представление двудольного графа может быть не единственным.

Ниже мы сформулируем и докажем критерий двудольности графа.

Лемма 1.7. Граф является двудольным тогда и только тогда, когда он не содержит циклов нечетной длины.

Доказательство. $\Rightarrow$. Очевидно, так как цикл нечетной длины невозможно правильным образом покрасить в два цвета.
$\Leftarrow$. Можно считать, что наш граф $G$ связен, иначе докажем утверждение отдельно для каждой компоненты. Выделим в связном графе $G$ остовное дерево $T$. Легко понять, что вершины дерева $T$ можно правильным образом покрасить в два цвета: выделим любую вершину $a$ и покрасим в цвет 1 вершины на нечетном расстоянии от $a$, а в цвет 2 саму $a$ и вершины на четном расстоянии от $a$.

Докажем, что получилась правильная раскраска графа $G$. Пусть это не так, и нашлись две смежные вершины $x$ и $y$ одного цвета. Рассмотрим простые пути $P_{x}$ и $P_{y}$ в дереве $T$ от $a$ до $x$ и $y$, соответственно. В дереве такие пути единственны и имеют одинаковую четность, то есть, в сумме дают четное число. Отрезав от $P_{x}$ и $P_{y}$ их общее начало (если такое есть) мы получим $x y$-путь четной длины, который, очевидно, не содержит ребра $x y$. При добавлении этого ребра образуется нечетный цикл, противоречие. Таким образом, граф без нечетных циклов является двудольным.

# 1.7 Орграфы и ориентации 

### 1.7.1 Стрелки

Основным отличием ориентированного графа или просто орграфа от обычного графа является то, что каждое ребро орграфа имеет направление.

Определение 1.36. 1) Мы будем называть рёбра ориентированного графа стрелками, а множество всех стрелок ориентированного графа $D$ стрелок будем обозначать через $A(D)$.
1) Через $E(D)$ мы будем обозначать множество ребер орграфа $D$ без ориентации (каждую стрелку заменим обычным неориентированным ребром).
2) Для непересекающихся множеств $X, Y \subset V(D)$ через $A_{D}(X, Y)$ мы будем обозначать множества всех стрелок орграфа $D$ с началом в $X$ и концом в $Y$. Будем использовать обозначение $a_{D}(X, Y)=\left|A_{D}(X, Y)\right|$.
3) Запись $e=x y \in A(D)$ будет обозначать, что $e$ - стрелка с началом $x$ и концом $y$. В случае, когда допускаются кратные стрелки, эта запись не утверждает, что $e$ - единственная стрелка с началом $x$ и концом $y$.

Если не оговорено обратное, мы будем считать, что в орграфе нет петель и сонаправленных кратных стрелок (у которых совпадают и начала, и концы). Пары противоположно направленных стрелок (вида $u v$ и $v u$ ), как правило, допускаются.

# 1.7.2 Подграфы, степени и окрестности 

Определение 1.37. Подграф орграфа (в частности, индуцированный подграф) определяется так же, как для неориентированных графов. Индуцированный подграф орграфа $D$ на множестве вершин $X \subset V(D)$ будем обозначать через $D(X)$.

Определение 1.38. 1) Для любой вершины $v$ орграфа $D$ мы через $\mathrm{N}_{D}^{+}(v)$ обозначим множество вершин орграфа $D$, в которые выходят стрелки из $v$, а через $\mathrm{N}_{D}^{-}(v)$ обозначим множество вершин орграфа $D$, из которых выходят стрелки в $v$.
1) Множество $\mathrm{N}_{D}(v)=\mathrm{N}_{D}^{+}(v) \cup \mathrm{N}_{D}^{-}(v)-$ окрестность вершины $v$.

Определение 1.39. 1) Степень вершины $x \in V(D)$ - это количество инцидентных ей рёбер из $E(D)$.
1) Для вершины $x \in V(D)$ через $d_{D}^{+}(x)$ мы будем обозначать исходящую степень вершины $v$, то есть, количество стрелок орграфа $D$, выходящих из вершины $x$, а через $d_{D}^{-}(x)$ мы будем обозначать входящую степень вершины $v$ - количество стрелок орграфа $D$, входящих в вершину $x$.
2) Через $\delta(D), \delta^{+}(D)$ и $\delta^{-}(D)$ мы будем обозначать минимальную степень, минимальную исходящую и минимальную входящую степень вершин орграфа $D$, соответственно. Аналогично, $\Delta(D), \Delta^{+}(D)$ и $\Delta^{-}(D)-$ это максимальные степень, входящая степень и исходящая степень орграфа $D$, соответственно.

Замечание 1.10. Нетрудно понять, что для орграфа $D$ и вершины $v \in V(D)$ выполнено

$$
\begin{aligned}
& d_{D}(x)=d_{D}^{+}(x)+d_{D}^{-}(x), \quad d_{D}(v)=\left|\mathrm{N}_{D}(v)\right|, \\
& d_{D}^{+}(v)=\left|\mathrm{N}_{D}^{+}(v)\right|, \quad d_{D}^{-}(v)=\left|\mathrm{N}_{D}^{-}(v)\right| .
\end{aligned}
$$

### 1.7.3 Пути и циклы в орграфе

Пути и ииклы в ориентированном графе отличаются от обычного графа тем, что каждая стрелка может быть пройдена только в соответствии с

направлением от начала к концу. Таким образом, у каждого пути в орграфе есть начало и конеи, а у каждого цикла - фиксированное направление обхода.

Определение 1.40. 1) Путь $P$ называется простым, если все его вершины различны (то есть, каждой вершине $P$ инцидентна не более чем одна входящая и не более чем одна исходящая стрелка из $A(P)$ ).
1) Под $x y$-путём в орграфе мы понимаем простой путь с началом $x$ и концом $y$.
2) Длина пути - это количество его стрелок.
3) Если $P$ - простой путь, то его внутренность $\operatorname{Int}(P)$ - это множество всех вершин $P$, отличных от начала и конца этого пути. Вершины из $\operatorname{Int}(P)$ называются внутренними вершинами пути $P$.
4) Расстояние $\operatorname{dist}_{D}(x, y)$ от вершины $x$ до вершины $y$ в орграфе $D$ есть длина кратчайшего $x y$-пути.
5) Пусть $P$ - путь, а $x, y \in V(P)$, причем вершина $x$ ближе к началу пути $P$, чем вершина $y$. Тогда через $x P y$ обозначим участок пути $P$ с началом $x$ и концом $y$.
6) Для непересекающихся множеств $X, Y \subset V(D)$ под $X Y$-путём мы понимаем простой путь $P$, начало которого лежит в $X$, конец дежит в $Y$, а $\operatorname{Int}(P) \cap X \cup Y=\varnothing$.
7) Как и в неориентированном графе, пути $P_{1}, \ldots, P_{k}$ в орграфе называются независимыми, если никакие два из них не имеют общей внутренней вершины.

Замечание 1.11. В орграфе $D$ возможно, что $\operatorname{dist}_{D}(x, y) \neq \operatorname{dist}_{D}(y, x)$.
Для цикла в орграфе $D$ мы будем использовать термины, аналогичные неорентированному случаю.

Определение 1.41. 1) Цикл $C$ называется простым, если каждой вершине $C$ инцидентна не более чем одна входящая и не более чем одна исходящая стрелка из $A(C)$.
1) Простой цикл из трёх вершин, как и в неориентированном случае, будем называть треугольником.
2) Диагональ, или хорда цикла $C$ - это стрелка $e=x y$, где $x$ и $y-$ несоседние вершины цикла $C$.
3) Трансверсаль цикла $C$ - это простой $x y$-путь $P$, где $x, y \in V(C)$, а $\operatorname{Int}(P) \cap V(C)=\varnothing$.
4) Как и в неориентированном случае, две вершины $x, y \in V(C)$ делят ориентированный цикл $C$ на две дуги: $x C y$ и $y C x$ (одна дуга начинается в $x$ и кончается в $y$, а другая - наоборот).

# 1.7.4 Некоторые операции над орграфами 

Удаление вершин и стрелок из орграфа мы определим и будем обозначать так же, как удаление вершин и рёбер из неориентированного графа.

Аналогично неориентированному графу определим стягивание стрелки. В этом определении подразумевается, что в орграфе нет кратных стрелок (двух стрелок с совпадающими началами и концами), а также петель.

Определение 1.42. Для стрелки $e \in A(D)$ через $D \cdot e$ мы обозначим орграф, полученный в результате стягивания стрелки $e=x y$. Это означает, что $D \cdot e$ получается из орграфа $D-x-y$ добавлением новой вершины $w$, из которой в орграфе $D \cdot e$ будут выходить стрелки в вершины множества $\mathrm{N}_{D}^{+}(x) \cup \mathrm{N}_{D}^{+}(y)$ и в которую в орграфе $D \cdot e$ будут входить стрелки из вершин множества $\mathrm{N}_{D}^{-}(x) \cup \mathrm{N}_{D}^{-}(y)$. Мы будем применять обозначение $w=x \cdot y$.

Еще одна операция над орграфами, имеющая аналог для неориентированных графов - поразбиение.

Определение 1.43. Орграф $H^{\prime}$ называется подразбиением орграфа $H$, если $H^{\prime}$ может быть получен из $H$ заменой некоторых стрелок на простые пути. При этом, все добавлямые внутренние вершины этих путей различны и имеют степень 2 .

И, наконец, самая простая операция - объединение орграфов.
Определение 1.44. Пусть $D_{1}$ и $D_{2}$ - два орграфа. Тогда их объединение $D_{1} \cup D_{2}$ - это граф с множеством вершин $V\left(D_{1}\right) \cup V\left(D_{2}\right)$ и множеством стрелок $A\left(D_{1}\right) \cup A\left(D_{2}\right)$.

### 1.7.5 Ориентация графа

Определение 1.45. 1) Для неориентированного графа $H$ его ориентацией является любой граф $\vec{H}$ с $V(\vec{H})=V(H)$, стрелки которого - это ориентированные каким-либо способом рёбра из $E(H)$. Таким образом, у графа $H$ есть $2^{e(H)}$ ориентаций.
1) Будем говорить, что путь (цикл) графа $H$ в ориентации $\vec{H}$ ориентирован транзитивно, если соответствующие рёбрам этого пути (цикла) стрелки образуют ориентированный путь (цикл) в $\vec{H}$.
2) Для орграфа $D$ определим неориентированный граф $\underline{D}$ с множеством вершин $V(D)$ и множеством рёбер $E(D)$.

Иногда допускается частичная ориентация рёбер графа $G$, когда часть рёбер остается неориентированными, по ним разрешен проход в обеи стороны.

# 1.8 Корневые деревья 

В теории графов используется такой объект, как корневые деревья. Одна вершина дерева объявляется корнем, после чего все рёбра ориентируются в направлении "от корня" (напомним, что любые две вершины дерева соединяет единственный путь, поэтому такое определение корректно). В основном, применяются два вида таких деревьев: деревья поиска в ширину ("подвешивание за вершину") и деревья поиска в глубину (нормальные деревъя).

### 1.8.1 Дерево поиска в ширину

Далее неоднократно будет использоваться термин "подвесить (связный) граф за вершину". Вот что будет под этим подразумеваться. Одна из вершин $a$ связного графа $G$ объявляется корнем и составляет множество вершин уровня 0 (назовем его $L_{0}$ ). Остальные вершины разбиваются на уровни так: в $у р о в е н ь L_{k}$ попадают все вершины, находящиеся на расстоянии $k$ от корня $a$. Каждая вершина уровня $k$ присоединяется к одной из смежных с ней вершин уровня $k-1$. В результате получается дерево, часто бывает удобно ориентировать его рёбра от меньшего уровня к большему. Таким образом, разбиение на уровни единственно, а само дерево - нет.

Отметим важное свойство уровней: рёбра могут соединять либо вершины соседних уровней, либо одного и того же уровня. Действительно, пусть ребро $x y \in E(G)$ соединяет вершину $x \in L_{k}$ с $y \in L_{m}$ и $m>k$. Тогда $m=\operatorname{dist}_{G}(a, y) \leq \operatorname{dist}_{G}(a, x)+1=k+1$.

### 1.8.2 Нормальное дерево

Этот объект сложнее и реже используется, но весьма важен в теории графов.

Определение 1.46. Пусть $G$ - связный граф, $a \in V(G)$. Остовное дерево $T$ называется нормальным деревом с корнем $a$, если для любого ребра $x y \in E(G)$ либо $x$ лежит на $a y$-пути дерева $T$, либо $y$ лежит на $a x$-пути дерева $T$.

Нетрудно доказать, что корневое остовное дерево $\vec{T}$ с корнем $a$ является ориентацией нормального дерева, если и только если для любого ребра $x y \in E(G)$ в $\vec{T}$ существует либо $x y$-путь, либо $y x$-путь (задача ??).

Необходимо доказать, что нормальные деревья существуют.
Теорема 1.2. Пусть $G$ - связный граф, $a \in V(G)$. Тогда $y$ графа $G$ существует нормальное остовное дерево с корнем а.

Доказательство. Индукция по $v(G)$. База для графов с 1 или 2 вершинами очевидна. Докажем переход: предположим, что для меньших чем $G$ графов теорема уже доказана. Пусть $U_{1}, \ldots, U_{m}$ - все компонеты связности графа $G-a, G_{i}=G\left(U_{i}\right)$. Для каждого $i \in[1 . . m]$ отметим вершину $a_{i} \in U_{i} \cap \mathrm{~N}_{G}(a)$ и построим нормальное остовное дерево $T_{i}$ графа $G_{i}$ с корнем $a_{i}$. После этого соединим $a$ с $a_{1}, \ldots, a_{m}$ и получим остовное дерево $T$ исходного графа.

Пусть $x y \in E(G)$. Если обе вершины $x$ и $y$ отличны от $a$, то они лежат в одной из компонент связности $U_{i}$ (так как рёбер между разными компонентами нет), а значит, свойство для ребра $x y$ выполнено по индукционному предположению для $T_{i}$ (если, скажем, $x$ лежит на $a_{i} y$-пути по $T_{i}$, то $x$ лежит и на $a y$-пути по $T$ ). Если же $x=a$, то доказываемое свойство для ребра $x y$ очевидно.

# 1.9 Эйлеров цикл и покрытие рёбер путями 

В этом разделе в рассматриваемых графах возможны кратные рёбра.
Определение 1.47. 1) Эйлеров путь в графе $G$ - это путь, проходящий по каждому ребру ровно один раз.
1) Эйлеров цикл в графе $G$ - это цикл, проходящий по каждому ребру ровно один раз.
2) Граф $G$ - эйлеров, если в нём есть эйлеров цикл.
3) Ориентация графа $G$ - эйлерова, если в каждой вершине количество входящих стрелок равно количеству исходящих стрелок.
4) Эйлеров цикл в орграфе - это (ориентированный) цикл, проходящий по каждому ребру ровно один раз.
5) Орграф $D$ - эйлеров, если он имеет эйлеров цикл.

Разумеется, эйлеров путь и цикл в графе могут иметь самопересечения по вершинам. Начнем с построения эйлерова цикла в графе, который может иметь как ориентированные, так и неориентированные рёбра.

Теорема 1.3. В связном графе $G$ степени всех вершин четны. Некоторые (не обязательно все!) рёбра ориентировали так, что в каждой вершине количество входящих стрелок равно количеству исходящих стрелок. Тогда существует эйлеров иикл, проходящий все ориентированные рёбра в соответствие с направлением стрелок.

Доказательство. Отметим, что количество неориентированных рёбер, инцидентных каждой вершине, четно. Докажем утверждение индукцией по количеству вершин и ребер в графе. Будем считать, что для меньших графов утверждение уже доказано.

Начнем путь в произвольной вершине $a$ и будем идти, удаляя из графа пройденные ребра, пока это возможно. Каждое ориентированное ребро будем проходить только в соответстиве с направлением стрелки на нем. Будем соблюдать для любой вершины $b \neq a$ следующее правило: попадая в некоторую вершину $b$ по ориентированному ребру, выйдем из нее также по ориентированному ребру, а попадая в $b$ по неориентированному ребру, выйдем из нее по неориентированному ребру. Это всегда возможно, так как число входящих и выходящих стрелок в вершине $b$ одинаково, а число неорентированных рёбер - четно. После прохода через $b$ мы либо вычеркнем одну входящую и одну исходящую стрелку, либо два неориентированных ребра, и это условие по-прежнему будет выполнено.

Таким образом, наш путь обязательно закончится в вершине $a$. Если мы вышли по нориентированному ребру, то осталось нечетное число неориентированных рёбер в $a$, поэтому, закончится путь также неориентированным ребром. Если же мы вышли по ориентированному ребру, то в вершине $a$ входящих ребер осталось на одно больше, чем исходящих и путь обязательно закончится ориентированным ребром, входящим в $a$. В результате получится цикл $Z$.

Пусть $G_{1}, \ldots, G_{k}$ - компоненты графа $G-E(Z)$. Степени всех вершин каждой из компонент четны, в любой вершине поровну входящих и исходящих стрелок. Поэтому, в каждом графе $G_{i}$ есть эйлеров цикл $Z_{i}$, проходящий все стрелки в соответствие с направлением. Поскольку граф $G$ связен, то для каждого $i \in[1 . . k]$ существует вершина $u_{i} \in V_{i}$, лежащая на цикле $Z$. Тогда по вершине $u_{i}$ несложно состыковать циклы $Z$ и $Z_{i}$ в один (изменив при этом порядок обхода вершин, но сохранив направление обхода). Проделав такую операцию последовательно для циклов $Z_{1}, \ldots, Z_{k}$, мы получим искомый эйлеров цикл в графе $G$.

Следствие 1.3. Связный граф $G$ - эйлеров, если и только если степени всех вершин $G$ четны.

Доказательство. $\Rightarrow$. Каждый раз, проходя через вершину $v$, эйлеров цикл проходит по двум ребрам, поэтому $d_{G}(v)$ четна.
$\Leftarrow$. Применим теорему 1.3 для графа $G$ без ориентированных рёбер.

Свяжем понятия эйлерова цикла и эйлеровой ориентации.
Следствие 1.4. 1) Граф, все степени вершин которого четны, имеет эйлерову ориентаиию.
1) Для любой эйлеровой ориентаиии рёбер связного графа существует Эйлеров иикл, проходящий все рёбра в заданном этой ориентачией направлении.
2) Орграф $D$ - эйлеров, если и только если у каждой вершины $D$ одинаковы исходящая и входящая степени, а граф $\underline{D}$ связен.

Доказательство. 1) Пусть $G$ - граф, все степени вершин которого четны, а $G_{1}, \ldots, G_{\mathrm{n}}$ - его компоненты. Тогда каждая из них по следствию 1.3 имеет эйлеров цикл $Z_{i}$. Задав направление обхода каждого из циклов $Z_{i}$, мы зададим эйлерову ориентацию графа $G$.
1) Применим теорему 1.3 к нашему графу, все рёбра которого ориентированы в соответствие с эйлеровой ориентацией.
2) $\Rightarrow$. Из существования эйлерова цикла следует, что граф $\underline{D}$ связен. Каждый раз, проходя через вершину $v$, эйлеров цикл использует одну входящую и одну исходящую стрелку, поэтому, $d_{G}^{+}(v)=d_{G}^{-}(v)$.
$\Leftarrow$. Прямое следствие теоремы 1.3 .
В разделе 10.2.2 мы подсчитаем количество эйлеровых ориентаций регулярного графа степени 4 при помощи потоков.

Перейдем к вопросу о существовании эйлерова пути.
Следствие 1.5. Связный граф $G$ имеет эйлеров путь, если и только если в графе $G$ нет вершин нечетной степени или таких вершин ровно две.

Доказательство. $\Rightarrow$. Пусть эйлеров путь имеет концы $a$ и $b$. Если $a=b$, то наш путь - эйлеров цикл, а значит, степени всех вершин четны. Если же $a \neq b$, то в графе ровно две вершины нечетной степени - концы пути $a$ и $b$.
$\Leftarrow$. Количество вершин нечетной степени в графе четно. Если их нет, то в графе есть эйлеров цикл, который является и эйлеровым путем. Пусть в графе $G$ ровно две вершины нечетной степени $a$ и $b$. Добавим в граф ребро $a b$ (если такое ребро есть, то добавим еще одно). Мы получили связный граф $G^{\prime}$, в котором все вершины имеют четную степень и

по следствию 1.3 есть эйлеров цикл $C$. Удалим из цикла $C$ добавленное ребро $a b$ и получим эйлеров путь с концами $a$ и $b$.

И, наконец, докажем результат о покрытии рёбер графа путями.
Следствие 1.6. Пусть в графе $H$ ровно $2 k$ вершин нечетной степени. Тогда $E(H)$ представляется как объединение попарно непересекающихся рёберных множеств $k$ путей и, возможно, нескольких ииклов.

Доказательство. Разобьем вершины нечетной степени на $k$ пар и добавим в граф $k$ рёбер, соединяющих эти пары вершин (если какое-то из этих рёбер в графе есть, добавим еще одно). Получится граф, все степени которого четны. Каждая компонента такого графа имеет эйлеров цикл. Удалив $k$ добавленных рёбер, мы получим $k$ путей с концами в вершинах нечетной степени и, возможно, несколько циклов.

# 1.10 Гиперграф 

Для гиперграфа $\mathcal{H}$ мы будем применять такие же обозначения, как и для графа: множества вершин и гиперребер будем обозначать через $V(\mathcal{H})$ и $E(\mathcal{H})$, а количество вершин и гиперрёбер мы будем обозначать через $v(\mathcal{H})$ и $e(\mathcal{H})$, соответственно. Главное отличие гиперграфа от обычного графа в том, что гиперребро - это произвольное подмножество $V(\mathcal{H})$, состоящее хотя бы из двух вершин. Поэтому удобно оперировать с гиперрёбрами как с множествами вершин графа.

Определение 1.48. 1) Для вершины $v \in V(\mathcal{H})$ пусть $d_{\mathcal{H}}(v)$ - ее степень в гиперграфе $\mathcal{H}$, то есть, количество содержащих $v$ гиперребер.
1) Через $\Delta(\mathcal{H})$ и $\delta(\mathcal{H})$ обозначим максимальную и минимальную степени вершины гиперграфа $\mathcal{H}$, соответственно.

Определение 1.49. Для множества вершин $X \subset V(\mathcal{H})$ определим гиперграф $\mathcal{H}-X$ следующим образом: $V(\mathcal{H}-X)=V(\mathcal{H}) \backslash X$, а

$$
E(\mathcal{H}-X)=\{R \backslash X: R \in E(\mathcal{H}),|R \backslash X| \geq 2\}
$$

Определение 1.50. 1) Гиперграф $\mathcal{G}$ является подграфам гиперграфа $\mathcal{H}$, если $V(\mathcal{G}) \subset V(\mathcal{H})$ и $E(\mathcal{G}) \subset E(\mathcal{H})$.
1) Индуиированный подграф гиперграфа $\mathcal{H}$ на множестве вершин $X \subset V(\mathcal{H})$ - это гиперграф $\mathcal{H}(X)$ с $V(\mathcal{H}(X))=X$, гиперрёбра которого - это все гиперрёбра $\mathcal{H}$, являющиеся подмножествами $X$.

Определим путь и цикл в гиперграфе $\mathcal{H}$. Определения соответствуют понятиям простого пути и цикла в графе.

Определение 1.51. 1) Путь $P$ в гиперграфе $\mathcal{H}$ - это последовательность различных вершин $a_{1} \ldots a_{k}$, где для каждого $i \in[1 . . k-1]$ существует такое $e_{i} \in E(\mathcal{H})$, что $e_{i} \ni x_{i}, x_{i+1}$ и все эти гиперрёбра различны.

Мы считаем путь $P$ подграфом гиперграфа $\mathcal{H}$ с $V(P)=\left\{x_{1}, \ldots, x_{k}\right\}$ и $E(P)=\left\{e_{1}, \ldots, e_{k}\right\}$
1) Цикл $C$ в гиперграфе $\mathcal{H}$ - это последовательность различных вершин $a_{1} \ldots a_{k}$, где для каждого $i \in[1 . . k]$ существует такое $e_{i} \in E(\mathcal{H})$, что $e_{i} \ni x_{i}, x_{i+1}$ и все эти гиперрёбра различны (здесь $x_{k+1}=x_{1}$ ).

Мы считаем цикл $C$ подграфом гиперграфа $\mathcal{H}$ с $V(C)=\left\{x_{1}, \ldots, x_{k}\right\}$ и $E(C)=\left\{e_{1}, \ldots, e_{k}\right\}$.

Определение 1.52. 1) Гиперграф $\mathcal{H}$ называется связным, если любые две его вершины связаны, то есть, соединены путём.
1) Компоненты связности гиперграфа $\mathcal{H}$ определяются так же, как и компоненты связности графа - это максимальные по включению множества попарно связанных вершин.

# 1.11 Изоморфизм графов 

Как нам сделать вывод, что два по-разному заданных графа на самом деле - один и тот же граф?

Определение 1.53. Пусть $G$ и $G^{\prime}$ - два графа, а отображение

$$
\varphi: V(G) \rightarrow V\left(G^{\prime}\right)
$$

таково, что $x y \in E(G)$ если и только если $\varphi(x) \varphi(y) \in E\left(G^{\prime}\right)$. Тогда $\varphi-$ изоморфизм графов $G$ и $G^{\prime}$, а сами графы изоморфны.

В этой книге речь об изоморфизме графов будет идти крайне редко. В основном, мы будем говорить, что изоморфные графы равны друг другу, одинаковы, и.т.д. Это обусловлено тем, что с точки зрения комбинаторной теории графов изоморфные графы имеют одинаковые свойства, по сути такие графы - это разные способы задать один и тот же граф.

### 1.12 Рёберный граф

Определение 1.54. Для любого графа $G$ определим рёберный граф $G_{E}$. Множество его вершин - это множество рёбер графа $G$ (то есть, $V\left(G_{E}\right)=E(G)$ ), а две вершины $e, f \in V\left(G_{E}\right)$ смежны тогда и только тогда, когда соответствующие рёбра графа $G$ смежны, то есть, имеют общий конец.

Как связаны друг с другом связность графа $G$ и рёберного графа $G_{E}$ ? Интуиция подсказывает, что вершинная связность графа $G_{E}$ должна соответствовать рёберной связности графа $G$. Это почти что так, но нам потребуется немного более "рёберное" определение.

Определение 1.55. Назовём граф $G k$-рёберно-ииклически связным, если никакое множество рёбер $F \subset E(G),|F| \leq k-1$, не разделяет $E(G-F)$ (то есть, все рёбра графа $G-F$ соединяют вершины одной компоненты связности, а остальные компоненты связности этого графа - изолированные вершины).

Понятно, что $k$-рёберно связный граф является и $k$-рёберно-циклически связным. Отметим непосредственное следствие данного определения.

Следствие 1.7. Граф $G_{E}$ является $k$-связным, если и только если граф $G$ является $k$-рёберно-ииклически связным.

ГЛАВА 1. ВВЕДЕНИЕ

# Глава 2 

## Паросочетания

Начпём с определений.
Определение 2.1. 1) Множество вершин $U \subset V(G)$ называется независимым, если никакие две его вершины не смежны. Обозначим через $\alpha(G)$ количество вершин в максимальном независимом множестве графа $G$.
1) Множество рёбер $M \subset E(G)$ называется паросочетанием, если никакие два его ребра не имеют общей вершины. Обозначим через $\alpha^{\prime}(G)$ количество рёбер в максимальном паросочетании графа $G$.
2) Будем говорить, что множество вершин $W \subset V(G)$ покрьвает ребро $e \in V(G)$, если существует вершина $w \in W$, инцидентная $e$. Будем говорить, что множество рёбер $F \subset E(G)$ покрьвает вершину $v \in V(G)$, если существует ребро $f \in F$, инцидентное $v$.
3) Паросочетание $M$ графа $G$ называется совершенным, если оно покрывает все вершины графа.
4) Множество вершин $W \subset V(G)$ называется контролирующим, если оно покрывает все рёбра графа. Обозначим через $\beta(G)$ количество вершин в минимальном контролирующем множестве графа $G$.
5) Множество рёбер $F \subset E(G)$ называется покрытием, если оно покрывает все вершины графа. Обозначим через $\beta^{\prime}(G)$ количество рёбер в минимальном покрытии графа $G$.

В этой главе мы выясним много интересных фактов о введённых понятиях и их взаимоотношениях.

## 2.1 Чередующиеся и дополняющие пути

Определение 2.2. Пусть $M$ - паросочетание в графе $G$. Назовём путь $M$-чередуюшимся, если в нём чередуются рёбра из $M$ и рёбра, не вхо-

дящие в $M$. Назовём $M$-чередующийся путь $M$-дополняющим, если его начало и конец не покрыты паросочетанием $M$.

Отметим, что в любом $M$-дополняющем пути нечётное число рёбер и чётное число вершин.

Теорема 2.1. (C. Berge, 1957.) Паросочетание $M$ в графе $G$ является максимальным тогда и только тогда, когда нет $M$-дополняющих путей.

Доказательство. $\Rightarrow$. Пусть в графе $G$ существует $M$-дополняющий путь $S=a_{1} a_{2} \ldots a_{2 k}$. Тогда заменим входящие в $M$ рёбра $a_{2} a_{3}, \ldots, a_{2 k-2} a_{2 k-1}$ на не входящие в $M$ рёбра $a_{1} a_{2}, a_{3} a_{4}, \ldots, a_{2 k-1} a_{2 k}$, и тем самым получим большее паросочетание. Следовательно, $M$ - не максимально.
$\Leftarrow$. Пусть $M$ - не максимальное паросочетание, тогда рассмотрим максимальное паросочетание $M^{\prime},\left|M^{\prime}\right|>|M|$. Пусть $N=M \triangle M^{\prime}, H=$ $G(N)$. Для любой вершины $v \in H$ мы имеем $d_{H}(v) \in\{1,2\}$, следовательно, $H$ - объединение нескольких путей и циклов. Очевидно, в каждом из этих путей и циклов рёбра паросочетаний $M$ и $M^{\prime}$ чередуются. Так как рёбер из $M^{\prime}$ в $E(H)$ больше, хотя бы одна компонента $P$ графа $H-$ путь нечётной длины, в котором больше рёбер из $M^{\prime}$. Легко понять, что $P$ - это $M$-дополняющий путь.

# 2.2 Паросочетания в двудольном графе 

Пусть $G=\left(V_{1}(G), V_{2}(G), E(G)\right)-$ двудольный граф с долями $V_{1}(G)$ и $V_{2}(G)$.

Теорема 2.2. (P. Hall, 1935.) $B$ двудольном графе $G$ есть паросочетание, покрывающее все вершины доли $V_{1}(G)$ тогда и только тогда, когда для любого множества $U \subset V_{1}(G)$ выполняется $|U| \leq\left|\mathrm{N}_{G}(U)\right|$.
Замечание 2.1. Условие о размере окрестности из теоремы Холла мы будем называть условием Холла для доли $V_{1}$.

Доказательство. $\Rightarrow$. Очевидно.
$\Leftarrow$. Индукция по количеству вершин в графе. База для $\left|V_{1}(G)\right|=1$ очевидна. Предположим, что для меньшего чем $G$ графа утверждение уже доказано. Разберём два случая.

1. Пусть существует такое множество $A \subsetneq V_{1}(G)$, что $|A|=$ $\left|\mathrm{N}_{G}(A)\right|$.
Введём обозначения $B=\mathrm{N}_{G}(A), A^{\prime}=V_{1}(G) \backslash A, B^{\prime}=V_{2}(G) \backslash B$. Пусть $G_{1}=G(A \cup B), G_{2}=G\left(A^{\prime} \cup B^{\prime}\right)$. Очевидно, для графа $G_{1}$ выполняется

условие Холла и по индукционному предположению в графе $G_{1}$ существует паросочетание, покрывающее $A$.

Предположим, что условие Холла не выполняется для графа $G_{2}$, то есть, существует множество вершин $U \subset A^{\prime}$, для которого $\left|\mathrm{N}_{G_{2}}(U)\right|<|U|$. Но тогда

$$
\left|\mathrm{N}_{G}(U \cup A)\right|=\left|\mathrm{N}_{G_{2}}(U)\right|+\left|\mathrm{N}_{G}(A)\right|<|U|+|A|=|U \cup A|
$$

противоречие. Значит, в графе $G_{2}$ существует паросочетание, покрывающее все вершины из $A^{\prime}$. Вместе эти два паросочетания дают искомое паросочетание в графе $G$.
1. Для любого множества $A \subsetneq V_{1}(G)$ выполняется $\left|\mathrm{N}_{G}(A)\right|>|A|$. Рассмотрим произвольную вершину $a \in V_{1}(G)$ и смежную с ней вершину $b \in V_{2}(G)$. Пусть $G^{\prime}=G-a-b$. Для любого множества $A \subset V(G) \backslash\{a\}$ выполняется

$$
|A| \leq\left|\mathrm{N}_{G}(A)\right|-1 \leq\left|\mathrm{~N}_{G}(A) \backslash\{b\}\right|=\left|\mathrm{N}_{G^{\prime}}(A)\right|
$$

поэтому в графе $G^{\prime}$ существует паросочетание, покрывающее $V_{1}(G) \backslash\{a\}$. Вместе с ребром $a b$ получаем искомое паросочетание.

Следствие 2.1. (D. König.) 1) В регулярном двудольном графе существует совершенное паросочетание.
1) Регулярный двудольный граф степени $k$ есть объединение $k$ своих совершенных паросочетаний.

Доказательство. 1) Пусть степени всех вершин регулярного графа равны $k$. Проверим условие Холла. Пусть $A \subset V_{1}(G)$, тогда из вершин $A$ выходит $k \cdot|A|$ рёбер к вершинам из $\mathrm{N}_{G}(A)$, а в каждую вершину $b \in \mathrm{~N}_{G}(A)$ входит не более, чем $k$ рёбер из вершин множества $A$. Следовательно, $\left|\mathrm{N}_{G}(A)\right| \geq|A|$ и по теореме 2.2 в графе $G$ существует паросочетание $M$, покрывающее $V_{1}(G)$. Однако, в регулярном графе $\left|V_{1}(G)\right|=\left|V_{2}(G)\right|$ и следовательно, паросочетание $M$ покрывает все вершины из $V_{2}(G)$.
1) Очевидно, $G-M$ - регулярный двудольный граф степени $k-1$. Проджолжая выделять совершенные паросочетания, мы разобьём граф $G$ на $k$ паросочетаний.

Задача 2.1. В одной далекой стране каждый юноша хочет жениться на $k$ знакомых ему девушках. Докажите, что они могут это одновременно сделать тогда и только тогда, когда для любого набора юношей $M$ количество девушек, знакомых хотя бы одному юноше из $M$, не меньше $k \cdot|M|$.

Теорема 2.3. (D. König, 1931.) Пусть $G$ - двудольный граф. Тогда $\alpha^{\prime}(G)=\beta(G)$.

Доказательство. Пусть $M$ - максимальное паросочетание в графе $G$, $U_{1}$ - множество всех непокрытых этим паросочетанием вершин из $V_{1}(G)$, $U_{2}$ - множество непокрытых $M$ вершин из $V_{2}(G)$. Разобьём все покрытые паросочетанием $M$ вершины $V_{1}(G)$ на два множества: $Y_{1}$ - те вершины, до которых можно дойти от $U_{1}$ по $M$-чередующимся путям, а $Z_{1}$ - вершины, до которых дойти таким образом нельзя. Разобьём все покрытые паросочетанием $M$ вершины $V_{2}(G)$ на два множества: $Y_{2}$ - те вершины, до которых можно дойти от $U_{1}$ по $M$-чередующимся путям, а $Z_{2}-$ вершины, до которых дойти таким образом нельзя.


Рис. 2.1: Структура графа $G$.
Далее мы выясним, как должны проходить рёбра паросочетания $M$ и остальные рёбра графа $G$ между определенными выше множествами вершин. На рисунке 2.1 сплошными линиями показаны рёбра паросочетания $M$, пунктирными линиями - невозможные рёбра. Далее мы объясним, почему граф устроен именно так.

Любой $M$-чередующийся путь приходит в вершины множества $Y_{1}$ по ребрам из $M$, поэтому предыдущая вершина перед $Y_{1}$ на таком пути должна лежать в $Y_{2}$. Рёбра паросочетания $M$ не могут соединять $Y_{2}$ с $Z_{1}$ (иначе был бы $M$-чередующийся путь от $U_{1}$ до $Z_{1}$ ). Следовательно, паросочетание $M$ соединяет друг с другом вершины множеств $Y_{1}$ и $Y_{2}$ а также множеств $Z_{1}$ и $Z_{2}$, откуда следует $\left|Z_{1}\right|=\left|Z_{2}\right|$ и $\left|Y_{1}\right|=\left|Y_{2}\right|$.

Докажем, что $B=Z_{1} \cup Y_{2}$ - контролирующее множество. Рёбра не из $M$ не могут соединять вершины из $U_{1} \cup Y_{1}$ с вершинами из $Z_{2}$ (иначе был бы $M$-чередующийся путь от $U_{1}$ до $Z_{2}$ ). Остаётся заметить, что не существует рёбер из $U_{2}$ до $U_{1} \cup Y_{1}$. Если бы такое ребро существовало, то существовал бы $M$-дополняющий путь, что по теореме 2.1 для максимального паросочетания $M$ невозможно.

Заметим, что $|M|=|B|$. Так как в любом контролирующем множестве не меньше вершин, чем в любом паросочетании, отсюда следует, что $\alpha^{\prime}(G)=\beta(G)$.

Теоремы Холла и Кёнига выводятся друг из друга и могут быть доказаны одним и тем же методом. Мы специально привели разные доказательства, чтобы оставить простор для работы читателю.

# 2.3 Соотношения между $\alpha, \beta, \alpha^{\prime}$ и $\beta^{\prime}$ 

Начпём с очевидного.
Замечание 2.2. Очевидно, $U \subset V(G)$ - независимое множество тогда и только тогда, когда $V(G) \backslash U$ - контролирующее множество. Поэтому $\alpha(G)+\beta(G)=v(G)$.

Следующий результат выглядит очень похожим по формулировке, но является более содержательным.

Теорема 2.4. (T. Gallai, 1959). Пусть $G-$ граф с $\delta(G)>0$. Тогда $\alpha^{\prime}(G)+\beta^{\prime}(G)=v(G)$.
Доказательство. $\leq$. Пусть $M$ - максимальное паросочетание, $U-$ множество не покрытых $M$ вершин графа, тогда $|U|=v(G)-2 \alpha^{\prime}(G)$. Так как $\delta(G)>0$, можно выбрать множество $F$ из $|U|$ рёбер, покрывающее $U$. Тогда $M \cup F$ - покрытие, следовательно,
$\beta^{\prime}(G) \leq|M \cup F|=\alpha^{\prime}(G)+v(G)-2 \alpha^{\prime}(G), \quad$ откуда $\quad \alpha^{\prime}(G)+\beta^{\prime}(G) \leq v(G)$.
$\geq$. Пусть $L-$ минимальное рёберное покрытие $\left(|L|=\beta^{\prime}(G)\right.$ ), а $H=(V(G), L)$. Так как в графе $H$ нет вершин степени 0 , в каждой из компоненте графа $H$ можно выбрать по ребру, в результате получится паросочетание $N$ в графе $H$. Очевидно,
$\alpha^{\prime}(G) \geq|N|=c(H) \quad$ и $\quad \beta^{\prime}(G)=|L|=e(H) \geq v(H)-c(H)=v(G)-c(H)$, откуда следует $\alpha^{\prime}(G)+\beta^{\prime}(G) \geq v(G)$.
Следствие 2.2. Пусть $G-$ двудольный граф с $\delta(G)>0$. Тогда $\alpha(G)=\beta^{\prime}(G)$.

Доказательство. По теореме 2.3 для двудольного графа выполняется соотношение $\alpha^{\prime}(G)=\beta(G)$. По замечанию 2.2 и теореме 2.4 мы имеем

$$
\alpha(G)+\beta(G)=v(G)=\alpha^{\prime}(G)+\beta^{\prime}(G)
$$

откуда немедленно следует доказываемое утверждение.

# 2.4 Паросочетания с предпочтениями 

Иногда вершинам не всё равно, с какими вершинами "вступать в паросочетание". Предположим, что каждая вершина имеет список предпочтений, то есть, упорядочивает инцидентные ей рёбра. Наша задача построить такое паросочетание $M$ (не обязательно максимальное), что в нём не будет ребра $e=a b$, которое обе вершины $a$ и $b$ хотели бы поменять на свободные рёбра. Дадим строгие определения.

Определение 2.3. 1) Пусть для каждой вершины $v \in V(G)$ задано линейное отношение (нестрогого) порядка $\leq_{v}$ на множестве всех инцидентных $v$ рёбер из $E(G)$. Тогда $\leq=\left\{\leq_{v}\right\}_{v \in V(G)}$ - множество предпочтений.

Для двух инцидентных вершине $v$ рёбер $e, f$ мы будем использовать запись $e<_{v} f$ для записи строгого неравенства, если такое имеет место.
1) Паросочетание $M$ называется стабильным для множества предпочтений $\leq$, если для любого ребра $f \notin M$ существует такое ребро $e \in M$, что $e$ и $f$ имеют общий конец $v$ и $f \leq_{v} e$.

Следующую теорему называют "Stable marriage theorem".
Теорема 2.5. (D. Gale, L. Shapley, 1962.) Пусть $G$ - двудольный граф. Тогда для любого множества предпочтений $\leq$ в графе $G$ существует стабильное паросочетание.

Доказательство. Будем считать вершины одной доли мужчинами, а вершины другой доли - женщинами, а наше паросочетание будет состоять из семейных пар.

Изначально наше паросочетание пусто, оно будет изменяться пошагово. Опишем шаг алгоритма изменения паросочетания. Сначала действуют мужчины: каждый неженатый (то есть, не покрытый паросочетанием) мужчина выбирает женщину, которая ему больше всех нравится (то есть, наивысшую в своем предпочтении) из тех, которым он еще не делал предложения (если такие есть), после чего делает ей предложение. Затем действуют женщины: каждая из них рассматривает всех мужчин, кто сделал ей предложение и нравится ей строго больше, чем ее муж (если он есть). Если это множество непусто, она выбирает из них того, кто нравится ей больше всего (если таких несколько, то любого из них) и выходит за него замуж (вместо ее прежнего мужа, если он был).

Конечность алгоритма очевидна: никакой мужчина не делает предложение одной женщине дважды. Пусть в результате получилось паросочетнание $M$. Докажем, что $M$ стабильно. Рассмотрим любое ребро $u w \in E(G) \backslash M$ (где $u$ - мужчина). Если $u$ делал предложение $w$, но ему

отказали, то $w$ нашла мужа $u^{\prime}$, который ей нравится не меньше, чем $u$ (то есть, существует ребро $u^{\prime} w \in M$, для которого $u w \leq_{w} u^{\prime} w$ ). Если же $u$ не делал предложения $w$, то в процессе алгоритма нашел жену $w^{\prime}$, которая нравится ему не меньше, чем $w$ (то есть, существует ребро $u w^{\prime} \in M$, для которого $u w \leq_{u} u w^{\prime}$ ). Таким образом, построеннное паросочетание стабильно.

# 2.5 Паросочетания в произвольном графе 

Мы докажем необходимое и достаточное условие наличия в графе совершенного паросочетания. Этот результат принадлежит Татту (1947 г). Мы приведём теорему с более поздним доказательством Ловаса (1973 г).

### 2.5.1 Теорема Татта о совершенном паросочетании

Определение 2.4. Для произвольного графа $G$ через $o(G)$ обозначим количество нечётных компонент связности графа $G$ (то есть, компонент связности, содержащих нечётное число вершин).

Теорема 2.6. (W. T. Tutte, 1947.) B грабе $G$ существует совериенное паросочетание тогда и только тогда, когда для любого $S \subset V(G)$ выполняется условие $o(G-S) \leq|S|$.

Доказательство. $\Rightarrow$. Необходимость условия почти очевидна. Пусть $S \subset V(G)$, а $M$ - совершенное паросочетание. Тогда одна из вершин каждой нечетной компоненты связности графа $G-S$ должна быть соединена с вершиной из $S$ ребром паросочетания $M$, откуда следует требуемое неравенство.
$\Leftarrow$. Предположим, что граф удовлетворяет условию, но не имеет совершенного паросочетания. Тогда, в частности, $o(G) \leq|\varnothing|=0$, то есть, $v(G)$ чётно.

Пусть $G^{*}$ - максимальный надграф $G$ на том же множестве вершин, не имеющий совершенного паросочетания. Для любого $S \subset V(G)$ очевидно, выполняется неравенство $o\left(G^{*}-S\right) \leq o(G-S) \leq|S|$. Пусть $U=\left\{u \in V(G): d_{G^{*}}(u)=v(G)-1\right\}$. Очевидно, $G^{*}$ - не полный граф, поэтому $U \neq V(G)$.

Лемма 2.1. Граф $G^{*}-U-$ обвединение нескольких несвязанных друг с другом полных графов.

Доказательство. Предположим, что это не так, тогда существуют такие вершины $x, y, z \in V(G) \backslash U$, что $x y, y z \in E\left(G^{*}\right)$, но $x z \notin E\left(G^{*}\right)$. Так как $y \notin U$, существует такая вершина $w \notin U$, что $y w \notin E\left(G^{*}\right)$.

Ввиду максимальности графа $G^{*}$ существует совершенное паросочетание $M_{1}$ в графе $G^{*}+x z$ и совершенное паросочетание $M_{2}$ в графе $G^{*}+y w$. Так как в графе $G^{*}$ нет совершенного паросочетания, $x z \in M_{1}$ и $y w \in M_{2}$. Пусть $H=\left(V(G), M_{1} \cup M_{2}\right)$. Очевидно, граф $H-$ несвязное объединение чётных циклов, в каждом из которых чередуются рёбра паросочетаний $M_{1}$ и $M_{2}$. На вершинах любой компоненты связности графа $H$ существует совершенное паросочетание с рёбрами из $M_{1}$ и совершенное паросочетание с рёбрами из $M_{2}$. Рассмотрим два случая.

1. Пары вершин $x, z$ и $y, w$ лежат в разных компонентах связности $W_{1}$ и $W_{2}$ графа $H$, соответственно.
Тогда на вершинах множества $W_{1}$ мы выберем рёбра паросочетания $M_{2}$, на вершинах множества $W_{2}$ мы выберем рёбра паросочетания $M_{1}$, а в остальных компонентах связности графа $H$ - любого из этих паросочетаний. В итоге получится совершенное паросочетание графа $G^{*}$, противоречие.
1. Все четыре вершины $x, z, y, w$ лежат в одной компоненте связности $W$ графа $H$.


Рис. 2.2: Компонента, содержащая $x, y, z$ и $w$.
Пусть $C=H(W)$. В силу симметричности $x$ и $z$ можно считать, что вершины расположены в чётном цикле $C$ в порядке $y w z x$ (см. рисунок 2.2). Рассмотрим простой путь $P=x C y z C w$, состоящий из двух дуг цикла $C$ и ребра $y z$. Тогда $V(P)=V(C)$ и $E(P) \subset E\left(G^{*}\right)$. Следовательно, существует полное паросочетание $M_{W} \subset E\left(G^{*}\right)$ на вершинах компоненты связности $W$.

В остальных компонентах связности графа $H$ выберем рёбра любого из паросочетаний $M_{1}$ и $M_{2}$, в итоге получится совершенное паросочетание графа $G^{*}$, противоречие.

Вернёмся к доказательству теоремы Татта. Итак, граф $G^{*}-U$ есть объединение нескольких несвязанных полных графов. В силу условия, среди них не более чем $|U|$ имеет нечетное число вершин. В каждой

чётной компоненте графа $G^{*}-U$ мы построим полное паросочетание, в каждой нечётной компоненте - паросочетание, покрывающее все вершины, кроме одной, а оставшуюся вершину соединим с вершиной из $U$ (при этом мы используем различные вершины множества $U$ : их хватит ввиду $o\left(G^{*}-U\right) \leq|U|$ ). Наконец, мы разобём на пары оставшиеся непокрытыми вершины множества $U$ : это можно сделать, так как каждая из этих вершин смежна в графе $G^{*}$ со всеми остальными. Таким образом, мы получили совершенное паросочетание в графе $G^{*}$, противоречие.

Теорема Татта играет очень важную роль в теории паросочетаний. Условие на количество нечётных компонент связности $o(G-S) \leq|S|$ называют условием Tатта. Теперь для доказательства существования в графе совершенного паросочетания достаточно проверить условие Татта для всех множеств $S \subset V(G)$.

Пусть $S \subset V(G)$ таково, что $o(G-S)>|S|$. Такое множество мы будем называть множеством Tатта графа $G$. По теореме Татта, если в графе $G$ нет совершенного паросочетания, то в нём есть хотя бы одно множество Татта. Далее мы покажем, как применяется теорема Татта.

# 2.5.2 Совершенное паросочетание в регулярном графе 

Теорема о совершенном паросочетании в кубическом графе впервые была доказана Петерсеном в 1891 году. Доказательство было весьма непростым, но имея столь серьёзное средство, как теорема Татта, мы докажем даже более сильное утверждение намного проще.

Лемма 2.2. Пусть $G$ - регулярный граф степени $k, U \subset V(G)$, $|U|$ нечётно, $m$ - число рёбер, соединяющих вершины множества $U$ с вершинами из $V(G)-U$. Тогда $m \equiv k(\bmod 2)$.

Доказательство. Очевидно,

$$
m=\left(\sum_{v \in U} d_{G}(v)\right)-2 e(G(U))=k|U|-2 e(G(U)) \equiv k \quad(\bmod 2)
$$

Теорема 2.7. (J. Petersen, 1891.) Пусть $G$ - связный кубический граф, в котором не более двух мостов. Тогда в графе $G$ есть совершенное паросочетание.

Доказательство. Предположим, что совершенного паросочетания в графе $G$ нет, тогда по теореме 2.6 можно выбрать множество Татта $S \subset V(G)$. Пусть $U_{1}, \ldots, U_{n}$ - все нечётные компоненты связности графа $G-S, m_{i}=e_{G}\left(U_{i}, S\right)$. По лемме 2.2 все числа $m_{1}, \ldots, m_{n}$ нечётны. Так как не более чем два ребра графа $G$ - мосты, то не более, чем два числа из $m_{1}, \ldots, m_{n}$ равны 1 , а все остальные - не менее, чем 3 .

Напомним, что $o(G-S)>|S|$. Так как количество вершин кубического графа $G$ чётно, мы имеем $S \neq \varnothing$ и $o(G-S) \equiv|S|(\bmod 2)$, следовательно, $n=o(G-S) \geq|S|+2$. Тогда
$\sum_{v \in S} d_{G}(v) \geq \sum_{i=1}^{n} m_{i} \geq 3 n-4 \geq 3(|S|+2)-4=3|S|+2>3|S|=\sum_{v \in S} d_{G}(v)$, что, очевидно, невозможно.

Результат теоремы 2.7 в некотором смысле наилучший возможный: легко придумать связный кубический граф с тремя мостами, у которого нет совершенного паросочетания (см. рисунок 2.3).


Рис. 2.3: Кубический граф без совершенного паросочетания.

Теорема 2.8. (J.Plesnik, 1972.) Пусть $G$ - регулярный граф степени $k$ с чётным числом вершин, причём $\lambda(G) \geq k-1$, а граф $G^{\prime}$ получен из $G$ удалением не более, чем $k-1$ рёбер. Тогда в графе $G^{\prime}$ есть совершенное паросочетание.

Доказательство. Пусть множество $F \subset E(G)$ таково, что $G^{\prime}=G-F$. Тогда $|F| \leq k-1$.

Предположим, что условие Татта не выполняется и рассмотрим множество Татта $S \subset V\left(G^{\prime}\right)$ (возможно, $S=\varnothing$ ). Так как $o\left(G^{\prime}-S\right)+|S| \equiv$ $v(G) \equiv 0(\bmod 2)$, то из $o\left(G^{\prime}-S\right)>|S|$ следует $o\left(G^{\prime}-S\right) \geq|S|+2$.

Пусть $U_{1}, \ldots, U_{n}$ - нечётные, а $U_{n+1}, \ldots, U_{t}$ - чётные компоненты связности графа $G^{\prime}-S$. Для каждого $i \in[1 . . t]$ пусть $\alpha_{i}-$ количество рёбер из $E\left(G^{\prime}\right)$, соединяющих $U_{i}$ с $S, \beta_{i}$ - количество рёбер из $F$, соединяющих $U_{i}$ с $S, \gamma_{i}$ - количество рёбер из $F$, соединяющих $U_{i}$ с остальными

компонентами связности графа $G^{\prime}-S$ и $m_{i}=\alpha_{i}+\beta_{i}+\gamma_{i}$. Тогда $m_{i}-$ это количество рёбер графа $G$, соединяющих $U_{i}$ с $V(G) \backslash U_{i}$. По лемме 2.2 для нечётных компонент связности (то есть, для $i \in[1 . . n]$ ) мы имеем $m_{i} \equiv k$ $(\bmod 2)$. Кроме того, $m_{i} \geq \lambda(G) \geq k-1$, следовательно, $m_{i} \geq k$. Отсюда получаем неравенство

$$
\sum_{i=1}^{n} \alpha_{i}+\sum_{i=1}^{n} \beta_{i}+\sum_{i=1}^{n} \gamma_{i} \geq k n
$$

Отметим два очевидных факта:

$$
\begin{gathered}
\sum_{i=1}^{t} \alpha_{i}+\sum_{i=1}^{t} \beta_{i} \leq k \cdot|S| \\
2 \sum_{i=1}^{t} \beta_{i}+\sum_{i=1}^{t} \gamma_{i} \leq 2|F| \leq 2 k-2
\end{gathered}
$$

сложив которые, мы получим

$$
\sum_{i=1}^{t} \alpha_{i}+3 \sum_{i=1}^{t} \beta_{i}+\sum_{i=1}^{t} \gamma_{i} \leq k(|S|+2)-2
$$

Из неравенств (2.1) и (2.2) получаем $k n \leq k(|S|+2)-2$ и, следовательно, $o\left(G^{\prime}-S\right)=n<|S|+2$, что противоречит доказанному выше. Таким образом, условие Татта выполняется и по теореме 2.6 в графе $G^{\prime}$ существует совершенное паросочетание.

Следствие 2.3. Пусть $G$ - регулярный граф степени $k$ с чётным числом вершин, причём $\lambda(G) \geq k-1$. Тогда для любого ребра $e \in E(G)$ существует совершенное паросочетание графа $G$, содержащее е.

Доказательство. Пусть $e=a b$, а $e_{1}, \ldots, e_{k-1}-$ остальные рёбра, инцидентные вершине $a$. По теореме 2.8 , в графе $G-\left\{e_{1}, \ldots, e_{k-1}\right\}$ есть совершенное паросочетание $M$. Очевидно, $M \ni e$.

# 2.5.3 Факторы регулярного графа 

Определение 2.5. $k$-фактором графа $G$ называется его остовный регулярный подграф степени $k$.

Совершенное паросочетание - это 1-фактор. Следующая теорема, очень похожая по формулировке, говорит о наличии 2-фактора.

Теорема 2.9. (J. Petersen, 1891.) У регулярного графа чётной степени есть 2 -фактор.

Доказательство. Пусть $G$ - регулярный граф степени $2 k$. По следствию 1.4 граф $G$ имеет эйлерову ориентацию $\bar{G}$. Построим граф $G^{*}$ следующим образом. Разделим каждую вершину $v \in V(G)$ на две вершины $v_{1}$ и $v_{2}$. Для каждой стрелки $x y \in A(\bar{G})$ проведём в графе $G^{*}$ ребро $x_{1} y_{2}$. Таким образом, $e\left(G^{*}\right)=e(G)$.

Так как в каждую вершину $\bar{G}$ входит и выходит ровно по $k$ стрелок, $G^{*}$ - регулярный двудольный граф степени $k$ с долями $\left\{v_{1}\right\}_{v \in V(G)}$ и $\left\{v_{2}\right\}_{v \in V(G)}$. По следствию 2.1 в графе $G^{*}$ есть совершенное паросочетание $M^{*}$. Проведём соответствующие рёбрам из $M^{*}$ рёбра в графе $G$. Нетрудно понять, что получится 2 -фактор $M$.

Следствие 2.4. 1) Регулярный граф степени $2 k$ есть объединение $k$ своих 2 -факторов.
1) Для любого $r \leq k$ регулярный граф степени $2 k$ имеет $2 r$-фактор.

Все остальные утверждения вида "у регулярного графа степени $k$ есть фактор степени $r$ " без дополнительных условий на граф, увы, неверны. Для доказательства существования факторов помогает условие о рёберной связности.

Следствие 2.5. Пусть $G$ - регулярный граф степени $2 k+1$, причём $\lambda(G) \geq 2 k$, а $r \leq 2 k+1$. Тогда $y$ графа $G$ существует $r$-фактор.

Доказательство. По теореме 2.8 в графе $G$ есть совершенное паросочетание $M$. Граф $G^{\prime}=G-M$ - регулярный граф степени $2 k$, а значит, имеет регулярные факторы всех четных степеней $2 t \leq 2 k$. Следовательно, граф $G^{\prime}$ имеет регулярные факторы всех возможных нечетных степеней. Их дополнения до графа $G$ будут его факторами всех возможных четных степеней.

Утверждение следствия 2.5 можно доказать при более слабых условиях на граф. Однако, доказательство использует более сложную технику - теорию факторов. Это и другие утверждения о факторах регулярных графов можно найти в разделе 2.6.4.

Мы приведем несложную теорему о существовании "почти регулярного фактора".

Теорема 2.10. (C. Thomassen, 1981.) Пусть $G$ - граф, степени всех вершин которого равны $k$ или $k+1$, а $r<k$. Тогда существует остовный подграф $H$ графа $G$, степени всех вершин которого равны либо $r$, либо $r+1$.

Доказательство. Спуск по $r$. База для $r=k$ очевидна, в этом случае подойдет $H=G$.

Переход $r \rightarrow r-1$. Пусть граф $G$ имеет остовный подграф $F$, степени вершин которого равны $r$ или $r+1$. Начиная с графа $F$, пока это возможно, будем производить следующую операцию: удалять ребро, соединяющее две вершины степени $r+1$. В результате получится подграф $F^{\prime}$ графа $F$, степени вершин которого равны $r$ или $r+1$, в котором никакие две вершины степени $r+1$ не смежны.

Пусть $V_{r+1}$ - множество всех вершин степени $r+1$ в графе $F^{\prime}$. Можно считать, что $V_{r+1} \neq \varnothing$, иначе граф $F^{\prime}$ нам подходит. Пусть $V_{r}=$ $V(G) \backslash V_{r+1}$, а $B$ - двудольный граф с долями $V_{r+1}$ и $V_{r}$, ребра которого - это $E_{F^{\prime}}\left(V_{r+1}, V_{r}\right)$. По построению графа $F^{\prime}$, для каждой вершины $x \in V_{r+1}$ мы имеем $d_{B}(x)=r+1$, а для каждой вершины $y \in V_{r}$ мы имеем $d_{B}(y) \leq r$. Поэтому для доли $V_{r+1}$ выполнено (и даже перевыполнено!) условие Холла: $\left|\mathrm{N}_{B}(A)\right|>|A|$ для любого $A \subset V_{r+1}$. Тогда по теореме Холла 2.2 в графе $B$ существует паросочетание $M$, покрывающее все вершины из $V_{r+1}$. Очевидно, граф $H=F^{\prime}-M$ нам подходит.

Частным случаем этой теоремы является теорема Татта о почти регулярном факторе (следствие 2.6), впервые доказанная Таттом в 1978 году. Доказательство Татта использовало разработанную им теорию факторов, о которой мы расскажем дальше. Таким образом, Томассен нашел элементарное доказательство теоремы Татта.

Следствие 2.6. (W.T. Tutte, 1978.) Пусть $G-$ регулярный граф степени $k, r<k$. Тогда существует остовный подграф $H$ графа $G$, степени всех вершин которого равны либо $r$, либо $r+1$.

Еще одним следствием теоремы Томассена является теорема Ловаса о максимальных степенях, первоначальное доказательство которой также было весьма технически сложным.

Следствие 2.7. (L. Lovász, 1970.) Пусть $s, t \in \mathbb{N}$. Тогда любой граф максимальной степени $s+t-1$ представляется в виде объединения графа максимальной степени не более $s$ и графа максимальной степени не более $t$.

Доказательство. Пусть $G-$ граф с $\Delta(G)=s+t-1$. Несложно добавить в граф вершин и рёбер так, чтобы получился регулярный граф $H$ степени $k=s+t-1$. По следствию 2.6 , граф $H$ имеет остовный подграф $H_{1}$, степени всех вершин которого равны $t$ или $t-1$. Оставшиеся рёбра графа $H$ образуют граф, степени вершин которого равны $s$ или $s-1$. Удалив из графов $H_{1}$ и $H_{2}$ добавленные вершины и рёбра, мы

получим подграфы $G_{1}$ и $G_{2}$ графа $G$ с $\Delta\left(G_{1}\right) \leq t$ и $\Delta\left(G_{2}\right) \leq s$. Легко видеть, что $G=G_{1} \cup G_{2}$.

# 2.5.4 Дефицит графа. Формула Бержа 

А что делать в случае, когда в графе нет совершенного паросочетания?
Определение 2.6. Дефиұитом графа $G$ мы будем называть величину $\operatorname{def}(G)=v(G)-2 \alpha^{\prime}(G)$.

Замечание 2.3. 1) Дефицит графа $G$ - это количество вершин, не покрытых максимальным паросочетанием графа $G$.
1) Очевидно, $\operatorname{def}(G)=0$ тогда и только тогда, когда в графе $G$ есть совершенное паросочетание.
2) Определение дефицита можно переписать в виде формулы для вычисления размера максимального паросочетания в графе:

$$
\alpha^{\prime}(G)=\frac{v(G)-\operatorname{def}(G)}{2}
$$

Утверждение, которое мы докажем в следующей теореме, называется формулой Бержа.

Теорема 2.11. (C. Berge, 1958.) Для любого графа $G$ выполняется равенство

$$
\operatorname{def}(G)=\max _{S \subset V(G)} o(G-S)-|S|
$$

Доказательство. $\geq$. Пусть $M$ - максимальное паросочетание графа $G$, $S \subset V(G), n=o(G-S)$, а $U_{1}, \ldots, U_{n}$ - все нечётные компоненты связности графа $G-S$. Тогда в каждой нечётной компоненте связности $U_{i}$ существует хотя бы одна вершина $u_{i}$, которая не покрыта ребром $M$ или покрыта ребром $e_{i}=u_{i} x_{i} \in M$, где $x_{i} \in S$. Следовательно, не менее, чем $n-|S|$ из вершин $u_{1}, \ldots, u_{n}$ не покрыты паросочетанием $M$, откуда следует неравенство $\operatorname{def}(G) \geq o(G-S)-|S|$.
$\leq$. Пусть

$$
k=\max _{S \subset V(G)} o(G-S)-|S|
$$

Если $k=0$, по теореме 2.6 в графе $G$ есть совершенное паросочетание и $\operatorname{def}(G)=0$, этот случай тривиален. Пусть $k>0, W-$ множество из $k$ новых вершин $(W \cap V(G)=\varnothing)$, а граф $H$ получен присоединением к $G$ вершин множества $W$, причём каждая из вершин множества $W$ будет смежна со всеми остальными вершинами графа $H$.

Покажем, что для графа $H$ выполняется условие Татта. Понятно, что $k \equiv v(G)(\bmod 2)$, поэтому $v(H)=v(G)+k$ чётно. Таким образом, достаточно проверить условие для непустых множеств $T \subset V(H)$. Если $T \not \supset W$, то граф $H-T$ связан и $o(H-T) \leq 1 \leq|T|$. Если $T=W \cup S$, где $S \subset V(G)$, то $o(H-T)=o(G-S) \leq k+|S|=|T|$. В обоих случаях условие Татта выполняется и по теореме 2.6 в графе $H$ есть совершенное паросочетание $N$. Очевидно, тогда в графе $G$ существует такое паросочетание $M$, что $|M| \geq|N|-k$, следовательно,

$$
\alpha^{\prime}(G) \geq|M| \geq \frac{v(G)+k}{2}-k=\frac{v(G)-k}{2}
$$

откуда немедленно следует доказываемое неравенство.

# 2.5.5 Фактор-критические графы 

Определение 2.7. 1) Граф $G$ называется фактор-критическим, если для любой вершины $u \in V(G)$ у графа $G-u$ есть совершенное паросочетание.
1) Паросочетание $M$ в графе $G$ называется почти совершенным, если $M$ покрывает все вершины графа $G$, кроме одной.

Замечание 2.4. 1) Очевидно, фактор-критический граф не имеет совершенного паросочетания, количество вершин фактор-критического графа нечётно.
1) Ввиду формулы (2.3) понятно, что если граф $G$ - фактор-критический, то $\operatorname{def}(G)=1$.
2) Граф $G$ является фактор-критическим тогда и только тогда, когда для любой его вершины $u \in V(G)$ существует почти совершенное паросочетание $M_{u}$, не покрывающее $u$.

Легко видеть, что для фактор-критического графа $G$ и любой вершины $u \in V(G)$ выполняется равенство $\alpha^{\prime}(G-u)=\alpha^{\prime}(G)$. Гораздо интереснее, что это условие заставляет граф быть фактор-критическим. Это доказывается в следующей теореме, которую часто называют леммой Галлаи.

Теорема 2.12. (T. Gallai, 1963.) Пусть связный граф $G$ таков, что для любой вершины $u \in V(G)$ выполняется равенство $\alpha^{\prime}(G-u)=\alpha^{\prime}(G)$. Тогда $G$ - фактор-критический граф.

Доказательство. Рассмотрим множество Татта $S$, для которого $o(G-S)-|S|=\operatorname{def}(G)=k$ (такое существует по теореме 2.11) и предположим, что $S \neq \varnothing$. Пусть $v \in S, G^{\prime}=G-v$. Положим $S^{\prime}=S \backslash\{v\}$.

Очевидно, $G^{\prime}-S^{\prime}=G-S$, откуда следует, что
$\operatorname{def}(G-v)=\operatorname{def}\left(G^{\prime}\right) \geq o\left(G^{\prime}-S^{\prime}\right)-\left|S^{\prime}\right|=(o(G-S)-|S|)+1=\operatorname{def}(G)+1$.
Тогда ввиду формулы (2.3) получается $\alpha^{\prime}(G) \geq \alpha^{\prime}(G-v)+1$, что невозможно по условию. Следовательно, $S=\varnothing$ и, так как граф $G$ связен, мы имеем $\operatorname{def}(G)=o(G) \leq 1$. Однако, из условия теоремы очевидно, что у графа $G$ нет совершенного паросочетания, следовательно, $\operatorname{def}(G)=1$ и граф $G$ является фактор-критическим.

Из доказательства теоремы 2.12 мы извлечём следствие.
Следствие 2.8. Пусть $G$ - фактор-критический граф. Тогда $\varnothing$ - единственное множество Татта графа $G$.

Доказательство. Для любой вершины $u$ фактор-критического графа $G$ выполняется равенство $\alpha^{\prime}(G-u)=\alpha^{\prime}(G)$. Поэтому можно применить рассуждения из доказательства теоремы 2.12 и получить, что максимум $o(G-S)-|S|$ достигается только при $S=\varnothing$, причём этот максимум равен 1. Поскольку $o(G-S)-|S| \geq 1$ для любого множества Татта $S$, то непустых множеств Татта у фактор-критического графа нет.

# 2.5.6 Структурная теорема Галлаи-Эдмондса 

В этом разделе мы докажем теорему о структуре максимального паросочетания в графе. Для графа $G$ введём следующие обозначения:
$D(G)$ - множество из всех вершин $u \in V(G)$, для каждой из которых существует максимальное паросочетание $M_{u}$ графа $G$, не покрывающее $u$;
$A(G)$ - множество всех вершин графа $G$, не входящих в $D(G)$, но смежных хотя бы с одной вершиной из $D(G)$;
$C(G)=V(G) \backslash(A(G) \cup D(G))$.
Следующее утверждение носит название Stability lemma.
Лемма 2.3. Пусть $a \in A(G)$. Тогда $D(G-a)=D(G), A(G-a)=$ $A(G) \backslash\{a\}, C(G-a)=C(G), \alpha^{\prime}(G-a)=\alpha^{\prime}(G)-1$.

Доказательство. Очевидно, достаточно доказать, что $D(G-a)=D(G)$.
$\supset$. Пусть $u \in D(G)$. Тогда существует максимальное паросочетание $M_{u}$ графа $G$, не покрывающее $u$. Поскольку любое максимальное паросочетание графа $G$ покрывает $a$, то $\alpha^{\prime}(G-a)=\alpha^{\prime}(G)-1$ и более того, если $a x \in M_{u}$, то $M_{u} \backslash\{a x\}$ - максимальное паросочетание графа $G-a$, не покрывающее $u$. Таким образом, $D(G-a) \supset D(G)$.

С. Предположим, что существует максимальное паросочетание $M^{\prime}$ графа $G-a$, не покрывающее вершину $v \notin D(G)$. Пусть $w \in D(G)-$ смежная с $a \in A(G)$ вершина, а $M_{w}$ - максимальное паросочетание графа $G$, не покрывающее $w$. Так как $v \notin D(G)$, максимальное паросочетание $M_{w}$ покрывает вершину $v$.

Рассмотрим граф $H=G\left(M_{w} \cup M^{\prime}\right)$ - очевидно, он является объединением нескольких путей и чётных циклов. Пусть $P$ - компонента графа $H$, содержащая $v$. Так как $d_{P}(v)=1$, то $P$ - путь с началом в вершине $v$. В пути $P$ чередуются рёбра из $M_{w}$ и $M^{\prime}$, причём начинается путь ребром из $M_{w}$. Так как $d_{H}(a)=1$, то вершина $a$ либо не принадлежит пути $P$, либо является её концом (в этом случае последнее ребро пути принадлежит паросочетанию $M_{w}$ ). Рассмотрим несколько случаев.
а. Путь $P$ кончается ребром из $M^{\prime}$ (см. рисунок 2.4 a).

Рассмотрим паросочетание $M_{v}=M_{w} \triangle E(P)$ (симметрическая разность $M_{w}$ и $E(P)$, то есть, рёбра, входящие ровно в одно из двух множеств). Очевидно, $M_{v}$ - максимальное паросочетание графа $G$, не покрывающее $v$, поэтому $v \in D(G)$, противоречие.


Рис. 2.4: Путь $P$.
б. Путь $P$ кончается ребром из $M_{w}$, вершина а - конеи пути $P$ (см. рисунок 2.4 b$)$.
Рассмотрим паросочетание $M_{v}^{*}=\left(M_{w} \triangle E(P)\right) \cup\{a w\}$. Тогда $M_{v}^{*}-$ максимальное паросочетание графа $G$, не покрывающее $v$, поэтому $v \in D(G)$, противоречие.
в. Путь $P$ кончается ребром из $M_{w}, a \notin V(P)$ (см. рисунок 2.4 c ). Рассмотрим паросочетание $M^{\prime \prime}=M^{\prime} \triangle E(P)$. Тогда $\left|M^{\prime \prime}\right|=\left|M^{\prime}\right|+1$, причём $M^{\prime \prime} \subset E(G-a)$. Противоречие с максимальностью паросочетания $M^{\prime}$.

Таким образом, наше предположение невозможно и $D(G-a) \subset D(G)$.
Задача 2.2. а) Пусть $a \in C(G)$. Докажите, что $D(G-a) \supset D(G)$, $A(G-a) \supset A(G), C(G-a) \subset C(G), \alpha^{\prime}(G-a)=\alpha^{\prime}(G)-1$.
б) Пусть $a \in D(G)$. Докажите, что $D(G-a) \subset D(G) \backslash\{a\}, A(G-a) \subset$ $A(G) \backslash\{a\}, C(G-a) \supset C(G), \alpha^{\prime}(G-a)=\alpha^{\prime}(G)$.

Теорема 2.13. (T. Gallai, 1964; J. Edmonds, 1965.) Пусть $G$ - граф, $U_{1}, \ldots, U_{n}$ - компоненты связности графа $G(D(G)), D_{i}=G\left(U_{i}\right), C=$ $G(C(G))$. Тогда выполняются следующие утверждения.

1) Граф $C$ имеет совершенное паросочетание.
2) Графы $D_{1}, \ldots, D_{n}$ - фактор-критические.
3) Любое максимальное паросочетание $M$ графа $G$ состоит из совершенного паросочетания графа $C$, почти совершенных паросочетаний графов $D_{1}, \ldots, D_{n}$ и покрывает все вершины множества $A(G)$ рёбрами с концами в различных компонентах связности $U_{1}, \ldots, U_{n}$
4) $\operatorname{def}(G)=n-|A(G)|, \alpha^{\prime}(G)=\frac{v(G)+|A(G)|-n}{2}$.


Рис. 2.5: Разбиение графа на множества $A(G), D(G)$ и $C(G)$. Максимальное паросочетание в графе $G$, которое выделено более толстыми ребрами.

Доказательство. 1) Последовательно удаляя вершины множества $A=$ $A(G)$, по лемме 2.3 мы получим

$$
\begin{gathered}
D(G-A)=D(G), \quad A(G-A)=\varnothing, \quad C(G-A)=C(G) \\
\alpha^{\prime}(G-A)=\alpha^{\prime}(G)-|A|
\end{gathered}
$$

Это означает, что не существует рёбер, соединяющих вершины из $C(G-A)$ и $D(G-A)$. Каждое максимальное паросочетание $M^{\prime}$ графа $G-A$ покрывает все вершины множества $C(G)$, поэтому $M^{\prime}$ содержит совершенное паросочетание графа $C$.
1) Из формулы (2.4) следует, что $U_{1}, \ldots, U_{n}$ - компоненты связности графа $G-A$. Для любой вершины $u \in U_{i}$ существует максимальное паросочетание $M_{u}$ графа $G-A$, не содержащее $u$. Так как $U_{i}-$ компонента связности графа $G-A$, паросочетание $M_{u}$ содержит максимальное паросочетание графа $D_{i}$ (разумеется, не покрывающее вершину $u$ ). Следовательно, $\alpha^{\prime}\left(D_{i}\right)=\alpha^{\prime}\left(D_{i}-u\right)$ и по теореме 2.12 мы получаем, что граф $D_{i}$ - фактор-критический.

2) Пусть $M$ - максимальное паросочетание графа $G$, а $M^{\prime}$ получено из $M$ удалением всех рёбер, инцидентных вершинам множества $A$. Тогда $\left|M^{\prime}\right| \geq|M|-|A|$ и по формуле (2.4) понятно, что $M^{\prime}$ - максимальное паросочетание графа $G-A$. Более того, из $\alpha^{\prime}(G-A)=\alpha^{\prime}(G)-|A|$ следует $\left|M^{\prime}\right|=|M|-|A|$, а значит, все вершины множества $A$ покрыты в $M$ различными рёбрами. Так как $M^{\prime}$ - максимальное паросочетание графа $G-A$, по пунктам 1 и 2 очевидно, что $M^{\prime}$ содержит совершенное паросочетание графа $C$ и почти совершенные паросочетания факторкритических графов $D_{1}, \ldots, D_{n}$. Значит, рёбра паросочетания $M$ соединяют вершины $A$ с непокрытыми $M^{\prime}$ вершинами различных компонент связности из $U_{1}, \ldots, U_{n}$.
3) Из пункта 3 сразу же следуют оба равенства пункта 4.

Определение 2.8. Пусть $G=\left(V_{1}, V_{2}, E\right)$ - двудольный граф. Мы будем говорить, что доля $V_{i}$ (где $i \in\{1,2\}$ ) имеет запас, если для любого множества вершин $A \subset V_{i}$ выполняется $\left|\mathrm{N}_{G}(A)\right|>|A|$.

Замечание 2.5. Если доля $V_{1}$ имеет запас, то для графа $G$ и этой доли "перевыполняется" условие Холла. Более того, для любой вершины $u \in V_{2}$ для графа $G-u$ и его доли $V_{1}$ выполняется условие Холла: для любого множества вершин $A \subset V_{1}$, очевидно, $\left|\mathrm{N}_{G-u}(A)\right| \geq|A|$.

Следствие 2.9. Пусть $G$ - граф, $U_{1}, \ldots, U_{n}$ - компоненты связности графа $G(D(G)), D_{c}(G)=\left\{U_{1}, \ldots, U_{n}\right\}$ Пусть $D_{G}-$ двудольный граф с долями $A(G)$ и $D_{c}(G)$, причем $a \in A(G)$ и $U_{i} \in D_{c}(G)$ смежны тогда и только тогда, когда в графе $G$ вершина а смежна хотя бы с одной вершиной из $U_{i}$. Тогда доля $A(G)$ имеет запас в графе $D_{G}$.

Доказательство. Нам нужно доказать, что в графе $D_{G}-U_{i}$ выполняется условие Холла для доли $A(G)$, для чего по теореме 2.2 достаточно показать, что в этом графе есть паросочетание, покрывающее долю $A(G)$.

Пусть $u \in U_{i}$, а $M$ - максимальное паросочетание графа $G$, не покрывающее $u$. По теореме 2.13 паросочетание $M$ должно покрывать все вершины множества $A(G)$ рёбрами с концами в различных компонентах связности $U_{1}, \ldots, U_{n}$ и одновременно содержать почти совершенное паросочетание графа $D_{i}=G\left(U_{i}\right)$, следовательно, все вершины из $U_{i} \backslash\{u\}$ разбиты на пары соединённых рёбрами из $M$. Таким образом, $M$ не содержит рёбер, соединяющих $A(G)$ и $U_{i}$, следовательно, в графе $D_{G}-U_{i}$ есть максимальное паросочетание, покрывающее $A(G)$.

Следствие 2.10. Пусть $e \in E(G)$.

1) Если ребро е иниидентно вершине из $D(G)$, то существует максимальное паросочетание графа $G$, содержащее е.

2) Если ребро е соединяет две вершины из $A(G)$ или вершину из $A(G)$ с вершиной из $C(G)$, то не существует максимального паросочетания графа $G$, содержащего е.

Доказательство. 1) Пусть $u \in D(G)$, $e=u v$. Рассмотрим максимальное паросочетание $M_{u}$ графа $G$, не покрывающее $u$. Из максимальности $M_{u}$ следует, что оно покрывает вершину $v$, пусть $v w \in M_{u}$. Тогда $\left(M_{u} \backslash\{v w\}\right) \cup\{u v\}$ - максимальное паросочетание, содержащее ребро $e$.
1) Непосредственное следствие пункта 3 теоремы 2.13 .

В заключение мы разберём несколько важных случаев, в которых разбиение Галлаи-Эдмондса тривиально.

1. Граф $G$ имеет совершенное паросочетание.

В этом случае $D(G)=A(G)=\varnothing, C(G)=V(G)$.
1. Граф $G$ - фактор-критический.

В этом случае $D(G)=V(G), A(G)=C(G)=\varnothing$.
1. Двудолльный граф $G=\left(V_{1}(G), V_{2}(G), E(G)\right)$, в котором доля $V_{1}(G)$ имеет запас.
Тогда по теореме 2.2 для любой вершины $b \in V_{2}(G)$ в графе $G-b$ существует паросочетание $M_{b}$, покрывающее всю долю $V_{1}(G)$. Так как граф $G$ двудолен, $M$ - максимальное паросочетание графа $G$. Следовательно, в этом случае $D(G)=V_{2}(G), A(G)=V_{1}(G), C(G)=\varnothing$.

# 2.5.7 Барьеры 

Определение 2.9. Множество $S \subset V(G)$, для которого $o(G-S)-|S|=$ $\operatorname{def}(G)$ называется барьером.

Замечание 2.6. 1) Барьер графа $G$ - это такое множество вершин $S$, на котором достигается максимум в формуле Бержа (теорема 2.11).
1) Из пункта 4 теоремы 2.13 следует, что $A(G)$ - барьер графа $G$.

Однако, $A(G)$ - не единственный барьер. Более того, $A(G)$ в общем случае не является ни максимальным, ни минимальным по включению барьером. K тому же, ни пересечение, ни объединение двух барьеров не обязано быть барьером.

Задача 2.3. Докажите, что пересечение двух максимальных по включению барьеров графа $G$ является барьером.

Определение 2.10. Для любого множества $X \subset V(G)$ пусть $O(X)-$ объединение всех нечетных компонент связности графа $G-X$.

Лемма 2.4. 1) Пусть $x \in A(G) \cup C(G), G^{\prime}=G-x, B^{\prime}-$ барьер графа $G^{\prime}$. Тогда $B=B^{\prime} \cup\{x\}-$ барьер графа $G$. В частности, $x$ содержится хотя бы в одном барьере графа $G$.
1) Пусть $B-$ барьер графа $G$. Тогда $B \cap D(G)=\varnothing$ и $O(B) \supset D(G)$.
2) Пусть $B-$ барьер графа $G, x \in B$. Тогда $B^{\prime}=B \backslash\{x\}-$ барьер графа $G^{\prime}=G-x$.

Доказательство. 1) Так как любое максимальное паросочетание графа $G$ покрывает $x$, мы имеем $\alpha^{\prime}\left(G^{\prime}\right)=\alpha^{\prime}(G)-1$ и, следовательно, $\operatorname{def}\left(G^{\prime}\right)=$ $\operatorname{def}(G)+1$. Поэтому,
$o(G-B)=o\left(G^{\prime}-B^{\prime}\right)=\left|B^{\prime}\right|+\operatorname{def}\left(G^{\prime}\right)=\left|B^{\prime}\right|+\operatorname{def}(G)+1=|B|+\operatorname{def}(G)$,
следовательно, $B$ - барьер графа $G$. Так как $A\left(G^{\prime}\right)$ - барьер графа $G^{\prime}$, то $A\left(G^{\prime}\right) \cup\{x\}-$ барьер графа $G$.
1) Пусть $M$ - максимальное паросочетание графа $G$. Очевидно, $M$ должно оставить непокрытой хотя бы по одной вершине в $o(B)-|B|=$ $\operatorname{def}(G)$ нечётных компонентах связности графа $G-B$. Поскольку $M$ оставляет непокрытыми ровно $\operatorname{def}(G)$ вершин, то $M$ не покрывает ровно по одной вершине в $\operatorname{def}(G)$ нечётных компонентах связности графа $G-B$ и покрывает все остальные вершины графа. В частности, $M$ покрывает $B$, откуда следует, что $B \cap D(G)=\varnothing$.

Пусть $u \in D(G)$. Теперь можно рассмотреть компоненту связности $U$ графа $G-B$, содержащую вершину $u$ и максимальное паросочетание $M_{u}$ графа $G$, не покрывающее $u$. Так как $M_{u}$ не покрывает вершину компоненты связности $U$, из сказанного выше следует, что $U-$ нечётная. Следовательно, $D(G) \subset O(B)$.
1) Из пункта 2 следует, что $x \in A(G) \cup C(G)$, поэтому $\alpha^{\prime}\left(G^{\prime}\right)=\alpha^{\prime}(G)-1$ и $\operatorname{def}\left(G^{\prime}\right)=\operatorname{def}(G)+1$. Тогда
$o\left(G^{\prime}-B^{\prime}\right)=o(G-B)=|B|+\operatorname{def}(G)=\left|B^{\prime}\right|+\operatorname{def}(G)+1=\left|B^{\prime}\right|+\operatorname{def}\left(G^{\prime}\right)$,
следовательно, $B^{\prime}$ - барьер графа $G^{\prime}$.
Замечание 2.7. 1) Таким образом, любая вершина из $A(G) \cup C(G)$ входит хотя бы в один барьер, а вершины множества $D(G)$ в барьеры не входят.
1) Пусть $B$ - барьер графа $G$, а $M$ - максимальное паросочетание. Из доказательства пункта 2 леммы 2.4 следует, что $M$ оставляет непокрытыми ровно по одной вершине в $\operatorname{def}(G)$ нечётных компонентах связности графа $G-B$ и покрывает все остальные вершины графа. Bepшины барьера $B$ покрыты ребрами $M$, соединяющими их с вершинами различных нечётных компонент связности графа $G-B$.

2) Отметим, что по пункту 2 теоремы 2.13 мы имеем $O(A(G))=D(G)$, то есть, для всех барьеров $B$ графа $G$ имеет место $O(B) \supset O(A(G))$. В этом смысле барьер $A(G)$ является минимальным.
3) Если $C(G)=\varnothing$, то любой барьер является подмножеством $A(G)$. В этом случае $A(G)$ - единственный максимальный по включению барьер графа $G$.

Теорема 2.14. Пересечение всех максимальных по включению барьеров графа $G$ есть $A(G)$.

Доказательство. $\supset$. Пусть $B$ - максимальный барьер, $|A(G) \backslash B|=$ $k>0$. Мы докажем, что $B^{\prime}=B \cup A(G)$ - барьер и, тем самым, получим противоречие. $B^{\prime}$ получается из барьера $B$ добавлением $k$ вершин, поэтому достаточно доказать, что $o\left(G-B^{\prime}\right) \geq o(G-B)+k$ : тогда $o\left(G-B^{\prime}\right)-\left|B^{\prime}\right| \geq \operatorname{def}(G)$, то есть, $B^{\prime}-$ барьер.

Пусть $W$ - компонента связности графа $G-B$, содержащая $t>0$ вершин из $A(G)$ (см. рисунок 2.6 a ). В силу леммы $2.4, B^{\prime} \cap D(G)=\varnothing$. Поэтому, $W$ содержит все компоненты связности графа $G(D(G))$, соединённые рёбрами с $W \cap A(G)$. По теореме 2.13 все эти компоненты связности - нечётные, а по следствию 2.9 их хотя бы $t+1$. Таким образом, при добавлении $t$ вершин из $W \cap A(G)$ в барьер может исчезнуть одна нечётная компонента связности (если $|W|$ нечётно), а появляется хотя бы $t+1$ нечётная компонента связности. Просуммировав прибавления по всем компонентам связности графа $G-B$, содержащим вершины из $A(G)$, мы получим, что $o\left(G-B^{\prime}\right) \geq o(G-B)+k$, что и требовалось доказать.


Рис. 2.6: Максимальные барьеры и $A(G)$.
С. Предположим противное, пусть существует принадлежащая всем максимальным барьерам вершина $x \notin A(G)$. По лемме 2.4 тогда $x \in C(G)$.

Рассмотрим максимальное паросочетание $M$ графа $G$, пусть $x y \in M$. Докажем, что $B=A(G) \cup\{y\}$ - барьер графа $G$. Так как $|B|=|A(G)|+1$, для этого достаточно доказать, что $o(B) \geq o(A(G))+1$.

По теореме 2.13 мы имеем $y \in C(G)$. Пусть $W$ - компонента связности графа $G(C(G))$, содержащая $x$ и $y$ (см. рисунок 2.6a). По теореме 2.13 вершины $W$ разбиваются на пары соединённых рёбрами из $M$, поэтому $|W|$ чётно. Множество $W^{\prime}=W \backslash\{y\}$ содержит нечетное число вершин и является объединением нескольких компонент связности графа $G-B$, которых нет в $G-A(G)$. Среди этих компонент связности, очевидно, есть нечетная. Значит, $B$ - барьер графа $G$.

Пусть $B^{\prime}$ - максимальный барьер графа $G$, содержащий $B$. По пункту 2 замечания 2.7 в максимальном паросочетании $M$ графа $G$ все вершины барьера $B^{\prime}$ должны быть соединены рёбрами с вершинами различных нечётных компонент связности графа $G-B^{\prime}$, следовательно, $x \notin B^{\prime}$. Полученное противоречие показывает, что пересечение всех максимальных барьеров графа $G$ может содержать только вершины из $A(G)$.

В заключении раздела мы рассмотрим минимальные по включению барьеры графа $G$.

Определение 2.11. Назовём лапой индуцированный подграф графа $G$, изоморфный двудольному графу $K_{1,3}$. Вершину степени 3 в этом подграфе назовём центром лапы.

Лемма 2.5. Пусть $B$ - минимальный по включению барьер графа $G$. Тогда каждая вершина $B$ - центр лапы графа $G$.

Доказательство. Пусть $x \in B$ - не центр лапы, $B^{\prime}=B \backslash\{x\}$. Тогда вершина $x$ смежна не более, чем с двумя компонентами связности графа $G-B$. В графе $G-B^{\prime}$ все компоненты связности, смежные с $x$, объединяются в одну, содержащую также вершину $x$. Легко видеть, что тогда $o\left(G-B^{\prime}\right) \geq o(G-B)-1$. Это означает, что $B^{\prime}-$ барьер графа $G$, противоречие с минимальностью барьера $B$.

Следствие 2.11. (D. P. Sumner, 1974; M. Las Vergnas, 1975.)
Пусть $G$ - связный граф, не содержащий лапы, $v(G)$ чётно. Тогда $G$ имеет совершенное паросочетание.

Доказательство. Пусть $B$ - минимальный по включению барьер графа $G$. Тогда по лемме 2.5 мы имеем $B=\varnothing$. Однако, $G$ - связный граф с чётным числом вершин, поэтому $o(G-\varnothing)=0$, следовательно, $\operatorname{def}(G)=0$ и граф $G$ имеет совершенное паросочетание.

# 2.5.8 Критерии существования совершенного паросочетания 

В этом разделе мы докажем несколько критериев существования совершенного паросочетания в графе. Начнем с новых понятий.

Определение 2.12. Бинд графа $G$ - это

$$
\operatorname{bind}(G)=\min _{S \subseteq V(G), S \neq \varnothing, \mathrm{~N}_{G}^{\prime}(S) \neq V(G)} \frac{\left|\mathrm{N}_{G}^{\prime}(S)\right|}{|S|}
$$

Эту характеристику графа впервые рассмотрел Андерсон в 1973 году. Он доказал, что граф с четным числом вершин и биндом не менее $\frac{4}{3}$ обязательно имеет совершенное паросочетание. Мы представим чуть более сильную теорему.

Теорема 2.15. (D. R. Woodall, 1973.) Пусть $G$ - такой граф с четным числом вершин, что

$$
\left|\mathrm{N}_{G}^{\prime}(S)\right| \geq \min \left\{|V(G)|, \frac{4}{3}|S|-\frac{2}{3}\right\}
$$

для любого $S \subseteq V(G)$. Тогда граф $G$ имеет совершенное паросочетание.
Доказательство. Предположим, что граф $G$ не имеет совершенного паросочетания. Тогда по теореме 2.6 он имеет множество Татта $S$, для которого $o(G-S)>|S|$. Пусть $|S|=k$. Как уже отмечалось, из четности $v(G)$ тогда следует, что $o(G-S) \geq k+2$.

Пусть $m$ - количество одновершинных компонент связности графа $G-S$. Рассмотрим два случая.

1. $m>0$.

Пусть $M$ - объединение всех одновершинных компонент связности графа $G-S$. В нашем случае $\mathrm{N}_{G}^{\prime}(V(G) \backslash S) \subset V(G) \backslash M$, поэтому

$$
v(G)-m \geq\left|\mathrm{N}_{G}^{\prime}(V(G) \backslash S)\right| \geq \frac{4(v(G)-k)-2}{3}
$$

что можно переписать в виде

$$
v(G) \leq 4 k-3 m+2
$$

С другой стороны, $o(G-S) \geq k+2$ и в $k+2-m$ нечетных компонентах графа $G-S$ хотя бы по три вершины. Поэтому

$$
v(G) \geq k+m+3(k+2-m)=4 k-2 m+6
$$

что противоречит неравенству (2.5).
1. $m=0$.

Тогда все нечетные компоненты связности графа $G-S$ содержат хотя бы по три вершины. Пусть $X$ - объединение $k+1$ нечетной компоненты связности графа $G-S$. Тогда

$$
|X| \geq 3 k+3
$$

Множество $X$ не содержит хотя бы одну из нечетных компонент $G-S$ и не смежно с ней, следовательно, $\mathrm{N}_{G}^{\prime}(X) \neq V(G)$ и поэтому

$$
\left|\mathrm{N}_{G}^{\prime}(X)\right| \geq \frac{4}{3}|X|-\frac{2}{3}
$$

С другой стороны, $\mathrm{N}_{G}^{\prime}(X) \subset X \cup S$, поэтому $\left|\mathrm{N}_{G}^{\prime}(X)\right| \leq|X|+k$. Следовательно,

$$
|X|+k \geq \frac{4}{3}|X|-\frac{2}{3}
$$

откуда $|X| \leq 3 k+2$, противоречие с неравенством (2.6).
Определение 2.13. Если граф $G$ отличен от полного, то жесткость графа $G$ - это

$$
\mathrm{t}(G)=\min _{S \subseteq V(G), c(G-S) \neq 1} \frac{|S|}{|c(G-S)|}
$$

Будем говорить, что неполный граф $G$ является $t$-жестким, если $t(G) \geq t$.
Лемма 2.6. Пусть $G$ - неполный граф с $t(G)>0$. Тогда $G$ связен.
Доказательство. Предположим противное. Так как $c(G-\varnothing) \geq 2$, то должно выполняться $0=|\varnothing| \geq t(G) c(G-\varnothing)>0$, что, очевидно, не так.

Задача 2.4. Докажите, что для неполного графа $G$ выполняется неравенство $\operatorname{bind}(G) \leq t(G)+1$.

Понятие жесткости напрямую связано с паросочетаниями. Следующее утверждение является непосредственным следствием теоремы Татта о совершенном паросочетании 2.8 .

Следствие 2.12. Пусть $G$ - неполный граф с четным числом вершин и $t(G) \geq 1$. Тогда $G$ имеет совершенное паросочетание.

Доказательство. Проверим условие Татта для множества $S \subset V(G)$. Пусть $S=\varnothing$. Тогда из $t(G) \geq 1$ следует связность графа $G$, а из четности числа вершин - условие Татта.

Пусть $S \neq \varnothing$. Тогда $o(G-S) \leq c(G-S) \leq \min \{1,|S|\}$, и по теореме 2.8 граф $G$ имеет совершенное паросочетание.

Условие $t(G) \geq k$ для графа с четным числом вершин дает существование $k$-фактора. Это гораздо более сложное утверждение будет доказано в разделе 2.6.5 с помощью теоремы Татта о факторе.

# 2.6 Факторы 

Понятие $f$-фактора обобщает введенное в определении 2.5 понятие $k$ фактора.

Определение 2.14. Пусть $f: V(G) \rightarrow \mathbb{N}_{0}$. Подграф $H$ графа $G$ называется $f$-фактором, если $d_{H}(v)=f(v)$ для любой вершины $v \in V(G)$.

### 2.6.1 Факторы и паросочетания

Мы будем считать, что граф $G$ - без изолированных вершин (то есть, $\delta(G) \geq 1$ ). Кратные рёбра и петли в графе допускаются. Первой нашей задачей будет свести вопрос о наличии $f$-фактора в графе $G$ к хорошо изученному выше вопросу о существовании паросочетания в графе, который мы специально построим. С помощью нескольких определений мы проделаем путь, похожий на определение дефицита графа. Однако, это будет технически сложнее.

Определение 2.15. 1) Пусть $D, S \subset V(G)$ - фиксированные непересекающиеся множества, Назовём компоненту связности $U$ графа $G-D-S$ $(f ; D, S)$-нечётной, если величина

$$
r_{f ; D, S}(U)=e_{G}(U, S)+\sum_{x \in U} f(x)
$$

нечётна и $(f ; D, S)$-чётной в противном случае.
1) Обозначим через $o(f ; D, S)$ количество $(f, D, S)$-нечётных компонент связности.

Замечание 2.8. Пусть $x y \notin E(G)$, причем $x \in D$ или обе вершины $x, y$ лежат в одной компоненте связности графа $G-D-S$. Тогда непосредственно из определения 2.15 следует, что графы $G-D-S$ и $G+x y-D-S$ имеют одни и те же $(f, D, S)$-нечетные компоненты связности.

Очевидным необходимым условием для существования $f$-фактора является условие $f(v) \leq d_{G}(v)$ для всех вершин $v \in V(G)$. При описании следующей конструкции будем считать, что оно выполняется.

Определение 2.16. Пусть $s(v)=d_{G}(v)-f(v)$ - избыточная степень вершины $v \in V(G)$.

По графу $G$ и функции $f$ мы построим вспомогательный граф $G_{f}$. Для каждой вершины $x \in V(G)$ мы построим множества вершин $D(x)$ и $S(x)$ так, что все эти $2 v(G)$ множеств попарно не пересекаются, $|D(x)|=$ $d_{G}(x)$ и $|S(x)|=s(x)$. Пусть

$$
V_{D}=\bigcup_{x \in V(G)} D(x), \quad V_{S}=\bigcup_{x \in V(G)} S(x)
$$

Очевидно, существует биекция из $D(x)$ в множество концов рёбер, инцидентных $x$ (каждой инцидентной вершине $x$ петле при этом соответствуют две вершины $x_{e, 1}$ и $x_{e, 2}$ из $D(x)$ !). Таким образом, каждому ребру $e \in E(G)$ соответствуют ровно две вершины из $V_{D}$, которые мы соединим ребром $\varphi(e)$. Пусть $E_{1}=\{\varphi(e): e \in E(G)\}$. Отметим, что рёбра из $E_{1}$ не имеют общих концов, а $\varphi: E(G) \rightarrow E_{1}-$ биекция.


Рис. 2.7: Окрестность вершины $x$ в графе $G$ и соответствующие рёбра множества $E_{1}$ в $G_{f}$.

Для каждой вершины $x \in V(G)$ пусть $B(x)$ - полный двудольный граф с долями $D(x)$ и $S(x)$. Пусть

$$
E_{2}=\bigcup_{x \in V(G)} E(B(x))
$$

Определим граф $G_{f}$, положив $V\left(G_{f}\right)=V_{D} \cup V_{S}, E\left(G_{f}\right)=E_{1} \cup E_{2}$. Отметим, что вершины множества $S(v)$ смежны в графе $G_{f}$ только с вершинами множества $D(v)$.
Лемма 2.7. Граф $G$ имеет $f$-фактор тогда и только тогда, когда граф $G_{f}$ имеет совериенное паросочетание (то есть, 1-фактор).
Доказательство. $\Rightarrow$. Пусть $G$ имеет $f$-фактор $H$ с множеством рёбер $F=E(H)$. Тогда $\varphi(F)$ - паросочетание в графе $G_{f}$, покрывающее ровно $f(v)=|D(v)|-|S(v)|$ вершин из $D(v)$ и не покрывающее вершин множества $S(v)$ для каждой вершины $v \in V(G)$. Можно легко дополнить $\varphi(F)$ рёбрами, соединяющими вершины множества $S(v)$ с непокрытыми вершинами из $D(v)$ для каждой вершины $v \in V(G)$, в результате получится совершенное паросочетание графа $G_{f}$.

$\Leftarrow$. Пусть $G_{f}$ имеет совершенное паросочетание $F^{*}$. Тогда $F^{*}$ для каждой вершины $v \in V(G)$ покрывает ровно $s(v)$ вершин множества $D(v)$ рёбрами двудольного графа $B(v)$, следовательно, ровно $f(v)=$ $|D(v)|-|S(v)|$ вершин из $D(v)$ покрыты в $F^{*}$ рёбрами из $E_{1}$. Поэтому $\varphi^{-1}\left(F^{*} \cap E_{1}\right)$ - множество рёбер графа $G$, индуцирующих $f$-фактор этого графа.

# 2.6.2 Нормальные множества 

Продолжим описывать конструкции, необходимые для формулировки и доказательства основного результата этого раздела - теоремы Татта о $f$-факторе.

Определение 2.17. 1) Назовём множество $W \subset V\left(G_{f}\right)$ нормальным, если для каждой вершины $x \in V(G)$ выполняется одно из трёх условий:
$1^{\circ} W \supset D(x), W \cap S(x)=\varnothing$ (причем $S(x) \neq \varnothing$ !);
$2^{\circ} W \cap D(x)=\varnothing, W \supset S(x) ;$
$3^{\circ} W \cap D(x)=\varnothing, W \cap S(x)=\varnothing$.
1) Для нормального множества $W$ пусть

$$
D_{W}=\{x \in V(G): D(x) \subset W\}, \quad S_{W}=\{x \in V(G): S(x) \subset W\}
$$

Замечание 2.9. 1) Пусть $W$ - нормальное множество. Тогда

$$
|W|=\sum_{x \in D_{W}} d_{G}(x)+\sum_{x \in S_{W}} s(x)=\sum_{x \in D_{W}} d_{G}(x)+\sum_{x \in S_{W}}\left(d_{G}(x)-f(x)\right)
$$

1) В случае, когда $S(x)=\varnothing$, по определению $D(x) \cap W=\varnothing$. В этом случае $x \notin D_{W} \cup S_{W}$. Отметим, что $D(x) \neq \varnothing$ ввиду $\delta(G) \geq 1$.
2) Таким образом, при $x \in D_{W} \cup S_{W}$ двудольный граф $B(x)$ связен.

Лемма 2.8. Пусть $W \subset V\left(G_{f}\right)$ - нормальное множество. Тогда

$$
o\left(G_{f}-W\right)-|W|=o\left(f ; D_{W}, S_{W}\right)-\sum_{x \in D_{W}} f(x)+\sum_{x \in S_{W}}\left(f(x)-d_{G-D_{W}}(x)\right)
$$

Доказательство. Пусть $U-$ компонента связности графа $G_{f}-W$, $H=G_{f}(U)$. Рассмотрим четыре случая.

1. $U$ состоит из одной вершины множества $V_{D}$.

Пусть $U=\{u\}, e \in E(G), \varphi(e)=u v, u \in D(x), v \in D(y)$ (где вершины $x, y \in V(G)$, возможно, совпадают). Тогда $\mathrm{N}_{G_{f}}(u)=S(x) \cup\{v\} \subset W$, следовательно, $x \neq y, x \in S_{W}, y \in D_{W}$ и $x y \in E(G)$ (см. рисунок 2.8). Наоборот, если $e=x y \in E(G), x \in S_{W}, y \in D_{W}$, то принадлежащий $D(x)$

конец ребра $\varphi(e)=u v$ - компонента связности графа $G_{f}-W$. Таким образом, количество таких одновершинных компонент связности графа $G-W$ равно

$$
e_{G}\left(D_{W}, S_{W}\right)=\sum_{x \in S_{W}}\left(d_{G}(x)-d_{G-D_{W}}(x)\right)
$$



Рис. 2.8: Одиночная компонента связности $G_{f}-W$ - вершина из $V_{D}$.
1. $U$ состоит из одной вершины множества $V_{S}$.

Пусть $v \in S(x), x \in V(G)$. Тогда понятно, что $x \in D_{W}$. Наоборот, если $x \in D_{W}$, то каждая вершина из $S(x)$ образует компоненту связности графа $G_{f}-W$. Таким образом, количество таких одновершинных компонент связности графа $G-W$ равно

$$
\sum_{x \in D_{W}} s(x)=\sum_{x \in D_{W}}\left(d_{G}(x)-f(x)\right)
$$

1. $E(H) \neq \varnothing, E(H) \subset E_{1}$.

Так как $E_{1}$ состоит из независимых рёбер, в этом случае $|U|=2$.
1. $E(H) \cap E_{2} \neq \varnothing$.

Назовём такую компоненту связности $U$ большой. Предположим, что $H$ содержит ребро двудольного графа $B(x)$ для некоторой вершины $x \in V(G)$. Тогда $D(x) \notin W, S(x) \notin W$, следовательно, $D(x) \cup S(x) \subset U$. Пусть $M=\{x \in V(G): D(x) \cup S(x) \subset U\}$. Тогда компонента связности $U \supset U_{M}=\cup_{x \in M} D(x) \cup S(x)$.

Пусть $u \in U \backslash U_{M}$. Тогда $u v \in E_{1} \cap E(H)$ для некоторой вершины $v \in U_{M}$, следовательно, $u v=\varphi(e)$, где $e=x y \in E(G), u \in D(x), v \in D(y)$. Поскольку $u \notin W$, то $x \notin D_{W}$. Так как $u \notin U_{M}$, то вершина $u$ не соединена рёбрами из $E_{2}$ с вершинами из $U$, следовательно, $S(x) \subset W$, то есть, $x \in S_{W}$. Наоборот, если $x \in S_{W}, y \in M, e=x y \in E(G)$, то $\varphi(e)$ - ребро графа $H$, а его конец из $D(x)$ лежит в $U$.

Таким образом, $U$ состоит из вершин множества $U_{M}$ и концов всех рёбер $u v \in E_{1}$, где $u \in D(x), v \in D(y), x \in S_{W}, y \in M$. Рёбра множества $E_{1}$, соединяющие вершины из $U_{M}$ с остальными вершинами графа $G_{f}-W$, как мы доказали выше, выходят только к вершинам множества $S_{W}$. Поэтому граф $G_{f}\left(U_{M}\right)$ должен быть связным, а $M$ - компонента связности



Рис. 2.9: Компонента связности $M$ графа $G-D_{W}-S_{W}$ и соответствующая ей большая компонента связности $U$ графа $G_{f}-W$.

графа $G-D_{W}-S_{W}$. Наоборот, понятно, что каждой компоненте связности графа $G-D_{W}-S_{W}$ соответствует большая компонента связности графа $G_{f}-W$.

Отметим, что

$$
|U|=\sum_{x \in M}\left(d_{G}(x)+s(x)\right)+e_{G}\left(M, S_{W}\right) \equiv \sum_{x \in M} f(x)+e_{G}\left(M, S_{W}\right) \quad(\bmod 2)
$$

следовательно, число вершин в $U$ нечётно, если $M$ является $\left(f, D_{W}, S_{W}\right)$ нечётной и чётно в противном случае. Таким образом, количество нечётных больших компонент связности графа $G_{f}-W$ есть $o\left(f, D_{W}, S_{W}\right)$.

Теперь ввиду доказанного выше (формулы (2.8) и (2.9), пункт 4) получаем, что
$o\left(G_{f}-W\right)=o\left(f, D_{W}, S_{W}\right)+\sum_{x \in S_{W}}\left(d_{G}(x)-d_{G-D_{W}}(x)\right)+\sum_{x \in D_{W}}\left(d_{G}(x)-f(x)\right)$.
Вычитая равенство (2.7) из полученного равенства, получаем утверждение леммы.

# 2.6.3 $f$-дефицит. Теорема Татта о факторе 

Введём обозначение

$$
\operatorname{def}(f ; D, S)=o(f ; D, S)-\sum_{x \in D} f(x)+\sum_{x \in S}\left(f(x)-d_{G-D}(x)\right)
$$

Определение 2.18. Назовём $f$-дефицитом графа $G$ величину $\operatorname{def}(G ; f)$, равную максимуму $\operatorname{def}(f ; D, S)$ по всем парам непересекающихся множеств $D, S \subset V(G)$.

Замечание 2.10. Отметим, что $f$-дефицит неотрицателен:

$$
\operatorname{def}(G ; f) \geq \operatorname{def}(f ; \varnothing, \varnothing)=o(f ; \varnothing, \varnothing) \geq 0
$$

Следующая теорема даёт необходимое и достаточное условие существования $f$-фактора в терминах $f$-дефицита. Интересно сравнить это утверждение с аналогами для паросочетаний (теоремы 2.6 и 2.11).

Теорема 2.16. (W. T. Tutte, 1952.) Граф $G$ имеет $f$-фактор тогда и только тогда, когда $\operatorname{def}(G ; f)=0$, то есть $\operatorname{def}(f ; D, S) \leq 0$, или

$$
o(f ; D, S)+\sum_{x \in S}\left(f(x)-d_{G-D}(x)\right) \leq \sum_{x \in D} f(x)
$$

для любой пары непересекающихся множеств $S, D \subset V(G)$.
Доказательство. Мы будем подразумевать, что что $f(x) \leq d_{G}(x)$ для любой вершины $x \in V(G)$ и $\sum_{x \in V(G)} f(x)$ четно. Оба утверждения очевидно следуют из существования $f$-фактора. Выведем их из неравенства (2.10) и тем самым убедимся, что наше предположение корректно.

Подставив $D=S=\varnothing$, получим, что $o(f ; \varnothing, \varnothing) \leq 0$, а следовательно, $\sum_{x \in U} f(x)$ четно для каждой компоненты связности $U$ графа $G$. Таким образом, $\sum_{x \in V(G)} f(x)$ четно. Подставим $D=\varnothing, S=\{x\}$ в неравенство (2.10). Мы получим $o(f ; \varnothing,\{x\})+\left(f(x)-d_{G}(x)\right) \leq 0$, откуда очевидно следует, что $f(x) \leq d_{G}(x)$.

Мы воспользуемся конструкцией графа $G_{f}$ и доказанными ранее леммами, чтобы вывести теорему 2.16 из теоремы Татта о совершенном паросочетании 2.6.
$\Rightarrow$. Предположим противное, пусть неравенство (2.10) не выполняется и выберем опровергающую его пару $(D, S)$ так, чтобы $|D|$ было минимальным.

Предположим, что $f(z)=d_{G}(z)$ для вершины $z \in D$. Пусть $D_{z}=$ $D \backslash\{z\}, S_{z}=S \cup\{z\}$. Докажем, что тогда неравенство (2.10) не выполняется для пары $\left(D_{z}, S_{z}\right)$.

Для этого достаточно доказать, что при перемещении вершины $z$ из $D$ в $S$ левая часть уменьшится не более, чем правая. Отметим, что граф $G-D-S$ и его компоненты связности при таком изменении $D$ и $S$ не изменятся. Рассмотрим величину $\Delta=o\left(f ; D_{z}, S_{z}\right)-o(f ; D, S)$. Изменяют свою четность те и только те компоненты связности графа $G-D-S$, которые соединены с $z$ нечётным числом рёбер (см. рисунок 2.10). Их количество, очевидно, не превосходит $e(V(G-D-S), z)$, поэтому $\Delta \geq-e(V(G-D-S), z)$.



Рис. 2.10: Пары множеств $(D, S)$ и $\left(D_{z}, S_{z}\right)$.

Отметим, что

$$
\Delta^{\prime}=\sum_{y \in S}\left(-d_{G-D_{z}}(y)+d_{G-D}(y)\right)=-e(z, S)
$$

Итак, левая часть неравенства (2.10) изменится на

$$
\Delta+\Delta^{\prime}+f(z)-d_{G-D_{z}}(z) \geq-e(V(G-D-S), z)-e(z, S) \geq-d_{G}(z)
$$

(поскольку $f(z)=d_{G}(z) \geq d_{G-D_{z}}(z)$ ), а правая часть неравенства (2.10) изменится ровно на $-d_{G}(z)$.

Таким образом, неравенство (2.10) не выполнено для пары $\left(D_{z}, S_{z}\right)$, противоречие с минимальностью $|D|$. Значит, $s(x)=d_{G}(x)-f(x)>0$ и, следовательно, двудольный граф $B(x)$ связен для любой вершины $x \in D$. Определим множество $W$ как

$$
W=\bigcup_{x \in D} D(x) \cup \bigcup_{y \in S} S(y)
$$

Ввиду доказанного выше очевидно, что $W$ нормально, $D_{W}=D$ и $S_{W}=S$. Теперь из леммы 2.8 следует $o\left(G_{f}-W\right)>|W|$ и по теореме Татта 2.6 совершенное паросочетание в графе $G_{f}$ отсутствует. Следовательно, по лемме 2.7 в графе $G$ нет $f$-фактора, противоречие с предположением.
$\Leftarrow$. Предположим противное, пусть $G$ не имеет $f$-фактора, тогда по лемме 2.7 граф $G_{f}$ не имеет совершенного паросочетания. По теореме 2.6 это означает, что существует множество $W \subset V\left(G_{f}\right)$, для которого не выполняется условие Татта (то есть, $o\left(G_{f}-W\right)>|W|$ ). Пусть $W$ - минимальное множество, не удовлетворяющее условию Татта. Мы докажем, что оно нормально.

Легко видеть, что числа $o\left(G_{f}-W\right)$ и $|W|$ - одинаковой четности, так как

$$
v\left(G_{f}\right)=\sum_{x \in V(G)} d_{G}(x)+\sum_{x \in V(G)}\left(d_{G}(x)-f(x)\right)
$$

чётно. Следовательно, $o\left(G_{f}-W\right) \geq|W|+2$. Пусть $W^{\prime} \subsetneq W$. В силу минимальности $W$, тогда

$$
o\left(G_{f}-W^{\prime}\right) \leq\left|W^{\prime}\right| \leq|W|-1 \leq o\left(G_{f}-W\right)-3
$$

Предположим, что множество $W$ не является нормальным. Разберём несколько случаев.

1. Пусть $W \cap D(x) \neq \varnothing$ для некоторой вершины $x \in V(G)$ и выполняется хотя бы одно из двух условий:
$-W \not \supset D(x) ;$
$-S(x)=\varnothing$.


Рис. 2.11: Теорема Татта о факторе: случай 1.
Пусть $w \in D(x) \cap W, w u \in E_{1}$. Положим $W^{\prime}=W \backslash\{w\}$. В графе $G_{f}-W^{\prime}$ вершина $w$ смежна с вершинами из $S(x) \backslash W$ (если это множество непусто) и с вершиной $u$ (при условии, что $u \notin W$ ). Если $S(x) \backslash W=\varnothing$, то $w$ смежна не более, чем с одной компонентой связности графа $G-W$. Если $S(x) \backslash W \neq \varnothing$, то имеет место случай $W \not \supset D(x)$. Тогда существует вершина $v \in D(x) \backslash W$ и все вершины из $S(x) \backslash W$ смежны с $v$, а следовательно, лежат в одной компоненте связности графа $G-W$ (см. рисунок 2.11). Таким образом, в любом из случаев вершина $w$ смежна не более, чем с двумя компонентами связности графа $G-W$. Эти компоненты склеятся в одну, содержащую к тому же $w$, остальные компоненты связности в $G_{f}-W^{\prime}$ такие же, как и в $G_{f}-W$, поэтому $o\left(G_{f}-W^{\prime}\right) \geq o\left(G_{f}-W\right)-2$, что противоречит неравенству (2.11).

Таким образом, теперь для любой вершины $x \in V(G)$ либо $W \supset D(x)$ $u S(x) \neq \varnothing$, либо $W \cap D(x)=\varnothing$.
1. Пусть $W \cap S(x) \neq \varnothing$ для некоторой вершины $x \in V(G)$.

Пусть $w \in S(x) \cap W$. Положим $W^{\prime}=W \backslash\{w\}$. Вершина $w$ смежна в графе $G_{f}$ только с вершинами из $D(x)$. Если $W \supset D(x)$ (см. рисунок 2.12a), то $\{w\}$ - компонента связности графа $G_{f}-W^{\prime}$, остальные компоненты связности в графах $G_{f}-W$ и $G_{f}-W^{\prime}$ совпадают, следовательно, $o\left(G_{f}-W^{\prime}\right)=o\left(G_{f}-W\right)+1$, противоречие с неравенством (2.11).



Рис. 2.12: Теорема Татта о факторе: случай 2.

Следовательно, учитывая доказанное выше, имеем $W \cap D(x)=\varnothing$. Пусть $W \not \supset S(x)$. Тогда существует вершина $u \in S(x) \backslash W$, пусть $U-$ компонента связности графа $G_{f}-W$, содержащая $u$. Тогда $U \supset D(x)$ (см. рисунок 2.12 b ). Вершина $w$ смежна в $G_{f}-W^{\prime}$ только с вершинами компоненты связности $U$, поэтому $o\left(G_{f}-W^{\prime}\right) \geq o\left(G_{f}-W\right)-1$, очередное противоречие с неравенством (2.11).

Таким образом, при $W \cap S(x) \neq \varnothing$ остаётся единственный возможный случай: $W \cap D(x)=\varnothing$ и $W \supset S(x)$, следовательно, множество $W-$ нормальное.

Теперь мы можем применить лемму 2.8 и получить

$$
\operatorname{def}(G ; f) \geq \operatorname{def}\left(f ; D_{W}, S_{W}\right)=o\left(G_{f}-W\right)-|W|>0
$$

Следовательно, неравенство (2.10) для пары множеств $\left(D_{W}, S_{W}\right)$ не выполняется. Полученное противоречие завершает доказательство.

Пусть $f: V(G) \rightarrow \mathbb{N}_{0}$. Определим функцию $f^{\prime}$, положив $f^{\prime}(x)=$ $d_{G}(x)-f(x)$ для любой вершины $v \in V(G)$. Понятно, что $G$ имеет $f$ фактор тогда и только тогда, когда $G$ имеет $f^{\prime}$-фактор. Таким образом, должна быть связь между $f$-дефицитом и $f^{\prime}$-дефицитом графа $G$.
Лемма 2.9. (W. T. Tutte, 1974.) Для любой пары непересекающихся множеств $D, S \subset V(G)$ выполняются следующие свойства.

1) Компонента связности $U$ графа $G-D-S$ является $(f ; D, S)$ нечетной тогда и только тогда, когда она является $\left(f^{\prime} ; S, D\right)$-нечетной. Следовательно, $o(f ; D, S)=o\left(f^{\prime} ; S, D\right)$.
2) $\operatorname{def}(f ; D, S)=\operatorname{def}\left(f^{\prime} ; S, D\right)$.

Доказательство. 1) По определению 2.15 , компонента связности $U$ является $(f ; D, S)$-нечетной тогда и только тогда, когда $r_{f ; D, S}(U)$ нечетно и $U$ является $\left(f^{\prime} ; S, D\right)$-нечетной тогда и только тогда, когда $r_{f^{\prime} ; S, D}(U)$ нечетно. Сложим эти два выражения, учитывая, что $f(x)+f^{\prime}(x)=d_{G}(x)$ : $r_{f ; D, S}(U)+r_{f^{\prime} ; S, D}(U)=e_{G}(U, D \cup S)+\sum_{x \in U} d_{G}(x)=2 e_{G}(U, D \cup S)+2 e(G(U))$.

Таким образом, компонента связности является $(f ; D, S)$-нечетной тогда и только тогда, когда она является $\left(f^{\prime} ; S, D\right)$-нечетной.
1) Разберёмся со второй частью суммы в определении $f$-дефицита:

$$
\begin{aligned}
& \operatorname{def}(f ; D, S)-o(f ; D, S)=-\sum_{x \in D} f(x)+\sum_{x \in S}\left(f(x)-d_{G-D}(x)\right)= \\
& \quad=\sum_{x \in D} f^{\prime}(x)+\sum_{x \in S} f(x)-\sum_{x \in D} d_{G}(x)-\sum_{x \in S} d_{G}(x)+e(D, S)= \\
& -\sum_{x \in S} f^{\prime}(x)+\sum_{x \in D}\left(f^{\prime}(x)-d_{G-S}(x)\right)=\operatorname{def}\left(f^{\prime} ; S, D\right)-o\left(f^{\prime} ; S, D\right)
\end{aligned}
$$

откуда немедленно следует, что $\operatorname{def}(f ; D, S)=\operatorname{def}\left(f^{\prime} ; S, D\right)$.
Условие (2.10) из теоремы Татта о факторе можно эквивалентно перевормулировать следующим образом.

Следствие 2.13. Граф $G$ имеет $f$-фактор тогда и только тогда, когда

$$
o(f ; D, S)+e_{G}(D, S) \leq \sum_{x \in D} f(x)+\sum_{x \in S} f^{\prime}(x)
$$

Применять критерий существования $f$-фактора прямо в виде, сформулированном в теореме 2.16 или следствии 2.13 неудобно. Мы предпримем исследование о том, когда же вершина входит в пару множеств $(D, S)$ с максимальным $f$-дефицитом.

Определение 2.19. Пусть $x \in D$. Обозначим через $o(f ; D, S, x)$ количество $(f ; D, S)$-нечётных компонент связности графа $G-D-S$, смежных с $x$. Пусть $\nu(f ; D, S, x)$ равно единице, если $o(f ; D, S, x)+e(x, S)+f(x)$ нечётно и нулю, если это число чётно.


Рис. 2.13: Компоненты связности графа $G-D-S$, смежные с $x \in D$.

Теорема 2.17. (W. T. Tutte, 1978.) Пусть $(D, S)$ - пара непересекающихся подмножеств $V(G)$ с максимальным $\operatorname{def}(f ; D, S)$. Тогда выполняются следующие утверждения.

1) Для любой вершины $x \in D$

$$
f(x) \leq o(f ; D, S, x)-\nu(f ; D, S, x)+e(x, S)
$$

В случае равенства $\operatorname{def}(f ; D, S)=\operatorname{def}(f ; D \backslash\{x\}, S)$.
1) Для любой вершины $x \in S$

$$
f^{\prime}(x) \leq o\left(f^{\prime} ; S, D, x\right)-\nu\left(f^{\prime} ; S, D, x\right)+e(x, D)
$$

В случае равенства $\operatorname{def}\left(f^{\prime} ; S, D\right)=\operatorname{def}\left(f^{\prime} ; S \backslash\{x\}, D\right)$.
1) Для любой вершины $x \in V(G)-D-S$

$$
\begin{aligned}
& f(x) \geq o(f ; D \cup\{x\}, S, x)-\nu(f ; D \cup\{x\}, S, x)+e(x, S) \quad u \\
& f^{\prime}(x) \geq o\left(f^{\prime} ; S \cup\{x\}, D, x\right)-\nu\left(f^{\prime} ; S \cup\{x\}, D, x\right)+e(x, D)
\end{aligned}
$$

Доказательство. 1) Пусть $D_{x}=D \backslash\{x\}, q=o(f ; D, S, x)$. В графе $G-D_{x}-S$ вместо всех компонент связности графа $G-D-S$, смежных с $x$, есть компонента связности $U$, полученная объединением всех этих компонент связности и вершины $x$ (см. рисунок 2.13). Остальные компоненты связности в графах $G-D_{x}-S$ и $G-D-S-$ одни и те же. Отметим, что,
$e(U, S)+\sum_{y \in U} f(y) \equiv o(f ; D, S, x)+e(x, S)+f(x) \equiv \nu(f ; D, S, x) \quad(\bmod 2)$.
Таким образом, функция $\nu(f ; D, S, x)$ показывает, является ли нечетной новая компонента связности $U$ графа $G-D_{x}-S$. Поэтому

$$
\begin{aligned}
& o(f ; D, S)-o\left(f ; D_{x}, S\right)=o(f ; D, S, x)-\nu(f ; D, S, x) \quad \text { и } \\
& 0 \leq \operatorname{def}(f ; D, S)-\operatorname{def}\left(f ; D_{x}, S\right)= \\
& \quad o(f ; D, S, x)-\nu(f ; D, S, x)+e(x, S)-f(x)
\end{aligned}
$$

откуда немедленно следует утверждение пункта 1.
Доказательство пункта 2 следует из пункта 1 и леммы 2.9. Неравенства пункта 3 аналогичны неравенствам пунктов 1 и 2.

Замечание 2.11. По определению $\nu(f ; D, S, x)$, величина

$$
f(x)-o(f ; D, S, x)+\nu(f ; D, S, x)-e(x, S)
$$

всегда четна. Поэтому в случае строгого неравенства в любом из пунктов теоремы 2.17 разность левой и правой части по модулю не менее 2.

Следствие 2.14. Существует такая пара $(D, S)$ непересекающихся множеств с максимальным $\operatorname{def}(f ; D, S)$, что $f(x)>1$ для всех вершин $x \in S$.

Доказательство. Выберем среди всех пар с максимальным $f$-дефицитом такую пару $(D, S)$, что $|S|$ минимально. Предположим, что существует вершина $x \in S$, для которой $f(x) \leq 1$. Из минимальности множества $S$ следует $\operatorname{def}\left(f^{\prime} ; S, D\right)>\operatorname{def}\left(f^{\prime} ; S \backslash\{x\}, D\right)$. Теперь применим пункт 2 теоремы 2.17 и учтём замечание 2.11 :
$d_{G}(x)-1 \leq f^{\prime}(x) \leq o\left(f^{\prime} ; S, D, x\right)-\nu\left(f^{\prime} ; S, D, x\right)+e(x, D)-2 \leq d_{G}(x)-2$, противоречие. Следовательно, пара множеств $(D, S)$ - искомая.

# 2.6.4 Еще раз про факторы регулярного графа 

В этом разделе мы дополним известный нам из раздела 2.5.3 список результатов о регулярных факторах регулярных графов.

Определение 2.20. Назовем граф $G$ реберно $k$-нечетно связным, если для любого множества $F \subset E(G)$, состоящего менее чем из $k$ рёбер, все компоненты связности графа $G-F$ имеют четное число вершин.

Замечание 2.12. 1) Очевидно, у $k$-нечетно связного графа четное число вершин.
1) Разумеется, реберно $k$-связный граф с четным числом вершин является и реберно $k$-нечетно связным.

Итак, вернемся к вопросу о том, когда у регулярного графа степени $k$ есть $r$-фактор. Остаются неразобранными случаи, когда хотя бы одно из чисел $r$ и $k$ нечетно. В этих случаях имеет смысл рассматривать только регулярные графы с четным количеством вершин.

Теорема 2.18. (B. Bollobás, A. Saito, N. C. Wormald, 1985.) Пусть $G$ - реберно $n$-нечетно связный регулярный граф степени $k$. Тогда выполняются следующие утверждения.

1) Пусть $k$ нечетно, а $n^{\prime}=2\left\lfloor\frac{n}{2}\right\rfloor+1$ - наименьшее нечетное число, которое не менее $n$. Тогда $G$ имеет $r$-факторы для четных $r \leq \frac{n^{\prime}-1}{n^{\prime}} \cdot k$ и для нечетных $r \geq \frac{1}{n^{\prime}} \cdot k$.
2) Пусть $k$ четно. Тогда $G$ имеет $r$-факторы для всех таких нечетных $r$, что $\frac{1}{n} \cdot k \leq r \leq \frac{n-1}{n} \cdot k$.
Замечание 2.13. В 1961 году T. Gallai доказал почти что эту теорему, с единственным отличием - в пункте 1 фигурировало $n$ вместо $n^{\prime}$.

Задача 2.5. Пусть $n, k$ и $r$ не удовлетворяют условию теоремы 2.18. Докажите, что существует рёберно $n$-связный $k$-регулярный граф $G$, не имеющий $r$-фактора.

Доказательство теоремы 2.18. 1) Достаточно доказать утверждение только для четных $r$. Действительно, дополнение графа $G$ до $r$-фактора с четным $r$ - это $(k-r)$-фактор, а $k-r$ - нечетно. При этом, если $r \leq \frac{n^{\prime}-1}{n^{\prime}} \cdot k$, то $k-r \geq \frac{1}{n^{\prime}} \cdot k$.

Итак, пусть $r$ четно, $r \leq \frac{n^{\prime}-1}{n^{\prime}} \cdot k$. Положим $f(x)=k-r$ для каждой вершины $x \in V(G)$. Тогда $f^{\prime}(x)=d_{G}(x)-f(x)=r$. Мы хотим доказать, что граф $G$ имеет $f$-фактор. Пусть $D, S \subset V(G)$ - произвольные непересекающиеся подмножества. По следствию 2.13 нам достаточно доказать, что выполняется неравенство (2.12). Перепишем его, используя явный вид функций $f$ и $f^{\prime}$ :

$$
o(f ; D, S)+e_{G}(D, S) \leq(k-r)|D|+r|S|
$$

Пусть $U_{1}, \ldots, U_{p}-$ все $(f ; D, S)$-нечетные (а значит, по лемме 2.9 , все $\left(f^{\prime} ; S, D\right.$ )-нечетные) компоненты связности графа $G-D-S$. Пусть $d_{i}$ и $s_{i}$ - количества рёбер из $U_{i}$ в $D$ и $S$ соответственно. Компонента связности $U_{i}$ является $\left(f^{\prime} ; S, D\right)$-нечетной тогда и только тогда, когда нечетно

$$
r_{f^{\prime} ; S, D}\left(U_{i}\right)=d_{i}+\sum_{x \in U_{i}} f^{\prime}(x)=d_{i}+r\left|U_{i}\right| \equiv d_{i} \quad(\bmod 2)
$$

Таким образом, все числа $d_{1}, \ldots, d_{p}$ - нечетны, а следовательно, каждое из них не менее 1 . Пусть компоненты связности $U_{1}, \ldots, U_{q}$ (где $q \leq p$ ) несмежны с $S$, а $U_{q+1}, \ldots, U_{p}-$ смежны с $S$, то есть, $s_{1}=\cdots=s_{q}=0$, а $s_{q+1}, \ldots, s_{p}$ не менее 1 . Тогда $U_{1}, \ldots, U_{q}-$ компоненты связности графа $G-D$.

Пусть $1 \leq i \leq q$. Так как степени вершин графа $G$ нечетны, по лемме 2.2 числа $\left|U_{i}\right|$ и $d_{i}$ имеют одинаковую четность. Следовательно, $U_{i}-$ нечетная компонента связности, а значит, по условию имеем $d_{i} \geq n$. Учитывая четность, получаем $d_{i} \geq n^{\prime}$ (см. рисунок 2.14).

Посчитаем ребра, выходящие из множества $D$ в $V(G) \backslash(D \cup S)$ :

$$
k|D|-e_{G}(D, S) \geq \sum_{i=1}^{q} d_{i}+\sum_{j=q+1}^{p} d_{j} \geq n^{\prime} q+(p-q)=\left(n^{\prime}-1\right) q+p
$$

Посчитаем ребра, выходящие из множества $S$ в $V(G) \backslash(D \cup S)$ :

$$
k|S|-e_{G}(D, S) \geq \sum_{j=q+1}^{p} s_{j} \geq p-q
$$



Рис. 2.14: Компоненты связности графа $G-D-S$.

Умножим неравенство (2.14) на $(k-r)$, а неравенство (2.15) на $r$ и сложим:

$$
\begin{aligned}
& k \cdot((k-r)|D|+r| S|-e_{G}(D, S))= \\
& \quad(k-r) \cdot\left(k|D|-e_{G}(D, S)\right)+r \cdot\left(k|S|-e_{G}(D, S)\right) \geq \\
& \quad(k-r)\left(\left(n^{\prime}-1\right) q+p\right)+r(p-q) \geq k p+\left(k\left(n^{\prime}-1\right)-r n^{\prime}\right) \cdot q \geq \\
& \quad k p=k \cdot o(f ; D, S)
\end{aligned}
$$

так как $p=o(f ; D, S)$. Таким образом, мы доказали неравенство (2.13) и утверждение 1 теоремы 2.18 .
1) Утверждение для четного $r$ доказано в следствии 2.4. Пусть $r$ нечетно, $\frac{1}{n} \cdot k \leq r \leq \frac{n-1}{n} \cdot k$. Тогда $k-r$ также нечетно. Положим $f(x)=$ $k-r$ для каждой вершины $x \in V(G)$. Тогда $f^{\prime}(x)=d_{G}(x)-f(x)=r$. Мы хотим доказать, что граф $G$ имеет $f$-фактор. Пусть $D, S \subset V(G)$ произвольные непересекающиеся подмножества. По следствию 2.13 нам достаточно доказать, что выполняется неравенство (2.13).

Пусть $U_{1}, \ldots, U_{p}$ - все $(f ; D, S)$-нечетные (а значит, по лемме 2.9 , все $\left(f^{\prime} ; S, D\right.$ )-нечетные) компоненты связности графа $G-D-S$. Пусть $d_{i}$ и $s_{i}$ - количества рёбер из $U_{i}$ в $D$ и $S$ соответственно. Компонента связности $U_{i}$ является $(f ; D, S)$-нечетной тогда и только тогда, когда нечетно

$$
r_{f ; D, S}\left(U_{i}\right)=s_{i}+\sum_{x \in U_{i}} f(x)=d_{i}+(k-r)\left|U_{i}\right| \equiv d_{i}+\left|U_{i}\right| \quad(\bmod 2)
$$

Аналогично, $r_{f ; D, S}\left(U_{i}\right)=r_{f^{\prime} ; S, D}\left(U_{i}\right) \equiv s_{i}+\left|U_{i}\right|(\bmod 2)$. Таким образом, если $\left|U_{i}\right|$ четно, то оба числа $s_{i}$ и $d_{i}$ нечетны, а значит, не менее 1.

Пусть компоненты связности $U_{1}, \ldots, U_{q}$ (где $q \leq p$ ) несмежны с $S$, компоненты связности $U_{q+1}, \ldots, U_{q+t}$ несмежны с $D$, а остальные компоненты связности $U_{q+t+1}, \ldots, U_{p}$ смежны и с $S$, и с $D$.

Из сказанного выше понятно, что все компоненты связности $U_{1}, \ldots$, $U_{q}, U_{q+1}, \ldots, U_{q+t}$ - нечетны, поэтому все числа $d_{1}, \ldots, d_{q}, s_{q+1}, \ldots, s_{q+t}$ - не менее, чем $n$ (см. рисунок 2.15 ).



Рис. 2.15: Компоненты связности графа $G-D-S$.

Посчитаем ребра, выходящие из множества $D$ в $V(G) \backslash(D \cup S)$ :

$$
k|D|-e_{G}(D, S) \geq \sum_{i=1}^{p} d_{i} \geq n q+p-t-q=p+(n-1) q-t
$$

Посчитаем ребра, выходящие из множества $S$ в $V(G) \backslash(D \cup S)$ :

$$
k|S|-e_{G}(D, S) \geq \sum_{j=1}^{p} s_{j} \geq n t+p-q-t=p+(n-1) t-q
$$

Умножим неравенство (2.16) на $(k-r)$, а неравенство (2.17) на $r$ и сложим:

$$
\begin{aligned}
& k \cdot((k-r)|D|+r| S \mid-e_{G}(D, S))= \\
& (k-r) \cdot\left(k|D|-e_{G}(D, S)\right)+r \cdot(k|S|-e_{G}(D, S)) \geq \\
& (k-r)(p+(n-1) q-t)+r(p+(n-1) t-q) \geq \\
& k p+(k(n-1)-r n) \cdot q+(r n-k) \cdot t \geq \\
& k p=k \cdot o(f ; D, S)
\end{aligned}
$$

Таким образом, мы доказали неравенство (2.13) и утверждение 2 теоремы 2.18 .

Следствие 2.15. (F. Bäbler, 1938.) Пусть $G$ - n-нечетно-связный регулярный граф нечетной степени $k$, причем $n$ четно. Тогда $G$ имеет $n$-бактор и $k-n$-бактор.

# 2.6.5 Жесткость и $k$-факторы 

Сначала выясним очевидные свойства $k$-жесткого графа.
Лемма 2.10. Пусть $k$ - натуральное число, а $G$ - неполный $k$-жесткий граф. Тогда $v(G) \geq 2 k+2 u \delta(G) \geq 2 k$.

Доказательство. Предположим, что $v(G) \leq 2 k+1$. Так как граф неполный, то в нем есть две несмежные вершины $a$ и $b$. Пусть $X=V(G) \backslash\{a, b\}$. Тогда $G-X$ имеет две компоненты связности, следовательно,

$$
2 k-1 \geq|X| \geq c(G-X) \cdot t(G) \geq 2 k
$$

противоречие. Далее мы будем считать,что $v(G) \geq 2 k+2$.
Предположим, что существует вершина $x \in V(G)$ степени $d_{G}(x) \leq 2 k-1$. Тогда из $v(G) \geq 2 k+2$ следует, что $c\left(G-\mathrm{N}_{G}(x)\right) \geq 2$, а значит,

$$
2 k-1 \geq\left|\mathrm{N}_{G}(x)\right| \geq c\left(G-\mathrm{N}_{G}(x)\right) \cdot t(G) \geq 2 k
$$

противоречие.
Основной целью этого раздела будет доказательство следующей теоремы.

Теорема 2.19. (H.Enomoto, B.Jackson, P.Katerinis, A.Saito, 1985.) Пусть $G$ - неполный граф с $v(G) \geq k+1$, причем $k \cdot v(G)$ четно $u \mathrm{t}(G) \geq k$. Тогда $G$ имеет $k$-фактор.

Доказательство. Предположим, что $G$ не имеет $k$-фактора. Пока это возможно, будем добавлять в граф $G$ рёбра так, чтобы не появился $k$ фактор. От этой процедуры, очевидно, не уменьшается $\mathrm{t}(G)$. Так как $k v(G)$ четно, у полного графа на $v(G)$ вершинах есть $k$-фактор. Поэтому можно считать, что граф $G$ - неполный и не имеет $k$-фактора, но при добавлении любого ребра $k$-фактор появляется.

Положим $f(x)=k$ для любой вершины $x \in V(G)$. Будем считать, что $k \geq 2$, иначе воспользуемся следствием 2.12. Для доказательства теоремы мы проверим, что для любой пары непересекающихся множеств $D, S \subset V(G)$ выполняется условие теоремы Татта о факторе $\operatorname{def}(f ; D, S) \leq 0$, или эквивалентное ему неравенство (2.10), которое мы перепишем, учитывая явный вид функции $f$ :

$$
o(f ; D, S)+k|S| \leq k|D|+\sum_{x \in S} d_{G-D}(x)
$$

Предположим, что это условие выполнено не всегда и выберем из всех пар $(D, S)$ с наибольшим $f$-дефицитом пару с минимальным $S$. Понятно, что $\operatorname{def}(f ; D, S)>0$.

Сразу же отметим невозможность случая $D=S=\varnothing$. Так как по лемме 2.6 граф $G$ связен, в этом случае $G$ - единственная компонента связности графа $G-\varnothing$, которая в силу $r(f ; \varnothing, \varnothing)=k v(G)$ является четной.

Лемма 2.11. Пусть $S \neq \varnothing$. Тогда $\Delta(G(S)) \leq k-2$.
Доказательство. Пусть $x \in S$. По выбору множества $S$ мы имеем $\operatorname{def}(f ; D, S \backslash\{x\}) \leq 0$. Тогда из пункта 2 теоремы 2.17 следует, что

$$
d_{G}(x)-k=f^{\prime}(x)<o\left(f^{\prime} ; S, D, x\right)+e_{G}(x, D)-\nu\left(f^{\prime} ; S, D, x\right)
$$

По замечанию 2.11 левая часть меньше правой хотя бы на 2 , что можно переписать в виде

$$
d_{G}(x)-o\left(f^{\prime} ; S, D, x\right)-e_{G}(x, D) \leq k-2-\nu\left(f^{\prime} ; S, D, x\right)
$$

Отметим, что $o\left(f^{\prime} ; S, D, x\right) \leq e(x, V(G-D-S))$, а $\nu\left(f^{\prime} ; S, D, x\right) \geq 0$, следовательно

$$
\begin{aligned}
d_{G(S)}(x)=d_{G}(x)-e_{G}(x, V(G-D-S))-e_{G}(x, D) & \leq \\
d_{G}(x)-o\left(f^{\prime} ; S, D, x\right)-e_{G}(x, D) & \leq k-2
\end{aligned}
$$

что и требовалось доказать.
Вернемся к доказательству теоремы 2.19. Пусть $U=V(G-D-S)$, а $U_{1}, \ldots, U_{p}$ - все компоненты связности графа $G-D-S$.

Отметим, что отсутствие $k$-фактора эквивалентно невыполнению условия (2.18). Предположим, что вершина $a \in D$ несмежна хотя бы с одной вершиной $b \in V(G)$. По замечанию 2.8 , в графах $G-D-S$ и $G+a b-D-S$ одни и те же $(f, D, S)$-нечетные компоненты связности. Поэтому, в графе $G+a b$ левая и правая часть (2.18) такие же, как в $G$, значит, и этот граф не имеет $k$-фактора, что противоречит выбору $G$. Таким образом, каждая вершина множества $D$ смежна со всеми остальными вершинами графа $G$.

Предположим, что в графе $G$ несмежны вершины $x, y \in U_{i}$. По замечанию 2.8 , в графах $G-D-S$ и $G+x y-D-S$ одни и те же $(f, D, S)$ нечетные компоненты связности. Поэтому, в графе $G+x y$ левая и правая часть (2.18) такие же, как в $G$, значит, и этот граф не имеет $k$-фактора, что противоречит выбору $G$. Таким образом, каждая компонента связности $U_{i}$ - клика в графе $G$.

Пусть $S_{1}$ - максимальное независимое множество вершин в графе $H=G(S)$, а $H_{1}=G(S)-S_{1}$. Для $i \geq 1$ пусть $S_{i+1}$ - максимальное независимое множество вершин в графе $H_{i}$, а $H_{i+1}=H_{i}-S_{i+1}$. Из $\Delta(H) \leq k-2$ следует, что $S=\cup_{i=1}^{k-1} S_{i}$. Пусть $V_{i}=V\left(H_{i}\right)$. Изучим свойства множеств $S_{1}, \ldots, S_{k-1}$.

Лемма 2.12. Можно выбрать множество $S_{1}$ так, чтобы

$$
k\left|S_{1}\right| \leq|D|+\left|V_{1}\right|+e_{G}\left(U, S_{1}\right)-p
$$

Доказательство. Пусть $W_{1}$ - множество всех вершин из $U$, смежных с $S_{1}$. Предположим, что $U_{1}, \ldots, U_{q}$ - все компоненты связности графа $G-D-S$, смежные с $S_{1}$. Если в компоненте связности $U_{i}$ существует вершина, смежная ровно с одной вершиной из $S_{1}$, то выберем одну из таких вершин и обозначим через $w_{i}$. Пусть $W_{2}$ - множество из всех вершин $w_{i},\left|W_{2}\right|=t$, а $W_{3}=W_{1} \backslash W_{2}$. Понятно, что $t \leq q$.


Рис. 2.16: Множества $W_{2}, W_{3}$ и граф $G_{1}$.
Каждая из компонент связности $U_{1}, \ldots, U_{q}$, не содержащая вершину из $W_{2}$, содержит только вершины, инцидентные хотя бы двум рёбрам из $E_{G}\left(U, S_{1}\right)=E_{G}\left(W_{1}, S_{1}\right)$, поэтому в множестве $W_{1}$ не менее $q-t$ таких вершин. Следовательно,

$$
\left|W_{1}\right| \leq e_{G}\left(W_{1}, S_{1}\right)-(q-t)
$$

а значит,

$$
\left|W_{3}\right|=\left|W_{1}\right|-t \leq e_{G}\left(W_{1}, S_{1}\right)-q=e_{G}\left(U, S_{1}\right)-q
$$

Пусть $G_{1}=G-\left(D \cup V_{1} \cup W_{3}\right)$. Отметим, что $S_{1} \subset V\left(G_{1}\right)$ - независимое множество, и его вершины в графе $G_{1}$ смежны только с вершинами из независимого множества $W_{2}$, причем каждая вершина из $W_{2}$ смежна только с одной вершиной из $S_{1}$. Поэтому вершины из $S_{1}$ принадлежат разным компонентам связности графа $G_{1}$. Компоненты связности $U_{q+1}, \ldots, U_{p}$ графа $G-D-S$, вершины которых не смежны с $S_{1}$, являются компонентами связности графа $G_{1}$. Поэтому

$$
c\left(G_{1}\right) \geq\left|S_{1}\right|+p-q
$$

Рассмотрим два случая.

1. $c\left(G_{1}\right) \geq 2$.

Тогда из $\mathrm{t}(G) \geq k$, неравенств (2.20) и (2.21) делаем вывод

$$
\begin{aligned}
& \left|D\left|+\left|V_{1}\right|+e_{G}\left(U, S_{1}\right)-q \geq\right|\left(D \cup V_{1} \cup W_{3}\right)\right| \geq k \cdot c\left(G_{1}\right) \geq \\
& k\left(\left|S_{1}\right|+p-q\right) \geq k\left|S_{1}\right|+p-q
\end{aligned}
$$

откуда непосредственно следует утверждение леммы.
1. $c\left(G_{1}\right)=1$.

В силу (2.21) мы имеем $\left|S_{1}\right|=0$ или $\left|S_{1}\right|=1$. Рассмотрим два случая.
2.1. $\left|S_{1}\right|=0$.

Тогда $S=S_{1}=\varnothing$, следовательно, $\left|V_{1}\right|=e_{G}\left(U, S_{1}\right)=0$. Следовательно, как сказано выше, тогда $D \neq \varnothing$. В этом случае утверждение леммы эквивалентно неравенству $|D| \leq p$. Если $p=c(G-D)>1$, то мы имеем $p \geq k|D|>|D|$. Если же $p=1$, то утверждение очевидно, так как $|D| \geq 1$.
2.2. $\left|S_{1}\right|=1$.

Пусть $S_{1}=\left\{s_{1}\right\}$. Тогда $S-$ клика в $G$, следовательно, все вершины из $V_{1}$ смежны с $s_{1}$. По построению, все вершины множества $D$ смежны с $s_{1}$. Если $p=1$, то по лемме 2.10 мы имеем $d_{G}\left(s_{1}\right) \geq 2 k$ и

$$
k\left|S_{1}\right|=k<d_{G}\left(s_{1}\right)-p \leq|D|+\left|V_{1}\right|+e_{G}\left(U, s_{1}\right)-p
$$

что и требовалось доказать.
Пусть $p \geq 2$. Тогда из $\mathrm{t}(G) \geq k$ следует, что

$$
|D|+|S|=|D \cup S| \geq k \cdot c(G-D-S)=k p \geq 2 k
$$

Тогда

$$
|D|+\left|V_{1}\right|=|D|+\left|V_{1}\right|+\left|S_{1}\right|-1=|D|+|S|-1 \geq 2 k-1>k=k\left|S_{1}\right|
$$

что и требовалось доказать.
Лемма 2.13. Пусть $M_{r}=\cup_{j=1}^{r} S_{j}$. Тогда для $i \in[2 . . k-1]$ выполнено неравенство

$$
k\left|S_{i}\right| \leq|D|+\left|V_{i}\right|+e_{G}\left(U, S_{i}\right)+e_{G}\left(M_{i-1}, S_{i}\right)
$$

Доказательство. Если $S_{i}=\varnothing$, то, очевидно, утверждение выполнено. Пусть $S_{i} \neq \varnothing$. Положим

$$
X_{i}=\mathrm{N}_{G}\left(S_{i}\right) \cap M_{i-1}, \quad Y_{i}=\mathrm{N}_{G}\left(S_{i}\right) \cap U, \quad G_{i}=G-\mathrm{N}_{G}\left(S_{i}\right)
$$

(см. рисунок 2.17). Понятно, что $\mathrm{N}_{G}\left(S_{i}\right)=D \cup X_{i} \cup Y_{i} \cup V_{i}$ (напомним, что вершины множества $V_{i}$ смежны со всеми вершинами из $S_{i}$ по построению,



Рис. 2.17: Множества $S_{i}, V_{i}, X_{i}, Y_{i}$ и граф $G_{i}$.

а вершины множества $D$ - по доказанному выше). Отметим очевидные неравенства $\left|X_{i}\right| \leq e_{G}\left(M_{i-1}, S_{i}\right)$ и $\left|Y_{i}\right| \leq e_{G}\left(U, S_{i}\right)$. Тогда

$$
\left|\mathrm{N}_{G}\left(S_{i}\right)\right| \leq|D|+\left|V_{i}\right|+e_{G}\left(M_{i-1}, S_{i}\right)+e_{G}\left(U, S_{i}\right)
$$

Вершины множества $S_{i}$ - изолированные в $G_{i}$, следовательно, $c\left(G_{i}\right) \geq\left|S_{i}\right|$. Рассмотрим два случая.

1. $c\left(G_{i}\right) \geq 2$.

Тогда из $\mathrm{t}(G) \geq k$ и неравенства (2.23) следует, что

$$
|D|+\left|V_{i}\right|+e_{G}\left(M_{i-1}, S_{i}\right)+e_{G}\left(U, S_{i}\right) \geq\left|\mathrm{N}_{G}\left(S_{i}\right)\right| \geq k \cdot c\left(G_{i}\right) \geq k\left|S_{i}\right|
$$

1. $c\left(G_{i}\right)=1$.

В этом случае $\left|S_{i}\right|=1$ и, кроме того, $V(G)=S_{i} \cup \mathrm{~N}_{G}\left(S_{i}\right)$. Тогда из $v(G) \geq 2 k+2$ следует, что $\left|\mathrm{N}_{G}\left(S_{i}\right)\right|>k$. Теперь из неравенства (2.23) следует, что

$$
|D|+\left|V_{i}\right|+e_{G}\left(M_{i-1}, S_{i}\right)+e_{G}\left(U, S_{i}\right) \geq\left|\mathrm{N}_{G}\left(S_{i}\right)\right|>k=k\left|S_{i}\right|
$$

Закончим доказательство теоремы. Положим $M_{0}=\varnothing$. Заметим, что $e_{G}\left(S_{i}, V_{i}\right) \geq\left|V_{i}\right|$, так как $S_{i}$ - максимальное независимое множество вершин в графе $H_{i}$, а $V_{i}=V\left(H_{i}\right) \backslash S_{i}$. Кроме того, $V(G) \backslash D=U \cup M_{i-1} \cup S_{i} \cup V_{i}$. Так как никакие две вершины множества $S_{i}$ не смежны, мы имеем

$$
\begin{aligned}
& e_{G}\left(S_{i}, V(G) \backslash D\right)=e_{G}\left(S_{i}, M_{i-1}\right)+e_{G}\left(S_{i}, U\right)+e_{G}\left(S_{i}, V_{i}\right) \geq \\
& e_{G}\left(S_{i}, M_{i-1}\right)+e_{G}\left(S_{i}, U\right)+\left|V_{i}\right|
\end{aligned}
$$

Воспользуемся леммами 2.12 и 2.13: сложим неравенство (2.19) и неравенства (2.22) для $i \in[2, \ldots, k-1]$, после чего перенесем $p$ в левую часть.

Учитывая (2.24), получим

$$
\begin{aligned}
& k|S|+o(f ; D, S) \leq \sum_{i=1}^{k-1} k\left|S_{i}\right|+p \leq \\
& (k-1)|D|+\sum_{i=1}^{k-1}\left|V_{i}\right|+\sum_{i=1}^{k-1} e_{G}\left(U, S_{i}\right)+\sum_{i=2}^{k-1} e_{G}\left(M_{i-1}, S_{i}\right)= \\
& (k-1)|D|+\sum_{i=1}^{k-1}\left(e_{G}\left(S_{i}, U\right)+e_{G}\left(S_{i}, M_{i-1}\right)+\left|V_{i}\right|\right) \leq \\
& (k-1)|D|+\sum_{i=1}^{k-1} e_{G}\left(S_{i}, V(G) \backslash D\right) \leq k|D|+\sum_{x \in S} d_{G-D}(x)
\end{aligned}
$$

Тем самым неравенство (2.18) для множеств $D$ и $S$ выполнено, противоречие. Теорема доказана.

# 2.7 Графы с единственным паросочетанием 

В этом разделе мы рассмотрим гораздо более простой по формулировке вопрос. Что можно сказать о графе, имеющем ровно одно совершенное паросочетание?

Теорема 2.20. (A. Kotzig, 1959.) Пусть $G$ - связный граф (возможно, с кратными рёбрами, но без петель), имеющий единственное совершенное паросочетание. Тогда граф $G$ имеет мост, входящий в это паросочетание.

Доказательство. 1. Предположим, что это утверждение неверно и выберем граф-контрпример $G$ с наименьшим количеством вершин. Пусть $M$ - единственное совершенное паросочетание графа $G$, а $N=E(G) \backslash M$.

Понятно, что граф $G$ связен. Докажем, что существует такое множество $F \subset N$ из одного или двух рёбер, что граф $G-F$ имеет ровно две компоненты связности.

Если граф $G$ имеет мост $f$, то $f \in N$ и $F=\{f\}$ нам подойдет. Пусть граф $G$ не имеет мостов. Тогда $\delta(G) \geq 2$. Очевидно, наш граф $G$ не является четным циклом, поэтому имеет хотя бы одну вершину степени более 2. Следовательно, $|N|>|M|$.

Для любого ребра $f \in N$ граф $G-f$ также имеет единственное паросочетание, причем это паросочетание $M$. Следовательно, $G-f$ имеет мост $e \in M$. Так как $|N|>|M|$, существуют ребра $f_{1}, f_{2} \in N$ и $e \in M$,

что ребро $e$ является мостом и в $G-f_{1}$, и в $G-f_{2}$. Таким образом, $\left\{f_{1}, e\right\}$ и $\left\{f_{2}, e\right\}$ - разделяющие множества в $G$.

В графе $G-e$ оба ребра $f_{1}$ и $f_{2}$ - мосты, каждый из них делит граф на две компоненты связности. Следовательно, граф $G-\left\{e, f_{1}, f_{2}\right\}$ имеет три компоненты связности. Теперь понятно, что граф $G-\left\{f_{1}, f_{2}\right\}$ несвязен, но становится связным при добавлении ребра $f_{1}$, а следовательно, имеет ровно две компоненты связности. Таким образом, $F=\left\{f_{1}, f_{2}\right\}$ нам подходит.
1. Пусть $F=\left\{f_{1}, f_{2}\right\}$ (при $|F|=1$ мы полагаем $\left.f_{1}=f_{2}\right), f_{1}=a_{1} a_{2}$, $f_{2}=b_{1} b_{2}$. Не умаляя общности можно считать, что $U_{1} \ni a_{1}, b_{1}$ и $U_{2} \ni a_{2}, b_{2}$ - компоненты связности графа $G-F$.

Определим граф $G_{1}$. В случае, когда $a_{1}=b_{1}$ положим $G_{1}=G\left(U_{1}\right)$, а при $a_{1} \neq b_{1}$ пусть $G_{1}$ получен из $G\left(U_{1}\right)$ добавлением нового ребра $f_{1}^{\prime}$ с концами $a_{1}$ и $b_{1}$ (даже если ребро с такими концами в $G\left(U_{1}\right)$ есть). Аналогично определим $G_{2}$.

Рассмотрим граф $G_{1}$ - он меньше $G$ и имеет паросочетание, являющееся частью $M$. Следовательно, либо граф $G_{1}$ имеет мост $e_{1} \in M$, либо он имеет другое совершенное паросочетание $M_{1}$. Рассмотрим случай, когда есть мост. В графе $G$ ребро $e_{1}$ не является мостом, следовательно, $e_{1}$ входит в простой цикл $Z$, проходящий хотя бы по одному из рёбер множества $F$. Но такой цикл обязан проходить и по $a_{1}$, и по $b_{1}$, причем эти вершины должны быть различны, более того, вершины $a_{1}$ и $b_{1}$ делят $Z$ на две дуги: одна лежит в $U_{1}$ и содержит $e_{1}$, а другая проходит по $U_{2}$ (см. рисунок 2.18). Заменив вторую дугу на ребро $f_{1}^{\prime}$, мы получим простой цикл в $G_{1}$, содержащий ребро $e_{1}$, противоречие.


Рис. 2.18: Мост $e_{1}$.
Таким образом, граф $G_{1}$ имеет паросочетание $M_{1}$, отличное от части $M$. Аналогично, граф $G_{2}$ имеет паросочетание $M_{2}$, отличное от части $M$.
1. Пусть $M_{1} \not \ni f_{1}^{\prime}$. Тогда мы построим второе совершенное паросочетание в графе $G$ таким образом: в $U_{1}$ возьмём ребра из $M_{1}$, а в $U_{2}$ возьмём ребра исходного паросочетания $M$. Аналогично рассматривается случай, когда $M_{2} \not \ni f_{2}^{\prime}$.



Рис. 2.19: Паросочетания $M_{1}, M_{2}$ и $M^{\prime}$.

Остается случай $M_{1} \ni f_{1}^{\prime}, M_{2} \ni f_{2}^{\prime}$. В этом случае мы построим второе совершенное паросочетание в графе $G$ таким образом (см. рисунок 2.19):

$$
M^{\prime}=\left(M_{1} \backslash\left\{f_{1}^{\prime}\right\}\right) \cup\left(M_{2} \backslash\left\{f_{2}^{\prime}\right\}\right) \cup\left\{f_{1}, f_{2}\right\}
$$

В любом из случаев получаем противоречие с выбором графа $G$.

# 2.8 Комментарии 

Глава начинается с классических утверждений, которые можно найти во многих источниках. Автору наиболее симпатично изложение в книге Бонди и Мурти "Graph Theory with Applications" [3], но нельзя сказать, что мы полностью следуем этой книге.

Несколько более современной является теория паросочетаний с предпочтениями. Теорема Гэйла-Шепли приведена в книге с элегантным фольклорным доказательством, которое мне рассказали студенты. В книге Дистеля [8] ее можно найти с другим доказательством, на основе более сложного инварианта. В разделе 8.7.2 можно найти неожиданное на первый взгляд применение теоремы Гэйла-Шепли в теореме Гэльвина о списочных раскрасках двудольных графов.

Значительная часть главы посвящена вопросу о максимальном паросочетании в произвольном (не обязательно двудольном) графе. Главное утверждение, из которого вся эта часть вышла - теорема Татта 2.6 (так называемая "one-factor theorem"). В книге эта теорема приведена с классическим доказательством Ловаса. Из нее выводится ряд следствий о паросочетаниях в регулярных графах - классическая теорема Петерсена (доказанная гораздо сложнее еще в 1891 году) о существовании паросочетания в кубическомом графе без мостов и чуть более сложная теорема Плешника.

В разделе 2.5.3 мы начинаем разговор о регулярных факторах регулярных графов с еще одной классической теоремы Петерсена - о 2факторе регулярного графа четной степени. Там же доказана теорема Томассена 2.10 о почти регулярном факторе почти регулярного графа. Эта теорема, доказанная в 1981 году [31], немного усиливает результат,

доказанный тремя годами ранее Таттом в качестве приложения разработанной им теории факторов. Однако, как это нередко бывает, оказалось, что теорему можно доказать гораздо проще - по индукции с помощью всего лишь теоремы Холла, если чуть усилить утверждение. Кроме того, Томассен заметил, что из теоремы о почти регулярном факторе следует доказанная гораздо сложнее в 1970 году теорема Ловаса о разбиении графа максимальной степени $s+t-1$ в объединение графа максимальной степени $s$ и графа максимальной степени $t$ (следствие 2.7).

Далее в книге следуют теория о дефиците графа (формула Бержа и ее следствия), структурная теорема Галлаи-Эдмнодса и теория барьеров - все это подробнее можно найти в книге Ловаса и Пламмера [22].

Теория факторов - достаточно абстрактная часть книги, сложная для неподготовленного читателя. В целом, изложение этой придуманной Таттом теории следует книге Ловаса и Пламмера [22], в которой можно найти еще много чего интересного по теории паросочетаний и факторов.

Нельзя оставить такую абстрактную теорию, как теория факторов, без конкретных и понятных задач, для решения которых ее можно (и нужно!) применить. В конце главы показан ряд применений теории факторов в задачах о поиске регулярных факторов. Теорема 2.18 впервые доказана в статье [2], а теорема 2.19 - в статье [9].

Заканчивается глава классической теоремой Котцига о графах с единственным паросочетанием с достаточно простым и симпатичным доказательством, которое придумал Г. Ненашев. Мы вернемся к этой теме в главе Раскраски, где выведем теорему Котцига из теоремы Йео 4.19 о чередующемся цикле.

ГЛАВА 2. ПАРОСОЧЕТАНИЯ

# Глава 3 

## Пути и циклы

## 3.1 Гамильтонов путь и цикл

Определение 3.1. Гамильтонов путь в графе $G$ - это простой путь, проходящий по каждой вершине графа.

Гамильтонов цикл в графе $G$ - это простой цикл, проходящий по каждой вершине графа.

Граф называется гамильтоновым, если в нем есть гамильтонов цикл.
В этом разделе рассматриваются графы без петель и кратных рёбер.

### 3.1.1 Классические критерии Дирака и Оре

Лемма 3.1. Пусть $n>2, a_{1} \ldots a_{n}$ - максимальный путь в графе $G$, причём $d_{G}\left(a_{1}\right)+d_{G}\left(a_{n}\right) \geq n$. Тогда в графе есть цикл длины $n$.


Рис. 3.1: Построение цикла.

Доказательство. Если вершины $a_{1}$ и $a_{n}$ смежны, то из $n>2$ следует, что в графе есть цикл длины $n$. Пусть эти две вершины несмежны. Понятно, что

$$
\mathrm{N}_{G}\left(a_{1}\right), \mathrm{N}_{G}\left(a_{n}\right) \subset\left\{a_{2}, \ldots, a_{n-1}\right\}
$$

Пусть вершина $a_{n}$ смежна с $a_{k}$, а вершина $a_{1}$ смежна с $a_{k+1}$. Тогда в графе есть цикл из $n$ вершин: $a_{1} a_{2} \ldots a_{k} a_{n} a_{n-1} \ldots a_{k+1}$ (см. рисунок 3.1), что и требовалось доказать.

Пусть $\mathrm{N}_{G}\left(a_{n}\right)=\left\{a_{i_{1}}, \ldots, a_{i_{\ell}}\right\}$, тогда либо в графе есть цикл длины $n$, либо $a_{i_{1}+1}, \ldots a_{i_{\ell}+1} \notin \mathrm{~N}_{G}\left(a_{1}\right)$, следовательно, $d_{G}\left(a_{1}\right) \leq n-1-d_{G}\left(a_{n}\right)$. Полученное неравенство противоречит условию леммы.

Теорема 3.1. (О. Оте.) 1) Если для любых двух несмежных вершин $u, v \in V(G)$ выполняется $d_{G}(u)+d_{G}(v) \geq v(G)-1$, то в графе $G$ есть гамильтонов путь.
1) Если для любых двух несмежных вершин $u, v \in V(G)$ выполняется $d_{G}(u)+d_{G}(v) \geq v(G)$, то в графе $G$ есть гамильтонов цикл.

Доказательство. 1) Случай, когда в графе $G$ ровно две вершины, очевиден. Пусть $v(G)>2$. Заметим, что граф $G$ обязательно связен. (Пусть $a$ и $b$ - две несмежные вершины графа, тогда $d_{G}(a)+d_{G}(b) \geq v(G)-1$, откуда следует, что $\mathrm{N}_{G}(a) \cap \mathrm{N}_{G}(b) \neq \varnothing$, то есть, вершины $a$ и $b$ связаны.)

Пусть $n<v(G)$ - количество вершин в наибольшем простом пути графа $G$. Поскольку граф $G$ связен и $v(G)>2$, то $n \geq 3$. По лемме 3.1 в графе $G$ есть цикл $Z$ из $n$ вершин. Так как граф связен, существует не вошедшая в этот цикл вершина, смежная хотя бы с одной из вершин цикла, но тогда очевидно существует и путь длины $n+1$, что противоречит предположению. Таким образом, в графе есть гамильтонов путь.
1) Гамильтонов путь в графе уже есть по пункту 1. Пусть это путь $a_{1} \ldots a_{v(G)}$. Если вершины $a_{1}$ и $a_{v(G)}$ смежны, то очевидно есть и гамильтонов цикл, а если эти вершины несмежны, то $d_{G}\left(a_{1}\right)+d_{G}\left(a_{v(G)}\right) \geq v(G)$ и гамильтонов цикл есть по лемме 3.1.

А теперь приведем прямое следствие теоремы Оре.
Следствие 3.1. (G. A. Dirac, 1952.) 1) Если $\delta(G) \geq \frac{v(G)-1}{2}$, то в графе $G$ есть гамильтонов путь.
1) Если $\delta(G) \geq \frac{v(G)}{2}$, то в графе $G$ есть гамильтонов цикл.

# 3.1.2 Замыкание. Метод Хватала 

Лемма 3.2. Пусть $a b \notin E(G), d_{G}(a)+d_{G}(b) \geq v(G)$. Тогда граф $G-$ гамильтонов, если и только если граф $G+a b-$ гамильтонов.

Доказательство. Очевидно, достаточно доказать обратное следствие. Итак, пусть граф $G+a b$ - гамильтонов. Если гамильтонов цикл в графе $G+a b$ не проходит по ребру $a b$, то этот цикл есть и в графе $G$. Пусть гамильтонов цикл в графе $G+a b$ проходит по ребру $a b$, тогда в графе $G$ есть гамильтонов путь с концами $a$ и $b$. Значит, по лемме 3.1 в графе $G$ существует гамильтонов цикл.

Рассмотрим произвольный граф $G$. Если существуют две несмежные вершины $a, b \in V(G)$, для которых $d_{G}(a)+d_{G}(b) \geq v(G)$, то добавим в граф ребро $a b$. Далее продолжим процесс с полученным графом, и так далее, до тех пор, пока это возможно. Полученный в результате граф назовем замыканием графа $G$ и обозначим через $C(G)$.

Лемма 3.3. Замыкание графа $G$ определено однозначно, то есть, не зависит от порядка добавления рёбер.

Доказательство. Пусть в результате двух разных цепочек добавления рёбер были получены различные графы $G_{1}$ и $G_{2}$. Рассмотрим первый момент в двух процессах добавления рёбер, когда мы добавили разные рёбра. Перед этим моментом графы были одинаковы - пусть это был граф $G_{0}$. Пусть в процессе получения графа $G_{1}$ мы добавили ребро $a_{1} b_{1}$, а в процессе получения графа $G_{2}$ мы добавили ребро $a_{2} b_{2}$. Тогда
$a_{1} b_{1}, a_{2} b_{2} \notin E\left(G_{0}\right), \quad d_{G_{0}}\left(a_{1}\right)+d_{G_{0}}\left(b_{1}\right) \geq v(G), \quad d_{G_{0}}\left(a_{2}\right)+d_{G_{0}}\left(b_{2}\right) \geq v(G)$.
Следовательно, оба ребра $a_{1} b_{1}$ и $a_{2} b_{2}$ будут добавлены в каждом из двух процессов построения замыкания. Тогда ничто не мешает добавить оба ребра одновременно в каждом из двух процессов и перейти к рассмотрению следующего различия в них. В итоге мы получим, что в обоих процессах построения замыкания добавлены одни и те же рёбра.

Непосредственно из леммы 3.2 следует достаточно интересный результат:

Следствие 3.2. (V. Chvatal, 1974.) Граф $G$ гамильтонов, если и только если его замыкание $C(G)$ - гамильтонов граф.

Найти гамильтонов цикл в замыкании обычно гораздо проще, чем в исходном графе.

# 3.1.3 Связность и гамильтоновы циклы 

Лемма 3.4. Пусть граф $G$ гамильтонов. Тогда для любого множества $S \subset V(G)$ выполняется неравенство $c(G-S) \leq|S|$.

Доказательство. Пусть $c(G-S)=c, U_{1}, \ldots, U_{c}$ - компоненты связности графа $G-S$, а $Z$ - гамильтонов цикл графа $G$. Начнём обходить цикл $Z$, начиная с вершины множества $S$. Пусть $s_{i}$ - вершина, предшествующая первому входу цикла $Z$ в компоненту связности $U_{i}$. Понятно, что $s_{i} \in S$ и все вершины $s_{1}, \ldots, s_{c}$ различны, откуда немедленно следует требуемое неравенство.

Любопытно внешнее сходство с условием Татта о совершенном паросочетании (см. главу Паросочетания, теорема 2.6): наличие совершенного паросочетания в графе $G$ эквивалентно условию о том, что количество нечётных компонент связности графа $G-S$ не превосходит $|S|$ для любого множества $S \subset V(G)$. Однако, аналогичного критерия существования гамильтонова цикла нет.

Следующая теорема даёт критерий гамильтоновости графа на языке его вершинной связности. Подробнее о связности написано в соответствующей главе, пока же нам потребуются только определения, которые содержатся во введении.

Теорема 3.2. Пусть $v(G) \geq 3 u \kappa(G) \geq \alpha(G)$. Тогда в графе $G$ существует гамильтонов иикл.

Доказательство. Очевидно, в графе $G$ есть циклы, так как в противном случае $\kappa(G)=1$ и $\alpha(G) \geq 2$, что невозможно. Пусть $\kappa(G)=k$. Выберем цикл максимальной длины $C$ в графе $G$, пусть $C=v_{1} v_{2} \ldots v_{n}$ (нумерация вершин - циклическая).

Предположим, что цикл $C$ не гамильтонов и рассмотрим компоненту связности $W$ графа $G-V(C)$. Тогда $\mathrm{N}_{G}(W) \subset V(C)$. Предположим, что $v_{i}, v_{i+1} \in \mathrm{~N}_{G}(W)$, пусть $w, w^{\prime} \in W, v_{i} w, v_{i+1} w^{\prime} \in E(G)$ (возможно, вершины $w$ и $w^{\prime}$ совпадают), а $P-w w^{\prime}$-путь по вершинам компоненты связности $W$. Тогда цикл $C$ можно удлинить, заменив ребро $v_{i} v_{i+1}$ на ребро $v_{i} w$, путь $P$ и ребро $w^{\prime} v_{i+1}$ (см. рисунок 3.2 a ). Противоречие с максимальностью цикла $C$.

a

b

Рис. 3.2: Цикл $C$ и компонента связности $W$.
Пусть $M=\left\{v_{i+1}: v_{i} \in \mathrm{~N}_{G}(W)\right\}$. Как показано выше, $M \cap \mathrm{~N}_{G}(W)=\varnothing$. В частности это означает, что $\mathrm{N}_{G}(W)$ отделяет непустое множество $M$ от $W$, следовательно, $|M|=\left|\mathrm{N}_{G}(W)\right| \geq k$.

Предположим, что вершины $v_{i+1}, v_{j+1} \in M$ смежны. Пусть $w, w^{\prime} \in W$, $v_{i} w, v_{j} w^{\prime} \in E(G)$ (возможно, вершины $w$ и $w^{\prime}$ совпадают), а $P-w w^{\prime}$-путь по вершинам компоненты связности $W$. Рассмотрим цикл $Z$, проходящий

сначала участок $v_{j+1} v_{j+2} \ldots v_{i}$ цикла $C$, затем ребро $v_{i} w$, путь $P$ и ребро $w^{\prime} v_{j}$, потом участок $v_{j} v_{j-1} \ldots v_{i+1}$ цикла $C$ и, наконец, ребро $v_{i+1} v_{j+1}$ (см. рисунок 3.2 b ). Очевидно, $|Z|>|C|$, что противоречит максимальности цикла $C$.

Из доказанного следует, что множество $M \cup\{w\}$ - независимое, но в нём $|M|+1>k$ вершин, что противоречит условию $\alpha(G) \leq k$. Таким образом, цикл $C$ - гамильтонов.

# 3.1.4 Гамильтоновы последовательности 

Определение 3.2. 1) Пусть $a_{1} \leq a_{2} \leq \cdots \leq a_{n}$ и $b_{1} \leq b_{2} \leq \cdots \leq b_{n}-$ две упорядоченные последовательности. Будем говорить, что последовательность $\left\{a_{i}\right\}_{i \in[1 . . n]}$ мажорирует последовательность $\left\{b_{i}\right\}_{i \in[1 . . n]}$, если $a_{i} \geq b_{i}$ для всех $i \in[1 . . n]$.
1) Пусть $G$ - граф на $n$ вершинах. Степенной последовательностью графа $G$ назовём упорядоченную последовательность степеней его вершин $d_{1} \leq d_{2} \leq \cdots \leq d_{n}$.
2) Будем говорить, что граф $G$ мажорирует граф $H$, если степенная последовательность графа $G$ мажорирует степенную последовательность графа $H$.
3) Последовательность $a_{1} \leq a_{2} \leq \cdots \leq a_{n}$ называется гамильтоновой, если $a_{n} \leq n-1$ и любой граф на $n$ вершинах, степенная последовательность которого мажорирует $a_{1}, \ldots, a_{n}$, имеет гамильтонов цикл.

Теорема 3.3. (V. Chvatal, 1972.) Пусть $0 \leq a_{1} \leq a_{2} \leq \cdots \leq a_{n} \leq n-1$, $n \geq 3$. Следующие два утверждения равносильны.
$1^{\circ}$ Последовательность $a_{1}, \ldots, a_{n}$ гамильтонова.
$2^{\circ}$ Для каждого $h<\frac{n}{2}$ из $a_{h} \leq h$ следует $a_{n-h} \geq n-h$.
Доказательство. $2^{\circ} \Rightarrow 1^{\circ}$. Предположим, что наша последовательность негамильтонова и рассмотрим негамильтонов граф $G$ на $n$ вершинах с максимальным числом рёбер, степенная последовательность

$$
d_{1} \leq d_{2} \leq \cdots \leq d_{n}
$$

которого мажорирует $a_{1}, \ldots, a_{n}$. В силу леммы 3.2 понятно, что граф $G$ совпадает со своим замыканием, то есть, сумма степеней любых двух несмежных вершин графа $G$ менее $n$.

Понятно, что граф $G$ - не полный. Рассмотрим две несмежные вершины $x, y \in V(G)$ с наибольшим $d_{G}(x)+d_{G}(y)$. Будем считать, что $d_{G}(x) \leq d_{G}(y)$. Как уже отмечалось, $d_{G}(x)+d_{G}(y)<n$, поэтому $d_{G}(x)=h<\frac{n}{2}, d_{G}(y) \leq n-1-h$.

Пусть $W_{x}$ - множество всех вершин графа $G$, отличных от $x$ и не смежных с $x$, а $W_{y}$ - множество всех вершин графа $G$, отличных от $y$ и не смежных с $y$. Понятно, что

$$
\left|W_{x}\right|=n-1-d_{G}(x)=n-1-h, \quad\left|W_{y}\right|=n-1-d_{G}(y) \geq d_{G}(x)=h
$$

По выбору вершин $x$ и $y$ степени всех вершин множества $W_{y}$ (а их хотя бы $h$ ) не превосходят $d_{G}(x)=h$, поэтому $a_{h} \leq d_{h} \leq h$. Степени всех $n-h$ вершин множества $W_{x} \cup\{x\}$ не превосходят $d_{G}(y) \leq n-1-h$, поэтому $a_{n-h} \leq d_{n-h} \leq n-h-1$. Противоречие с условием $2^{\circ}$ показывает, что на самом деле последовательность $a_{1}, \ldots, a_{n}$ гамильтонова.


Рис. 3.3: Граф $G_{n, h}$.
$1^{\circ} \Rightarrow 2^{\circ}$. Пусть $h<\frac{n}{2}, d_{h} \leq h$ и $d_{n-h} \leq n-h-1$. Построим негамильтонов граф $G_{n, h}$, степенная последовательность которого мажорирует $a_{1}, \ldots, a_{n}$. Пусть $A=\left\{v_{1}, \ldots, v_{h}\right\}, B=\left\{v_{n-h+1}, \ldots, v_{n}\right\}, D=$ $\left\{v_{h+1}, \ldots, v_{n-h}\right\}$. Наш граф является объединением полного двудольного графа $K_{h, h}$ с долями $A$ и $B$ и полного графа $K_{n-h}$ на вершинах множества $B \cup D$ (см. рисунок 3.3). Таким образом,

$$
\begin{gathered}
d_{G_{n, h}}\left(v_{1}\right)=\cdots=d_{G_{n, h}}\left(v_{h}\right)=h, \quad d_{G_{n, h}}\left(v_{h+1}\right)=\cdots=d_{G_{n, h}}\left(v_{n-h}\right)=n-h-1 \\
d_{G_{n, h}}\left(v_{n-h+1}\right)=\cdots=d_{G_{n, h}}\left(v_{n}\right)=n-1
\end{gathered}
$$

Легко видеть, что степенная последовательность графа $G_{n, h}$ мажорирует $a_{1}, \ldots, a_{n}$. Отметим, что $c\left(G_{n, h}-B\right)=h+1$ (эти компоненты связности множество $D$ и $h$ попарно несмежных вершин множества $A$ ). Таким обра30м,
$c\left(G_{n, h}-B\right)>h=|B|$ и по лемме 3.4 граф $G_{n, h}$ не является гамильтоновым.

Следствие 3.3. Любой негамильтонов граф $G$ на $n$ вершинах мажорируется графом $G_{n, h}$ для некоторого $h<\frac{n}{2}$.
Доказательство. Пусть $G$ имеет степенную последовательность $d_{1}, \ldots, d_{n}$. По теореме 3.3 , существует такое $h<\frac{n}{2}$, что $d_{h} \leq h$ и $d_{n-h}<n-h$. Тогда легко видеть, что граф $G$ мажорируется графом $G_{n, h}$.

Применим разработанную технику для гамильтоновых путей.
Теорема 3.4. Пусть $0 \leq a_{1} \leq a_{2} \leq \cdots \leq a_{n} \leq n-1, n \geq 3$. Следующие два утверждения равносильны.
$1^{\circ}$ Любой граф $G$, степенная последовательность которого мажорирует $a_{1}, \ldots, a_{n}$, имеет гамильтонов путь.
$2^{\circ}$ Для каждого $h \leq \frac{n}{2}$ из $a_{h} \leq h-1$ следует $a_{n+1-h} \geq n-h$.
Доказательство. Для любого графа $G$ обозначим через $G^{*}$ граф, полученный из $G$ добавлением новой вершины $w$, смежной со всеми вершинами из $V(G)$. Нетрудно понять, что граф $G$ имеет гамильтонов путь тогда и только тогда, когда $G^{*}$ имеет гамильтонов цикл.

Пусть степенная последовательность графа $G$ на $n$ вершинах - это $d_{1} \leq \cdots \leq d_{n}$, тогда степенная последовательность графа $G^{*}$ - это $d_{1}+1 \leq \cdots \leq d_{n}+1 \leq n$. Очевидно, последовательность $d_{1}, \ldots, d_{n}$ мажорирует $a_{1}, \ldots, a_{n}$ тогда и только тогда, когда $d_{1}+1, \ldots, d_{n}+1, n$ мажорирует $a_{1}+1, \ldots, a_{n}+1, n$.

Отметим, что последовательность $a_{1}, \ldots, a_{n}$ удовлетворяет условию $2^{\circ}$ нашей теоремы тогда и только тогда, когда последовательность $a_{1}+1, \ldots, a_{n}+1, n$ удовлетворяет условию $2^{\circ}$ теоремы 3.3.
$2^{\circ} \Rightarrow 1^{\circ}$. Пусть степенная последовательность графа $G$ мажорирует $a_{1}, \ldots, a_{n}$. Тогда степенная последовательность графа $G^{*}$ мажорирует $a_{1}+1, \ldots, a_{n}+1, n$ и по теореме 3.3 граф $G^{*}$ - гамильтонов, а значит, в графе $G$ есть гамильтонов путь.
$1^{\circ} \Rightarrow 2^{\circ}$. Предположим противное: пусть существует такое $h \leq \frac{n}{2}$, что $a_{h} \leq h-1$ и $a_{n+1-h} \leq n-h-1$. Тогда $a_{h}+1 \leq h$ и $a_{n+1-h}+1 \leq n-h$, а значит, степенная последовательность негамильтонова графа $G_{n+1, h}$ мажорирует $a_{1}+1, \ldots, a_{n}+1, n$. Отметим, что в графе $G_{n+1, h}$ есть вершина $w$ степени $n$, пусть $H_{n, h}=G_{n+1, h}-w$. Тогда $H_{n, h}^{*}=G_{n+1, h}$, а значит, граф $H_{n, h}$ не имеет гамильтонова пути и его степенная последовательность мажорирует $a_{1}, \ldots, a_{n}$. Противоречие.

# 3.1.5 Гамильтонов цикл в степени графа 

Определение 3.3. Для графа $G$ и натурального числа $d$ обозначим через $G^{d}$ граф на вершинах из $V(G)$, в котором вершины $x$ и $y$ смежны тогда и только тогда, когда $\operatorname{dist}_{G}(x, y) \leq d$.

Сначала мы докажем совсем несложный факт о наличии гамильтонова цикла в кубе любого связного графа на не менее, чем трех вершинах. Потом мы докажем гораздо более сложную теорему: для любого двусвязного графа $G$ в графе $G^{2}$ есть гамильтонов цикл.

# Гамильтонов цикл в кубе графа 

Теорема 3.5. (G. Chartrand, S. F. Kapoor, 1969.) Для любого связного графа $G$ с $v(G) \geq 3$ и ребра $e \in E(G)$ в графе $G^{3}$ существует гамильтонов цикл, содержащий ребро $e$.

Доказательство. Разумеется, достаточно доказать теорему для случая, когда $G$ - дерево (иначе выделим остовное дерево, содержащее ребро $e$ ). Мы докажем утверждение индукцией по количеству вершин. База для дерева на трех или четырех вершинах очевидна.

Предположим, что для всех деревьев, имеющих меньше чем $G$ вершин, теорема уже доказана. Пусть $e=u v$, тогда в графе $G-u v$ две компоненты связности $U \ni u$ и $V \ni v$. Пусть $G_{u}=G(U)$ и $G_{v}=G(V)$. Не умаляя общности можно считать, что $|U| \geq 3$. По индукционному предположению построим гамильтонов цикл в графе $G_{u}^{3}$, содержащий инцидентное $u$ ребро $u x \in E(G)$.

Если $|V| \geq 3$, то аналогично мы построим гамильтонов цикл в графе $G_{v}^{3}$, содержащий инцидентное вершине $v$ ребро $v y \in E(G)$. Соединим эти два цикла в один, заменив рёбра $u x$ и $v y$ на $u v$ и $x y$, как изображено на рисунке 3.4 a (отметим, что $\operatorname{dist}_{G}(x, y)=3$, поэтому, $x y \in E\left(G^{3}\right)$ ).


Рис. 3.4: Гамильтонов цикл в кубе графа
Остаются очевидные случаи, когда $|V|<3$. При $V=\{v\}$ мы заменим в гамильтоновом цикле графа $G_{u}^{3}$ ребро $u x$ на $u v$ и $v x$ (см. рисунок 3.4 b ). При $V=\{v, y\}$, очевидно, $v y \in E(G)$ и мы заменим в гамильтоновом цикле графа $G_{u}^{3}$ ребро $u x$ на $u v, v y$ и $y x$ (см. рисунок 3.4 c ).

## Гамильтонов цикл в квадрате графа

Мы докажем, что для любого двусвязного графа $G$ в графе $G^{2}$ есть гамильтонов цикл. Начнём доказательство с двух несложных лемм.

Лемма 3.5. Пусть $G$ - двусвязный граф, $x \in V(G)$. Тогда в графе $G$ существует вершина $y \neq x$ и цикл $C$, для которого $x, y \in V(C)$ и $\mathrm{N}_{G}(y) \subset V(C)$.

Доказательство. Если граф $G$ гамильтонов, лемма очевидна. Пусть в $G$ нет гамильтонова цикла. Из двусвязности следует, что в графе $G$ есть цикл, проходящий через $x$. Выберем такой цикл $Z$, что одна из компонент связности $U$ графа $G-Z$ - наименьшая для всех проходящих по $x$ циклов. Очевидно, $\mathrm{N}_{G}(U) \subset V(Z)$, из двусвязности графа $G$ следует, что $\left|\mathrm{N}_{G}(U)\right| \geq 2$. Тогда выберем $u_{1}, u_{2} \in \mathrm{~N}_{G}(U)$ так, что для одной из дуг $L$ цикла $Z$ с концами $u_{1}$ и $u_{2}$ выполняются условия $x \notin \operatorname{Int}(L)$ и $\mathrm{N}_{G}(U) \cap \operatorname{Int}(L)=\varnothing$ (см. рисунок 3.5 ).


Рис. 3.5: Цикл $Z$ и компонента связности $U$.
Заменим дугу $L$ на $u_{1} u_{2}$-путь, проходящий по $U$. Мы получили цикл $Z^{\prime}$, проходящий по $x$ и вершине $y \in U$. Если $\mathrm{N}_{G}(y) \not \subset V\left(Z^{\prime}\right)$, то существует вершина $y^{\prime} \in \mathrm{N}_{G}(y) \backslash V\left(Z^{\prime}\right)$. Рассмотрим компоненту связности $U^{\prime} \ni y^{\prime}$ графа $G-Z^{\prime}$. Так как вершины из $\operatorname{Int}(L)$ не смежны с вершинами из $U$, то $U^{\prime} \subsetneq U$ и, следовательно, $\left|U^{\prime}\right|<|U|$, что противоречит выбору цикла $Z$ и компоненты связности $U$.

Лемма 3.6. Пусть $H$ - регулярный граф степени 3 с гамильтоновым циклом $C$ (в графе допускаются кратные рёбра). Пусть е $\in E(C)$ и $f \in E(H) \backslash E(C)$ - рёбра с общим концом $v$. Тогда существует замкнутый маршрут $Z$, удовлетворяющий следуюшим условиям.
$1^{\circ} Z$ проходит по каждому ребру из $E(H) \backslash E(C)$ и по ребру е ровно один раз, а по остальным рёбрам цикла $C$ - один или два раза. Рёбра цикла $C$, по которым маршрут $Z$ проходит два раза, не имеют общих концов.
$2^{\circ} Z$ проходит последовательно рёбра е и $f$.


Рис. 3.6: Графы $H$ и $H^{\prime}$.

Доказательство. Очевидно, $v(G)$ четно и поэтому цикл $C$ четен. Покрасим в цвета 1 и 2 ребра цикла $C$ через одно. Пусть ребро $e$ имеет цвет 1 , тогда удвоим все рёбра цвета 2 (для каждого из них добавим кратное ребро). В полученном графе $H^{\prime}$ (см. рисунок 3.6) степени всех вершин равны 4. Наконец, разобьём вершину $v$ на вершину $v_{1}$, инцидентную рёбрам $e$ и $f$ и вершину $v_{2}$, инцидентную остальным двум рёбрам вершины $v$. Граф $H^{\prime}$, очевидно, связен, степени всех его вершин чётны и потому в $H^{\prime}$ существует эйлеров цикл $Z$, который и является искомым замкнутым маршрутом в графе $H$.

Теорема 3.6. (H. Fleischner, 1974.) Для любого двусвязного графа $G$ в графе $G^{2}$ есть гамильтонов иикл.

Доказательство. Мы будем доказывать индукцией по количеству вершин более сильное утверждение.
Для любого двусвязного графа $G$ и любой вершины $a \in V(G)$ в графе $G^{2}$ есть гамильтонов иикл, в котором оба иниидентных вериине а ребра принадлежат $E(G)$.

База для графа из трёх вершин очевидна. Пусть $v(G) \geq 4$ и для всех меньших графов утверждение доказано. Зафиксируем вершину $a \in V(G)$. По лемме 3.5 существует отличная от $a$ вершина $b \in V(G)$ и цикл $C$, для которого $a, b \in V(C)$ и $\mathrm{N}_{G}(b) \subset V(C)$. Если $C$ - гамильтонов цикл, то утверждение доказано. Далее рассматриваем случай, когда цикл $C$ не гамильтонов.

# 1. Построение множества $\mathcal{P}$. 

Рассмотрим компоненту связности $U$ графа $G-C$. Если $U=\{u\}$, то пусть $\mathcal{P}(U)=\{u\}$. Пусть $|U| \geq 2$. Построим вспомогательный граф $G_{U}$, стянув все вершины из $V(G) \backslash U$ в одну вершину $a^{*}$.

Пусть $x$ - точка сочленения графа $G_{U}$. Понятно, что $x \neq a^{*}$. Пусть $Y$ - компонента связности графа $G_{U}-x$, не содержащая $a^{*}$. Тогда ни одна из вершин $Y$, очевидно, не смежна с циклом $C$ в графе $G$, а следовательно, граф $G-x$ несвязен, что невозможно. Таким образом, граф $G_{U}$ двусвязен.

Мы будем рассматривать рёбра графа $G_{U}$, как подмножество $E(G)$ (каждое ребро $e^{\prime} \in E\left(G_{U}\right)$ отождествим с одним из рёбер $e \in E(G)$, переходящих в $e^{\prime}$ при стягивании вершин).

По индукционному предположению, в графе $G_{U}^{2}$ есть гамильтонов цикл $C_{U}$, в котором оба инцидентных $a^{*}$ ребра принадлежат $E\left(G_{U}\right)$. Отметим, что в графе $G_{U}^{2}$ могут быть рёбра, не входящие в $E\left(G^{2}\right)$ : это рёбра, соединяющие пары вершин, смежных в графе $G_{U}$ с вершиной $a^{*}$.

Обозначим множество таких рёбер через $E^{*}$. Удалим из цикла $C_{U}$ вершину $a^{*}$ и все рёбра из $E^{*}$, в результате чего цикл распадётся на несколько путей (см. рисунок 3.7a). Пусть $\mathcal{P}(U)$ - множество этих путей (возможно, среди них есть пути из одной вершины). Отметим, что пути из $\mathcal{P}(U)$ покрывают все вершины компоненты связности $U$, для каждого пути $P \in \mathcal{P}(U)$ оба его конца смежны с $a^{*}$, а $E(P) \subset E\left(G^{2}\right)$.


Рис. 3.7: Пути множества $\mathcal{P}$.
Построим множество путей $\mathcal{P}(U)$ для всех компонент связности графа $G-C$, пусть $\mathcal{P}$ - объединение всех этих множеств путей. Отметим, что $\mathcal{P}$ - множество попарно непересекающихся путей в графе $G^{2}$, удовлетворяющее следующим свойствам.
$(P 1) V(G) \backslash V(C)=\cup_{P \in \mathcal{P}} V(P)$.
$(P 2)$ Пусть $x$ - конеи пути $P \in \mathcal{P}$. Тогда существует вершина $y \in V(C)$, смежная с $x$.

Докажем свойство ( $P 2$ ). Пусть $P \in \mathcal{P}(U)$. По построению, вершина $x$ смежна в графе $G_{U}$ с вершиной $a^{*}$. Это означает существование ребра $x y \in E(G)$, где $y \notin U$. Так как $U-$ компонента связности графа $G-C$, мы имеем $y \in V(C)$.

Вершину $y$ мы назовём основанием пути $P$ в вершине $x$. Возможно, такая вершина $y$ не единственна, для определённости в каждом случае мы выберем в качестве основания ровно одну вершину. Если путь $P \in \mathcal{P}$ имеет более одной вершины, то у него есть по основанию в каждом конце, однако, эти основания могут совпадать. Пусть $\mathcal{P}_{1}$ - множество всех путей из $\mathcal{P}$ с одним основанием, а $\mathcal{P}_{2}$ - множество всех путей из $\mathcal{P}$ с двумя основаниями.

Подправим множество $\mathcal{P}$ так, чтобы кроме $(P 1)$ и $(P 2)$ выполнялось еще одно условие.
$(P 3)$ Никакая вершина цикла $C$ не является основанием двух путей из $\mathcal{P}$.

Пусть это условие не выполняется и вершина $y \in V(C)$ является общим основанием пути $P_{1}$ в вершине $x_{1}$ и пути $P_{2}$ в вершине $x_{2}$. Тогда $x_{1} x_{2} \in E\left(G^{2}\right)$ и мы можем соединить пути $P_{1}$ и $P_{2}$ в один путь (см. рисунок 3.7 b ). Будем выполнять такие операции до тех пор, пока не выполнится условие $(P 3)$.

Далее мы не будем менять пути из $\mathcal{P}$. Более того, каждый из этих путей будет дугой гамильтонова цикла графа $G^{2}$, который мы построим.
1. Включение в иикл путей из $\mathcal{P}_{2}$.

Пусть $G_{1}=G-\cup_{P \in \mathcal{P}_{1}} V(P)$. Мы хотим построить из цикла $C$ гамильтонов цикл $Z$ графа $G_{1}^{2}$. В случае $\mathcal{P}_{2}=\varnothing$, очевидно, подойдёт $Z=C$. Далее будем считать, что $\left|\mathcal{P}_{2}\right|=p \neq 0$.

Введём циклическую нумерацию вершин цикла $C=v_{1} v_{2} \ldots v_{k}$. Для каждой дуги $Q=v_{i} v_{i+1} \ldots v_{j}$ нашего цикла назовём $v_{i}$ её левым концом и обозначим через $\ell(Q)$, а $v_{j}-$ правым концом и обозначим через $r(Q)$.

Пусть $W$ - множество всех оснований всех путей из $\mathcal{P}_{2}$. В силу ( $P 3$ ) мы имеем $|W|=2\left|\mathcal{P}_{2}\right|=2 p$. Отметим на цикле $C$ все вершины множества $W$, они разбивают $C$ на $2 p$ дуг (не содержащих внутри вершин из $W$ ). Пусть $\mathcal{W}$ - множество всех этих дуг. Очевидно, ровно одна дуга $I \in \mathcal{W}$ такова, что $a \in \operatorname{Int}(I)$ или $a=r(I)$. Пусть $w=r(I)$, а $P \in \mathcal{P}_{2}$ - единственный путь с основанием $w$ (см. рисунок 3.8 a ). Для каждой дуги $Q \in \mathcal{W}$ обозначим через $Q^{\ell}$ и $Q^{r}$ соседние слева и справа соответственно дуги. Таким образом, $\ell(Q)=r\left(Q^{\ell}\right)$ и $r(Q)=\ell\left(Q^{r}\right)$.

Построим вспомогательный кубический граф $H$ на вершинах множества $W$, соединив ребром вершины $x, y \in W$ тогда и только тогда, когда $x$ и $y$ - основания одного пути из $\mathcal{P}_{2}$ или $x$ и $y$ - концы дуги из $\mathcal{W}$. Будем обозначать рёбра графа $H$ так же, как соответствующие им пути и дуги. Получился кубический граф. Применим лемму 3.6 к графу $H$, рёбрам $I$ и $P$ (имеющим общую вершину $w$ ). В результате получится замкнутый маршрут $Z^{\prime}$, удовлетворяющий условиям $1^{\circ}$ и $2^{\circ}$ леммы 3.6.

В качестве первого приближения мы построим замкнутый маршрут $Z$ в графе $G_{1}$, проходя в порядке $Z^{\prime}$ пути и дуги, соответствующие рёбрам $Z^{\prime}$. В силу леммы 3.6 , любая дуга $Q \in \mathcal{W}$ принадлежит одному из трёх типов.

Tun 1. $Z$ проходит $Q$ один раз.
Tun 2. $Z$ проходит $Q$ два раза: от одного конца к другому, разворачивается и сразу же идёт в обратном направлении. Конец дуги $Q$, в котором происходит разворот, назовём мёртвым.

Tun 3. $Z$ проходит $Q$ два раза, но не подряд.
Дуга $I$, очевидно, принадлежит типу 1 , а соседняя справа дуга $I^{r}$ типу 2. По лемме 3.6, одна из двух соседних дуг всегда принадлежит ти-

пу 1. Мы изменим маршрут $Z$ на дугах типов 2 и 3 так, чтобы получился гамильтонов цикл в графе $G_{1}$. Будем рассматривать дуги типов 2 и 3 в порядке их обхода маршрутом $Z^{\prime}$.

a

b


C

Рис. 3.8: Построение цикла $Z$ : дуга типа 2.
2.1. Дуга $Q$ принадлежит типу 2.

Не умаляя общности предположим, что $r(Q)$ - мёртвый конец дуги $Q$. Пусть $x_{1}=\ell(Q)$, далее занумеруем вершины дуги $Q$ по порядку до $x_{n}$ - вершины, предшествующей мёртвому правому концу $r(Q)$ (возможно, $n=1$ ). Через $x_{0}$ обозначим конец пути $P^{\ell} \in \mathcal{P}_{2}$, чьим основанием является $x_{1}=\ell(Q)$. Тогда маршрут $Z$ проходит от $x_{0}$ к $x_{1}$, далее до $x_{n}$, затем в $r(Q)$, где разворачивается и идёт обратно в $x_{1}$, затем на соседнюю слева с $Q$ дугу $Q^{\ell}$, которая принадлежит типу 1 (мысленно введём на $Z$ именно такое направление, см. рисунок 3.8 b ).

Мы изменим маршрут на участке $x_{0} x_{1} \ldots x_{n} r(Q)$. Наш маршрут не будет проходить ребро $x_{n} r(Q)$ (ведь вершину $r(Q)$ он проходит еще раз!). Включим в маршрут ребро $x_{n-1} x_{n}$. В зависимости от четности $n$, от одной из вершин $x_{n}$ и $x_{n-1}$ можно добраться до $x_{1}$, а от другой - до $x_{0}$, проходя по рёбрам вида $x_{k} x_{k-2}$, такие рёбра входят в $G_{1}^{2}$ (на рисунке 3.8 c изображены оба случая - четного и нечетного $n$ ). В результате мы построили новый участок маршрута, который идёт от $x_{0}$ до $x_{1}$, проходя все вершины $x_{0}, x_{1}, \ldots, x_{n}$ ровно по одному разу. В остальном маршрут $Z$ не изменится: до вершины $x_{0}$ он пойдёт по пути $P^{\ell}$, а после $x_{1}$ - по дуге $Q^{\ell}$ (которую проходил один раз).

Последовательно выполним такие операции для всех дуг типа 2. Отметим, что маршрут $Z$ не изменится на всех дугах типа 1 и типа 3 , а также на всех путях из $\mathcal{P}_{2}$.
2.2. Дуга $Q$ принадлежит типу 3.

Пронумеруем вершины дуги $Q: x_{1}=\ell(Q), x_{2}, \ldots, x_{n}=r(Q)$. В рассматриваемом случае $n \geq 2$. Пусть $P^{\ell}, P^{r} \in \mathcal{P}_{2}$ - пути, основаниями которых являются $x_{1}=\ell(Q)$ и $x_{n}=r(Q)$, соответственно (см. рисунок 3.9 a ).

Через $x_{0}$ мы обозначим либо конец пути из $P^{\ell}$, чьим основанием является $x_{1}$, либо лежащую на дуге $Q^{\ell}$ соседнюю слева с $x_{1}$ вершину цикла $C$. Мы выберем один из этих двух вариантов позже. Через $x_{n+1}$ обозначим конец пути $P^{r}$, чьим основанием является $x_{n}$.


Рис. 3.9: Построение цикла $Z$ : дуга типа 3.
Теперь подумаем, каким образом маршрут $Z$ дважды проходит дугу $Q$. Так как соседние с $Q$ дуги $Q^{\ell}$ и $Q^{r}$, а также пути $P^{\ell}$ и $P^{r}$ маршрут $Z$ проходит по одному разу, в нем либо должны быть участки $Q^{\ell} Q Q^{r}$ и $P^{\ell} Q P^{r}$, либо должны быть участки $Q^{\ell} Q P^{r}$ и $P^{\ell} Q Q^{r}$ (направление прохода этих участков нас не интересует). В любом из вариантов ясно, какие концы должна соединять пара путей, которые мы строим.

В любом случае, мы соединим $x_{n}$ с вершиной дуги $Q^{r}$, соседней в цикле $C$ с $x_{n}=r(Q)$. Мы соединим пару вершин $x_{0}, x_{1}$ с $x_{n}, x_{n+1}$ двумя непересекающимися путями в $G_{1}^{2}$, проходящими все вершины $x_{2}, \ldots, x_{n-1}$ ровно по одному разу. Это сделать несложно: для всех $i \in[1 . . n]$ мы проведём рёбра $x_{i-1} x_{i+1} \in E\left(G_{1}^{2}\right)$. Какие концы в итоге соединятся, зависит от четности $n$.

Выберем $x_{0}$ из двух предложенных вариантов так, чтобы путь $P^{r}$ был соединён в перестроенном маршруте $Z$ именно с тем из $Q^{\ell}$ и $P^{\ell}$, с кем нужно. Все четыре варианта соединения концов показаны: на рисунке 3.9 b - варианты, в которых мы выбираем в качестве $x_{0}$ конец пути $P^{\ell}$, а на рисунке 3.9 c - варианты, в которых мы выбираем в качестве $x_{0}$ соседнюю слева с $x_{1}$ вершину цикла $C$. Таким образом, при любой четности $\ell$ мы можем провести в $G^{2}$ как два непересекающихся пути $Q^{\ell} Q Q^{r}$ и $P^{\ell} Q P^{r}$, так и два непересекающихся пути $Q^{\ell} Q P^{r}$ и $P^{\ell} Q P^{r}$ В результате получится новый замкнутый маршрут $Z$, который за два раза пройдёт все вершины дуги $Q$ по одному разу.

Последовательно выполним такие операции для всех дуг типа 3. В результате маршрут $Z$ станет гамильтоновым циклом графа $G_{1}^{2}$. Отметим, что маршрут $Z$ не изменится на всех путях из $\mathcal{P}_{2}$. На любой дуге $J$ типа 1 цикл $Z$ по-прежнему проходит все рёбра, кроме, возможно, самого правого ребра. Самое правое ребро дуги $J$ цикл $Z$ может не проходить

только в том случае, когда соседняя справа дуга $J^{r}$ принадлежит типу 3. Поскольку $I^{r}$ принадлежит типу 2 , то цикл $Z$ проходит все рёбра дуги $I$.

В случае $a \in \operatorname{Int}(I)$ оба выходящих из $a$ ребра цикла $Z$ - это рёбра цикла $C$, которые принадлежат $E(G)$. Если же $a=r(I)=w$, то $w-$ мёртвый конец дуги $I^{r}$ типа 2 , поэтому цикл $Z$ содержит два инцидентных вершине $a=w$ ребра графа $G$ : ребро дуги $I$ и ребро, соединяющее $a$ с концом пути $P$.
1. Включение в цикл путей из $\mathcal{P}_{1}$.

Итак, мы имеем гамильтонов цикл $Z$ в графе $G_{1}^{2}$, в котором оба инцидентных $a$ ребра принадлежат графу $G$. Остаётся включить в него пути с одним основанием. Пусть $U-$ множество всех контактов путей из $\mathcal{P}_{1}$. Тогда в силу $(P 3)$ мы имеем $|U|=\left|\mathcal{P}_{1}\right|$, все вершины из $U-$ внутренние вершины дуг из $\mathcal{W}$.
3.1. Соответствие $u \rightarrow e(u)$.

Мы поставим в соответствие каждой вершине $u \in U$ ребро $e(u)$ цикла $Z$ так, чтобы соответствие было однозначным и выполнялось одно из двух условий.
$(E 1)$ Ребро $e(u) \in E(C)$ инцидентно и. При $u \neq a$, ребро $e(u)$ не инцидентно а.
$(E 2)$ Ребро $e(u)$ соединяет две соседние с и вершины цикла $C$.
Для простоты мы определим $e(u)$ на $V(C) \backslash W \supset U$. Построим соответствие отдельно на внутренности каждой дуги $Q \in \mathcal{W}$.
3.1.1. $Q$ - дуга типа 3.

Тогда для каждой вершины $u \in \operatorname{Int}(Q)$ цикл $Z$ по построению содержит ребро, соединяющее две соседние с $u$ вершины цикла $C$. Именно это ребро и назовём $e(u)$. Очевидно, в этом случае выполняется условие (E2).
3.1.2. $Q$ - дуга типа 2.

Пусть $u^{\prime}$ - соседняя с мёртвым концом вершина дуги $Q$. Тогда для каждой отличной от $u^{\prime}$ вершины $u \in \operatorname{Int}(Q)$, в цикле $Z$ по построению есть ребро, соединяющее две соседние с $u$ вершины цикла $C$. Именно это ребро и назовём $e(u)$. Очевидно, в этом случае выполняется условие ( $E 2$ ).

Рассмотрим вершину $u^{\prime}$. Если $u^{\prime} \in U$, то $u^{\prime} \in \operatorname{Int}(Q)$. Тогда цикл $Z$ по построению содержит ребро дуги $Q$, соединяющее $u^{\prime}$ с соседней вершиной $x$ дуги $Q$, причём $x$ - не мёртвый конец $Q$, то есть, $x \neq a$. Тем самым, выполняется условие $(E 1)$.
3.1.3. $Q$ - дуга типа 1.

Вспомним, что единственная дуга, левым концом которой может быть $a$ - это $I^{r}$ и она принадлежит типу 2. Поэтому $a \neq \ell(Q)$. Рассмотрим два случая.

# 3.1.3.1. $a \notin \operatorname{Int}(Q)$. 

Тогда цикл $Z$ проходит все рёбра дуги $Q$, кроме, возможно, самого правого ребра. Мы каждой вершине $u \in \operatorname{Int}(Q)$ поставим в соответствие ребро $e(u)$, соединяющее $u$ с соседом слева. Очевидно, выполняется условие $(E 1)$.

### 3.1.3.2. $a \in \operatorname{Int}(Q)$.

Сюда же отнесём случай, когда $\mathcal{P}_{2}=\varnothing$. В этом случае мы вспомним про вершину $b \in V(C)$, у которой $\mathrm{N}_{G}(b) \subset V(C)$. Понятно, что $b \notin U$. Мы будем рассматривать цикл $C$, как дугу $Q$, обоими концами которой является $b$ (а все остальные вершины - внутренние). Поскольку $a \neq b$, то $a$ принадлежит внутренности этой дуги.

Пронумеруем вершины дуги слева направо: $x_{1}=\ell(Q), \ldots, x_{m}=a, \ldots$, $x_{n}=r(Q)$. Отметим, что $m>1$. Для всех $i \in[m . . n-1]$ мы положим $e\left(x_{i}\right)=x_{i} x_{i+1}$, а для всех $i \in[2 . . m-1]$ мы положим $e\left(x_{i}\right)=x_{i} x_{i-1}$. В таком случае вершина $a$ инцидентна только ребру $e\left(x_{m}\right)=e(a)$ и выполняется условие $(E 1)$.

Инвективность отображения $u \rightarrow e(u)$ достаточно проверить при $|U| \geq 2$. По построению, если для двух вершин $u, u^{\prime} \in U$ отображение $e$ удовлетворяет условию $(E 1)$, то $e(u) \neq e\left(u^{\prime}\right)$.

Пусть $e(u)$ удовлетворяет условию ( $E 2$ ). Это означает, что $u$ принадлежит внутренности дуги типа 2 или 3 , поэтому, $\mathcal{P}_{2} \neq \varnothing$. Опять вспомним про вершину $b$. Поскольку $\mathrm{N}_{G}(b) \subset V(C)$, то $b \notin W \cup U$, поэтому

$$
v(C) \geq 1+|U|+|W|=1+\left|\mathcal{P}_{1}\right|+2\left|\mathcal{P}_{2}\right| \geq 5
$$

Тогда ребро $e(u)$ не может удовлетворять условию ( $E 1$ ) или ( $E 2$ ) для отличной от $u$ вершины $u^{\prime} \in V(C)$ (в этих случаях длина цикла $C$ не превосходила бы 4). Таким образом, отображение $u \rightarrow e(u)$ инъективно.

## 3.2. Перестройка цикла.

По очереди мы рассмотрим все вершины $u \in U$ и для каждой из них изменим цикл $Z$, включив в него путь из $P=y_{1} \ldots y_{m} \in \mathcal{P}_{1}$ с основанием $u$. Разберём два случая: ребро $e(u)$ удовлетворяет условию ( $E 1$ ) или ( $E 2$ ).
3.2.1. Ребро $e(u)$ удовлетворяет условию ( $E 1$ ).

Пусть $e(u)=u v, v-$ соседняя с $u$ вершина цикла $C$. Тогда в графе $G^{2}$ есть ребро $y_{m} v$ (так как $y_{m}, v \in \mathrm{~N}_{G}(u)$ ). Заменим в цикле $Z$ ребро $u v$ на путь $u y_{1} \ldots y_{m} v$, вставив в цикл $Z$ путь $P$ (см. рисунок 3.10a). Отметим, что если $a$ инцидентно $u v$, то $a=u$ и после замены выходящие из $a=u$ ребра цикла $Z$ принадлежат графу $G$.
3.2.2. Ребро $e(u)$ удовлетворяет условию ( $E 2$ ).

Пусть $e(u)=v_{1} v_{2}$, где $v_{1}, v_{2} \in \mathrm{~N}_{G}(u)$ - соседние с $u$ вершины цикла $C$. Тогда в графе $G^{2}$ есть ребра $v_{1} y_{1}$ и $y_{m} v_{2}$ (так как $y_{1}, y_{m} \in \mathrm{~N}_{G}(u)$ ). Заменим



Рис. 3.10: Построение цикла $Z$ : путь из $\mathcal{P}_{1}$.

в цикле $Z$ ребро $v_{1} v_{2}$ на путь $v_{1} y_{1} \ldots y_{m} v_{2}$, вставив в цикл $Z$ путь $P$. В этом случае $a$ не может быть инцидентно $v_{1} v_{2}$.

В результате мы получили гамильтонов цикл $Z$ в графе $G^{2}$, в котором оба инцидентных вершине $a$ ребра принадлежат графу $G$.

# 3.2 Панциклические графы 

Определение 3.4. Граф называется панциклическим, если в нем есть циклы всех длин - от треугольника до гамильтонова цикла.

Теорема 3.7. (J. A. Bondy, 1971) Пусть $G$ - гамильтонов граф, $v(G)=n, e(G) \geq \frac{n^{2}}{4}$. Тогда либо $G$ - панциклический, либо $G=K_{\frac{n}{2}, \frac{n}{2}}$. В частности, при $e(G)>\frac{n^{2}}{4}$ граф $G-$ панциклический.

Доказательство. Будем вести доказательство индукцией по $n$. База для $n \leq 4$ очевидна. Рассмотрим несколько случаев.

1. В графе $G$ есть цикл $Z$ длиныь $n-1$.

Пусть $a$ - единственная не входящая в $Z$ вершина.
1a. $d_{G}(a) \leq \frac{n-1}{2}$.
Граф $G^{\prime}=G-a-$ гамильтонов,

$$
e\left(G^{\prime}\right)=e(G)-d_{G}(a) \geq \frac{n^{2}}{4}-\frac{n-1}{2}=\frac{n^{2}-2 n+2}{4}>\frac{(n-1)^{2}}{4}
$$

следовательно, по индукционному предположению в графе $G$ есть циклы всех длин от 3 до $n-1$.
1б. $d_{G}(a)>\frac{n-1}{2}$.

Пусть $Z=b_{1} b_{2} \ldots b_{n-1}$. Тогда для любого $r \in[1 . . n-4]$ существует пара вершин $b_{i}, b_{i+r}$, смежных с $a$. Легко видеть, что $b_{i} b_{i+1} \ldots b_{i+r} a-$ цикл длины $r+2$, то есть в графе $G$ есть циклы всех длин от 3 до $n-2$.

1. В графе $G$ нет цикла длины $n-1$.

Пусть $x_{1} x_{2} \ldots x_{n}$ - гамильтонов цикл в $G$. Рассмотрим пару соседних вершин $x_{k}, x_{k+1}$. Если $x_{k} x_{i}, x_{k+1} x_{i+2} \in E(G)$ для некоторого $i$, то в графе существует цикл длины $n-1$ :

$$
x_{k+1} x_{k+2} \ldots x_{i} x_{k} x_{k-1} \ldots x_{i+2}
$$

(см. рисунок 3.11a, этот цикл проходит по всем вершинам, кроме $x_{i+1}$ ), что противоречит предположению. Значит, из рёбер $x_{k} x_{i}, x_{k+1} x_{i+2}$ в графе $G$ есть не более, чем одно. Отсюда следует, что $d_{G}\left(x_{k}\right)+d_{G}\left(x_{k+1}\right) \leq n$ и $e(G) \leq \frac{n^{2}}{4}$.


Рис. 3.11: Цикл $Z$ и его хорды.
Тогда по условию $e(G)=\frac{n^{2}}{4}$, следовательно, $d_{G}\left(x_{k}\right)+d_{G}\left(x_{k+1}\right)=n$ для любого $k \in[1 . . n]$ и $n \vdots 2$. Но тогда для любого $k \in[1 . . n], i \in[1 . . n]$ из пары рёбер $x_{k} x_{i}, x_{k+1} x_{i+2}$ в графе $G$ есть ровно одно.

Если граф двудолен, то в нем не более $\frac{n^{2}}{4}$ рёбер и максимум достигается только для $K_{\frac{n}{2}, \frac{n}{2}}$, следовательно, граф $G$ и есть $K_{\frac{n}{2}, \frac{n}{2}}$.

Предположим, что граф $G$ недвудолен. Тогда можно выбрать минимальное четное $s$, для которого существует такое $i \in[1 . . n]$, что в графе $G$ есть ребро $x_{i} x_{i+s}$. Легко понять, что $s \geq 4$, так как при $s=2$ в графе очевидно есть цикл длины $n-1$. Тогда $x_{i-1} x_{i+s-2} \notin E(G)$, следовательно, $x_{i+1} x_{i+s-1} \in E(G)$, что противоречит выбору $s$ (см. рисунок 3.11 b ). Таким образом, предположение неверно и единственным непанциклическим графом с $e(G)=\frac{n^{2}}{4}$ является $G=K_{\frac{n}{2}, \frac{n}{2}}$.

# 3.3 Окружение графа 

Окружение графа - это длина его наибольшего простого цикла. Следующая теорема содержит оценку на окружение двусвязного графа и дополняет многочисленные результаты о гамильтоновых циклах.

Теорема 3.8. (N. Linial, 1975). Пусть $G$ - двусвязный граф, а

$$
m=\min _{x y \notin E(G)} d_{G}(x)+d_{G}(y)
$$

Тогда окружение графа $G$ не менее чем $\min (m, v(G))$.
Доказательство. Очевидно, достаточно рассмотреть случай $m \leq v(G)$ и в этом случае доказать существование в графе $G$ простого цикла длины не менее $m$. Пусть существует граф $G$, для которого это утверждение не выполняется, а $P=x_{1} \ldots x_{n}$ - наибольший путь в этом графе.

Предположим, что в графе $G$ есть цикл $Z$ длины не менее $n$. Если $n=v(G)$, то утверждение теоремы для графа $G$ выполняется. Значит, $n<v(G)$. Ввиду связности графа $G$ существует смежная с $Z$ вершина $x \in V(G) \backslash V(Z)$. Тогда вершина $x$ и вершины цикла $Z$ образуют путь из $n+1$ вершины, что противоречит максимальности $P$.

Далее пусть в графе $G$ нет цикла длины $n$. Очевидно, $\mathrm{N}_{G}\left(x_{1}\right) \subset V(P)$ и $\mathrm{N}_{G}\left(x_{n}\right) \subset V(P)$, иначе путь $P$ можно было бы легко удлинить. Отметим, что $d_{G}\left(x_{1}\right)+d_{G}\left(x_{n}\right) \geq m$. Напомним часть доказательства леммы 3.1. Если $x_{1} x_{k}, x_{k-1} x_{n} \in E(G)$, то существует цикл из $n$ вершин: $x_{1} x_{2} \ldots x_{k-1} x_{n} x_{n-1} \ldots x_{k}$ (см. рисунок 3.12a). Противоречие показывает нам, что из $x_{1} x_{k} \in E(G)$ следует, что $x_{k-1} x_{n} \notin E(G)$. В частности, отсюда следует, что $m<n$. Разберём несколько случаев, в каждом случае мы будем считать, что не выполнено условие ни одного из предыдущих.


Рис. 3.12: Максимальный путь $P$ и циклы.

1. Пусть $x_{1} x_{k}, x_{\ell} x_{n} \in E(G)$, где $0<k-\ell \leq n-m+1$.

Тогда рассмотрим цикл $Z=x_{1} x_{2} \ldots x_{\ell} x_{n} x_{n-1} \ldots x_{k}$ (см. рисунок 3.12 b ). Этот цикл проходит все вершины пути $P$, кроме $x_{\ell+1}, \ldots, x_{k-1}$, то есть, $v(Z)=n-(k-\ell)+1 \geq m$, а мы ищем как раз такой цикл.
1. Пусть существуют рёбра $x_{1} x_{k}, x_{\ell} x_{n} \in E(G)$, где $k>\ell$.

Будем считать, что разность $k-\ell$ минимально возможная. Поскольку не выполнено условие пункта 1 , то $k-\ell \geq n-m+2$. Мы знаем, что $\mathrm{N}_{G}\left(x_{1}\right) \subset$ $V\left(P-x_{1}\right)$. Пусть $d_{G}\left(x_{1}\right)=s$ и эта вершина смежна с $x_{i_{1}}, \ldots x_{i_{s}}$ (среди них, конечно же, есть $x_{2}$ и $x_{k}$ ). Тогда, как доказано выше, $x_{n}$ несмежна с $x_{i_{1}-1}, \ldots, x_{i_{s}-1}$. Кроме того, ввиду минимальности $k-\ell$ вершина $x_{n}$

несмежна с $x_{\ell+1}, \ldots, x_{k-1}$ (из которых ранее учтена только $x_{k-1}$ ). Так как $\mathrm{N}_{G}\left(x_{n}\right) \subset V\left(P-x_{n}\right)$,
$d_{G}\left(x_{n}\right) \leq n-1-d_{G}\left(x_{1}\right)-(k-\ell-2) \leq n-1-d_{G}\left(x_{1}\right)-(n-m)=m-1-d_{G}\left(x_{1}\right)$,
откуда $d_{G}\left(x_{1}\right)+d_{G}\left(x_{n}\right) \leq m-1$, что для несмежных вершин $x_{1}$ и $x_{n}$ невозможно.
1. Пусть $k$ - наибольший номер вершины пути $P$, смежной с $x_{1}$, а $\ell$ - наименьший номер вершины пути $P$, смежной с $x_{n}$.
Тогда $k<\ell$. Так как граф $G$ двусвязен, существует путь из $\left\{x_{1}, \ldots, x_{k-1}\right\}$ до $\left\{x_{k+1}, \ldots, x_{n}\right\}$, не проходящий через $x_{k}$, а значит и $x_{s_{1}} x_{t_{1}}$-путь $P_{1}$, внутренние вершины которого не принадлежат $P$ и $s_{1}<k<t_{1}$. Мы выберем путь $P_{1}$ так, чтобы $t_{1}$ было максимально возможным.

Если $t_{1}>\ell$, то закончим построение, иначе продолжим его. Аналогично, из двусвязности графа $G$ следует существование $x_{s_{2}} x_{t_{2}}$-пути $P_{2}$, внутренние вершины которого не принадлежат $P$ и $s_{2}<t_{1}<t_{2}$. Мы выберем путь $P_{2}$ так, чтобы $t_{2}$ было максимально возможным.


Рис. 3.13: Пути $P_{1}, P_{2}, \ldots, P_{r}$
Далее, если $t_{2} \leq \ell$, то продолжим построение и выберем $x_{s_{3}} x_{t_{3}}$-путь $P_{3}$, внутренние вершины которого не принадлежат $P, s_{3}<t_{2}<t_{3}$ и $t_{3}$ - максимально возможное. И так далее, пока не получим $t_{r}>\ell$. Пути $P_{1}, P_{2}$, $\ldots, P_{r}$ изображены на рисунке 3.13 (вдоль пути $P$ проставлены только номера вершин).

Остался последний шаг в построении нашей конструкции. Пусть $t_{0}$ наименьший такой номер вершины, что $t_{0}>s_{1}$ и $x_{1} x_{t_{0}} \in E(G)$. Пусть $s_{r+1}$ - наибольший такой номер вершины, что $s_{r+1}<t_{r}$ и $x_{n} x_{s_{r+1}} \in E(G)$. Поскольку $x_{1} x_{k}, x_{n} x_{\ell} \in E(G), k>s_{1}$ и $\ell<t_{r}$, то такие $t_{0}$ и $s_{r+1}$ существуют.

Докажем важное свойство: $s_{i+2} \geq t_{i}$ для всех $i \in[0 . . r-1]$.
Пусть $i \in[1 . . r-2]$. Тогда $t_{i+2}>t_{i+1}$. Так как при построении пути $P_{i+1}$ мы не могли выбрать путь до $x_{t_{i+2}}$, то должно быть $s_{i+2} \geq t_{i}$.

Теперь рассмотрим $i=0$. Очевидно, $t_{2}>t_{1}$, поэтому $s_{2} \geq k \geq t_{0}$ (иначе мы бы выбрали путь $P_{2}$ вместо $P_{1}$ ). Случай $i=r-1$ очевиден: по построению, $t_{r-1} \leq \ell$, а $s_{r+1} \geq \ell$.


Рис. 3.14: Цикл $C$.
Построим на основе путей $P, P_{1}, \ldots, P_{r}$ цикл $C$, как на рисунке 3.14 (слева изображен случай нечетного $r$, а справа - случай четного $r$ ). Из доказанного выше утверждения $s_{i+2} \geq t_{i}$ следует, что ни по одной из вершин цикл не пройдет дважды, то есть, построение корректно.

Цикл $C$ проходит все вершины пути $P$, кроме внутренних вершин $s_{i} t_{i-1}$-участков этого пути (для $i \in[1 . . r+1]$ ). Отметим, что из выбора $t_{0}$ и $s_{2} \geq k$ следует, что все вершины из $\mathrm{N}_{G}\left(x_{1}\right)$ содержатся в цикле $C$, а из выбора $s_{r+1}$ и $t_{r-1} \leq \ell$ следует, что все вершины из $\mathrm{N}_{G}\left(x_{n}\right)$ содержатся в цикле $C$. Кроме этого, $C$ содержит еще хотя бы две вершины: это $x_{1}$ и $x_{n}$. В рассматриваемом случае $\left|\mathrm{N}_{G}\left(x_{1}\right) \cap \mathrm{N}_{G}\left(x_{n}\right)\right| \leq 1$, поэтому

$$
v(C) \geq d_{G}\left(x_{1}\right)+d_{G}\left(x_{n}\right)+2-1 \geq m+1
$$

Таким образом, цикл $C$ подходит в качестве искомого.
Все случаи разобраны, теорема доказана.

# 3.4 Циклы четной длины 

В этом разделе мы покажем, что для наличия в графе циклов заданной четной длины достаточно сравнительно небольшого количества ребер. Начнем с несложных лемм.

Лемма 3.7. Для любого графа $G$ существует двудольный подграф $G^{\prime}$ с $e\left(G^{\prime}\right) \geq \frac{e(G)}{2}$.

Доказательство. Разобьем все вершины графа на два множества $A$ и $B$ так, чтобы количество рёбер внутри множеств было наименьшим. Обозначим через $d_{A}(x)$ и $d_{B}(x)$ количество рёбер, выходящих из $x$ к вершинам множеств $A$ и $B$ соответственно. Тогда для каждой вершины $a \in A$ выполняется неравенство $d_{A}(a) \leq d_{B}(a)$, иначе перекинув вершину $a$ в

множество $B$ мы уменьшим количество ребер внутри множеств, что противоречит выбору разбиения. Аналогично для каждой вершины $b \in B$ выполняется неравенство $d_{B}(b) \leq d_{A}(b)$. Сложив такие неравенства для всех вершин мы получим, что количество рёбер внутри множеств не превосходит количество рёбер между множествами. Удалив все внутренние рёбра, получим искомый двудольный подграф $G^{\prime}$.

Определение 3.5. Раскраска вершин называется $t$-периодической, если концы любого простого пути длины $t$ покрашены в один цвет.

Лемма 3.8. Пусть раскраска $\rho$ вершин графа $H$ такова, что для любой вершины $a \in V(H)$ все вершины из $\mathrm{N}_{G}(a)$ покрашены в один и тот же ивет. Тогда в раскраске $\rho$ используется не более, чем два ивета.

Доказательство. Рассмотрим остовное дерево $T$ графа $H$, подвесим его за произвольную вершину $a$. Эта вершина будет иметь уровень 0 , остальные вершины мы распределим по уровням (номер уровня будет равен длине пути из $a$ ). Пусть вершина $a$ имеет цвет $i$, уровень 1 - это вершины из $\mathrm{N}_{H}(a)$ и по пункту 1 они все имеют одинаковый цвет - пусть это цвет $j$ (возможно, $i=j$ ).

Докажем, что все вершины четных уровней имеют цвет $i$, а все вершины нечетных уровней имеют цвет $j$. Рассмотрим очередной уровень с номером не менее 2 и его вершину $x$. Пусть $y$ - предок $x$, а $z$ - предок $y$. Тогда $x, z \in \mathrm{~N}_{H}(y)$, следовательно $\rho(x)=\rho(y)$. Таким образом, вершины рассматриваемого уровня покрашены так же, как и вершины уровня с номером на 2 меньше.

Таким образом, все вершины дерева $T$ (то есть, графа $H$ ) покрашены не более чем в два цвета.

Следствие 3.4. Пусть раскраска $\rho$ вершин связного графа $G$ является 2-периодической. Тогда $\rho$ красит вершины не более, чем в два ивета.

Доказательство. Очевидно, для любой вершины $v \in V(G)$ все вершины из $\mathrm{N}_{G}(v)$ покрашены в один цвет в силу 2-периодичности раскраски. Тогда по лемме 3.8 раскраска $\rho$ красит вершины не более, чем в два цвета.

Лемма 3.9. Пусть $t \in \mathbb{N}, t \geq 3$, для связного графа $G$ выполняется неравенство $e(G) \geq t \cdot v(G)$, а раскраска вершин $\rho$ является $t$-периодической. Тогда $\rho$ красит вершины не более, чем в два ивета.

Доказательство. (Идея доказательства принадлежит М. Л. Матдинову.) 1. По лемме 1.4 существует подграф $G^{\prime}$ графа $G$, в котором

$\delta\left(G^{\prime}\right) \geq t+1$. Докажем, что все вершины графа $G^{\prime}$ покрашены в два цвета. Рассмотрим вершину $v \in V\left(G^{\prime}\right)$ и докажем, что любые две вершины из $\mathrm{N}_{G^{\prime}}(v)$ покрашены в один и тот же цвет.


Рис. 3.15: Пути длины $t$.
Пусть $a, b \in \mathrm{~N}_{G^{\prime}}(v)$. Построим путь длины $t-1$ с началом $v$, не проходящий через $a$ и $b$. Выйдем из вершины $v$ и, пока это возможно, будем из конца пути идти в отличную от $a$ и $b$ вершину, в которой ещё не были. Пусть мы находимся в вершине $w$ и не можем пойти дальше. Так как $d_{G^{\prime}}(w) \geq t+1$, то пройдено не менее $t+1-2$ отличных от $w$ вершин и мы имеем простой путь длины хотя бы $t-1$. Пусть $w^{\prime}$ - вершина на этом пути на расстоянии ровно $t-1$ от $v$. Тогда $\rho(a)=\rho\left(w^{\prime}\right)=\rho(b)$ в силу периодичности раскраски. В силу произвольности выбора $a$ и $b$ мы имеем, что все вершины из $\mathrm{N}_{G^{\prime}}(a)$ одноцветны.

По лемме 3.8 , все вершины графа $G^{\prime}$ покрашены не более, чем в два цвета.
1. Пусть $w \in V(G) \backslash V\left(G^{\prime}\right)$. Рассмотрим простой путь $P$ от $w$ до вершин из $V\left(G^{\prime}\right)$, пусть его конец - это вершина $a \in V\left(G^{\prime}\right)$. Как мы уже обсуждали, существует простой путь длины не менее $t-1$ с началом в $a$ и проходящий только по вершинам из $V\left(G^{\prime}\right)$, следовательно, не пересекающийся с $P$. Тогда путь $P$ можно дополнить до пути, длина которого кратна $t$, с началом в $w$ и концом в $V\left(G^{\prime}\right)$. Следовательно, вершина $w$ также покрашена в один из двух цветов, в которые покрашены вершины графа $G^{\prime}$.

Теорема 3.9. (J. A. Bondy, M. Simonivits, 1974) Пусть $G$ - связный граф, $n=v(G), k \in \mathbb{N}, e(G)>18 k \cdot n^{1+\frac{1}{k}}$. Тогда для любого натурального $\ell$, удовлетворяющего условию $k \leq \ell \leq k n^{\frac{1}{k}}$, в графе $G$ есть цикл длины $2 \ell$.

Доказательство. 1. Зафиксируем $\ell$ и докажем существование цикла длины $2 \ell$. По лемме 3.7 существует двудольный подграф $G^{*}$ графа $G$ с $e\left(G^{*}\right) \geq 9 k n^{1+\frac{1}{k}}=\delta n$. По лемме 1.4 существует такой подграф $G^{\prime}$ графа $G^{*}$, что $\delta\left(G^{\prime}\right) \geq \delta$. Будем считать граф $G^{\prime}$ связным (иначе рассмотрим его компоненту). Дальше мы будем работать только со связным двудольным графом $G^{\prime}$.

Проверим, что

$$
\delta=9 k n^{\frac{1}{k}} \geq 9 \ell, \quad \delta \geq \frac{9}{2} \ell n^{1 / \ell}
$$

для любого $\ell$ из указанного промежутка значений.
Первое неравенство очевидно, проверим второе. Рассмотрим функцию $f(x)=x \cdot n^{\frac{1}{x}}$. Продифференцировав ее, мы получим на положительной полуоси единственную точку минимума $x_{0}=\ln n$. Следовательно, достаточно проверить второе неравенство (3.1) в крайних точках $\ell=k$ и $\ell=k \cdot n^{\frac{1}{k}}$. В первом случае получается очевидное неравенство, а во втором случае мы получаем

$$
2 \cdot k n^{\frac{1}{k}} \geq k n^{\frac{1}{k}} \cdot n^{\frac{1}{k n^{1 / k}}}
$$

Тогда нам достаточно доказать, что

$$
g(n)=n^{\frac{1}{k n^{1 / k}}}<2
$$

Это можно понять, продифференцировав $g(n)$ по $n$ и подставив единственную точку максимума $n_{0}=e^{k}$ : максимальное значение окажется равным $e^{1 / e}<2$. Таким образом, неравенство доказано.
1. Пусть граф $G^{\prime}$ не содержит цикла длины $2 \ell$. Зафиксируем вершину $c \in V\left(G^{\prime}\right)$ и разобьем граф на уровни $V_{0}=\{c\}, V_{1}, V_{2}, \ldots$, где уровень $V_{i}$ состоит из вершин, находящихся на расстоянии $i$ от вершины $c$. Построим остовное дерево $T$ графа $G^{\prime}$, проведя от каждой вершины, кроме $c$, ровно одно ребро к смежной с ней вершине предыдущего уровня. Нашей ближайшей целью будет доказательство неравенства

$$
\frac{\left|V_{i+1}\right|}{\left|V_{i}\right|} \geq \frac{2 \delta}{9 \ell} \quad \text { для } i<\ell
$$

1. Рассмотрим граф $G^{\prime}\left(V_{i} \cup V_{i+1}\right)$ и его произвольную компоненту $H$. Докажем неравенство $e(H) \leq 2 \ell \cdot v(H)$. Если мы это сделаем, то, очевидно, будет выполняться и неравенство

$$
e\left(G^{\prime}\left(V_{i} \cup V_{i+1}\right)\right) \leq 2 \ell \cdot v\left(G^{\prime}\left(V_{i} \cup V_{i+1}\right)\right)
$$

Пусть $W_{1}=V(H) \cap V_{i}, W_{2}=V(H) \cap V_{i+1}$. Тогда граф $H$, очевидно, двудолен с долями $W_{1}$ и $W_{2}$, так как в двудольном графе $G^{\prime}$ не могут быть смежными вершины, находящиеся на одинаковом расстоянии от $c$. Можно считать, что $\left|W_{1}\right|,\left|W_{2}\right| \geq 2$, иначе граф $H$ является деревом и доказываемое неравенство очевидно.

Пусть $a \in V_{h}$ - вершина наибольшего уровня, от которой в дереве $T$ можно дойти до всех вершин из $W_{1}$ (такая вершина, очевидно, существует, так как, например, от $c$ можно дойти по дереву $T$ до всех вершин из $W_{1}$ ). Зафиксируем вершину $b \in V_{h+1}$, по которой в $T$ проходит хотя бы один путь от $a$ до $W_{1}$. Отметим, что не все пути от $a$ до $W_{1}$ проходят по вершине $b$ (иначе мы выбрали бы $b$ вместо $a$ ).

Построим раскраску $\rho$ вершин графа $H$. Пусть $\rho(x)=0$ для вершины $x \in W_{2}, \rho(x)=1$, если $x \in W_{1}$ и простой $a x$-путь в дереве $T$ проходит по $b$ и, наконец, $\rho(x)=2$, если $x \in W_{1}$, но $a x$-путь в дереве $T$ не проходит по $b$. Из сказанного выше понятно, что все три цвета в раскраске присутствуют.

Пусть $t=2(\ell-i+h)$. Из $i<\ell$ следует $t \geq 2$. Докажем, что раскраска $\rho$ является $t$-периодической. Так как $t$ четно, а граф $H$ двудолен, любой путь длины $t$ с началом цвета 0 (то есть, из множества $W_{2}$ ) имеет конец из $W_{2}$, то есть, цвета 0 .


Рис. 3.16: Построение цикла длины $2 \ell$.
Пусть $x, y \in W_{1}, \rho(x)=1, \rho(y)=2$ и существует $x y$-путь $P$ длины $t$ в графе $H$. Рассмотрим $a x$-путь $Q$ в дереве $T$, проходящий по $b$ и $a y$-путь $S$ в дереве $T$ (см. рисунок 3.16). Тогда $S$ не проходит по $b$, а значит, пути $Q$ и $S$ не пересекаются (так как $T$ - дерево). Оба пути $Q$ и $S$, очевидно, не пересекаются с $P$. Таким образом, пути $P, Q$ и $S$ вместе образуют цикл длины

$$
2(i-h)+t=2(i-h)+2(\ell-i+h)=2 \ell
$$

Противоречие с предположением об отсутствии таких циклов.
Таким образом, остается случай, когда раскраска $\rho$ является $t$-периодической. При $t=2$ по следствию 3.4 в раскраске не могут использоваться три цвета, противоречие. При $t>2$, так как в раскраске используются три цвета, по лемме 3.9 мы имеем $e(H) \leq 2 \ell v(H)$, а следовательно, и неравенство (3.3).
1. Теперь по индукции докажем неравенство (3.2). База для $i=0$ очевидна, так как $\left|V_{0}\right|=1,\left|V_{1}\right|=d_{G^{\prime}}(c) \geq \delta>\frac{2 \delta}{9 \ell}$. Пусть $m_{j}-$ это количество рёбер графа $G^{\prime}$ между $V_{j}$ и $V_{j+1}$. Понятно, что из $V_{i}$ рёбра

графа $G^{\prime}$ могут выходить только в $V_{i-1}$ (их $m_{i-1}$ ) и в $V_{i+1}$ (их $m_{i}$ ). Тогда

$$
\delta\left|V_{i}\right| \leq m_{i-1}+m_{i} \leq 2 \ell\left(\left|V_{i-1}\right|+2\left|V_{i}\right|+\left|V_{i+1}\right|\right)<2 \ell\left|V_{i}\right|\left(2+\frac{9 \ell}{2 \delta}\right)+2 \ell\left|V_{i+1}\right|
$$

(последнее неравенство следует из индукционного предположения $\left.\frac{\left|V_{i-1}\right|}{\left|V_{i}\right|} \leq \frac{9 \ell}{2 \delta}\right)$. Отсюда получаем

$$
\frac{\left|V_{i+1}\right|}{\left|V_{i}\right|}>\frac{1}{2 \ell}\left(\delta-4 \ell-\frac{9 \ell^{2}}{\delta}\right)>\frac{1}{2 \ell}(\delta-5 \ell)>\frac{2 \delta}{9 \ell} \geq n^{1 / \ell}
$$

(Все переходы в цепочке неравенств следуют из (3.1): второе и третье неравенство следуют из $\delta \geq 9 \ell$, а последнее - из $\delta \geq \frac{9}{2} \ell n^{1 / \ell}$.)

Следовательно,

$$
\left|V_{\ell}\right|>\left(n^{1 / \ell}\right)^{\ell} \cdot\left|V_{0}\right|=n
$$

что очевидно невозможно. Полученное противоречие показывает, что цикл длины $2 \ell$ в нашем графе есть.

# 3.5 Обхват 

Определение 3.6. Обхват графа $G$ (обозначение $g(G)$ ) - это длина наименьшего цикла в графе $G$.

Интуитивно ясно, что обхват графа никак не связан с его минимальной степенью, что должны существовать графы сколь угодно большого обхвата со сколь угодно большой минимальной степенью. Однако, не так просто придумать явную серию примеров (отметим, что явные конструкции существуют). Мы приведем изящное неконструктивное доказательство Татта существования регулярного графа фиксированной степени с фиксированным обхватом.

Теорема 3.10. (W. T. Tutte.) Пусть $k, g, n \in \mathbb{N}$, причём $k, g \geq 3$, $n>\frac{k(k-1)^{g-1}-2}{k-2}$ и kn чётно. Тогда существует регулярный граф $G$ степени $k$ с $g(G)=g$ и $v(G)=n$.

Доказательство. Пусть $\mathcal{G}(n, g, k)$ - семейство всех графов на $n$ вершинах с обхватом $g$ и максимальной степенью вершин не более $k$. При $n>g$ очевидно, что $\mathcal{G}(n, g, k) \neq \varnothing$ : например, нам подойдёт граф, состоящий из цикла на $g$ вершинах и нескольких изолированных вершин. Пусть $v_{<k}(G)$ - количество вершин степени менее $k$ в графе $G$, а $\operatorname{dist}_{<k}(G)$ - максимальное из расстояний между парами вершин степени менее $k$ в графе $G$ (при $v_{<k}(G)<2$ положим $\operatorname{dist}_{<k}(G)=0$ ). Мы выберем в $\mathcal{G}(n, g, k)$ граф

следующим образом: сначала выберем все графы с максимальным количеством рёбер, затем из них выберем графы с максимальным $v_{<k}$ и, наконец, из оставшихся выберем граф $G$ с максимальным $\operatorname{dist}_{<k}(G)$.

Докажем, что $G$ - регулярный граф степени $k$. Предположим, что это не так и рассмотрим пару его максимально удаленных вершин степени менее $k$ : пусть это $x$ и $y$ (если вершина степени менее $k$ в графе $G$ единственна, то $x=y$ ). Если $\operatorname{dist}_{G}(x, y) \geq g-1$, то соединим их и получим граф $G^{\prime} \in \mathcal{G}(n, g, k)$ с $e\left(G^{\prime}\right)>e(G)$ - противоречие с выбором $G$. Следовательно, $\operatorname{dist}_{G}(x, y) \leq g-2$.

Так как $d_{G}(x), d_{G}(y) \leq k-1$, а степени остальных вершин графа не более $k$, то на расстоянии не более $g-1$ от $y$ находится не более чем $\frac{(k-1)^{g}-1}{k-2}$ вершин, а на расстоянии не более $g-2$ от $x$ находится не более чем $\frac{(k-1)^{g-1}-1}{k-2}$ вершин. Тогда по условию теоремы существует такая вершина $z$, что $\operatorname{dist}(x, z) \geq g-1$ и $\operatorname{dist}(y, z) \geq g$. Из доказанного выше понятно, что $d_{G}(z)=k \geq 3$, следовательно, существует ребро $z u \in E(G)$, через которое проходят не все простые циклы длины $g$ графа $G$, тогда $g(G-z u)=g(G)=g$.

Пусть $G^{\prime}=G-z u+z x$. Из

$$
\operatorname{dist}_{G}(y, u) \geq \operatorname{dist}_{G}(y, z)-1 \geq g-1>\operatorname{dist}_{G}(x, y)=\operatorname{dist}_{<k}(G)
$$

следует, что $d_{G}(u)=k$. Легко видеть, что $g\left(G^{\prime}\right)=g, e\left(G^{\prime}\right)=e(G)$,

$$
d_{G^{\prime}}(x)=d_{G}(x)+1, \quad d_{G^{\prime}}(u)=d_{G}(u)-1=k-1
$$

степени остальных вершин в графах $G$ и $G^{\prime}$ совпадают. Таким образом, $G^{\prime} \in \mathcal{G}(n, g, k)$. Из (3.5) следует, что $v_{<k}\left(G^{\prime}\right) \geq v_{<k}(G)$. Тогда ввиду выбора графа $G$ должно быть $v_{<k}\left(G^{\prime}\right)=v_{<k}(G)$, что возможно лишь при $d_{G^{\prime}}(x)=k$ и $d_{G}(x)=k-1$. Так как $k n \vdots 2$, вершина $x$ не может быть единственной вершиной степени менее $k$ в графе $G$, следовательно, $x \neq y$.

Докажем, что $\operatorname{dist}_{G^{\prime}}(y, u)>\operatorname{dist}_{G}(y, x)$. Действительно, рассмотрим $y u$-путь $P$, который реализует расстояние между $y$ и $u$ в $G^{\prime}$. Если $P$ проходит только по ребрам $G$, то учитывая неравенство (3.4) получаем

$$
\operatorname{dist}_{G^{\prime}}(y, u)=\operatorname{dist}_{G}(y, u) \geq g-1>\operatorname{dist}_{G}(y, x)
$$

Значит, $P$ проходит по ребру $z x$. Следовательно, $P$ содержит путь по рёбрам графа $G$ от $y$ до одной из вершин $x$ или $z$ и ребро $z x$. Тогда

$$
\operatorname{dist}_{G^{\prime}}(y, u) \geq \min \left(\operatorname{dist}_{G}(y, x)+1, \operatorname{dist}_{G}(y, z)+1\right)>\operatorname{dist}_{G}(y, x)
$$

так как $\operatorname{dist}_{G}(y, z) \geq g>\operatorname{dist}_{G}(y, x)$. Таким образом,

$$
\operatorname{dist}_{<k}\left(G^{\prime}\right) \geq \operatorname{dist}_{G^{\prime}}(y, u)>\operatorname{dist}_{G}(y, x)=\operatorname{dist}_{<k}(G)
$$

Полученное противоречие с выбором графа $G$ показывает, что $G-k$-регулярный граф.

# 3.6 Комментарии 

Начало главы содержит классические критерии гамильтоновости Дирака и Оре, а также теоремы Хватала о гамильтоновых графах. Теоремы Хватала изложены близко к книге Бонди и Мурти [3].

Говоря о гамильтоновых циклах в степени графа многие (в том числе замечательная книга Дистеля [8]) вспоминают знаменитую теорему Флейшнера о гамильтоновости квадрата двусвязного графа, незаслуженно забывая элементарную, но весьма интересную теорему Чаргранда и Капура о гамильтоновости куба связного графа. Мы приводим доказательства обеих теорем. Теорема Флейшнера - наиболее сложная в этой, в общем-то, простой главе.

Далее следует несложная теорема Бонди о панциклическом графе (содержащем циклы всех возможных длин) и теорема Линиала об оценке на длину наибольшего цикла в графе [20], которая перекликается с методом Хватала.

Теорему Бонди-Симоновица о циклах четной длины можно найти в книге Боллобаша "Extremal Graph Theory" [1] с более сложным доказательством ключевой леммы 3.9 и несколько худшей оценкой. Основная идея приведенного в книге доказательства этой леммы была придумана школьником М. Матдиновым на Фестивале юных математиков - турнире математических боев.

Завершает главу теорема Татта о существовании регулярного графа заданного обхвата с заданным количеством вершин. Для меня эта теорема в первую очередь интересна доказательством - неконструктивным, но в то же время чисто комбинаторным: теорему доказывает порясающей красоты инвариант.

# Глава 4 

## Раскраски

## 4.1 Хроматическое число

Определение 4.1. Через $\chi(G)$ обозначим хроматическое число графа $G$ - наименьшее натуральное число, для которого существует правильная раскраска вершин графа $G$ в такое количество цветов.

Обычно при разговоре о раскрасках в $k$ цветов мы будем использовать для обозначения цветов числа от 1 до $k$. В случаях, когда мы используем другие обозначения для цветов, об этом будет сказано.

Докажем две леммы, содержащие простейшие, но очень важные свойства хроматического числа, которые мы будеи неоднократно использовать.

Лемма 4.1. Пусть граф $G$ таков, что для любого его подграфа $H$ выполняется $\delta(H) \leq k-1$. Тогда $\chi(G) \leq k$.

Доказательство. По индукции докажем, что вершины любого подграфа $H$ графа $G$ можно правильным образом покрасить в $k$ цветов. База для подграфа из одной вершины очевидна.

Рассмотрим подграф $H$, пусть $v \in V(H)$ - вершина наименьшей степени. По индукционному предположению мы можем покрасить правильным образом в $k$ цветов вершины графа $H-v$, остаётся лишь заметить, что $d_{H}(v)=\delta(H) \leq k-1$, поэтому вершину $v$ можно докрасить, не нарушая правильности раскраски.

Лемма 4.2. Для любого графа $G$ выполняется неравенство

$$
\chi(G) \cdot \alpha(G) \geq v(G)
$$

Доказательство. Утверждение очевидно следует из соображения о том, что все вершины одного цвета в правильной раскраске попарно несмежны, то есть, образуют независимое множество.

# 4.2 Теорема Брукса 

В этом разделе мы сформулируем теорему Брукса и приведем два доказательства этой теоремы. Первым будет, наверное, наиболее классическое доказательство - методом чередующихся цепей. Вторым будет доказательство Ловаса (1973 г), идеи которого восходят к работам Дирака, опубликованным в 1950 -е годы.

Теорема 4.1. (R. L. Brooks, 1941.) Пусть $d \geq 3$, а $G$ - связный граф, отличный от $K_{d+1}, \Delta(G) \leq d$. Тогда $\chi(G) \leq d$.

Замечание 4.1. При $\Delta(G)=2$ вопрос о существовании правильной раскраски вершин связного графа $G$ в два цвета очевиден. Такой граф $G$ либо $P_{n}$ (путь из $n$ вершин), либо $C_{n}$ (цикл из $n$ вершин). В первом случае легко видеть, что $\chi\left(P_{n}\right)=2$, а во втором случае $\chi\left(C_{2 k}\right)=2$ и $\chi\left(C_{2 k+1}\right)=3$.

Начнем с несложной леммы.
Лемма 4.3. Пусть $G$ - связный граф, $\Delta(G) \leq d$, причем хотя бы одна из вершин графа $G$ имеет степень менее $d$. Тогда $\chi(G) \leq d$.

Доказательство. Индукция по количеству вершин. База для графа, у которого не более $d$ вершин, очевидна. Будем считать, что утверждение верно для любого связного графа с меньшим чем $v(G)$ количеством вершин.

Пусть $u \in V(G)$ - вершина степени менее $d$. Рассмотрим граф $G-u$. Пусть $G_{1}, \ldots, G_{k}$ - компоненты графа $G-u$. В каждом из графов $G_{1}, \ldots, G_{k}$ ввиду связности графа $G$ обязательно есть вершина, смежная в графе $G$ с $u$, и эта вершина имеет в $G_{i}$ степень менее $d$. Так как $\Delta\left(G_{i}\right) \leq d$, по индукционному предположению существует правильная раскраска вершин графа $G_{i}$ в $d$ цветов. Значит, существует правильная раскраска вершин в $d$ цветов и у графа $G-u$. Так как $d_{G}(u)<d$, мы можем докрасить в один из цветов вершину $u$, не нарушая правильности раскраски графа.

Доказательство теоремы Брукса методом чередующихся цепей. Ввиду леммы 4.3 остается доказать теорему Брукса в случае, когда все вершины имеют степень $d$. Выберем вершину $a \in V(G)$ и рассмотрим

правильную раскраску $\rho$ вершин графа $G-a$ в $d$ цветов (такая раскраска существует по лемме 4.3). Интересен лишь случай, когда $d$ вершин окрестности $\mathrm{N}_{G}(a)$ раскрашены по одной в цвета $1,2, \ldots, d$ : иначе найдется цвет, в который можно покрасить вершину $a$. Пусть $\mathrm{N}_{G}(a)=$ $\left\{a_{1}, \ldots, a_{d}\right\}$, причем $\rho\left(a_{i}\right)=i$.

# 1. Построение чередующейся цепи. 

Пусть $i, j \in[1 . . d], i \neq j$. Пусть $G_{i, j}-$ подграф $G$, индуцированный на множестве вершин степеней $i$ и $j$. Рассмотрим компоненту связности $U_{i, j}$ графа $G_{i, j}$, содержащую вершину $a_{i}$. Если поменять цвета всех вершин в $U_{i, j}$ (цвет $i$ на цвет $j$ и наоборот), то раскраска останется правильной. Значит, $a_{j} \in U_{i, j}$ : иначе после смены цветов в $U_{i, j}$ получается раскраска, в которой обе вершины $a_{i}$ и $a_{j}$ имеют цвет $j$ и новых вершин цвета $i$ в $\mathrm{N}_{G}(a)$ не добавилось, тогда можно покрасить $a$ в цвет $i$ и получить правильную раскраску графа $G$. Таким образом, вершины $a_{i}$ и $a_{j}$ соединены в графе $G$ простым путём, на котором чередуются цвета $i$ и $j$. Этот путь назовем чередующейся іj-цепъю.

## 2. Свойства чередующихся цепей.

(a). $d_{G}\left(a_{i}\right)=d_{G}\left(a_{j}\right)=d$, все вершины в $\mathrm{N}_{G}\left(a_{i}\right) \backslash\{a\}$ и в $\mathrm{N}_{G}\left(a_{j}\right) \backslash\{a\}$ покрашены в разные ивета.
Если, скажем, для $a_{i}$ это не так, то ее можно перекрасить в цвет, отличный от $i$, после чего покрасить $a$ в цвет $i$ и тем самым получить правильную раскраску графа $G$.
(b). Если $x$ - внутренняя вершина чередующейся $i j$-цеп и и $\rho(x)=i$, то $d_{G}(x)=d$, в $\mathrm{N}_{G}(x)$ - две вершины ивета $j$, и по одной вершине всех иветов, кроме $i$ и $j$.
Назовем внутреннюю вершину цепи, для которой это свойство не выполнено, плохой. Предположим, что такие вершины есть и рассмотрим из них ближайшую к $a_{i}$ - пусть $x$ как раз такая вершина и $\rho(x)=i$. Тогда в $\mathrm{N}_{G}(x)$ нет вершин какого-то цвета, отличного от $i$ - скажем, цвета $\ell$. Перекрасим $x$ в цвет $\ell$, а во всех вершинах цепи от $a_{i}$ (включительно) до $x$ (не включительно) поменяем цвет $i$ на цвет $j$ и наоборот. По предыдущему пункту и так как от $a_{i}$ до $x$ нет плохих вершин, мы получим правильную раскраску, в которой в $\mathrm{N}_{G}(a)$ нет вершин цвета $i$. Покрасим $a$ в цвет $i$ и получим правильную раскраску графа $G$.
(c). Граф $G\left(U_{i, j}\right)$ - это и есть чередующаяся $i j$-цепъ.

Непосредсвенное следствие свойства (b).
(d). При перекраске чередующейся іj-цеп и (операции, при которой вершины цепи ивета $i$ менят ивет на $j$ и наоборот) получается правильная раскраска $\rho^{\prime}$ графа $G-a$, в которой $\rho^{\prime}\left(a_{i}\right)=j$ и $\rho^{\prime}\left(a_{j}\right)=i$.
Непосредсвенное следствие свойства (с).

(e). Чередующиеся $i j$ и is-цепи не могут иметь общих вершин, кроме $a_{i}$.
Пусть $b \neq a_{i}$ - общая внутренняя вершина этих двух цепей. Тогда $\rho(b)=i$, вершина $b$ не является концом ни одной из цепей и в $\mathrm{N}_{G}(b)$ есть по две вершины цветов $j$ и $s$. Это противоречит свойству (b).

# 3. Перекрашивание вершин. 

Итак, для любых $i, j \in[1 . . d]$ вершины $a_{i}$ и $a_{j}$ соединены чередующейся $i j$-цепью. В принципе, такая цепь может не иметь внутренних вершин, если $a_{i}$ и $a_{j}$ смежны. Однако, так как $G-$ не полный граф на $d+1$ вершине, в $\mathrm{N}_{G}(a)$ есть две несмежные вершины, пусть это $a_{1}$ и $a_{2}$. Тогда 12 -цепь $b_{1}=a_{1}, b_{2}, \ldots, b_{2 k-1}, b_{2 k}=a_{2}$ нетривиальна, то есть, $b_{2} \neq a_{2}$.

Для "исправления" раскраски $\rho$ нам хватит трёх цветов. Рассмотрим 23 -цепь и построим новую раскраску $\rho^{\prime}$ из $\rho$ перекраской 23 -цепи. Из свойства (d) следует, что полученная раскраска $\rho^{\prime}$ будет правильной раскраской вершин графа $G-a$, причем $\rho^{\prime}\left(a_{2}\right)=3$ и $\rho^{\prime}\left(a_{3}\right)=2$.


Рис. 4.1: Перекрашивание чередующейся цепи.
В раскраске $\rho^{\prime}$ также должна существовать чередующая 12 -цепь. По свойству (e) ни одна из внутренних вершин 12 -цепи, построенной для раскраски $\rho$, не входит в 23 -цепь для раскраски $\rho$, следовательно, все эти вершины не перекрашены, то есть и в раскраске $\rho^{\prime}$ начало 12 -цепи также будет $b_{1}=a_{1}, b_{2}, \ldots, b_{2 k-1}$ (см. рисунок 4.1a). В множестве $M_{2 k-1}=$ $\mathrm{N}_{G}\left(b_{2 k-1}\right) \backslash\left\{b_{2 k-2}\right\}$ в раскраске $\rho$ единственной вершиной цвета 2 была $b_{2 k}=a_{2}$, но в новой раскраске $\rho^{\prime}$ эта вершина перекрашена в цвет 3 . Значит, одна из вершин $x \in M_{2 k-1}$ должна была изменить цвет 3 на цвет 2 , то есть, эта вершина входила в перекрашенную 23 -цепь. Рассмотрим два случая.

Если $x=a_{3}$, то чередующиеся 31 и 21 -цепи раскраски $\rho$ имели общую внутреннюю вершину $b_{2 k-1}$ (см. рисунок 4.1 a , в нашем случае это единственная вершина цвета 1 в раскраске $\rho$ как в $\mathrm{N}_{G}\left(a_{2}\right)$, так и в $\mathrm{N}_{G}\left(a_{3}\right)$ ), противоречие со свойством (e).

Пусть $x$ - внутренняя вершина перекрашенной 23 -цепи. Вспомним, что 32 -цепь в раскраске $\rho^{\prime}$ - это 23 -цепь в раскраске $\rho$, так как все ее вершины просто перекрасились (цвет 2 на 3 и наоборот). Тогда $x$ является общей внутренней вершиной 32 и 12 -цепей в раскраске $\rho^{\prime}$ (см. рисунок 4.1 b ), что также невозможно.

Таким образом, в раскраске $\rho^{\prime}$ не существует чередующейся 12 -цепи. Как показано выше, это означает возможность исправить раскраску и дополнить ее до правильной раскраски вершин графа $G$.

Перейдем ко второму доказательству теоремы Брукса. Оно чуть длиннее, но тоже весьма интересное.

# Доказательство теоремы Брукса с использованием связности. 

Мы рассмотрим три случая:

- в графе $G$ есть точка сочленения;
- в графе $G$ нет точки сочленения, но есть двухвершинное разделяющее множество;
- граф $G$ - вершинно трехсвязный.

1. В графе $G$ есть точка сочленения $a \in V(G)$.

Пусть $\operatorname{Part}(a)=\left\{F_{1}, \ldots, F_{m}\right\}, G_{i}=G\left(F_{i}\right)$. По пункту 3 замечания 1.7, графы $G_{1}, \ldots, G_{m}$ - связные. Так как $a$ смежна хотя бы с одной вершиной в каждой компоненте связности, то $d_{G_{i}}(a)<d$. Следовательно, по лемме 4.3 , для каждого графа $G_{i}$ существует правильная раскраска $\rho_{i}$ его вершин в $d$ цветов. Так как цвета в этих раскрасках нумеруются независимо, можно считать, что $\rho_{i}(a)=1$ для каждого $i \in[1 . . m]$. Теперь мы можем склеить эти раскраски по точке сочленения $a$ и получить правильную раскраску графа $G$ : пусть $\rho(v)=\rho_{i}(v)$ при $v \in F_{i}$. Так как разные части $\operatorname{Part}(a)$ пересекаются только по вершине $a$, на которой раскраски согласованы, то получится корректно определенная правильная раскраска $\rho$ вершин графа $G$.
1. В графе $G$ нет точек сочленения, но есть двухвершинное разделяющее множество $S$.
Пусть $S=\{a, b\}, \operatorname{Part}(S)=\left\{F_{1}, \ldots, F_{m}\right\}, G_{i}=G\left(F_{i}\right)$. Тогда $S-$ минимальное по включению разделяющее множество и по замечанию 1.7 мы получаем, что графы $G_{1}, \ldots, G_{m}$ - связны,

$$
d_{G_{i}}(a) \leq d-m+1<d, \quad d_{G_{i}}(b) \leq d-m+1<d
$$

Рассмотрим два случая.
2а. Вериины а и $b$ смежны.
В этом случае действуем аналогично случаю 1 . Точно так же, для каждого $i \in[1 . . m]$ существует правильная раскраска $\rho_{i}$ вершин графа $G_{i}$

в $d$ цветов. Так как $a$ и $b$ смежны, $\rho_{i}(a) \neq \rho_{i}(b)$. Поскольку цвета в этих раскрасках нумеруются независимо, можно считать, что $\rho_{i}(a)=1$ и $\rho_{i}(b)=2$ для каждого $i \in[1 . . m]$. Аналогично пункту 1 , склеим эти раскраски (согласованные по общим вершинам $a$ и $b$ наших графов) и получим правильную раскраску $\rho$ вершин графа $G$.
2b. Вериины а и $b$ несмежны.
Для каждого $i$ построим граф $G_{i}^{\prime}=G_{i}+a b$ (добавим к графу $G_{i}$ отсутствующее в нем ребро $a b$, см. рисунок 4.2 b ).

Пусть у каждого из графов $G_{i}^{\prime}$ существует правильная раскраска $\rho_{i}$ вершин графа $G_{i}^{\prime}$ в $d$ цветов. Тогда $\rho_{i}(a) \neq \rho_{i}(b)$, в этом случае будем действовать, как в случае 2 a .


Рис. 4.2: Случай несмежных $a$ и $b$.
Пусть у графа $G_{1}^{\prime}$ нет правильной раскраски вершин в $d$ цветов. Тогда по лемме 4.3 все вершины этого графа имеют степень $d$. В частности, это означает

$$
d=d_{G_{1}^{\prime}}(a)=d_{G_{1}^{\prime}}(b)=d_{G_{1}}(a)+1=d_{G_{1}}(b)+1
$$

откуда в силу неравенства (4.1) мы имеем $m=2$. Более того,

$$
d-1=d_{G_{1}}(a)=d_{G}(a)-d_{G_{2}}(a), \quad d-1=d_{G_{1}}(b)=d_{G}(b)-d_{G_{2}}(b)
$$

откуда следует $d_{G_{2}}(a)=d_{G_{2}}(b)=1$. Пусть $H_{2}=F_{2} \backslash\{a, b\}-$ компонента связности графа $G-S$. Как мы только что доказали, существует единственная вершина $a^{\prime} \in H_{2}$, смежная с $a$ в графе $G$ и единственная вершина $b^{\prime} \in H_{2}$, смежная с $b$ в графе $G$ (см. рисунок 4.2 c ). Граф $G\left(H_{2}\right)$ связен, причем $d_{G_{2}^{\prime}}\left(a^{\prime}\right)<d$ и по лемме 4.3 существует правильная раскраска $\rho_{2}$ вершин этого графа в $d$ цветов.

Вспомним, что $d_{G_{1}}(a)<d$ и по лемме 4.3 существует правильная раскраска $\rho_{1}$ вершин графа $G_{1}$ в $d$ цветов. Однако, у графа $G_{1}^{\prime}$ нет правильной раскраски вершин в $d$ цветов, в частности, правильная раскраска $\rho_{1}$ графа $G_{1}$ не является таковой для $G_{1}^{\prime}=G_{1}+a b$. Тогда $\rho_{1}(a)=\rho_{1}(b)$. Зафиксируем цвета раскраски $\rho_{2}$ вершин множества $H_{2}$ и перенумеруем цвета для $\rho_{1}$ так, чтобы цвет $\rho_{1}(a)=\rho_{1}(b)$ был отличен и от $\rho_{2}\left(a^{\prime}\right)$, и

от $\rho_{2}\left(b^{\prime}\right)$ - это всегда можно сделать, так как цветов хотя бы три. Теперь раскраски согласованы и, склеив раскраски $\rho_{1}$ и $\rho_{2}$, мы получим правильную раскраску графа $G$.
1. Граф $G$ - вершинно трехсвязный.

Опять же, в силу леммы 4.3 нас интересует только случай, когда все вершины графа $G$ имеют степень $d$. Тогда граф $G$ не является полным. В графе $G$, как и во всяком неполном связном графе, существуют такие вершины $u, v, w$, что $w$ смежна с $u$ и $v$, а $u$ и $v$ несмежны. Рассмотрим связный граф $G^{\prime}=G-\{u, v\}$ и остовное дерево $T$ этого графа, сделаем его корнем $w$ и распределим вершины $T$ по уровням (номером уровня будет расстояние до корня $w$ ).

Положим $\rho(u)=\rho(v)=1$ и будем красить остальные вершины графа $G$ (они же вершины дерева $T$ ) в порядке убывания номеров их уровней, начиная с висячих вершин. Пусть $x \neq w$ - очередная вершина, причем на момент ее рассмотрения мы не красили вершин меньших уровней. Следовательно, предок вершины $x$ (в дереве $T$ ) пока что не покрашен. Тогда покрашено не более, чем $d-1$ соседей вершины $x$ и мы можем выбрать цвет $\rho(x)$ отличным от всех уже покрашенных соседей вершины $x$.

В итоге все отличные от корня $w$ вершины мы покрасим. Рассмотрим $w$ - все ее соседи уже покрашены, но $\rho(u)=\rho(v)$, следовательно, существует цвет, в который не покрашен ни один из соседей вершины $w$. Именно в этот цвет мы покрасим вершину $w$, в итоге получится правильная раскраска вершин графа $G$ в $d$ цветов.

# 4.3 Гипотеза Хайоша 

Гипотеза 4.1. (G. Hajós, 1961) Если $\chi(G)=q$, то граф $G$ содержит подразбиение полного графа $K_{q}$ в качестве подграфа.

Разумеется, эта гипотеза в общем случае не доказана. В случаях $q=1,2,3$ гипотеза тривиальна. В случае $q=5$ из гипотезы Хайоша следует знаменитая гипотеза (или теорема - как кому больше нравится!) четырех красок, которую мы подробно рассмотрим в главе Планарные графы. В случае $q=4$ утверждение гипотезы доказал Дирак, доказательство будет приведено в этом разделе.

### 4.3.1 Критические графы

Определение 4.2. Назовем граф $G \quad k$-критическим, если $\chi(G)=k$, но $\chi(H)<k$ для любого собственного подграфа $H$ графа $G$.

Дирак ввел понятие критического графа и исследовал его свойства в 1950-х годах. В результатах этого раздела немало общего с идеями доказательства теоремы Брукса, основанного на связности. Начнем с исследования простейших свойств $k$-критических графов.

Лемма 4.4. Пусть $G-k$-критический граф, $S \subset V(G)$ - разделяющее множество, $|S|<k$. Тогда граф $G(S)$ - не полный.

Доказательство. Предположим, что граф $G(S)$ - полный. Пусть

$$
S=\left\{a_{1}, \ldots, a_{m}\right\}, \quad \operatorname{Part}(S)=\left\{F_{1}, \ldots, F_{n}\right\}, \quad G_{i}=G\left(F_{i}\right)
$$

Так как $G_{i}$ - собственный подграф графа $G$, то $\chi\left(G_{i}\right) \leq k-1$. Пусть $\rho_{i}-$ правильная раскраска вершин графа $G_{i}$ в $k-1$ цвет. Так как вершины множества $S$ попарно смежны в $G_{i}$, то все цвета $\rho_{i}\left(a_{1}\right), \rho_{i}\left(a_{2}\right), \ldots, \rho_{i}\left(a_{m}\right)$ различны. Поскольку мы можем нумеровать цвета в раскрасках графов $G_{1}, \ldots, G_{n}$ независимо, это можно сделать так, чтобы $\rho_{i}\left(a_{1}\right)=1, \ldots$, $\rho_{i}\left(a_{m}\right)=m$ для всех $i \in[1 . . n]$.

Теперь наши раскраски согласованы на множестве $S$ - пересечении множеств вершин любых двух из наших графов $G_{1}, \ldots, G_{n}$ - и мы можем положить $\rho(v)=\rho_{i}(v)$ при $v \in F_{i}$. Получится корректно определенная правильная раскраска $\rho$ вершин графа $G$ в $k-1$ цвет, что противоречит условию леммы. Следовательно, граф $G(S)$ - не полный.

Лемма 4.5. (G. A. Dirac, 1953.) Пусть $G-k$-критический граф, $S=\{a, b\}$ - разделяющее множество графа $G$,

$$
\operatorname{Part}(S)=\left\{F_{1}, \ldots, F_{m}\right\}, \quad G_{i}=G\left(F_{i}\right)
$$

Тогда $m=2$, вершины а и $b$ несмежны и части $\operatorname{Part}(S)$ можно занумеровать так, что графы $G_{1}+a b$ и $G_{2} \# a b-k$-критические.

Доказательство. 1. Пусть $U_{i}=F_{i} \backslash S-$ компонента связности графа $G-S$, тогда $M_{i}=V(G) \backslash U_{i}-$ объединение вершин всех частей $\operatorname{Part}(S)$, кроме $F_{i}$. Положим $G_{i}^{\prime}=G\left(M_{i}\right)$.

Так как $G-k$-критический граф, то его собственный подграф $G_{i}^{\prime}$ имеет правильную раскраску в $k-1$ цвет. Пусть $\rho_{i}^{\prime}$ - такая раскраска. Назовем раскраску $\rho_{i}^{\prime}$ раскраской типа 1 , если $\rho_{i}^{\prime}(a)=\rho_{i}^{\prime}(b)$ и раскраской типа 2 , если $\rho_{i}^{\prime}(a) \neq \rho_{i}^{\prime}(b)$.

Пусть для некоторых различных $i, j$ существуют правильные раскраски одного типа $\rho_{i}^{\prime}$ графа $G_{i}^{\prime}$ и $\rho_{j}^{\prime}$ графа $G_{j}^{\prime}$. Рассмотрим случай, когда

это раскраски типа 1. Можно пронумеровать цвета таким образом, чтобы $\rho_{i}^{\prime}(a)=\rho_{i}^{\prime}(b)=\rho_{j}^{\prime}(a)=\rho_{j}^{\prime}(b)=1$. Теперь рассмотрим раскраску $\rho$ вершин графа $G$ :

$$
\rho(v)=\rho_{i}^{\prime}(v) \text { при } v \in M_{i}, \quad \rho(v)=\rho_{j}^{\prime}(v) \text { при } v \in F_{i} .
$$

Отметим, что $M_{i} \cap F_{i}=S, M_{i} \cup F_{i}=V(G), F_{i} \subset M_{j}$. Поэтому определение раскраски $\rho$ корректно: $\rho_{j}^{\prime}$ определена на $F_{i}$, раскраски $\rho_{i}^{\prime}$ и $\rho_{j}^{\prime}$ согласованы на $\{a, b\}=M_{i} \cap F_{i}$. Из правильности раскрасок $\rho_{i}^{\prime}$ и $\rho_{j}^{\prime}$ и отсутствия ребер между разными компонентами связности графа $G-S$ следует, что $\rho$ - правильная раскраска вершин графа $G$ в $k-1$ цвет, которой не существует по условию леммы. В случае, если раскраски $\rho_{i}^{\prime}$ и $\rho_{j}^{\prime}$ имеют тип 2 , рассуждение аналогично.

Пусть $m \geq 3$. Рассмотрим правильные раскраски $\rho_{i}^{\prime}$ графов $G_{i}^{\prime}$ при $i \in[1 . .3]$. Пусть, скажем, $\rho_{1}^{\prime}$ имеет тип 1 . Тогда $\rho_{2}^{\prime}$ не может иметь тип 1 , следовательно, раскраска $\rho_{2}^{\prime}$ имеет тип 2 . Тогда раскраска $\rho_{3}^{\prime}$ не может иметь ни один из типов, следовательно, $m=2$.
1. Итак, $m=2$. Тогда $G_{1}=G_{2}^{\prime}$ и $G_{2}=G_{1}^{\prime}$. По доказанному выше, у графов $G_{1}$ и $G_{2}$ не может быть правильных раскрасок одного и того же типа. Это означает, что вершины $a$ и $b$ несмежны. Не умаляя общности можно положить, что все правильные раскраски графа $G_{1}$ имеют тип 1 , а все правильные раскраски графа $G_{2}$ имеют тип 2 .

2a. Докажем, что граф $G_{1}^{*}=G_{1}+a b-k$-критический. Во-первых, $G_{1}^{*}-a$ - собственный подграф $G$, следовательно, $\chi\left(G_{1}^{*}-a\right) \leq k-1$, откуда следует, что $\chi\left(G_{1}^{*}\right) \leq k$. Если бы $\chi\left(G_{1}^{*}\right) \leq k-1$, то существовала бы правильная раскраска $\rho_{1}$ вершин графа $G_{1}^{*}$ в $k-1$ цвет, которая была бы правильной раскраской вершин графа $G_{1}$ типа 2 , а таких раскрасок не существует. Полученное противоречие показывает, что $\chi\left(G_{1}^{*}\right)=k$.

Рассмотрим произвольный подграф $H$ графа $G_{1}^{*}$, пусть $W=V(H)$. Предположим, что $\chi(H)=k$. Тогда $H$ не может быть подграфом $G$, следовательно, $W \ni a, b$, граф $H$ содержит ребро $a b$. Построим новый граф $H^{\prime}$ на множестве вершин $W \cup F_{2}$ : рёбрами $H^{\prime}$ будут все ребра графа $G$ на множестве $F_{2}$ и все ребра графа $H$, кроме ребра $a b$. Отметим, что $G_{2}$ - подграф $H^{\prime}$, а $H^{\prime}$ - собственный подграф $G$. Следовательно, существует правильная раскраска $\rho$ вершин графа $H^{\prime}$ в $k-1$ цвет. Поскольку $G_{2}$ - подграф $H^{\prime}$, то $\rho$ индуцирует правильную раскраску вершин $G_{2}$ в $k-1$ цвет, следовательно, эта раскраска имеет тип 2 , то есть, $\rho(a) \neq \rho(b)$. Тогда $\rho$ индуцирует правильную раскраску вершин графа $H=H^{\prime}(W)+a b$. Следовательно, $\chi(H)=k-1$. Таким образом, мы доказали, что $G_{1}+a b-k$-критический граф.

2b. Докажем, что граф $G_{2}^{*}=G_{2} \# a b$ является $k$-критическим. Пусть $w=a \# b$. Тогда $G_{2}^{*}-w-$ собственный подграф $G$, следователь-

но, $\chi\left(G_{2}^{*}-w\right) \leq k-1$, откуда следует $\chi\left(G_{2}^{*}\right) \leq k$. Предположим, что $\chi\left(G_{2}^{*}\right) \leq k-1$. Тогда существует правильная раскраска $\rho_{2}$ вершин графа $G_{2}^{*}$ в $k-1$ цвет. Рассмотрим следующую раскраску $\rho_{2}^{\prime}$ вершин графа $G_{2}$ :

$$
\rho_{2}^{\prime}(a)=\rho_{2}^{\prime}(b)=\rho_{2}(w) \quad \text { и } \quad \rho_{2}^{\prime}(v)=\rho_{2}(v) \text { при } v \in U_{2}
$$

Легко понять, что $\rho_{2}^{\prime}$ - правильная раскраска вершин $G_{2}$, причем имеющая тип 1 , а таких раскрасок не существует. Полученное противоречие показывает, что $\chi\left(G_{2}^{*}\right)=k$.

Рассмотрим произвольный собственный подграф $H^{*}$ графа $G_{2}^{*}$, пусть $W^{*}=V\left(H^{*}\right)$. Предположим, что $\chi\left(H^{*}\right)=k$. Тогда $H^{*}$ не может быть подграфом $G$, следовательно, $W^{*} \ni w$ (см. рисунок 4.3a). Определим инъективную функцию

$$
\varphi: E\left(G_{2}^{*}\right) \rightarrow E(G)
$$

следующим образом: для $e=x y \in E\left(G_{2}^{*}\right)$ положим $\varphi(e)=e$, если $x$ и $y$ отличны от $w$. При $x=w$ понятно, что $y \in V(G)$ и хотя бы одно из рёбер $a y, b y$ есть в $E(G)$. Тогда положим $\varphi(e)=a y$, если $a y \in E(G)$ и $\varphi(e)=b y$ в противном случае.

a

b

Рис. 4.3: Графы $H^{*}$ и $H$.
Пусть $W=) W^{*} \backslash\{w\}) \cup S$. Построим подграф $H$ графа $G$ на множестве вершин $W \cup F_{1}$ : рёбрами $H$ будут все ребра графа $G$ на множестве $F_{1}$ и рёбра из $\varphi\left(E\left(H^{*}\right)\right)$ (см. рисунок 4.3 b ). В случае $W^{*} \neq V\left(G_{2}^{*}\right)$ мы имеем $V(H) \neq V(G)$. Если же $W^{*}=V\left(G_{2}^{*}\right)$, то $E\left(H^{*}\right) \subsetneq E\left(G_{2}^{*}\right)$. В этом случае рассмотрим ребро $e \in E\left(G_{2}^{*}\right) \backslash E\left(H^{*}\right)$ : понятно, что $\varphi(e) \notin E(H)$.

Таким образом, в любом из случаев $G_{1}$ - подграф $H$, а $H$ - собственный подграф $G$.

Следовательно, существует правильная раскраска $\rho$ вершин графа $H$ в $k-1$ цвет. Поскольку $G_{1}$ - подграф $H$, то $\rho$ индуцирует правильную раскраску вершин $G_{1}$ в $k-1$ цвет, следовательно, эта раскраска

имеет тип 1 , то есть, $\rho(a)=\rho(b)$. Раскраска $\rho$ индуцирует правильную раскраску вершин графа $H(W)$ в $k-1$ цвет, причем $\rho(a)=\rho(b)$. Следовательно, существует правильная раскраска в $k-1$ цвет вершин графа $H^{*}=H(W) \# a b$, то есть, $\chi\left(H^{*}\right)=k-1$. Таким образом, мы доказали, что $G_{2} \# a b-k$-критический граф.

# 4.3.2 Гипотеза Хайоша, случай $k=4$ 

Теорема 4.2. (G. A. Dirac, 1953.) Если $\chi(G)=4$, то граф $G$ содержит в качестве подграфа подразбиение $K_{4}$.

Доказательство. Достаточно доказать теорему для 4-критических графов. Рассмотрим именно такой граф $G$. Доказательство будет индукцией по количеству вершин в графе.

1. $G$ - трёхсвязный граф.

Этот случай будет базой индукции. Из трёхсвязности графа следует $\delta(G) \geq 3$. По лемме 1.3 в графе $G$ существует простой цикл $Z=a_{1} a_{2} \ldots a_{n}$, $n \geq 4$. Так как граф $G-\left\{a_{1}, a_{3}\right\}$ связен, существует простой путь $P$, соединяющий $a_{2}$ и одну из вершин множества $\left\{a_{4}, \ldots, a_{n}\right\}$, не проходящий через другие вершины цикла. Пусть концы этого пути $a_{2}$ и $a_{m}$. Эти две вершины - несоседние в цикле и делят его на две непустые дуги $B=\left\{a_{3}, \ldots, a_{m-1}\right\}$ и $B^{\prime}=\left\{a_{m+1}, \ldots, a_{1}\right\}$. Так как граф $G-\left\{a_{2}, a_{m}\right\}$ связен, существует $B B^{\prime}$-путь $Q$, не проходящий через $a_{2}$ и $a_{m}$. Пусть $a_{x} \in B$ и $a_{y} \in B^{\prime}$ - концы $Q$. Рассмотрим два случая.
1.1. Пути $P$ и $Q$ не имеют общих вершин.

В этом случае рассмотрим подграф $H$ графа $G$ - объединение цикла $Z$ и путей $P$ и $Q$. Этот граф является подразбиением $K_{4}$, так как каждые две из четырех вершин $a_{2}, a_{x}, a_{m}, a_{y}$ соединены в $H$ путем, причем никакие два из этих путей не имеют общих внутренних вершин (четыре пути это дуги цикла, еще два пути $-P$ и $Q$, см. рисунок 4.4 a).
1.2. Пути $P$ и $Q$ имеют хотя бы одну общую внутреннюю вершину. Пусть $u$ - первая точка пересечения с $Q$ на пути $P$ (от вершины $a_{2}$ ). Тогда рассмотрим подграф $H$, равный объединению цикла $Z$, пути $Q$ и участка $a_{2} P u$. Подграф $H$ является подразбиением $K_{4}$ : каждые две из четырех вершин $a_{2}, a_{x}, a_{m}, u$ соединены в этом графе путём, причем никакие два из этих путей не имеют общих внутренних вершин (наши пути - это $a_{x} Q u, a_{y} Q u, a_{2} P u$ и три дуги цикла $Z$ между $a_{2}, a_{x}$ и $a_{y}$, см. рисунок 4.4 b$)$.



Рис. 4.4: Подразбиение $K_{4}$.
1. Граф $G$ не является трёхсвязным.

Пусть $S$ - минимальное разделяющее множество графа $G$, тогда $|S| \leq 2$. В силу леммы 4.4 мы имеем $S=\{a, b\}$, причем вершины $a$ и $b$ несмежны. По лемме 4.5 тогда $\operatorname{Part}(S)=\left\{F_{1}, F_{2}\right\}, G_{i}=G\left(F_{i}\right)$, причем части можно занумеровать так, что граф $G_{1}^{*}=G_{1}+a b-4$-критический.

По индукционному предположению, в графе $G_{1}^{*}$ есть подграф $H$, являющийся подразбиением $K_{4}$. Если $H$ - подграф $G$, то теорема доказана. Пусть $H$ - не подграф $G$, тогда $H$ содержит ребро $a b$. По замечанию 1.7 граф $G_{2}$ связен, следовательно, существует $a b$-путь $P$ с $\operatorname{Int}(P) \cap V(H)=\varnothing$. Тогда граф $H^{\prime}=H-a b \cup P$ (см. рисунок 4.4 с) тоже является подразбиением $K_{4}$. Остается лишь заметить, что $H^{\prime}-$ подграф $G$.

# 4.4 Конструируемые графы 

Определение 4.3. Пусть $q \in \mathrm{~N}$. Определим класс $q$-конструируемых графов $\mathcal{C}_{q}$ рекурсивно, как класс всех графов, которые могут быть получены из $K_{q}$ с помощью любой последовательности следующих двух операций.
$(H 1)$ Если $G \in \mathcal{C}_{q}, x, y \in V(G), x y \notin E(G)$, то $G \# x y \in \mathcal{C}_{q}$.
$(H 2)$ Пусть $G_{1}, G_{2} \in \mathcal{C}_{q}, V\left(G_{1}\right) \cap V\left(G_{2}\right)=\{x\}, x y_{1} \in E\left(G_{1}\right)$, $x y_{2} \in E\left(G_{2}\right)$. Тогда

$$
\left(G_{1}-x y_{1}\right) \cup\left(G_{2}-x y_{2}\right)+y_{1} y_{2} \in \mathcal{C}_{q}
$$

Последовательность операций может быть пустой, то есть, $K_{q} \in \mathcal{C}_{q}$. Хайош определил эти операции в 1961 году и доказал, что граф $G$ имеет $\chi(G)>q$, если и только если он содежит $q$-коструируемый подграф. Мы оставим лишь элементарную часть доказательства Хайоша, потому что далее докажем гораздо более интересный факт: $\mathcal{C}_{q}$ совпадает при $q \geq 3$ с классом всех графов, имеющих хроматическое число не менее $q$.

Лемма 4.6. (G. Hajós, 1961.) Пусть $q \in \mathrm{~N}$, а граф $G$ имеет подграф из $\mathcal{C}_{q}$. Тогда $\chi(G) \geq k$.

Доказательство. Достаточно доказать, что $\chi(H) \geq q$ для $H \in \mathcal{C}_{q}$. Докажем это индукцией по построению $H$. База для $H=K_{q}$ очевидна, в индукционном переходе разберём два случая.

1. $H=H^{\prime} \# x y, H^{\prime} \in \mathcal{C}_{q}$.

По индукционому предположению, $\chi\left(H^{\prime}\right) \geq q$. Предположим, что существует правильная раскраска $\rho$ вершин графа $H$ в $q-1$ цвет, пусть $w=x \# y$. Тогда построим раскраску $\rho^{\prime}$ вершин $H^{\prime}$ в $q-1$ цвет: $\rho^{\prime}(x)=$ $\rho^{\prime}(y)=\rho(w)$ и $\rho^{\prime}(v)=\rho(v)$ для $v \in V\left(H^{\prime}\right) \backslash\{x, y\}$. Очевидно, раскраска $\rho^{\prime}$ - правильная, противоречие с $\chi\left(H^{\prime}\right) \geq q$. Значит, $\chi(H) \geq q$.
1. $H_{1}, H_{2} \in \mathcal{C}_{q}, V\left(H_{1}\right) \cap V\left(H_{2}\right)=\{x\}, x y_{1} \in E\left(H_{1}\right), x y_{2} \in E\left(H_{2}\right)$, $H=\left(H_{1}-x y_{1}\right) \cup\left(H_{2}-x y_{2}\right)+y_{1} y_{2}$.
По индукционому предположению, $\chi\left(H_{1}\right) \geq q$ и $\chi\left(H_{2}\right) \geq q$. Предположим, что существует правильная раскраска $\rho$ вершин графа $H$ в $q-1$ цвет. Поскольку $y_{1} y_{2} \in E(H)$, то $\rho\left(y_{1}\right) \neq \rho\left(y_{2}\right)$. Цвета обеих вершин $y_{1}$ и $y_{2}$ не могут совпасть с цветом $x$ и мы можем не умаляя общности предположить, что $\rho\left(y_{1}\right) \neq \rho(x)$. Тогда $\rho$ индуцирует правильную раскраску вершин графа $H_{1}$ в $q-1$ цвет, противоречие с $\chi\left(H_{1}\right) \geq q$. Значит, $\chi(H) \geq q$.

В 1967 году Оре предложил одну, несколько более сложную операцию, заменяющие две операции Хайоша.

Определение 4.4. 1) Определим операцию слияния графов. Пусть $G_{1}$, $G_{2}$ - графы с $V\left(G_{1}\right) \cap V\left(G_{2}\right)=\varnothing$, а множества $W_{1} \subset V\left(G_{1}\right), W_{2} \subset V\left(G_{2}\right)$ таковы, что $\left|W_{1}\right|=\left|W_{2}\right|$ и $\mu: W_{1} \rightarrow W_{2}-$ биекция. Предположим, что $x_{1} y_{1} \in E\left(G_{1}\right), x_{2} y_{2} \in E\left(G_{2}\right)$, причем $x_{1} \in W_{1}, \mu\left(x_{1}\right)=x_{2}$ и $\mu\left(y_{1}\right) \neq y_{2}$ (возможно, $y_{1} \notin W_{1}$ ). Слияние графов $G_{1}$ и $G_{2}$ - это граф $G_{1} \#_{\mu, x_{1} y_{1}, x_{2} y_{2}} G_{2}$, полученный из $\left(G_{1}-x_{1} y_{1}\right) \cup\left(G_{2}-x_{2} y_{2}\right)+y_{1} y_{2}$ слиянием пар вершин $v, \mu(v)$ для всех $v \in W_{1}$.
1) Пусть $q \in \mathrm{~N}$. Определим $\mathcal{C}_{q}^{\prime}$ как класс всех графов, которые могут быть получены из $K_{q}$ с помощью любой последовательности операций слияиния графов.

Придуманная Оре операция намного менее наглядна, чем обе операции Хайоша, но зато она всего одна! Несложно заметить, что граф, постренный с помощью операций слияния, можно получить с помощью операций $(H 1)$ и $(H 2)$.

Лемма 4.7. Для любого $q \geq 3$ выполнено $\mathcal{C}_{q}^{\prime} \subset \mathcal{C}_{q}$.
Доказательство. Пусть $G=G_{1} \#_{\mu, x_{1} y_{1}, x_{2} y_{2}} G_{2}$, будем использовать обозначения из определения 4.4. Рассмотрим граф $G^{\prime}=\left(G_{1} \cup G_{2}\right) \# x_{1} x_{2}$. Для каждого $i \in\{1,2\}$ граф $G^{\prime}$ содержит подграф $G_{i}^{\prime}$, изоморфный $G_{i}$ (вершина $x_{i}^{\prime}=x_{1} \# x_{2}$ заменяет $x_{i}$, остальные вершины графа $G_{i}$ есть в $G^{\prime}$ - они вместе с $x_{i}^{\prime}$ индуцируют подграф $\left.G_{i}^{\prime}\right)$.

Тогда $G^{\prime}$ получается из $G_{1}^{\prime}$ и $G_{2}^{\prime}$ операцией $(H 2)$. После этого, граф $G$ получается из $G^{\prime}$ с помощью $\left|W_{1}\right|-1$ операций слияния пар вершин $v, \mu(v)$ для всех $v \in W_{1} \backslash\left\{x_{1}\right\}$ (то есть, с помощью операций (H1)).

Таким образом, операцию слияния графов можно заменить операцией $(H 2)$ и несколькими операциями $(H 1)$. Теперь индукцией по построению любого графа из $\mathcal{C}_{q}^{\prime}$ легко доказывается, что этот граф лежит в $\mathcal{C}_{q}$.

В 1967 году Оре доказал, что любой граф с хроматическим числом не менее $q$ содержит подграф из $\mathcal{C}_{q}^{\prime}$, тем самым усилив результат Хайоша. Несмотря на то, что операция слияния, придуманная Оре, весьма сложна, с одной операцией удобнее работать. В 1997 году Уркхарт доказал, что $\mathcal{C}_{q}=\mathcal{C}_{q}^{\prime}$ и этот класс состоит из графов хроматического числа не менее $k$. В доказательстве использовалась именно операция слияния, а не операции Хайоша. Более того, следующая теорема, доказанная Уркхартом, почти повторяет доказанную на 30 лет раньше Оре, только действия совершаются в другом порядке.

Теорема 4.3. (A. Urquhart, 1997.) Пусть $q \in \mathrm{~N}$. Тогда любой граф $G$ с $\chi(G) \geq q$ может быть получен с помощью операчий слияния из графов, содержащих клики размера не менее $q$.

Доказательство. Пусть утверждение теоремы неверно. Рассмотрим рё-берно-максимальный граф $G$ с $\chi(G)>q$, для которого утверждение не выполнено. Предположим, что существуют такие вершины $x, y, z \in V(G)$, что $x y, y z \notin E(G)$ и $x z \in E(G)$. Пусть $G_{1}$ и $G_{2}$ - копии графов $G+x y$ и $G+y z$, не имеющие общих вершин. Для каждой вершины $v \in V(G)$ будем обозначать через $v_{1}$ и $v_{2}$ её копии в графах $G_{1}$ и $G_{2}$.

В силу максимальности $G$, графы $G_{1}$ и $G_{2}$ могут быть получены из графов с кликовым числом не менее $q$ с помощью операций слияния. Определим биекцию $\mu: V\left(G_{1}\right) \rightarrow V\left(G_{2}\right)$ так: $\mu\left(v_{1}\right)=v_{2}$ для всех $v_{1} \in V\left(G_{1}\right)$. Тогда $G$ изоморфен графу $G_{1} \#_{\mu, y_{1} x_{1}, y_{2} z_{2}} G_{2}$ (слияние с добавлением ребра $x_{1} z_{2}$ ), противоречие.

Значит, наше предположения неверно и для любых $x, y, z \in V(G)$ из $x y, y z \notin E(G)$ следует $x z \notin E(G)$. Это означает, что несмежность -

отношение эквивалентности, то есть $G$ - это полный $n$-дольный граф для некоторого $n$. Понятно, что $G$ содержит клику размера $n$, но не должен содержать клику размера $q$, откуда следует $q>n$. Но тогда $\chi(G)=n<q$, противоречие.

Нам остается доказать, что любой граф кликового числа не менее $q$ может быть построен из графов $K_{q}$ с помощью операций слияния. Мы сделаем это с помощью нескольких вспомогательных графов, не слишком сильно отличающихся от $K_{q}$.

Определение 4.5. 1) Пусть $r \in \mathbb{Z}, 0 \leq r \leq q-1$. Тогда $K_{q}^{r}-$ граф, полученный из $K_{q}$ добавлением одной вершины, смежной с $r$ вершинами исходного графа $K_{q}$. Добавленную вершину назовем особой.
1) Через $K_{q}^{\prime}$ обозначим граф, полученный из $K_{q}$ добавлением двух новых вершин, смежных только друг с другом.

Лемма 4.8. Пусть $0 \leq r \leq q-2$. Тогда $K_{q}^{r} \in \mathcal{C}_{q}^{\prime}$.
Доказательство. Индукция по $r$. Начнем с базы для $r=q-2$.


Рис. 4.5: Слияние двух $K_{5}$ в $K_{5}^{3}$
Пусть $G_{1}$ и $G_{2}$ - две копии $K_{q}$, причем для любой вершины $v \in V\left(K_{q}\right)$ обозначим ее копии через $v_{1} \in V\left(G_{1}\right)$ и $v_{2} \in V\left(G_{2}\right)$. Определим биекцию $\mu: V\left(G_{1}\right) \backslash\left\{y_{1}\right\} \rightarrow V\left(G_{2}\right) \backslash\left\{y_{2}\right\}$ так: $\mu\left(v_{1}\right)=v_{2}$ для всех $v_{1}$. Пусть $x_{1} y_{1}$ и $x_{2} y_{2}$ - соответствующие друг другу рёбра $G_{1}$ и $G_{2}$. Тогда граф $G=G_{1} \#_{\mu, x_{1} y_{1}, x_{2} y_{2}} G_{2}$ изоморфен $K_{q}^{q-2}$ (в графе $G$ ровно $q+1$ вершина, все вершины, кроме $x=x_{1} \# x_{2}$, попарно смежны, а $x$ смежна со всеми вершинами, кроме $y_{1}$ и $y_{2}$, см. рисунок 4.5 ).


Рис. 4.6: Слияние двух $K_{5}^{3}$ в $K_{5}^{2}$

Переход $r \rightarrow r-1$.
Пусть $r>0, G_{1}$ и $G_{2}$ - две копии $K_{q}^{r}$, обозначения соответствующих вершин - как выше. Пусть $x_{1} \in V\left(G_{1}\right)$ и $x_{2} \in V\left(G_{2}\right)$ - особые вершины, $N_{i}=\mathrm{N}_{G_{i}}\left(x_{i}\right)$. Выделим рёбра $x_{1} y_{1} \in E\left(G_{1}\right)$ и $x_{2} z_{2} \in E\left(G_{2}\right)$, пусть $z_{1} \notin N_{1}$ и $y_{2} \notin N_{2}$. Для любой отличной от $y_{1}$ вершины $v_{1} \in N_{1}$ будем считать, что $v_{2} \in N_{2}$.

Биекция $\mu: V\left(G_{1}\right) \rightarrow V\left(G_{2}\right)$ задана правилом $\mu\left(v_{1}\right)=v_{2}$ для всех $v_{1}$. Отметим, что $\mu\left(y_{1}\right)=y_{2} \neq z_{2}$. Докажем, что граф $G=G_{1} \#_{\mu, x_{1} y_{1}, x_{2} z_{2}} G_{2}$ изоморфен $K_{q}^{r-1}$ (см. рисунок 4.6). Действительно, в графе $G$ ровно $q+1$ вершина, все вершины, кроме $x=x_{1} \# x_{2}$, попарно смежны. Вершина $x$ смежна со всеми вершинами вида $v_{1} \# v_{2}$, где $v_{1} \in N_{1} \backslash\left\{y_{1}\right\}$ - то есть, с $r-1$ вершиной.

Лемма 4.9. $K_{q}^{\prime} \in \mathcal{C}_{q}^{\prime}$.


Рис. 4.7: Слияние двух $K_{5}^{3}$ в $K_{5}^{2}$

Доказательство. Пусть $G_{1}$ и $G_{2}$ - две копии $K_{q}^{1}$, обозначения соответствующих вершин как в лемме 4.8. Пусть $x_{1} \in V\left(G_{1}\right)$ и $x_{2} \in V\left(G_{2}\right)$ особые вершины, $x_{1} y_{1} \in E\left(G_{1}\right)$ и $x_{2} y_{2} \in E\left(G_{2}\right)$. На этот раз мы определим биекцию $\mu: V\left(G_{1}\right) \backslash\left\{x_{1}\right\} \rightarrow V\left(G_{2}\right) \backslash\left\{x_{2}\right\}$ : пусть $\mu\left(v_{1}\right)=v_{2}$ для всех $v_{1}$. Докажем, что граф $G=G_{1} \#_{\mu, y_{1} x_{1}, y_{2} x_{2}} G_{2}$ изоморфен $K_{q}^{\prime}$. Действительно, в графе $G$ ровно $q+2$ вершины. Вершины $x_{1}$ и $x_{2}$ смежны только друг с другом, остальные $q$ вершин попарно смежны.

Теорема 4.4. (A. Urquhart, 1997.) Пусть $q \in \mathrm{~N}, q \geq 3$. Тогда $\mathcal{C}_{q}=\mathcal{C}_{q}^{\prime} u$ этот кдасс состоит из всех графов с хроматическим числом не менее $q$.

Доказательство. Пусть $\mathcal{M}_{q}$ - класс всех графов с хроматическим числом не менее $q$. По лемме 4.7 мы имеем $\mathcal{C}_{q}^{\prime} \subset \mathcal{C}_{q}$, а по лемме 4.6 нам известно, что $\mathcal{C}_{q} \subset \mathcal{M}_{q}$.

Остается доказать, что $\mathcal{M}_{q} \subset \mathcal{C}_{q}^{\prime}$. В силу теоремы 4.3 для этого достаточно доказать, что все графы, имеющие подграф $K_{q}$, можно получить из $K_{q}$ с помощью операций слияния. Докажем это по индукцией: приступая к доказательству для графа $G$ будем считать, что утверждение

доказано для всех графов с меньшим числом вершин или с $v(G)$ вершинами и меньшим числом рёбер. База для $G=K_{q}$ очевидна.

Выделим в $G$ подграф $K_{q}$ и назовём выделенными его вершины и дополнительными все не входящие в него рёбра и вершины. Рассмотрим два случая.

1. $G$ имеет дополнительное ребро $e$.

Пусть $G_{1}$ - это копия $G-e, U_{1}$ - множество копий выделенных вершин, а $x_{1} y_{1}$ - копия дополнительного ребра $e$, причем $x_{1} \notin U_{1}$. Пусть $G_{2}-$ это граф $K_{q}^{\prime}$ (при $y_{1} \notin U_{1}$ ) или $K_{q}^{1}$ (при $y_{1} \in U_{1}$ ), $U_{2}$ - клика размера $q$ в $G_{2}$, а $x_{2} y_{2}$ - добавленное ребро, причем $x_{2} \notin U_{2}$. Как всегда, для каждой вершины $v_{1} \in U_{1}$ мы будем обозначать через $v_{2}$ соответствующую вершину из $U_{2}$.

Рассмотрим вершины $s_{1}, t_{1} \in U_{1}$ и $s_{2}, p_{2} \in U_{2}$, причем $p_{2} \notin\left\{t_{2}, y_{2}\right\}$, $t_{1} \notin\left\{p_{1}, y_{1}\right\}$ (это возможно при $q \geq 3$ ). Определим биекцию

$$
\mu:\left(U_{1} \cup\left\{x_{1}, y_{1}\right\}\right) \rightarrow\left(U_{2} \cup\left\{x_{2}, y_{2}\right\}\right)
$$

заданную правилом $\mu\left(v_{1}\right)=v_{2}$ для всех $v_{1}$.


Рис. 4.8: Добавление ребра
Докажем, что граф $G^{\prime}=G_{1} \#_{\mu, s_{1} t_{1}, s_{2} p_{2}} G_{2}$ изоморфен $G$ (см. рисунок 4.8). Действительно, пусть $v=v_{1} \# v_{2}$ для каждой пары соответствующих вершин $v_{1}, v_{2}$. В графе $G^{\prime}$ добавилось ребро $x y$, которое и нужно было добавить. Так как $\mu\left(t_{1}\right) \neq p_{2}$, в результате всех склеек вместо $U_{1}$ в графе $G^{\prime}$ получится такая же клика размера $q$ (клика $U_{1}$ склелась с кликой $U_{2}$, вершины $t=t_{1} \# t_{2}$ и $p=p_{1} \# p_{2}$ смежны со всеми остальными вершинами полученной клики). Таким образом, к графу $G_{1}$ просто добавилось нужное ребро и получился граф $G^{\prime}$, изоморфный $G$.
1. $G$ не имеет дополнительных ребер.

Тогда $G$ состоит из клики размера $q$ и нескольких изолированных вершин, пусть $w$ - одна из них. Пусть $G_{1}$ - это копия $G-w$, а $U_{1}-$ множество копий выделенных вершин. Пусть $G_{2}$ - копия графа $K_{q}^{0}, U_{2}$ - клика из $q$ вершин в $G_{2}$, а $x$ - добавленная вершина. Как всегда, для каждой вершины $v_{1} \in U_{1}$ мы будем обозначать через $v_{2}$ соответствующую вершину из $U_{2}$.

Рассмотрим вершины $s_{1}, t_{1} \in U_{1}$ и $s_{2}, p_{2} \in U_{2}$, причем $p_{2} \neq t_{2}, t_{1} \neq p_{1}$ (это возможно при $q \geq 3$ ). Определим биекцию $\mu: U_{1} \rightarrow U_{2}$, заданную правилом $\mu\left(v_{1}\right)=v_{2}$ для всех $v_{1}$.

Тогда граф $G^{\prime}=G_{1} \#_{\mu, s_{1} t_{1}, s_{2} p_{2}} G_{2}$ изоморфен $G$ (как и в предыдущем пункте, сохранилась клика размера $q$, на этот раз добавилась вершина $x$ ).

# 4.5 Обхват и хроматическое число 

Определение 4.6. Кликовое число графа $G$ (обозначение: $\omega(G)$ ) - это количество вершин в наибольшей клике (то есть, полном подграфе) этого графа.

Очевидно, $\chi(G) \geq \omega(G)$. Самый простой и естественный способ построить граф с большим хроматическим числом - поместить в граф клику большого размера. Однако, совершенно не обязательно граф с большим хроматическим числом должен обладать большой кликой. Сначала мы приведём серию примеров графов без треугольников произвольного хроматического числа - конструкцию Мычильски. Потом с помощью подсчёта мы докажем теорему Эрдеша о существовании графа сколь угодно большого обхвата и при этом сколь угодно большого хроматического числа. Отметим, что конструктивное доказательство теоремы Эрдеша было впервые получено в 1968 году, когда Ловас сконструировал графы сколь угодно большого обхвата и хроматического числа.

Теорема 4.5. Для любого $k \in \mathrm{~N}$ существует граф $G$ удовлетворяюший условиям $\chi(G)=k, g(G) \geq 4$.
Доказательство. (J. Mycielski, 1955.) Для $k=1$ и $k=2$ подойдут полные графы $K_{1}$ и $K_{2}$. Стартуя от графа $G_{2}=K_{2}$, мы построим серию примеров графов $G_{3}, G_{4}, \ldots$ без треугольников с $\chi\left(G_{k}\right)=k$.

Пусть построен граф $G_{k}$, причём $V\left(G_{k}\right)=\left\{u_{1}, \ldots, u_{n}\right\}$. Этот граф будет частью графа $G_{k+1}$, в котором будут добавлены вершины $v_{1}, \ldots, v_{n}, w$. Рёбра между новыми вершинами проведёми так: $v_{i}$ будет смежна со всеми вершинами из $\mathrm{N}_{G_{k}}\left(u_{i}\right)$ и только с ними, а $w$ - со всеми вершинами $v_{1}, \ldots, v_{n}$ и только с ними (см. рисунок 4.9). Понятно, что треугольников в графе $G_{k+1}$ нет.

Заметим, что $\chi\left(G_{k+1}\right) \leq k+1$ : если $\rho-$ правильная раскраска вершин $G_{k}$ в $k$ цветов, то можно продолжить её на $G_{k+1}$, , использовав только один дополнительный цвет: положим $\rho\left(v_{i}\right)=\rho\left(u_{i}\right), \rho(w)=k+1$.

Предположим, что $\chi\left(G_{k+1}\right) \leq k$ и рассмотрим правильную раскраску $\rho$ вершин графа $G_{k+1}$ в $k$ цветов. Не умаляя общности, предположим,



Рис. 4.9: Граф $G_{k+1}$.

что $\rho(w)=k$. Мы построим новую правильную раскраску $\rho^{\prime}$ вершин графа $G_{k}$ в $k-1$ цвет и, тем самым, придём к противоречию. Для каждой вершины $u_{i}$ мы положим $\rho^{\prime}\left(u_{i}\right)=\rho\left(u_{i}\right)$, если $\rho\left(u_{i}\right) \neq k$ и $\rho^{\prime}\left(u_{i}\right)=\rho\left(v_{i}\right)$, если $\rho\left(u_{i}\right)=k$. Так как вершины $v_{1}, \ldots, v_{n}$ смежны с вершиной $w$ цвета $k$, то их цвета отличны от $k$, следовательно, $\rho^{\prime}: V\left(G_{k}\right) \rightarrow[1 . . k-1]$.

Докажем правильность раскраски $\rho^{\prime}$. Предположим противное, пусть $\rho^{\prime}\left(u_{i}\right)=\rho^{\prime}\left(u_{j}\right)$, вершины $u_{i}$ и $u_{j}$ смежны. Очевидно, хотя бы одна из них перекрашена, пусть это $u_{i}$, тогда $\rho^{\prime}\left(u_{i}\right)=\rho\left(v_{i}\right)$. Мы перекрашивали только вершины, имеющие цвет $k$ в раскраске $\rho$, среди них не было смежных, следовательно, $\rho^{\prime}\left(u_{j}\right)=\rho\left(u_{j}\right)$. По построению, из $u_{j} \in \mathrm{~N}_{G_{k}}\left(u_{i}\right)$ следует $u_{j} \in \mathrm{~N}_{G_{k}}\left(v_{i}\right)$ и мы можем сделать вывод $\rho^{\prime}\left(u_{i}\right)=\rho\left(v_{i}\right) \neq \rho\left(u_{j}\right)=\rho^{\prime}\left(u_{j}\right)$, противоречие с предположением. Таким образом, $\rho^{\prime}$ - правильная раскраска, что невозможно по индукционному предположению. Это означает, что $\chi\left(G_{k+1}\right)=k+1$.

Теорему Эрдеша мы докажем с помощью подсчёта, поскольку это проще, чем все известные на настоящий момент конструкции графов со сколь угодно большим обхватом и одновременно сколь угодно большим хроматическим числом. Традиционно приводят вероятностное доказачество этой теоремы, мы же просто оценим все нужные величины.

Теорема 4.6. (P. Erdös, 1959). Пусть $k, g \in \mathbb{N}, k, g \geq 3$. Тогда существует граф $G$ с $g(G) \geq g u \chi(G) \geq k$.
Доказательство. Пусть $n \geq(2 \delta)^{g}$. Мы рассмотрим множество $\mathcal{G}$ всех графов $G$ на множестве вершин $V=\{1,2, \ldots, n\}$ с $e(G)=\delta n$. Мы не будем "экономить": параметр $\delta$ позже будет выбран настолько большим, чтобы все оценки проходили без лишних трудностей.

1. Сначала мы оценим среднее количество $A$ "коротких циклов" (длины не более $g-1$ ) в графах из $\mathcal{G}$.

На вершинах множества $V$ существует $C_{n}^{\ell} \cdot \frac{(\ell-1)!}{2}<\frac{n^{\ell}}{2 \ell}$ циклов фиксированной длины $\ell$. Пусть $m=\frac{n \cdot(n-1)}{2}$. Данный цикл длины $\ell$ есть в $C_{m-\ell}^{\delta n-\ell}$

графах множества $\mathcal{G}$. Оценим сверху среднее количество циклов длины не более $g-1$ в графах множества $\mathcal{G}$ :

$$
A<\left(\sum_{\ell=3}^{g-1} \frac{n^{\ell}}{2 \ell} \cdot \mathrm{C}_{m-\ell}^{\delta n-\ell}\right) \cdot\left(\mathrm{C}_{m}^{\delta n}\right)^{-1}
$$

Оценим отдельно каждое слагаемое:

$$
\begin{gathered}
B_{\ell}=\frac{n^{\ell}}{2 \ell} \cdot \frac{\mathrm{C}_{m-\ell}^{\delta n-\ell}}{\mathrm{C}_{m}^{\delta n}}=\frac{n^{\ell}}{2 \ell} \cdot \frac{(m-\ell)!(\delta n)!}{(m)!(\delta n-\ell)!}= \\
=\frac{n^{\ell}}{2 \ell} \cdot \frac{\delta n}{m} \cdot \frac{\delta n-1}{m-1} \cdot \cdots \cdot \frac{\delta n-\ell+1}{m-\ell+1}<\frac{1}{2 \ell}\left(\frac{\delta n^{2}}{m}\right)^{\ell}
\end{gathered}
$$

так как при $0<i<n$ выполняется неравенство $\frac{\delta n}{m}>\frac{\delta n-i}{m-i}$ (вспомним, что $\left.m=\frac{n \cdot(n-1)}{2}>\delta n\right)$. В силу $\ell<g$ мы имеем $n-1 \geq(2 \delta)^{g}-1>2^{\ell}-1$. Продолжим оценку:

$$
\begin{aligned}
B_{\ell}<\frac{1}{2 \ell}\left(\frac{\delta n^{2}}{m}\right)^{\ell}= & \frac{(2 \delta)^{\ell}}{2 \ell} \cdot\left(1+\frac{1}{n-1}\right)^{\ell}<\frac{(2 \delta)^{\ell}}{2 \ell} \cdot\left(1+\frac{2^{\ell}-1}{n-1}\right)< \\
& <\frac{(2 \delta)^{\ell}}{2 \ell} \cdot 2=\frac{(2 \delta)^{\ell}}{\ell} \leq \frac{(2 \delta)^{\ell}}{3}
\end{aligned}
$$

Теперь вернемся к оценке сверху среднего количества циклов длины не более $g-1$ в графах семейства $\mathcal{G}$ :

$$
A=\sum_{\ell=3}^{g-1} B_{\ell}<\frac{1}{3} \sum_{\ell=3}^{g-1}(2 \delta)^{\ell}<\frac{1}{3 \cdot(2 \delta-1)}(2 \delta)^{g}<\frac{n}{6 \delta-3}
$$

1. Теперь оценим долю q графов, содержащих "большое" независимое множество (размера $\frac{n}{c}$ ), среди графов из $\mathcal{G}$, где с - достаточно большое число.

Для удобства будем считать, что $\frac{n}{c}=p \in \mathbb{N}$. Количество способов выбрать независимое множество размера $p$ равно $\mathrm{C}_{n}^{p}<2^{n}$. Пусть $t=\mathrm{C}_{p}^{2}$, тогда в каждом графе, содержащем большое независимое множество $t$ пар вершин этого множества не могут быть соединены рёбрами. Следовательно,

$$
q \leq \mathrm{C}_{n}^{p} \cdot \frac{\mathrm{C}_{m-t}^{\delta n}}{\mathrm{C}_{m}^{\delta n}}<2^{n} \cdot \prod_{i=0}^{\delta n-1} \frac{m-t-i}{m-i}<2^{n} \cdot\left(\frac{m-t}{m}\right)^{\delta n}=2^{n} \cdot\left(1-\frac{t}{m}\right)^{\delta n}
$$

Отметим, что $\frac{t}{m}=\frac{\frac{n^{2}}{n^{2}}-\frac{n}{n^{2}-n}}{n^{2}-n}>\frac{1}{2 c^{2}}$. Подставив это неравенство в (4.3) мы получим

$$
q<\left(2 \cdot\left(1-\frac{1}{2 c^{2}}\right)^{\delta}\right)^{n}<\frac{1}{2}
$$

для любого $c>0$ при достаточно больших $n$ и $\delta$.
1. Перейдём непосредственно к доказательству теоремы. Рассмотрим достаточно большие $c, \delta$ и $n$. В силу неравенства (4.2), среднее количество коротких циклов в графе из $\mathcal{G}$ меньше $\frac{n}{6}$. Следовательно, менее чем в половине графов из $\mathcal{G}$ количество коротких циклов превосходит $\frac{n}{3}$. Также менее чем в половине графов из $\mathcal{G}$ есть большое независимое множество. Следовательно, существует граф $G \in \mathcal{G}$ с $\alpha(G)<\frac{n}{c}$ и количеством коротких циклов не более $\frac{n}{3}$. Удалив из каждого короткого цикла по вершине, мы получим граф $G^{\prime}$ с $g\left(G^{\prime}\right) \geq g, v\left(G^{\prime}\right) \geq \frac{2 n}{3}$ и $\alpha\left(G^{\prime}\right)<\frac{n}{c}$. По лемме 4.2 мы имеем

$$
\chi\left(G^{\prime}\right) \geq \frac{v\left(G^{\prime}\right)}{\alpha\left(G^{\prime}\right)}>\frac{2 c}{3}>k
$$

при достаточно большом $c$.

# 4.6 Совершенные графы 

Как видно из предыдущего раздела, большое хроматическое число в графе может получаться несмотря на отсутствие больших клик. Однако, важное место в теории графов занимают графы, для которых хроматическое и кликовое число равны.

Определение 4.7. Граф $G$ называется совершенным, если для любого его индуцированного подграфа $H$ выполняется условие $\chi(H)=\omega(H)$.

Простейшим примером совершенных графов (не считая, разумеется, полных графов) являются двудольные графы. Отметим, что любой индуцированный подграф совершенного графа также совершенен.

Задача 4.1. Докажите, не используя последующих теорем, что если $G-$ двудольный, то $\bar{G}$ - совершенный граф.

В 1963 году Берж высказал две гипотезы о том, как устроены совершенные графы.

Слабая гипотеза Бержа. Граф $G$ совершенен тогда и только тогда, когда граф $\bar{G}$ совершенен.

Сильная гипотеза Бержа. Граф $G$ совершенен тогда и только тогда, когда ни $G$, ни $\bar{G}$ не содержат нечётного цикла длины более 3 в качестве индуцированного подграфа.
Первая гипотеза была доказана в 1972 г., это сделал Л. Ловас. Доказательство с использованием линейной алгебры, которое мы приведём ниже, значительно проще первоначального доказательства. Вторая гипотеза была доказана только в 2002 году, доказательство весьма сложное и техническое, поэтому мы вместо этого фундаментального результата приведём несколько более слабую теорему Галлаи.
Теорема 4.7. (L. Lovász, 1972.) Граф $G$ совершенен тогда и только тогда, когда для любого его индуцированного подграфа $G^{\prime}$ выполняется

$$
\omega\left(G^{\prime}\right) \omega\left(\bar{G}^{\prime}\right)=\alpha\left(G^{\prime}\right) \omega\left(G^{\prime}\right) \geq v\left(G^{\prime}\right)
$$

Следствие 4.1. Граф $G$ совершенен тогда и только тогда, когда граф $\bar{G}$ совершенен.
Доказательство. (G. Gasparian, 1996.) Следствие очевидно, так как теорема 4.7 даёт критерий совершенности графа, одинаковый для графа и его дополнения. Приступим к доказательству теоремы.
$\Rightarrow$. Если граф совершенен, то для любого его индуцированного подграфа $G^{\prime}$ в силу его совершенности и леммы 4.2 мы имеем $\omega\left(G^{\prime}\right)=$ $\chi\left(G^{\prime}\right) \geq \frac{v\left(G^{\prime}\right)}{\alpha\left(G^{\prime}\right)}$, откуда умножением на $\alpha\left(G^{\prime}\right)$ получаем то, что нужно.
$\Leftarrow$. Докажем обратную импликацию индукцией по $v(G)$. База $v(G)=1$ очевидна, сосредоточимся на переходе. Итак, рассмотрим наш граф $G$, удовлетворяющий условию (4.4). По индукционному предположению, для любой вершины $u \in V(G)$ граф $G-u$ совершенен. Пусть $\alpha=\alpha(G)$, $\omega=\omega(G)$. Тогда для любой вершины $u \in V(G)$ выполняется условие

$$
\chi(G-u)=\omega(G-u) \leq \omega
$$

Предположим, что граф $G$ не совершенен, то есть, $\chi(G)>\omega(G)$. Пусть $A_{0}=\left\{u_{0}, \ldots, u_{\alpha-1}\right\}-$ независимое множество в графе $G$. Ввиду условия (4.5) существует правильная раскраска вершин $G-u_{i}$ в $\omega$ цветов, тогда $V\left(G-u_{i}\right)$ можно разбить на $\omega$ независимых множеств: $A_{i \omega+1}, \ldots, A_{(i+1) \omega}$. Итого мы имеем $\alpha \omega+1$ независимых множеств: $A_{0}, A_{1}, \ldots, A_{\alpha \omega}$.

Пусть $i \in[0 . . \alpha \omega]$. Если $\chi\left(G-A_{i}\right) \leq \omega-1$, то из независимости множества $A_{i}$ мы получаем $\chi(G) \leq \chi\left(G-A_{i}\right)+1 \leq \omega$, что противоречит предположению. Тогда $\omega\left(G-A_{i}\right)=\chi\left(G-A_{i}\right) \geq \omega$, следовательно, существует клика размера $\omega$ в графе $G-A_{i}$, обозначим множество ее вершин через $C_{i}$. Таким образом, у нас есть клики $C_{0}, \ldots, C_{\alpha \omega}$. Докажем вспомогательный факт.

Пусть $C$ - множество вершин клики размера $\omega$ в графе $G$. Тогда $C$ пересекает все множества $A_{0}, \ldots, A_{\alpha \omega}$, кроме одного.

Доказательство. Рассмотрим разбиение вершин графа $G$ на $\omega+1$ независимых множеств $\left\{\left\{u_{i}\right\}, A_{i \omega+1}, \ldots, A_{(i+1) \omega}\right\}$. Так как $C$ может пересекать независимое множество лишь по одной вершине, $C$ пересекает все эти множества, кроме одного. Значит, $C$ либо пересекает все множества $A_{i \omega+1}, \ldots, A_{(i+1) \omega}$, либо все эти множества, кроме одного и при этом $C \ni u_{i}$. Поскольку $\left|C \cap A_{0}\right| \leq 1$, то $C$ содержит не более, чем одну из вершин $u_{0}, \ldots, u_{\alpha-1}$. Тогда либо $\left|C \cap A_{0}\right|=1$ и $C$ пересекает все множества $A_{1}, \ldots, A_{\alpha \omega}$, кроме одного, либо $C \cap A_{0}=\varnothing$ и $C$ пересекает все множества $A_{1}, \ldots, A_{\alpha \omega}$.

Пусть $M$ - матрица размера $(\alpha \omega+1) \times(\alpha \omega+1)$, заданная равенством $m_{i, j}=\left|A_{i} \cap C_{j}\right|$ (индексы пробегают значения из $[0 . . \alpha \omega]$ ). Понятно, что $m_{i, j} \in\{0,1\}$, по построению $m_{i, i}=0$. Тогда по доказанному выше $m_{i j}=1$ при $i \neq j$. Таким образом, матрица $M$ имеет нули на главной диагонали и единицы на всех остальных позициях.

Пусть $V(G)=\left\{v_{1}, \ldots, v_{n}\right\}$. Рассмотрим матрицу $A$ размера $(\alpha \omega+1) \times n$, в которой $a_{i j}=1$ при $A_{i} \ni v_{j}$ и $a_{i j}=0$ при $A_{i} \not \ni v_{j}$. Рассмотрим матрицу $B$ размера $n \times(\alpha \omega+1)$, в которой $b_{j \ell}=1$ при $v_{j} \in C_{\ell}$ и $b_{j \ell}=0$ при $v_{j} \notin C_{\ell}$. Легко видеть, что $A \cdot B=M$. Матрица $M$, очевидно, невырождена, следовательно, её ранг $\operatorname{rk}(M)=\alpha \omega+1$. Так как $\operatorname{rk}(M) \leq \min (\operatorname{rk}(A), \operatorname{rk}(B))$, мы имеем $v(G)=n \geq \operatorname{rk}(A) \geq \alpha \omega+1$, что противоречит неравенству (4.4), а значит, и условию теоремы.

Определение 4.8. Пусть $C$ - простой цикл длины более 3 в графе $G$. Будем говорить, что цикл $C$ триангулируем, если в графе $G$ есть $v(C)-3$ диагонали этого цикла, разбивающие его на треугольники.

В 1958 году было доказано (A. Hajnal, J. Surányi), что граф, каждый цикл которого триангулируем (или, что равносильно, каждый цикл длины больше 3 в котором имеет хотя бы одну диагональ) является совершенным (в задаче ?? читателю предлагается повторить это доказательство). Такие графы называются хордальными (chordal graphs). Избыточность этого условия очевидна: совершенности графа ничем не мешают нетриангулируемые чётные циклы. В 1962 году Галлаи доказал, что граф, в котором каждый нечётный цикл триангулируем, совершенен. Эта теорема является еще одним шагом в направлении сильной гипотезы Бержа, тогда еще не доказанной. Мы приведём теорему с доказательством по мотивам более поздней работы J. Surányi.

Теорема 4.8. (T. Gallai, 1962.) Если каждый нечётный иикл в графе $G$ триангулируем, то $\chi(\bar{G})=\alpha(G)=\omega(\bar{G})$.

Доказательство. Докажем теорему по индукции. База для графов без циклов очевидна, приступим к индукционному переходу.

Итак, пусть для меньшего чем $G$ графа утверждение теоремы доказано, а для $G$ - неверно. Тогда $\chi(\bar{G})>\alpha(G)=q$. Рассмотрим множество $A=\left\{a_{1}, \ldots, a_{q}\right\}$ из $q$ независимых вершин графа $G$. Нашей целью будет построить в графе $G$ большее независимое множество и прийти к противоречию с $\alpha(G)=q$.

Пусть $b_{0} \notin A$, тогда в графе $G-b_{0}$ любой нечётный цикл триангулируем, множество $A$ - клика в $\bar{G}-b_{0}$ и по индукционному предположению оказывается, что $\chi\left(\bar{G}-b_{0}\right)=q$. Тогда множество $\mathcal{P}_{0}$ разбиений вершин графа $G-b_{0}$ на $q$ клик непусто. Для каждого разбиения $R=\left(R_{1}, \ldots, R_{q}\right) \in \mathcal{P}_{0}$ ровно по одной вершине независимого множества $A$ лежит в каждой из клик разбиения $R$, поэтому мы будем нумеровать клики разбиения $R$ так, чтобы $a_{i} \in R_{i}$. Для любого разбиения $R \in \mathcal{P}_{0}$ мы будем считать $R_{0}=\left\{b_{0}\right\}$.

# Ранги. Построение. 

Мы будем постепенно сужать круг рассматриваемых разбиений из $\mathcal{P}_{0}$ и присваивать ранги индексам из $[1 . . q]$. Множество индексов ранга $k$ мы будем обозначать через $I_{k}$. Пусть $J_{k}=[1 . . q] \backslash \cup_{i=1}^{k} I_{k}$. Такой же ранг, как индексам, мы будем присваивать соответствующим вершинам множества $A$ и содержащим их кликам рассматриваемых разбиений из $\mathcal{P}_{0}$.

Изначально положим $I_{0}=\{0\}$. Пусть построены ранги $I_{1}, I_{2}, \ldots, I_{k}$, множества разбиений $\mathcal{P}_{k} \subset \cdots \subset \mathcal{P}_{1} \subset \mathcal{P}_{0}$ так, что для любых $\ell \in[1 . . k]$ и $i \in I_{\ell}$ выполняются следующие условия.
$(R 1)$ У индекса $i$ существует единственный предок $p(i) \in I_{\ell-1}$.
$(R 2)$ Существует такая вершина $b_{i} \in V(G)$, что $b_{i} \in R_{i}$ для любого разбиения $R \in \mathcal{P}_{\ell}$.
$(R 3) a_{i} b_{p(i)} \in E(G), b_{i} b_{p(i)} \notin E(G)$.
$(R 4)$ Пусть $j \in J_{\ell}, R \in \mathcal{P}_{\ell}$. Тогда вершина $b_{i}$ не смежна хотя бы с одной вершиной из $R_{j}$.

По очереди рассмотрим все индексы из $I_{k}$ и для каждого $i \in I_{k}$ поместим в $I_{k+1}$ все такие индексы $j$, что $a_{j}$ смежна с $b_{i}$ (в этом случае положим $p(j)=i)$.

Зафиксируем произвольное разбиение $P \in \mathcal{P}_{k}$, для которого минимальна $\sum_{j \in I_{k+1}}\left|P_{j}\right|$ (пусть эта сумма равна $s_{k+1}$ ). Для каждого $j \in I_{k+1}$ в клике $P_{j}$ отметим такую вершину $b_{j}$, что $b_{p(j)} b_{j} \notin E(G)$. (При $k>1$ такая вершина существует в силу $(R 4)$. Если $k=1$ и такой вершины нет,



Рис. 4.10: Построение рангов.

то вершину $b_{0}$ можно добавить в клику $P_{j}$, тем самым получив правильную раскраску вершин графа $\bar{G}$ в $q$ цветов, которой по предположению не существует.)

Пусть $\mathcal{P}_{k+1}$ - множество из всех разбиений $R \in \mathcal{P}_{k}$, в которых $\sum_{i \in I_{k+1}}\left|R_{j}\right|=s_{k+1}$ и $b_{i} \in R_{i}$ для любого индекса $i \in I_{k+1}$. (Такие разбиения существуют: например, $P$.)

Пусть $i \in I_{k+1}$. Так как $\mathcal{P}_{k+1} \subset \mathcal{P}_{k}$, по построению, для индекса $i$ выполняются условия $(R 1)-(R 3)$. Остаётся проверить (R4). Предположим, что $j \in J_{k+1}, R \in \mathcal{P}_{k+1}$ и вершина $b_{i}$ смежна со всеми вершинами клики $R_{j}$. Тогда перекинем вершину $b_{i}$ в $R_{j}$ и получим новое разбиение $R^{\prime} \in \mathcal{P}_{k}$, в котором $\sum_{j \in I_{k+1}}\left|R_{j}^{\prime}\right|=s_{k+1}-1$, что невозможно.

# Множество $B^{\prime}$. 

Процесс построения закончится ввиду конечности графа. Пусть построены ранги $I_{1}, \ldots, I_{k}$,

$$
I=\bigcup_{i=1}^{k} I_{k}, \quad B^{\prime}=\left\{b_{i}: i \in I\right\}, \quad A^{\prime}=\left\{a_{i}: i \in I\right\}
$$

Докажем два утверждения.

1) Если $a_{j} \in A \backslash A^{\prime}, b_{i} \in B^{\prime}$, то $b_{i} a_{j} \notin E(G)$.
2) Множество вершин $B^{\prime}$ независимо в графе $G$.

Доказательство. 1) Если $b_{i} a_{j} \in E(G)$, можно продолжить процесс построения, определив ранг индекса $j$.
1) Если $i, j \in I$ и $i=p(j)$, то будем называть $j$ потомком $i$. Пусть $x, y \in I$, вершины $b_{x}$ и $b_{y}$ смежны. По построению рангов, существует такой индекс $i_{0}=j_{0} \in I$, что в последовательностях индексов $i_{0} \ldots, i_{n}=x$ $j_{0}, \ldots, j_{m}=y$ каждый следующий индекс является потомком предыдущего и все эти индексы различны. Отметим, что для любого $i \in I$ и $R \in \mathcal{P}_{k}$ мы имеем $a_{i}, b_{i} \in R_{i}$, следовательно, $a_{i} b_{i} \in E(G)$. Тогда в графе $G$ существует нечётный простой цикл

$$
Z=b_{i_{0}} a_{i_{1}} b_{i_{1}} \ldots a_{i_{n}} b_{i_{n}} b_{j_{m}} a_{j_{m}} \ldots b_{j_{1}} a_{j_{1}}
$$



Рис. 4.11: Цикл $Z$ и его короткие диагонали.
(см. рисунок 4.11a). По свойству ( $R 4$ ) понятно, что ни один из индексов $x$ и $y$ не может быть предком другого, поэтому $v(Z)>3$. Цикл $Z$ по условию теоремы триангулируем, рассмотрим его произвольную триангуляцию. В ней, как известно, есть хотя бы две "короткие" диагонали, соединяющие вершины через одну. Однако, $A$ - независимое множество в $G$, а $b_{i} b_{p(i)} \notin E(G)$ по условию $(R 3)$, поэтому единственными кандидатами в короткие диагонали являются $a_{i_{n}} b_{j_{m}}$ и $a_{i_{m}} b_{j_{n}}$. Их две, но они "пересекаются" (см. рисунок 4.11 b ) и не могут принадлежать одной триангуляции. Значит, триангуляция цикла невозможна - противоречие, доказывающее независимость $B^{\prime}$.

Остаётся заметить, что множество $\left(A \backslash A^{\prime}\right) \cup B^{\prime}$ независимо ввиду утверждений 1 и 2 и состоит из $q+1$ вершины. Противоречие с $\alpha(G)=q$ завершает доказательство теоремы.

Следствие 4.2. Если каждый нечётный цикл в графе $G$ триангулируем, то графы $G$ и $\bar{G}$ совершенны.

Доказательство. Если каждый нечетный цикл в графе $G$ триангулируем, то это же верно и для любого его индуцированного подграфа $G^{\prime}$, а значит, по теореме 4.8 мы имеем $\chi\left(\bar{G}^{\prime}\right)=\omega\left(\bar{G}^{\prime}\right)$. Так как индуцированные подграфы $\bar{G}$ как раз имеют вид $\bar{G}^{\prime}$ (где $G^{\prime}$ - индукцированный подграф $G$ ), граф $\bar{G}$ совершенен. По следствию 4.1 и граф $G$ совершенен.

# 4.7 Раскраски рёбер 

Определение 4.9. 1) Раскраской рёбер графа $G$ в $k$ цветов называется функция $\rho: E(G) \rightarrow M$, где $|M|=k$. Обычно мы будем использовать

для обозначения $k$ цветов в раскраске числа от 1 до $k$ : в случаях, когда $M \neq[1 . . k]$, об этом будет сказано.
1) Любая раскраска $\rho$ ребер графа $G$ в цвета $[1 . . k]$ - это разбиение множества $E(G)$ в объединение непересекающихся множеств $E_{1}, \ldots, E_{k}$, где $\rho$ принимает значение $i$ на рёбрах множества $E_{i}$.

Графы, рассматриваемые в этом разделе могут иметь кратные рёбра, но не имеют петель. В отличие от раскрасок вершин, при рассмотрении раскрасок рёбер кратные рёбра играют существенную роль.

Определение 4.10. 1) Раскраска $\rho$ называется правильной, если $\rho(e) \neq \rho\left(e^{\prime}\right)$ для любой пары смежных рёбер $e$ и $e^{\prime}$.

Через $\chi^{\prime}(G)$ обозначим реберное хроматическое число или хроматический индекс графа $G$ - наименьшее натуральное число, для которого существует правильная раскраска рёбер графа $G$ в такое количество цветов.
1) Назовем раскраску $\rho$ рёбер графа $G$ покрывающей, если ребра каждого цвета образуют покрытие (то есть, покрывают все вершины).

Через $\kappa^{\prime}(G)$ обозначим покрывающий индекс графа $G$ - наибольшее натуральное число, для которого существует покрывающая раскраска рёбер графа $G$ в такое количество цветов.

Замечание 4.2. 1) В дальнейшем мы покажем, что понятия правильной и покрывающей раскраски в некотором смысле двойственны друг другу. Картина двойственности начнет вырисовываться уже после следующих определений.
1) В англоязычной литературе число $\chi^{\prime}(G)$ называется chromatic index, а число число $\kappa^{\prime}(G)$ называется cover index.

# 4.7.1 Оптимальные раскраски 

Определение 4.11. Пусть $\rho$ - раскраска рёбер графа $G$ в $k$ цветов.

1) Пусть $v \in V(G)$. Будем говорить, что в раскраске $\rho$ цвет $i$ представлен в вершине $v$, если существует инцидентное $v$ ребро $e$ такое, что $\rho(e)=i$. Будем говорить, что цвет $i$ представлен $t$ раз в вершине $v$, если существует $t$ инцидентных $v$ ребер цвета $i$. Обозначим через $\rho(v)$ количество цветов, представленных в вершине $v$.
2) Введем обозначение $\rho(G)=\sum_{v \in V(G)} \rho(v)$. Назовем раскраску $\rho$ $k$-оптимальной, если для любой другой раскраски $\rho^{\prime}$ рёбер графа $G$ в $k$ цветов $\rho(G) \geq \rho^{\prime}(G)$.
Замечание 4.3. 1) Правильная раскраска рёбер графа $G$ может быть также определена как раскраска, в которой для каждой вершины любой

цвет представлен в ней не более одного раза. Покрывающая раскраска рёбер графа $G$ может быть также определена как раскраска, в которой в каждой вершине представлены все цвета.
1) Пусть $\rho$ - правильная раскраска рёбер графа $G$ в $k$ цветов. Тогда для каждой вершины $v \in V(G)$ мы имеем $\rho(v)=d_{G}(v) \geq \rho^{\prime}(v)$ для любой другой раскраски $\rho^{\prime}$. Таким образом, правильная раскраска рёбер всегда является $k$-оптимальной.
2) Если $\rho$ - покрывающая раскраска в $k$ цветов, то для каждой вершины $v \in V(G)$ мы имеем $\rho(v)=k$. Легко понять, что покрывающая раскраска является $k$-оптимальной.

Лемма 4.10. Пусть $G$ - связный граф, отличный от простого иикла нечетной длины. Тогда существует такая раскраска рёбер $G$ в два ивета, что в каждой вершине степени не менее двух представлены оба ивета.

Доказательство. Если в графе есть вершины нечетной степени, то добавим новую вершину $w$ и соединим её со всеми вершинами нечетной степени графа $G$. Получится граф $\tilde{G}$, степени всех вершин которого четны. Если все степени вершин графа $G$ четны, положим $\tilde{G}=G$.

В графе $\tilde{G}$ есть эйлеров цикл. Будем красить ребра графа, чередуясь, в цвета 1 и 2 по ходу эйлерова цикла. Пусть мы начали с вершины $a$. Тогда в каждой вершине $x$ графа $\tilde{G}$, кроме, может быть, вершины $a$, будут представлены оба цвета. Более того, если $d_{\tilde{G}}(x)=2 k$, то мы прошли $k$ раз по эйлерову циклу через $x$, следовательно, мы покрасили по $k$ инцидентных $x$ ребер в цвета 1 и 2 . Отличие для начальной вершины $a$ состоит в том, что при $d_{\tilde{G}}(a)=2 m$ мы проходим через $a$ только $m-1$ раз, следовательно, у вершины $a$ можно гарантировать только по $m-1$ рёбер каждого из цветов.

Пусть $v \in V(G)$. По построению графа $\tilde{G}$,

$$
d_{G}(v)=d_{\tilde{G}}(v) \text { при } d_{G}(v) \vdots 2, \quad d_{G}(v)=d_{\tilde{G}}(v)-1 \text { при } d_{G}(v) \nmid 2
$$

Поэтому при $v \neq a$ и $d_{G}(v) \geq 2$ в нашей раскраске существует два разноцветных ребра, инцидентных $a$. Для начальной вершины $a$ мы можем гарантировать это лишь в случае $d_{G}(a) \geq 3$.

Если в графе $G$ есть вершины нечетной степени, то мы начнем покраску рёбер с добавленной вершины (положим $a=w$ ), тогда получится искомая раскраска ребер графа $G$. Если в графе $G$ все вершины имеют четную степень, но есть вершина степени хотя бы 4 , то мы выберем в качестве $a$ именно такую вершину и опять же получим искомую раскраску ребер графа $G$. Остается случай, когда все вершины связного графа $G$

имеют степень 2 , то есть $G$ - простой цикл. Тогда это цикл четной длины, для которого нужная нам раскраска, очевидно, существует.

Замечание 4.4. Отметим, что в лемме 4.10 допускается наличие в графе кратных рёбер. Также оно ничем не мешает в следующей лемме и двух теоремах о реберных раскрасках двудольных графов.

Лемма 4.11. Пусть $\rho$ - $k$-оптимальная раскраска ребер графа $G$. Предположим, что вершина $w$ и ивета $i$ и $j$ таковы, что в вершине $w$ хотя бы два раза представлен ивет $i$ и не представлен ивет $j$. Пусть $H=G\left(E_{i} \cup E_{j}\right)$, а $H_{w}$ - компонента графа $H$, содержащая вершину $w$. Тогда $H_{w}$ - простой иикл нечетной длины.

Доказательство. Предположим, что $H_{w}$ не является простым циклом нечетной длины. Построим новую раскраску $\rho^{\prime}$, отличающуюся от $\rho$ лишь раскраской рёбер из $H_{w}$ : мы раскрасим их в цвета $i$ и $j$ так, чтобы в каждой вершине $x$ степени $d_{H_{w}}(x) \geq 2$ были представлены оба цвета $i$ и $j$ (это возможно по лемме 4.10). Тогда $\rho^{\prime}(w)=\rho(w)+1$, а для любой другой вершины $x$, очевидно, $\rho^{\prime}(x) \geq \rho(x)$. Таким образом, $\rho^{\prime}(G)>\rho(G)$, противоречие с $k$-оптимальностью $\rho$.

Теорема 4.9. (D. König, 1916.) Если граф $G-$ двудольный, то $\chi^{\prime}(G)=\Delta(G)$.

Доказательство. Рассмотрим $\Delta(G)$-оптимальную раскраску $\rho$ рёбер графа $G$. Предположим, что раскраска $\rho$ - неправильная. Тогда существует вершина $v$ и цвет $i$ такие, что $i$ дважды представлен в вершине $v$. Так как $d_{G}(v) \leq \Delta(G)$, то существует цвет $j$, не представленный в вершине $v$. Тогда по лемме 4.11 в графе $G$ есть нечетный цикл, противоречие. Следовательно, раскраска $\rho$ - правильная.

Задача 4.2. Выведите теорему 4.9 из теоремы Холла (2.2).
Интересно, что точно так же доказывается двойственная теорема.
Теорема 4.10. (R. P. Gupta, 1966.) Если граф $G-$ двудольный, то $\kappa^{\prime}(G)=\delta(G)$.

Доказательство. Рассмотрим $\delta(G)$-оптимальную раскраску $\rho$ рёбер графа $G$. Предположим, что раскраска $\rho$ не является покрывающей. Тогда существует вершина $v$ и цвет $i$ такие, что $i$ не представлен в вершине $v$. Так как $d_{G}(v) \geq \delta(G)$, то существует цвет $j$, представленный в вершине $v$ не менее, чем дважды. Тогда по лемме 4.11 в графе $G$ есть нечетный цикл, противоречие. Следовательно, раскраска $\rho$ - покрывающая.

# 4.7.2 Теорема Визинга 

Определение 4.12. Через $\mu(G)$ обозначим максимальную кратность ребра графа $G$, то есть, максимум $e_{G}(\{x\},\{y\})$ для всех пар $x, y \in V(G)$.

Мы докажем теорему Визинга для графов, в которых допускаются кратные ребра.

Теорема 4.11. (В. Г. Визинг, 1964.) Пусть $G$ - граф без петель. To$\operatorname{zda} \chi^{\prime}(G) \leq \Delta(G)+\mu(G)$.

Доказательство. (J.-C. Fournier, 1973.) Пусть $\mu(G)=\mu$. Рассмотрим $(\Delta(G)+\mu)$-оптимальную раскраску рёбер графа $G$ цветов. Предположим, что раскраска $\rho$ - неправильная. Тогда существует вершина $u$ и цвет $i_{1}$, который дважды представлен в вершине $u$. Так как $d_{G}(u)<\Delta(G)+\mu$, то существует цвет $j$, не представленный в вершине $u$.

Пусть $e_{1}=u v_{1} \in E(G)$ - ребро цвета $\rho\left(e_{1}\right)=i_{1}$. Так как $d_{G}\left(v_{1}\right)<$ $\Delta(G)+\mu$, существует цвет $i_{2}$, не представленный в $v_{1}$. Если $i_{2}$ не представлен в $u$, то, перекрасив ребро $e_{1}$ в цвет $i_{2}$, мы увеличим $\rho(G)$. Следовательно, цвет $i_{2}$ представлен в $u$, пусть $e_{2}=u v_{2}$ - ребро цвета $\rho\left(e_{2}\right)=i_{2}$.

## 1. Шаг процесса построения.

Пусть различные цвета $i_{1}, \ldots, i_{\ell}$ и рёбра $e_{1}, \ldots, e_{\ell} \in E(G)$ таковы, что $e_{t}=u v_{t}, \rho\left(e_{t}\right)=i_{t}$, а цвет $i_{t+1}$ не представлен в вершине $v_{t}$ (при всех $t \in[1 . . \ell])$. Мы будем говорить, что цвет $i_{t+1}$ выбран для вершины $v_{t}$. Вершины $v_{1}, \ldots, v_{\ell}$ не обязательно различны.

Рассмотрим вершину $v=v_{\ell}$. Пусть в наборе $v_{1}, \ldots, v_{\ell}$ вершина $v$ встречается $m$ раз. Понятно, что $m \leq \mu$. Тогда на предыдущих шагах мы рассматривали вершину $v$ и $m-1$ раз выбирали цвет, не представленный в этой вершине. Поскольку $d_{G}\left(v_{\ell}\right)+m-1<\Delta(G)+\mu$, то существует цвет $i_{\ell+1}$, не представленный в вершине $v_{\ell}$ и не выбранный для нее на предыдущих шагах. Мы выберем именно этот цвет.

Определим раскраску $\rho_{\ell}$ :

$$
\rho_{\ell}\left(e_{s}\right)=i_{s+1}, \text { при } s \in[1 . . \ell], \quad \rho_{\ell}(e)=\rho(e) \text { на остальных рёбрах } e .
$$

Докажем, что $\rho_{\ell}(G) \geq \rho(G)$, то есть, $\rho_{\ell}$ - оптимальная раскраска ребер в $\Delta(G)+\mu$ цветов. Для вершины $x \notin\left\{u, v_{1}, \ldots, v_{\ell}\right\}$ цвета инцидентных $x$ рёбер не менялись, поэтому $\rho_{\ell}(x)=\rho(x)$.

Рассмотрим вершину $w$, которая входит в набор $v_{1}, \ldots, v_{\ell}$ ровно $n$ раз. Пусть $w=v_{s_{1}}=\cdots=v_{s_{n}}$. По построению, все выбранные для вершины $v$ цвета $i_{s_{1}+1}, \ldots, i_{s_{n}+1}$ различны, не представлены в вершине $w$ в раскраске $\rho$ и представлены в раскраске $\rho_{\ell}$. Цвета $i_{s_{1}}, \ldots, i_{s_{n}}$ представлены в вершине $w$ в раскраске $\rho$ и, возможно, не представлены в раскраске $\rho_{\ell}$.

Все отличные от $e_{s_{1}}, \ldots, e_{s_{n}}$ рёбра, инцидентные $w$, не изменили свой цвет, и потому остальные цвета одинаково представлены в вершине $w$ в раскрасках $\rho$ и $\rho_{\ell}$. Поэтому $\rho_{\ell}\left(v_{t}\right) \geq \rho\left(v_{t}\right)$.

Рассмотрим вершину $u$. В результате перекрашивания инцидентных $u$ рёбер $e_{1}, \ldots, e_{\ell}$ из их цветов исчез $i_{1}$ и появился $i_{\ell+1}$. Однако, цвет $i_{1}$ был представлен в вершине $u$ в раскраске $\rho$ хотя бы дважды, поэтому он представлен и в раскраске $\rho_{\ell}$. Таким образом, $\rho_{\ell}(u) \geq \rho(u)$ и $\rho_{\ell}(G) \geq \rho(G)$, то есть, раскраска $\rho_{\ell}$ оптимальна.

Более того, из оптимальности $\rho$ следует, что $\rho_{\ell}(G)=\rho(G)$, следовательно, $\rho_{\ell}(u)=\rho(u)$. Это означает, что цвет $i_{\ell+1}$ представлен в вершине $u$ в раскраске $\rho$. Пусть $e_{\ell+1}=u v_{\ell+1}-$ ребро цвета $\rho\left(e_{\ell+1}\right)=i_{\ell+1}$.

a

b

c

Рис. 4.12: Раскраски $\rho, \rho_{k-1}$ и $\rho_{m}$.

# 2. Перекрашивание. 

Поскольку у вершины $u$ конечное число соседей, на некотором шаге построения мы впервые получим $i_{m+1}=i_{k}$. По построению отсюда следует, что $v_{m}$ не совпадает с $v_{k-1}$ (иначе мы выбрали бы цвета $i_{m+1}$ и $i_{k}$ разными). Так как в вершинах $v_{k-1}$ и $v_{m}$ в раскраске $\rho$ не представлен цвет $i_{k}$, а в $v_{k}$ - представлен, все три вершины $v_{k-1}, v_{k}$ и $v_{m}$ различны.

Рассмотрим оптимальные раскраски $\rho_{k-1}$ и $\rho_{m}$ (мы положим $\rho_{0}=\rho$ ). В обеих раскрасках в вершине $u$ хотя бы дважды представлен цвет $i_{k}$ :

$$
\rho_{k-1}\left(e_{k-1}\right)=\rho_{k-1}\left(e_{k}\right)=i_{k}, \quad \rho_{m}\left(e_{k-1}\right)=\rho_{m}\left(e_{m}\right)=i_{k}
$$

Пусть $E_{s}$ - множество всех ребер цвета $s$ в раскраске $\rho_{k-1}$, а $E_{s}^{\prime}$ - множество всех ребер цвета $s$ в раскраске $\rho_{m}, H=G\left(E_{i_{k}} \cup E_{j}\right)$ и $H^{\prime}=G\left(E_{i_{k}}^{\prime} \cup E_{j}^{\prime}\right)$. На рисунке 4.12 изображены цвета рёбер, соединяющих $u$ с $v_{1}, \ldots, v_{m}$ в раскрасках $\rho$ (рисунок 4.12a), $\rho_{k-1}$ (рисунок 4.12 b ) и $\rho_{m}$ (рисунок 4.12 c ). Применим лемму 4.11: из оптимальности наших раскрасок следует, что содержащие вершину $u$ компоненты графов $H$ и $H^{\prime}$ - простые циклы нечетной длины.

Тогда $d_{H}\left(v_{k}\right)=2$ : из $v_{k}$ выходит ребро $e_{k}$ цвета $\rho_{k-1}\left(e_{k}\right)=i_{k}$ и ребро цвета $j$. Для всех рёбер $e$ цикла $H$, кроме $e_{k}$, мы имеем $\rho_{k-1}(e)=\rho_{m}(e)$, поэтому $d_{H^{\prime}}\left(v_{k}\right)=d_{H}\left(v_{k}\right)-1=1$. При этом, очевидно, $v_{k}$ и $u$ лежат в одной компоненте графа $H^{\prime}$, которая должна быть простым нечётным циклом. Противоречие.

Полученное противоречие показывает, что $\rho$ - искомая правильная раскраска рёбер графа $G$ в $\Delta(G)+\mu$ цветов.

Замечание 4.5. 1) Для графов без кратных рёбер мы имеем $\mu(G)=1$, а следовательно, оценку $\chi^{\prime}(G) \leq \Delta(G)+1$.
1) Очевидно, оценка из теоремы 4.11 точна. Действительно, если $G-$ "греугольник", в котором каждое ребро имеет кратность $\mu$, то $\Delta(G)=2 \mu$, а $\mu(G)=\mu$. Нетрудно понять, что все $3 \mu$ рёбер графа $G$ должны быть разного цвета, а следовательно, $\chi^{\prime}(G)=3 \mu=\Delta(G)+\mu(G)$.

# 4.7.3 Покрывающие раскраски рёбер 

Теоремы 4.9 и 4.10 показывают связь между правильными и покрывающими раскрасками: для двудольного графа $G$ имеют место равенства $\chi^{\prime}(G)=\Delta(G)$ и $\kappa^{\prime}(G)=\delta(G)$. При этом, в графах допускается наличие кратных рёбер.

Перейдём к графам без условия двудольности. По теореме Визинга, $\chi^{\prime}(G) \leq \Delta(G)+\mu(G)$. При этом, не всегда существует правильная раскраска рёбер графа $G$ в меньшее число цветов. В 1974 году Гупта доказал, что $\kappa^{\prime}(G) \leq \delta(G)-\mu(G)$. Мы докажем эту оценку и покажем ее точность.

Теорема 4.12. (R. P. Gupta, 1974.) Для любого графа $G$

$$
\kappa^{\prime}(G) \geq \delta(G)-\mu(G)
$$

Доказательство. Пусть $d=\delta(G), \mu=\mu(G)$. Мы считаем, что $d>\mu$, иначе утверждение теоремы очевидно.

## 1. Перестройка графа.

Мы построим граф $G^{\prime}$, удовлетворяющий следующим условиям.
$1^{\circ}$ Для любой вершины $x \in V(G)$ существует конечное множество вершин $V_{x} \subset V\left(G^{\prime}\right)$. Для различных $x, y \in V(G)$ выполняется условие $V_{x} \cap V_{y}=\varnothing$.
$2^{\circ}$ Существует биекция $\varphi: E(G) \rightarrow E\left(G^{\prime}\right)$ такая, что если $\varphi(e)=e^{\prime}$ и $e=x y \in E(G)$, то $e^{\prime}=x^{\prime} y^{\prime} \in E\left(G^{\prime}\right)$, где $x^{\prime} \in V_{x}$ и $y^{\prime} \in V_{y}$.
$3^{\circ} \Delta\left(G^{\prime}\right)=d, \mu\left(G^{\prime}\right) \leq \mu$.

$4^{\circ}$ Для любой вершины $x \in V(G)$ существует вершина $x^{\prime} \in V_{x}$ такая, что $d_{G^{\prime}}\left(x^{\prime}\right)=d$.

Грубо говоря, мы должны расщепить каждую вершину $x \in V(G)$ на несколько вершин, составляющих $V_{x}$. Последовательно проделаем этот процесс со всеми вершинами графа $G$. Рассмотрим очередную вершину $x$. Пусть $q=\left\lceil\frac{d_{G}(x)}{d}\right\rceil$. Тогда мы расщепим вершину $x$ на $q$ вершин $x_{1}, \ldots, x_{q}$, произвольным образом распределив между ними инцидентные вершине $x$ рёбра так, чтобы из вершин $x_{1}, \ldots, x_{q-1}$ выходило ровно по $d$ рёбер.

В результате получится новый граф $G^{\prime}$ с множеством вершин $V\left(G^{\prime}\right)=\cup_{x \in V(G)} V_{x}$, причем построенное одновременно с графом $G^{\prime}$ соответствие рёбер графов $G$ и $G^{\prime}$ и будет биекцией $\varphi$ По построению граф $G^{\prime}$ удовлетворяет условиям $1^{\circ}-4^{\circ}$.

# 2. Покраска графа $G^{\prime}$. 

По теореме 4.11 существует правильная раскраска $\rho$ рёбер графа $G^{\prime}$ в $d+$ $\mu$ цветов. Назовем вершину $x \in V\left(G^{\prime}\right)$ большой, если $d_{G^{\prime}}(x)=d$. Каждой большой вершине инцидентны $d$ рёбер разных цветов, следовательно, в вершине $x$ представлены $d$ цветов. Мы попытаемся перекрасить ребра в цвета $1, \ldots, d-\mu$ (назовем их маленькими) так, что в каждой вершине графа $G^{\prime}$ будут представлены все цвета.

Цвета $d-\mu+1 \ldots, d+\mu$ назовём большими, их количество равно $2 \mu$. Обозначим через $H$ граф на вершинах $V\left(G^{\prime}\right)$ с рёбрами больших цветов. Поставим в соответствие каждой большой вершине $x$ множество $M(x)$, которая содержит те из цветов $1, \ldots, d-\mu$, которые не представлены в $x$.

Докажем, что для любой большой вершины $x \in V\left(G^{\prime}\right)$

$$
|M(x)| \leq\left[\frac{d_{H}(x)}{2}\right]
$$

Пусть $|M(x)|=m$. Так как вершина $x$ - большая, $d_{G^{\prime}}(x)=d$ и из правильности раскраски $\rho$ следует, что в вершине $x$ представлены $d$ цветов и не представлены какие-то $\mu$ цветов, причем среди них есть $m$ маленьких цветов и $\mu-m$ больших. Следовательно, в вершине $x$ представлены $2 \mu-(\mu-m)=\mu+m$ больших цветов, то есть, $d_{H}(x)=\mu+m \geq 2 m$, откуда следует доказываемое утверждение.

Мы построим новую раскраску $\rho^{\prime}$ рёбер графа $G^{\prime}$ в $d-\mu$ цвет, в которой в каждой большой вершине будут представлены все цвета. Для начала положим $\rho^{\prime}(e)=\rho(e)$, при $\rho(e) \leq d-\mu$ (то есть, $e \notin E(H)$ ). Рёбра больших цветов в раскраске $\rho$ (то есть, рёбра из $E(H)$ ) будут перекрашены.

По следствию 1.6 можно представить $E(H)$ как объединение множеств рёбер нескольких циклов и путей, не имеющих общих концов. Ориентируем транзитивно каждый путь и цикл - получится ориентация $\bar{H}$ графа $H$. Тогда для каждой вершины $x \in V(H)$ ее исходящая степень

$$
d_{\bar{H}}^{-}(x) \geq\left[\frac{d_{H}(x)}{2}\right] \geq|M(x)|
$$

Поэтому для каждой большой вершины $x$ каждое исходящее из $x$ ребро $e$ орграфа $\bar{H}$ можно покрасить в цвет $\rho^{\prime}(e) \in M(x)$ так, чтобы в каждый цвет из $M(x)$ был представлен в вершине $x$. В результате в раскраске $\rho^{\prime}$ в вершине $x$ представлены все цвета маленькие цвета. Для завершения доказательства остается покрасить все неперекрашенные ребра графа $H$ в маленькие цвета произвольно.

# 3. Покраска графа $G$. 

Покрасим рёбра графа $G$ так же, как соответствующие им рёбра графа $G^{\prime}$ : положим $\rho^{*}(x y)=\rho^{\prime}(\varphi(x y))$ для каждого ребра $x y \in E(G)$. Рассмотрим произвольную вершину $x \in V(G)$. По условию $4^{\circ}$ существует большая вершина $x^{\prime} \in V_{x}$. Так как в раскраске $\rho^{\prime}$ в вершине $x^{\prime}$ представлены все $d-\mu$ цветов, в вершине $x$ также представлены все $d-\mu$ цветов.

Замечание 4.6. Покажем, что оценка $\delta(G)-\mu(G)$ из теоремы 4.12 точна. Пусть $\mu=\mu(G)$. Рассмотрим граф $G$ на $2 \mu+1$ вершине, в котором каждые две вершины соединены $\mu$ кратными рёбрами. Тогда

$$
e(G)=\mu^{2}(2 \mu+1), \quad \delta(G)=2 \mu^{2}, \quad \mu(G)=\mu
$$

Предположим, что существует покрывающая раскраска ребер графа $G$ в $k=\delta(G)-\mu(G)+1=2 \mu^{2}-\mu(G)+1$ цветов. Тогда существует цвет, количество рёбер которого не более, чем

$$
\frac{e(G)}{k}=\frac{2 \mu^{3}+\mu^{2}}{2 \mu^{2}-\mu(G)+1}<\mu+1
$$

Следовательно, количество рёбер этого цвета не более чем $\mu$, но в таком случае он не может быть представлен во всех $2 \mu+1$ вершинах. Противоречие показывает, что покрывающая раскраска нашего графа $G$ должна содержать не более $\delta(G)-\mu(G)$ цветов, что подтверждает точность оченки из теоремы 4.12.
Задача 4.3. Докажите, что для однородного графа $G$ степени $r$ имеет место неравенство $\chi^{\prime}(G)+\kappa^{\prime}(G) \geq 2 r$.

# 4.8 Списочные раскраски 

Списочные раскраски (list colorings) появились относительно недавно впервые они были определены определены Визингом в 1976 году (он их назвал предписанными раскрасками). Каждой вершине графа $v \in V(G)$ ставится в соответствие список $L(v)$, после чего рассматривается правильная раскраска вершин с дополнительным ограничением: каждая вершина $v$ должна быть покрашена в цвет из списка $L(v)$. Минимальное такое $k \in \mathbb{N}$, что для любых списков из $k$ цветов существует правильная раскраска вершин графа $G$ обозначется через $\operatorname{ch}(G)$ (и носит название списочное хроматическое число, по английски - choice number).

Во всех случаях, когда речь идет о списках цветов мы будем обозначать список большой буквой (как правило, $L$ или $L^{\prime}$ ), а его размер соответствующей строчной: так, $\ell(v)=|L(v)|$.
Замечание 4.7. Очевидно, $\operatorname{ch}(G) \geq \chi(G)$. Нетрудно придумать пример графов, для которых $\operatorname{ch}(G)>\chi(G)$ (задача ??).

В том же 1976 году Визинг доказал списочную версию теоремы Брукса. Мы приведем более общий результат, доказанный Бородиным в 1977 году.

Определение 4.13. Граф $G$ называется $d$-раскрашиваемым, если для любого набора списков $L$, удовлетворяющего условию $\ell(v) \geq d_{G}(v)$ для каждой вершины $v \in V(G)$, существует правильная раскраска вершин графа $G$ в цвета из списков.

Английский вариант этого термина - d-choosable. Теорема Бородина говорит, что граф является $d$-раскрашиваемым, если он имеет блок, отличный от полного графа и нечетного цикла. Перед ее доказательством дадим еще одно определение и докажем несложную лемму, похожую на лемму 4.3.

Определение 4.14. Назовем вершину $v \in V(G)$ нормальной, если $\ell(v) \geq d_{G}(v)$ и избыточной, если $\ell(v)>d_{G}(v)$.

Лемма 4.12. Пусть $G$ - свялный граф, каждой вершине соответствует список цветов, причем все вершины - нормальные, а вершина а избыточная. Тогда существует правильная раскраска вершин графа $G$ в соответствие со списками.

Доказательство. Индукция по количеству вершин. База для графа с одной вершиной (естественно, избыточной) очевидна. Будем считать, что утверждение очевидно для любого связного графа с меньшим чем $v(G)$ количеством вершин.

Рассмотрим граф $G-a$. Пусть $G_{1}, \ldots, G_{k}$ - все компоненты графа $G-a$. В каждом графе $G_{i}$ (где $i \in[1 . . k]$ ) ввиду связности графа $G$ обязательно есть вершина $a_{i}$, смежная с $a$. Рассмотрим граф $G_{i}$, оставив списки вершин неизменными. Тогда $a_{i}$ станет избыточной вершиной (так как $d_{G_{i}}\left(a_{i}\right) \leq d_{G}\left(a_{i}\right)-1 \leq \ell\left(a_{i}\right)-1$ ). Тогда по индукционному предположению вершины всех графов $G_{1}, \ldots, G_{k}$ можно покрасить в соответствие со списками. Так как $d_{G}(a)<\ell(a)$, мы можем докрасить вершину $a$ в один из цветов ее списка $L(a)$, не нарушая правильности раскраски графа.

Теорема 4.13. (О. В. Бородин, 1977.) Граф $G$ является d-раскрашиваемым, если он имеет блок, отличный от полного графа и нечетного цикла.

Доказательство. Пусть каждой вершине $v$ соответствует список $L(v)$. Не умаляя общности можно считать, что $\ell(v)=d_{G}(v)$ для каждой вершины $v \in V(G)$. Нужно научиться красить вершины графа в цвета их списков правильным образом. Рассмотрим несколько случаев.

1. Существуют две такие смежные вершины а и $b$, что граф $G-a$ связен и $L(a) \not \subset L(b)$.
Пусть $1 \in L(a) \backslash L(b)$. В связном графе $G-a$ из всех списков вершин множества $\mathrm{N}_{G}(a)$, содержащих цвет 1 , удалим этот цвет, остальные списки оставим без изменений. Получим новые списки $L^{\prime}(v)$ графа $G-a$. Отметим, что все вершины графа $G-a$ нормальны: для вершин не из $\mathrm{N}_{G}(a)$ это очевидно, а для $v \in \mathrm{~N}_{G}(a)$ мы имеем

$$
\ell^{\prime}(v) \geq \ell(v)-1 \geq d_{G}(v)-1=d_{G-a}(v)
$$

При этом, из $1 \notin L(b)$ следует, что $\ell^{\prime}(b)=\ell(b)$. Так как $d_{G-a}(b)=d_{G}(b)-1$, вершина $b$ является избыточной. Тогда по лемме 4.12 существует правильная раскраска вершин графа $G-a$ в цвета из списков $L^{\prime}$. Докрасив $a$ в цвет 1 , мы получим правильную раскраску вершин графа $G$ в цвета из исходных списков.
1. Граф $G$ двусвязен.

Если не все списки одинаковы, то существуют две смежные вершины $a$ и $b$ с $L(a) \neq L(b)$ и мы имеем случай 1 . Значит, все списки одинаковы, пусть в них, скажем, $d$ цветов. Тогда и все степени вершин одинаковы и равны $d$. Таким образом, мы имеем дело с правильной раскраской графа степени $d$ в $d$ цветов. По условию граф $G$ отличен от полного графа и нечетного цикла. Значит, по теореме Брукса 4.1 искомая раскраска существует.
1. Граф $G$ недвусвязен.

Докажем утверждение по индукции, в качестве базы будут два предыдущих случая. Итак, пусть для меньшего чем $G$ графа теорема доказана. Рассмотрим крайний блок $B$ графа $G$, отделяемый от остального графа точкой сочленения $a$. Можно считать, что в графе $G$ есть блок, отличный от $B$, от нечетного цикла и полного графа (иначе рассмотрим в качестве $B$ другой крайний блок).

Граф $B-a$, очевидно, связан, все его вершины по условию нормальны, а все смежные с $a$ вершины (такие есть!) - избыточны. Поэтому, по лемме 4.12 его вершины можно покрасить в соответствие со списками.

Пусть $U=V(B) \backslash\{a\}, G^{\prime}=G-U$. Граф $G^{\prime}$ имеет те же самые блоки, что $G$, кроме $B$, а значит, среди них есть блок, отличный от нечетного цикла и полного графа. Списки всех отличных от $a$ вершин не изменились, а их степени - такие же, как в графе $G$. Новый список $L^{\prime}(a)$ будет содержать все цвета списка $L(a)$, кроме тех, что использованы для раскраски вершин из $\mathrm{N}_{B-a}(a)$. Таких цветов не более чем $d_{B-a}(a)$, а $d_{G}(a)=d_{B-a}(a)+d_{G^{\prime}}(a)$. Поэтому, $\ell^{\prime}(a) \geq d_{G^{\prime}}(a)$ и по индукционному предположению существует правильная раскраска вершин $G^{\prime}$ в цвета из списков. Вместе с раскраской графа $B-a$ мы получаем искомую правильную раскраску вершин графа $G$.

Замечание 4.8. Условие $d$-раскрашиваемости из теоремы 4.13 яляется не только достаточным, но также и необходимым. Если каждый бок графа $G$ - нечетный цикл или полный граф, несложно придумать такие списки цветов размеров, равных степеням соответствующих вершин, для которых раскраска невозможна.

Интересно, что такой набор списков обязательно устроен следующим образом. В этом наборе каждому блоку $B$, вершины которого имеют степень $d_{B}$ (в блоке $B$ ) соответствуют $d_{B}$ цветов. Множества цветов, соответствующие имеющим общую вершину блокам, не пересекаются. Каждая вершина получает список - множество всех цветов, соответствующих блокам, в которых она лежит (см. задачу ??). Для таких списков достаточно $\Delta(G)$ цветов.

Следствие 4.3. (В. Г. Визинг, 1976.) Пусть $d \geq 3$, а $G-$ связный граф, отличный от $K_{d+1}, \Delta(G) \leq d$. Тогда $\operatorname{ch}(G) \leq d$.

Доказательство. Пусть каждой вершине $v \in V(G)$ соответствует список $L(v)$, причём $\ell(v) \geq d$. Если граф имеет блок, отличный от нечетного цикла и полного графа, то утверждение следует из теоремы 4.13. Если же все блоки графа $G$ - нечетные циклы и полные графы, то $G$ недвусвязен, а его блоки отличны от $K_{d+1}$. Тогда рассмотрим крайний блок $B$ графа $G$ и его вершину $b$, не являющуюся точкой сочленения. Очевидно

$\ell(b) \geq d>d_{B}(b)=d_{G}(b)$, а значит, вершина $b-$ избыточна и искомая раскраска существует по лемме 4.12.

Для класса планарных графов Томассен получил сильные и красивые результаты о списочных раскрасках. Подробнее об этом написано в главе 6 .

Аналогично списочным раскраскам вершин мы определим списочные раскраски рёбер. Каждому ребру графа $e \in E(G)$ ставится в соответствие список $L(e)$ из $k$ цветов, после чего рассматривается правильная раскраска рёбер, в которой каждое ребро $e$ должно быть покрашено в цвет из списка $L(e)$. Минимальное такое $k \in \mathbb{N}$, что для любых списков из $k$ цветов существует правильная раскраска рёбер графа $G$ обозначется через $\operatorname{ch}^{\prime}(G)$ (и носит название списочный громатический индекс, в англоязычной литературе - choice index). Очевидно, $\operatorname{ch}^{\prime}(G) \geq \chi^{\prime}(G)$.

В отличие от ситуации со списочными раскрасками вершин графов, для которых, напомню, возможен случай $\operatorname{ch}(G)>\chi(G)$, аналогичных примеров для рёберных раскрасок неизвестно. Более того, выдвинута гипотеза (List Color Conjecture) о том, что $\operatorname{ch}^{\prime}(G)=\chi^{\prime}(G)$ для любого графа $G$. В 1995 году Гэльвин доказал эту гипотезу для двудольных графов. Доказательство использует понятие ориентации графа и будет приведено в разделе 8.7 главы 8.

# 4.9 Раскраски гиперграфов 

Существуют разные определения правильной раскраски вершин гиперграфа $\mathcal{H}$. Например, можно потребовать, чтобы все вершины каждого гиперребра были разноцветными. Однако, мы остановимся на следующем варианте, который был предложен в свое время Эрдешем.

Определение 4.15. Раскраска вершин гиперграфа $\mathcal{H}$ называется правильной, если в любом гиперребре есть хотя бы две вершины разных цветов.

### 4.9.1 Аналог теоремы Брукса

Теорема 4.14. (Н. В. Гравин, Д. В. Карпов, 2011.) Пусть $\mathcal{H}$ - гиперграф, каждое гиперребро которого содержит не менее, чем $r$ вершин, $c \Delta(\mathcal{H})=\Delta u k=\left\lceil\frac{2 \Delta}{r}\right\rceil$.

1) Тогда вершины $\mathcal{H}$ можно правильно раскрасить в $k+1$ ивет.
2) Пусть $r \geq 3$ и $k \geq 3$. Тогда вершины $\mathcal{H}$ можно правильно раскрасить в $k$ иветов.

Замечание 4.9. 1) В случае обычного графа $r=2$ и $k=\Delta$, а значит, в этом случае количество цветов в правильной раскраске из пункта 2 теоремы было бы именно таким, как в теореме Брукса.
1) Как и в случае класической теоремы Брукса, случай раскраски в два цвета имеет существенные отличия от случая, когда количество цветов $k \geq 3$. Раскраски гиперграфов в два цвета будут изучены в следующем разделе.

Перед доказательством теоремы мы введем несколько необходимых понятий и изучим их свойства.

Определение 4.16. Назовем образом гиперграфа $\mathcal{H}$ любой граф $G$ (возможно, с кратными рёбрами), для которого $V(G)=V(\mathcal{H})$ и существует такая биекция $\varphi: E(G) \rightarrow E(\mathcal{H})$, что $e \subset \varphi(e)$ для любого ребра $e \in E(G)$. Назовём $\varphi$ биекцией образа $G$.

Замечание 4.10. Кратные рёбра графа-образа $G$, соответствующие различным гиперрёбрам гиперграфа $\mathcal{H}$, мы считаем различными.

Понятно, что вопрос о правильной раскраске вершин гиперграфа $\mathcal{H}$ - это вопрос о правильной раскраске вершин любого его образа. В этом разделе мы объясним, как найти у гиперграфа $\mathcal{H}$ удобный для покраски образ.

Как и в классических теоремах о раскрасках вершин, нам поможет чередующаяся цепь. Следующее определение покажет, что мы имеем ввиду под этим понятием для гиперграфа.


Рис. 4.13: Чередующаяся цепь длины 5 с началом $a_{0}$ и концом $a_{5}$.

Определение 4.17. Пусть $r \geq 3, G$ - образ гиперграфа $\mathcal{H}$. Рассмотрим последовательность вершин $a_{0} b_{0} a_{1} b_{1} \ldots a_{n}$ гиперграфа $\mathcal{H}$, удовлетворяющую следующим условиям.
(1) Вершины $a_{i}, b_{i}, a_{i+1}$ различны, существует гиперребро $e_{i} \in E(\mathcal{H})$, для которого $a_{i}, b_{i}, a_{i+1} \in e_{i}$.
(2) Все гиперрёбра $e_{0}, \ldots, e_{n-1}$ различны, $a_{0} b_{0}, \ldots, a_{n-1} b_{n-1} \in E(G)$, причём $\varphi\left(a_{i} b_{i}\right)=e_{i}$.

Тогда $a_{0} b_{0} a_{1} b_{1} \ldots a_{n}$ - чередующаяся цепь от $a_{0}$ до $a_{n}$. Число $n$ назовём длиной этой чередующейся цепи. Будем говорить, что эта чередующаяся цепь проходит по вершинам $a_{0}, b_{0}, \ldots, a_{n}$ и по рёбрам $a_{0} b_{0}, \ldots$, $a_{n-1} b_{n-1}$.

Вершину $a_{0}$ назовём началом этой цепи, а вершину $a_{n}$ - концом.
Пусть $X, Y \subset V(G)$, причём $a_{0} \in X$ и $a_{n} \in Y$. Тогда будем говорить, что $a_{0} b_{0} a_{1} b_{1} \ldots a_{n}$ - чередующаяся цепь от $X$ до $Y$.

Замечание 4.11. 1) Мы допускаем в определении чередующейся цепи случай $n=0$. Таким образом, вершина $a_{0}$ является чередующейся цепью от $a_{0}$ до $a_{0}$ длины 0 .
1) Так как $\varphi$ - биекция, все рёбра $a_{0} b_{0}, \ldots, a_{n-1} b_{n-1}$ из определения чередующейся цепи - различные. Напомним, что кратные рёбра графа $G$, соответствующие разным гиперрёбрам, мы считаем различными.
2) Вершины в определении чередующейся цепи не обязательно различны. Возможно, по некоторым вершинам чередующаяся цепь проходит более одного раза.

Лемма 4.13. Пусть $\mathcal{H}$ - гиперграф, каждое гиперребро которого содержит не менее чем $r$ вершин с $\Delta(\mathcal{H})=\Delta$ и $k=\left\lceil\frac{2 \Delta}{r}\right\rceil$. Тогда существует образ $G$ гиперграфа $\mathcal{H}$ с $\Delta(G) \leq k$.

Доказательство. Рассмотрим тривиальный случай $r=2$. В этом случае для любого образа $G$ гиперграфа $\mathcal{H}$ очевидно, что $\Delta(G) \leq \Delta=k$. Везде далее $r \geq 3$.

Для графа $G$ обозначим через $V_{k+1}(G)$ множество всех вершин графа $G$, имеющих степень не менее $k+1$, а через $s_{k+1}(G)$ - сумму степеней вершин из $V_{k+1}(G)$ в графе $G$.

Предположим, что утверждение леммы неверно. В таком случае для любого образа $G$ мы имеем $V_{k+1}(G) \neq \varnothing$ и $s_{k+1}(G)>0$. Выберем образ $G$ с наименьшим $s_{k+1}(G)$. Обозначим через $\varphi$ биекцию образа $G$, пусть $S=V_{k+1}(G)$.

Пусть $U$ - множество, состоящее из всех вершин графа $G$, являющихся концами чередующихся цепей с началом в вершинах $S$, а $F=G(U)$. Понятно, что $S \subset U$. Докажем ряд свойств $U$.

1. Для любого ребра $e \in E(F)$ гиперребро $\varphi(e) \subset U$.

Предположим, что это не так, пусть $e=u w \in E(F)$ и гиперребро $\varphi(e)$ содержит вершину $v \notin U$ (см. рисунок 4.14a). Мы построим чередующуюся цепь от $S$ до $v$ и, тем самым, получим $v \in U$, что противоречит предположению.

Рассмотрим кратчайшую чередующуюся цепь $P=a_{0} b_{0} \ldots a_{n}$ от $S$ до $\{u, w\}$. Не умаляя общности можно предположить, что $a_{n}=u$. Тогда

$a_{i} \notin\{u, w\}$ при $0 \leq i<n$, поэтому цепь $P$ не проходит по ребру $e=u w$. Добавим к цепи $P$ вершины $w, v$ и получим чередующуюся цепь от $a_{0} \in S$ до $v$.


Рис. 4.14: Гиперрёбра, пересекающие $U$
1. Если $u \in U, v \notin U$ и $u v \in E(G)$, то все отличные от $v$ вершины гиперребра $\varphi(u v)$ лежат в $U$.
Предположим, что это не так. Пусть в гиперребре $e=\varphi(u v)$ есть вершина $w \notin U$ (см. рисунок 4.14 b ).

Как и в предыдущем пункте, построим кратчайшую чередующуюся цепь $P$ от $S$ до $u$ (в случае $u \in S$ эта цепь состоит из единственной вершины). Пусть цепь $P$ проходит по ребру $u v$. Так как мы выбрали кратчайшую цепь до $u$, то в этом случае для некоторого $i<n$ мы имеем $v=a_{i}, u=b_{i}$. Но тогда $v \in U$, противоречие.

Таким образом, цепь $P$ не проходит по ребру $u v$. Дополнив цепь $P$ вершинами $v$ и $w$, мы получим $w \in U$, что противоречит предположению. Значит, $v$ - единственная вершина гиперребра $e$, не входящая в $U$ (см. рисунок 4.14 c ).
1. Для любой вершины $u \in U$ выполняется $d_{G}(u) \geq k$.

Пусть $u \in U$ и $d_{G}(u) \leq k-1$. Понятно, что $u \notin S$. Рассмотрим чередующуюся цепь $P=a_{0} b_{0} \ldots a_{n}$ от $S$ до $u=a_{n}$. Построим новый граф $G^{\prime}$ : возьмём граф $G$ и для каждого $i \in[0, n-1]$ заменим в образе гиперребра $e_{i} \supset\left\{a_{i}, b_{i}, a_{i+1}\right\}$ ребро $a_{i} b_{i}$ на ребро $b_{i} a_{i+1}$. Нетрудно понять, что полученный граф $G^{\prime}$ - также образ гиперграфа $\mathcal{H}$.

Так как $d_{G^{\prime}}(u)=d_{G}(u)+1 \leq k$, вершина $u \notin V_{k+1}\left(G^{\prime}\right)$. Степени остальных вершин в графе $G^{\prime}$ не более, чем в $G$, а значит, $V_{k+1}\left(G^{\prime}\right) \subseteq S=$ $V_{k+1}(G)$. Остаётся лишь отметить, что $a_{0} \in S$ и $d_{G}\left(a_{0}\right)>d_{G^{\prime}}\left(a_{0}\right)$, следовательно, $s_{k+1}\left(G^{\prime}\right)<s_{k+1}(G)$. Противоречие с минимальностью $s_{k+1}(G)$ завершает доказательство утверждения.
1. Оценим сумму степеней вершин из $U$ в гиперграфе $\mathcal{H}$.

Пусть $u_{1}, \ldots u_{\ell}$ - все вершины множества $U$, имеющие в индуцированном

подграфе $F=G(U)$ степень менее $k$. Положим

$$
t_{i}=d_{G}\left(u_{i}\right)-d_{F}\left(u_{i}\right), \quad t=\sum_{i=1}^{t} t_{i}
$$

Из пункта 3 следует, что степени всех вершин множества $U$ в графе $G$ хотя бы $k$. Так как $S \subset U$, в множестве $U$ есть вершины, имеющие в графе $G$ степень более $k$. Следовательно,

$$
e(F)=\frac{1}{2} \sum_{u \in U} d_{F}(u)>\frac{k|U|-t}{2}
$$

Теперь оценим $m=\sum_{u \in U} d_{\mathcal{H}}(u)$. По пункту 1 , все гиперрёбра гиперграфа $\mathcal{H}$, соответствующие при отображении $\varphi$ рёбрам графа $F$, содержатся в множестве $U$ и вносят в $m$ вклад не менее, чем

$$
r \cdot e(F)>r \cdot \frac{k|U|-t}{2} \geq \Delta|U|-\frac{r t}{2}
$$

Каждое из $t$ рёбер графа $G$, выходящих из $U$ в $V(\mathcal{H}) \backslash U$, по пункту 2 входит в гиперребро гиперграфа $\mathcal{H}$, у которого только одна вершина лежит вне $U$, а следовательно, остальные вершины (их не менее $r-1$ ) лежат в $U$. Все эти $t$ гиперрёбер, очевидно, различны. Таким образом,

$$
m>\Delta|U|-\frac{r t}{2}+(r-1) t>\Delta|U|
$$

Следовательно, найдется вершина $u \in U$ степени $d_{\mathcal{H}}(u)>\Delta$, что противоречит условию леммы.

Полученное противоречие показывает, что существует образ $G$ гиперграфа $\mathcal{H}$ с $\Delta(G) \leq k$.

Доказательство теоремы 4.14. 1) По лемме 4.13, существует образ $G$ гиперграфа $\mathcal{H}$ с $\Delta(G) \leq k=\left\lceil\frac{2 \Delta}{r}\right\rceil$. Очевидно, существует правильная раскраска вершин графа $G$ в $k+1$ цвет.

Докажем, что эта раскраска будет правильной раскраской вершин гиперграфа $\mathcal{H}$. Пусть $\varphi$ - биекция образа $G$. Для каждого гиперребра $e \in E(\mathcal{H})$ мы имеем $\varphi^{-1}(e) \subset e$, а вершины ребра $\varphi^{-1}(e) \in E(G)$ покрашены в разные цвета.
1) Нам нужно доказать существование образа гиперграфа $\mathcal{H}$, имеющего правильную раскраску в $k$ цветов при $k \geq 3$ и $r \geq 3$. Для начала рассмотрим образ $G$ гиперграфа $\mathcal{H}$ с $\Delta(G) \leq k$ и его биекцию образа $\varphi$.

Вспомним классическую теорему Брукса 4.1: если $\Delta(G) \leq k$, ни одна из компонент графа $G$ не является кликой на $k+1$ вершине и $k \geq 3$, то вершины графа $G$ красятся правильным образом в $k$ иветов.

Пусть $C_{1}, \ldots, C_{q}$ - все компоненты графа $G$, являющиеся кликами на $k+1$ вершине (в дальнейшем для краткости именно эти компоненты мы будем называть просто кликами). Возможно, есть и другие компоненты - пусть это $D_{q+1}, \ldots, D_{p}$. Нам нужно немного подправить граф-образ $G$ так, чтобы получился раскрашиваемый в $k$ цветов граф. Мы сделаем это очень просто.

Изменение образа.
В каждой клике $C_{i}$ рассмотрим любое ребро $u_{i} w_{i}$. Понятно, что существует отличная от $u_{i}$ и $w_{i}$ вершина $v_{i} \in e_{i}=\varphi\left(u_{i} w_{i}\right)$. Построим новый образ $G^{\prime}$ гиперграфа $\mathcal{H}$, одновременно заменив каждое из рёбер $u_{i} w_{i}$ на $u_{i} v_{i}$. Назовём только что проведённые рёбра $u_{1} v_{1}, \ldots, u_{q} v_{q}$ новыми рёбрами.

Далее мы докажем, что вершины $G^{\prime}$ можно правильно раскрасить в $k$ иветов.
Построим вспомогательный орграф $F$, вершинами которого будут компоненты графа $G$, а из каждой компоненты-клики $C_{i}$ ведёт ориентированное ребро (стрелка) в компоненту, содержащую вершину $v_{i}$. Если $v_{i}-$ вершина клики $C_{i}$, то стрелка окажется петлёй. Фактически, мы ориентировали новые рёбра и стянули каждую компоненту графа $G$ в вершину.

Наш алгоритм покраски вершин в $k$ цветов будет выполняться по следующему плану:

- если существует клика, в которую в графе $F$ не входит ни одной стрелки, то выполним шаг 1 , после чего вернемся к началу алгоритма;
- если в каждую клику в графе $F$ входит хотя бы одна стрелка, то выполним шаг 2 , после чего алгоритм завершит работу.

1. Существует клика $C_{i}$, в которую не входит ни одной стрелки. Тогда $d_{G^{\prime}}\left(w_{i}\right)=k-1$. Произвольно пронумеруем вершины $C_{i}$, начиная с $w_{i}$ и заканчивая вершиной $u_{i}$, смежной в $G^{\prime}$ с вершиной какой-то другой компоненты графа $G$. Предположим, что мы покрасили вершины остальных компонент правильным образом в $k$ цветов. Тогда мы можем легко докрасить вершины $C_{i}$ в порядке, обратном их нумерации: на каждом шаге очередная рассматриваемая вершина будет смежна менее, чем с $k$ уже покрашенными.

Значит, мы можем удалить из графа $G^{\prime}$ вершины компоненты $C_{i}$ и перейти к вопросу о покраске остальных компонент. Соответственно преобразуем и граф $F$, удалив из него вершину $C_{i}$ и выходящую из нее стрелку.

1. В каждую компоненту-клику входит хотя бы одна стрелка.

Так как из каждой такой компоненты выходит ровно по одной стрелке, то и входит в каждую клику также ровно по одной стрелке. Таким образом, все компоненты-клики разбиваются в графе $F$ на ориентированные циклы, вершины которых не связаны друг с другом в графе $G^{\prime}$. Мы будем красить эти циклы независимо друг от друга. Остальные компоненты графа $G$ (не клики из $k+1$ вершин) являются компонентами графа $G^{\prime}$, и их вершины по теореме Брукса можно правильным образом покрасить в $k$ цветов.

Итак, пусть клики $C_{1}, \ldots, C_{\ell}$ образуют в $F$ ориентированный цикл. Обозначим через $G^{*}$ индуцированный подграф графа $G^{\prime}$ на множестве вершин всех этих клик. Остается доказать, что вершины графа $G^{*}$ можно правильным образом покрасить в $k$ цветов. При $\Delta\left(G^{*}\right) \leq k$ это следует из теоремы Брукса, так как граф $G^{*}$ связен и не является кликой на $k+1$ вершине. Предположим, что $\Delta\left(G^{*}\right)>k$ и рассмотрим два случая.
2.1. $\ell=1$, то есть, цикл является петлёй и $v_{1} \in V\left(C_{1}\right)$.

Тогда $G^{*}$ - это клика на $k+1$ вершине с удалённым ребром $u_{1} w_{1}$ и ребром $u_{1} v_{1}$ кратности два. Мы легко можем покрасить вершины $C_{1}$ правильным образом в $k$ цветов, покрасив в цвет 1 вершины $u_{1}$ и $w_{1}$, а остальные вершины клики - по одной в оставшиеся цвета.
2.2. $\ell \geq 2$.

Пусть в графе $G^{*}$ есть вершина $x$ степени более $k$ и лежит она в клике $C_{i}$. Тогда понятно, что $x$ смежна с вершиной клики $C_{i-1}$ и $x \neq w_{i}$. Более того, в этом случае $d_{G^{*}}\left(w_{i}\right)=k-1$. Так как $\left|C_{i}\right|=k+1 \geq 4$, существует отличная от $x, w_{i}, u_{i}$ вершина $z_{i} \in C_{i}$. Последовательно удалим из графа $G^{*}$ вершины $w_{i}$ и $z_{i}$. Степень каждой вершины на момент удаления менее $k$, а значит, их можно будет докрасить в обратном порядке после покраски всех остальных вершин. В полученном графе $G^{*}-w_{i}-z_{i}$ все вершины из $C_{i}$ имеют степень не более $k$.

Выполним такие операции со всеми компонентами-кликами, имеющими в графе $G^{*}$ вершину степени более $k$. В результате получим связный граф $H^{*}$ с максимальной степенью не более $k$.

Докажем, что граф $H^{*}$ отличен от клики на $k+1$ вершине.
По построению ясно, что все новые рёбра между компонентами $C_{1}, \ldots, C_{n}$ вошли в граф $H^{*}$ (мы не удаляли из графа $G^{*}$ их концы). Рассмотрим компоненту $C_{2}$ и два инцидентных её вершинам новых ребра $u_{1} v_{1}$ и $u_{2} v_{2}$. Понятно, что граф $H^{*}-u_{1} v_{1}-u_{2} v_{2}$ несвязен (вершины из $C_{2}$ отделены в нём от остальных). Таким образом, граф $H^{*}$ теряет связность при удалении двух рёбер, а следовательно, не является кликой на $k+1 \geq 4$ вершинах.

Теперь понятно, что вершины графа $H^{*}$ по теореме Брукса можно покрасить правильным образом в $k$ цветов, после чего мы докрасим с соблюдением правильности все удалённые из $G^{*}$ вершины.

Таким образом, вершины графа $G^{\prime}$ можно правильным образом покрасить в $k$ цветов, и эта раскраска, как уже указывалось выше, будет правильной раскраской вершин гиперграфа $\mathcal{H}$.

# 4.9.2 Правильные раскраски гиперграфов в два цвета 

Определение 4.18. Гиперграф $\mathcal{H}$ называется двудольным, если существует правильная раскраска его вершин в два цвета (то есть такая раскраска в два цвета, в которой в каждом гиперребре есть вершины обоих цветов).

Лемма 4.14. Пусть $\mathcal{H}$ - недвудольный гиперграф, а $X \subsetneq V(\mathcal{H})$ - множество, пересекающее все его гиперребра. Тогда существует такое гиперребро $e \in E(\mathcal{H})$, что $e \subset X$.

Доказательство. Если это не так, то покрасим вершины множества $X$ в цвет 1 , а вершины из $V(\mathcal{H}) \backslash X$ - в цвет 2 и получим правильную раскраску вершин гиперграфа $\mathcal{H}$.

В основном в этом разделе мы будем изучать минимальные недвудольные гиперграфы - такие, у которых любой собственный подгиперграф является двудольным.

Определение 4.19. Пусть $\mathcal{H}$ - гиперграф, а $U \subsetneq V(\mathcal{H})$. Обозначим через $\mathcal{H}_{U}$ гиперграф на множестве вершин $U$, гиперрёбра которого - это все непустые множества вида $e \cap U$, где $e \in E(\mathcal{H})$ (возможно, некоторые из них состоят из одной вершины).

Замечание 4.12. Мы считаем, что гиперграф, имеющий одновершинные рёбра, не является двудольным.

Лемма 4.15. Пусть $\mathcal{H}$ - минимальный недвудольный гиперграф, а $U \subsetneq V(\mathcal{H})$ - непустое подмножество. Тогда гиперграф $\mathcal{H}_{U}$ недвудолен.

Доказательство. Предположим противное, пусть гиперграф $\mathcal{H}_{U}$ двудолен, а $U_{1}$ и $U_{2}$ - множества вершин цветов 1 и 2 в его правильной раскраске. Заметим, что гиперграф $\mathcal{H}-u$ двудолен. Пусть $W_{1}$ и $W_{2}$ - множества вершин цветов 1 и 2 в правильной раскраске этого гиперграфа.

Покрасим вершины всего гиперграфа $\mathcal{H}$ : множества $U_{1} \cup W_{1}$ и $U_{2} \cup W_{2}-$ в цвета 1 и 2 соответственно. Рассмотрим любое гиперребро $e \in E(\mathcal{H})$. Если $e \subset V(\mathcal{H}) \backslash U$, то оно имеет две разноцветные вершины (так как пересекает и $W_{1}$, и $W_{2}$.) Если же $e \cap U \neq \varnothing$, то гиперребро $e$ имеет по вершине из $U_{1}$ и $U_{2}$. Таким образом, мы получили правильную раскраску $\mathcal{H}$ в два цвета. Полученное противоречие показывает, что граф $\mathcal{H}_{U}$ недвудолен.

Лемма 4.16. Пусть $\mathcal{H}$ - минимальный недвудольный гиперграф, а функиия $f: V(\mathcal{H}) \rightarrow \mathbb{R}$ такова, для любого гиперребра $e \in E(\mathcal{H})$ выполняется $\sum_{x \in e} f(x)=0$. Тогда $f(x)=0$ для всех $x \in V(\mathcal{H})$.

Доказательство. Пусть $U=\{x \in V(\mathcal{H}): f(x) \neq 0\}$ непусто. Покрасим в цвет 1 вершины $U$, на которых значение $f$ положительно, а в цвет $2-$ на которых значение $f$ отрицательно. Пусть гиперребро $e \in E(\mathcal{H})$ пересекает $U$. Поскольку сумма значений $f$ на вершинах любого гиперребра равна 0 , то в $e \cap U$ есть вершины обоих цветов. Следовательно, граф $\mathcal{H}_{U}$ двудолен, противоречие с леммой 4.15 .

Теорема 4.15. (P. D. Seymour, 1974.) Пусть $\mathcal{H}$ - минимальный недвудольный гиперграф, а $U \subset V(\mathcal{H})$. Тогда $U$ пересекает не менее чем $|U|$ гиперребер из $E(\mathcal{H})$. Равенство возможно только при $U=\varnothing$ или $U=V(\mathcal{H})$.

Доказательство. Случай $U=\varnothing$ очевиден.

1. Пусть $U=V(\mathcal{H})$. Предположим, что утверждение неверно. Тогда $e(\mathcal{H})<v(\mathcal{H})$. Поставим в соответствие каждой вершине из $V(\mathcal{H})$ по вещественной переменной, а для каждого гиперребра из $E(\mathcal{H})$ напишем уравнение: приравняем нулю сумму переменных, соответствующих его вершинам. Мы получили однородную систему линейных уравнений, в которой уравнений меньше, чем неизвестных. Как известно, она имеет решение, в котором не все переменные равны нулю. Таким образом, существует функция, запрещенная леммой 4.16.
2. Пусть $U$ - собственное подмножество $V(\mathcal{H})$, которое пересекает не более $|U|$ гиперребер.
Рассмотрим два случая.
2.1. Любое гиперребро из $E(\mathcal{H})$ содержится в $U$ или $V(\mathcal{H}) \backslash U$. В этом случае $E(\mathcal{H})$ есть дизъюнктное объединение множеств гиперребер двух двудольных гиперграфов $\mathcal{H}(U)$ (пусть $X_{1}$ и $X_{2}$ - множества его вершин цветов 1 и 2 ) и $\mathcal{H}-U$ (пусть $Y_{1}$ и $Y_{2}$ - множества его вершин цветов 1 и 2 ). Покрасим $X_{1} \cup Y_{1}$ в цвет 1 , а $X_{2} \cup Y_{2}$ - в цвет 2 и получим правильную раскраску вершин $\mathcal{H}$ в два цвета, противоречие.

2.2. Существует гиперребро $e \in E(\mathcal{H})$, пересекающее $U$, но не содержащееся в $U$.
Пусть $F$ - множество отличных от $e$ гиперребер, пересекающих $U$. Тогда $|F|<|U|$ и, аналогично доказанному выше, мы можем построить такую функцию $g: U \rightarrow \mathbb{R}$, что $\sum_{x \in f \cap U} g(x)=0$ для любого гиперребра $f \in F$ и не все значения $f-$ нули. Положим $g(y)=0$ для всех $y \in V(\mathcal{H}) \backslash U$. Тогда $\sum_{x \in f} g(x)=0$ выполнено для всех $f \in E(\mathcal{H}), f \neq e$. Из леммы 4.16 понятно, что такая сумма для гиперребра $e$ не равна 0 . Не умаляя общности будем считать, что $\sum_{x \in e} g(x)>0$. Пусть

$$
W=\{x \in V(\mathcal{H}): g(x)>0\}, \quad Y=\{x \in V(\mathcal{H}): g(x)=0\}
$$

Тогда $Y \neq V(\mathcal{H})$, следовательно, гиперграф $\mathcal{H}(Y)$ двудолен, пусть $Y_{1}$ и $Y_{2}$ - множества его вершин цветов 1 и 2 соответственно в правильной раскраске. Множество вершин $W \cup Y_{1}$ пересекает все гиперребра из $E(\mathcal{H})$ : для гиперребер, содержащихся в $Y$, это очевидно, а остальные должны содержать вершину, в которой функция $g$ положительна.

Тогда по лемме 4.14 существует гиперребро $f \in E(\mathcal{H})$, содержащееся в $W \cup Y_{1}$. Однако, по построению $f \not \subset Y_{1}$, следовательно, $f$ пересекает $W$, откуда следует, что $\sum_{x \in f} g(x)>0$. Таким образом, $f=e$, откуда можно сделать вывод $e \subset W \cup Y_{1}$. Аналогично можно доказать, что $e \subset W \cup Y_{2}$. Таким образом, $e \subset W \subset U$, противоречие с выбором $e$.

Отметим прямое следствие теоремы 4.15 .
Следствие 4.4. Пусть $\mathcal{H}$ - минимальный недвудольный гиперграф. To$\operatorname{zda} e(\mathcal{H}) \geq v(\mathcal{H})$.

Следующий критерий раскрашиваемости вершин гиперграфа в два цвета допускает короткое прямое доказательство, которое мы оставим любознательному читателю в качестве задачи.

Следствие 4.5. Пусть $\mathcal{H}$ - такой гиперграф, что любое множество $U \subset V(\mathcal{H})$ содержит менее $|U|$ гиперрёбер из $E(\mathcal{H})$. Тогда $\mathcal{H}-$ двудольный.

Доказательство. Пусть $\mathcal{H}$ - недвудольный. Тогда он содержит минимальный недвудольный подграф $\mathcal{G}$. Но из условия следствия для $U=$ $V(\mathcal{G})$ следует, что $e(\mathcal{G})<v(\mathcal{G})$, противоречие со следствием 4.4.

Вернемся к изучению минимальных недвудольных гиперграфов. Следующая наша цель - описать все минимальные недвудольные гиперграфы, содержащие столько же гиперребер, сколько вершин.

Лемма 4.17. 1) Пусть $\mathcal{H}-$ гиперграф с $e(\mathcal{H})=v(\mathcal{H})$, причем любое множество $U \subset V(\mathcal{H})$ пересекает не менее $|U|$ гиперрёбер $\mathcal{H}$. Тогда существует такая биекиия $\varphi: V(\mathcal{H}) \rightarrow E(\mathcal{H})$, что $x \in \varphi(x)$ для любой вершины $x$.
1) Пусть $\mathcal{H}$ - минимальный недвудольный гиперграф с $e(\mathcal{H})=v(\mathcal{H})$. Тогда существует такая биекиия $\varphi: V(\mathcal{H}) \rightarrow E(\mathcal{H})$, что $x \in \varphi(x)$ для любой вершины $x$.

Доказательство. 1) Построим двудольный граф, вершины одной доли которого соответствуют $V(\mathcal{H})$, а вершины другой доли $-E(\mathcal{H})$, причем $x \in V(\mathcal{H})$ и $e \in E(\mathcal{H})$ смежны тогда и только тогда, когда $x \in e$. Из условия и теоремы Холла (теорема 2.2) следует, что в этом графе существует совершенное паросочетание $M$. Для каждой вершины $x \in V(\mathcal{H})$ пусть $\varphi(x)$ - гиперребро, соединенное в $M$ с $x$. Тогда $\varphi: V(\mathcal{H}) \rightarrow E(\mathcal{H})$ - искомая биекция.
1) Прямое следствие теоремы 4.15 и пункта 1.

Лемма 4.18. Пусть гиперграф $\mathcal{H}$ недвудолен, $e(\mathcal{H})=v(\mathcal{H})$ и любое непустое множество $U \varsubsetneqq V(\mathcal{H})$ пересекает более $|U|$ гиперрёбер $\mathcal{H}$. Тогда $\mathcal{H}$ - минимальный недвудольный гиперграф.

Доказательство. Гиперграф $\mathcal{H}$ имеет минимальный недвудольный подгиперграф $\mathcal{G}$. По следствию 4.4 мы имеем $e(\mathcal{G}) \geq v(\mathcal{G})$. Тогда множество $V(\mathcal{H}) \backslash V(\mathcal{G})$ пересекает не более чем

$$
e(\mathcal{H})-e(\mathcal{G}) \leq v(\mathcal{H})-v(\mathcal{G})=|V(\mathcal{H}) \backslash V(\mathcal{G})|
$$

рёбер, откуда в силу условия леммы и $V(\mathcal{G}) \neq \varnothing$ следует $V(\mathcal{H})=V(\mathcal{G})$. Теперь из $e(\mathcal{H})=v(\mathcal{H})$ и следствия 4.4 понятно, что $\mathcal{H}=\mathcal{G}$. Тем самым, мы завершили доказательство леммы.

Теорема 4.16. (P.D.Seymour, 1974.) Гиперграф $\mathcal{H}$ с $e(\mathcal{H})=v(\mathcal{H})$ является минимальным недвудольным тогда и только тогда, когда выполняются следующие утверждения.
$1^{\circ}$ Любое множество $U \varsubsetneqq V(\mathcal{H})$ пересекает более $|U|$ гиперрёбер $\mathcal{H}$.
$2^{\circ}$ Если $C$ - четный иикл в $\mathcal{H}$, то не существует такой биекиии $\varphi: V(\mathcal{H}) \backslash V(C) \rightarrow E(\mathcal{H}) \backslash E(C)$, что $\varphi(x) \ni x$ для всех $x \in V(\mathcal{H}) \backslash V(C)$.
Доказательство. $\Rightarrow$. Пусть $\mathcal{H}$ - минимальный недвудольный гиперграф. Тогда условие $1^{\circ}$ следует из теоремы 4.15. Проверим условие $2^{\circ}$. Предположим, что оно не выполняется и такой четный цикл $C$ и биекция $\varphi$ существуют. Пусть $C=x_{1} x_{2} \ldots x_{2 k}$, причем $x_{i}, x_{i+1} \in e_{i} \in E(\mathcal{H})$. Доопределим функцию $\varphi$ на $V(C)$ следующим образом: $\varphi\left(x_{i}\right)=e_{i}$. Теперь $\varphi$ - биекция между $V(\mathcal{H})$ и $E(\mathcal{H})$.

Для каждого $U \subset V(\mathcal{H})$ обозначим через $\mathcal{H}^{\varphi}(U)$ подгиперграф на вершинах множества $U$ с множеством гиперрёбер

$$
E\left(\mathcal{H}^{\varphi}(U)\right)=\{U \cap \varphi(x): x \in U\}
$$

Очевидно, гиперграф $\mathcal{H}^{\varphi}(V(C))$ двудолен (вершины цикла $C$ с нечетными номерами красим в первый цвет, а с четными - во второй). А $\mathcal{H}^{\varphi}(V(\mathcal{H}))=\mathcal{H}$, этот граф недвудолен. Выберем максимальное множество $Y \subset V(\mathcal{H})$ такое, что граф $\mathcal{H}^{\varphi}(Y)$ двудолен. Пусть $Y_{1}$ и $Y_{2}$ - множества вершин цветов 1 и 2 соответственно в правильной раскраске вершин этого графа.

Понятно, что $\varnothing \neq Y \subsetneq V(\mathcal{H})$. По теореме 4.15 множество $Y$ пересекает хотя бы $|Y|+1$ гиперребро из $E(\mathcal{H})$. Поэтому существует вершина $x \in V(\mathcal{H}) \backslash Y$, для которой $Y \cap \varphi(x) \ni y$. Будем считать, что $y \in Y_{1}$. Но тогда покрасим $x$ в цвет 2 и получим правильную раскраску вершин графа $\mathcal{H}^{\varphi}(Y \cup\{x\})$, что противоречит выбору множества $Y$. Таким образом, условие $2^{\circ}$ должно выполняться.
$\Leftarrow$. Пусть $\mathcal{H}$ - гиперграф, удовлетворяющий условиям $1^{\circ}$ и $2^{\circ}$. Предположим, что $\mathcal{H}$ двудолен. По пункту 1 леммы 4.17 существует такая биекция $\varphi: V(\mathcal{H}) \rightarrow E(\mathcal{H})$, что $x \in \varphi(x)$ для любой вершины $x$.

Пусть $x_{1} \in V(\mathcal{H})$ - произвольная вершина. Далее, для каждой вершины $x_{i}$ выберем следующую вершину $x_{i+1} \in \varphi\left(x_{i}\right)$ так, чтобы цвета вершин $x_{i}$ и $x_{i+1}$ различались. Из конечности гиперграфа следует, что вершины в этой последовательности в некоторый момент повторятся, пусть $x_{m+1}=x_{k}$. Тогда получится цикл $C=x_{k} \ldots x_{m}$ (так как $x_{i}, x_{i+1} \in \varphi\left(x_{i}\right)$.) Из чередования цветов понятно, что этот цикл четен. Тогда сужение $\varphi$ на $V(\mathcal{H}) \backslash V(C)$ дает биекцию, запрещенную условием $2^{\circ}$, противоречие.

Значит, гиперграф $\mathcal{H}$ недвудолен. Тогда по лемме 4.18 этот гиперграф - минимальный недвудольный. Тем самым мы завершили доказательство леммы.

Определение 4.20. Пусть $\mathcal{H}$ - гиперграф. Определим двойственный гиперграф $\mathcal{H}^{*}$ : пусть $V\left(\mathcal{H}^{*}\right)=E(\mathcal{H})$, а

$$
E\left(\mathcal{H}^{*}\right)=\{\{e \in E(\mathcal{H}): e \ni x\}: x \in V(\mathcal{H})\}
$$

Вершины двойственного гиперграфа $\mathcal{H}^{*}$ соответствуют рёбрам гиперграфа $\mathcal{H}$, а рёбра - вершинам. В любом случае $v\left(\mathcal{H}^{*}\right)=e(\mathcal{H})$.
Замечание 4.13. Если в гиперграфе $\mathcal{H}$ нет двух вершин, входящих в одинаковый набор гиперрёбер, то выполняются следующие утверждения.

1) $e\left(\mathcal{H}^{*}\right)=v(\mathcal{H})$ и $\mathcal{H}^{* *}=\mathcal{H}$. Далее мы в таком случае будем отождествлять каждое ребро $\mathcal{H}^{*}$ с соответствующей вершиной гиперграфа $\mathcal{H}$.
2) Пусть $C=x_{1} \ldots x_{k}-$ цикл в гиперграфе $\mathcal{H}, E(C)=\left\{e_{1}, \ldots, e_{k}\right\}$ $\left(x_{i}, x_{i+1} \in e_{i}\right)$. Тогда $C^{*}=e_{1} \ldots e_{k}-$ цикл в гиперграфе $\mathcal{H}^{*}$, причём $V\left(C^{*}\right)=E(C)$ и $E\left(C^{*}\right)=\left\{x_{1}, \ldots x_{k}\right\}=V(C)$. Верно и обратное утверждение. Эти циклы мы будем называть двойственными друг другу.

Теорема 4.17. (Р. D. Seymour, 1974.) Пусть $\mathcal{H}$ - минимальный недвудолъный гиперграф с $e(\mathcal{H})=v(\mathcal{H})$. Тогда $\mathcal{H}^{*}$ - минимальный недвудолъный гиперграф.

Доказательство. Пусть $x, y \in V(\mathcal{H})$. Тогда существует гиперребро, содержащее ровно одну из этих вершин, иначе гиперграф $\mathcal{H}_{\{x, y\}}$ двудолен, что противоречит лемме 4.15. Значит, по замечанию 4.13 мы имеем $v\left(\mathcal{H}^{*}\right)=e\left(\mathcal{H}^{*}\right)$. Проверим выполнение условий $1^{\circ}$ и $2^{\circ}$ из теоремы 4.16 для $\mathcal{H}^{*}$.

Начнем с условия $1^{\circ}$. Пусть $F \subsetneq V\left(\mathcal{H}^{*}\right)=E(\mathcal{H})$, а $U \subset V(\mathcal{H})-$ объединение гиперрёбер из $F$. Тогда $U-$ это как раз множество гиперрёбер из $E\left(\mathcal{H}^{*}\right)$, содержащих вершины множества $F \subset E\left(\mathcal{H}^{*}\right)$. Значит, нам нужно доказать, что $|U| \geq|F|$. Заметим, что $E(\mathcal{H}) \backslash F$ содержит все рёбра, пересекающие $V(\mathcal{H}) \backslash U$, а значит, по теореме 4.15 мы имеем $e(\mathcal{H})-|F| \geq v(\mathcal{H})-|U|$, что равносильно $|U| \geq|F|$.

Перейдём к условию $2^{\circ}$. Как следует из замечания 4.13 , циклы графов $G$ и $G^{*}$ двойственны друг другу. Рассмотрим пару двойственных циклов $C$ и $C^{*}$. Пусть $C^{*}$ четен и существует описанная в условии $2^{\circ}$ биекция, которую можно представить как $\psi: E(\mathcal{H}) \backslash E(C) \rightarrow V(\mathcal{H}) \backslash V(C)$, удовлетворяющая условию $e \ni \psi(e)$ для любого $e \in E(\mathcal{H}) \backslash E(C)$. Тогда четный цикл $C$ в $\mathcal{H}$ вместе с биекцией $\psi^{-1}$ противоречат условию $2^{\circ}$ для гиперграфа $\mathcal{H}$ и, тем самым, теореме 4.16. Значит, условие $2^{\circ}$ выполняется и для графа $\mathcal{H}^{*}$.

Теперь из теоремы 4.16 следует, что $\mathcal{H}^{*}$ - минимальный недвусвязный граф.

Напоследок отметим еще одно интересное свойство минимальных недвудолъных гиперграфов.

Теорема 4.18. (P. D. Seymour, 1974.) Пусть $\mathcal{H}$ - минимальный недвудолъный гиперграф, $e \in E(\mathcal{H}), x \in V(\mathcal{H})$, причем $x \in e$. Тогда выполняются следующие утверждения.

1) Существует такое гиперребро $f \in E(\mathcal{H})$, что $e \cap f=\{x\}$.
2) Пусть $e(\mathcal{H})=v(\mathcal{H})$. Тогда существует такая вершина $y \in A$, что нет отличного от е гиперребра из $E(\mathcal{H})$, содержащего $x$ и $y$.

Доказательство. 1) Гиперграф $\mathcal{H}-e$ двудолен, пусть $V_{1}$ и $V_{2}$ - вершины цветов 1 и 2 соответственно в его правильной раскраске. Гиперребро $e$ в этой раскраске должно быть одноцветно, пусть все его вершины имеют цвет 1 (то есть, $V_{2} \cap e=\varnothing$ ). Тогда $V_{2} \cup\{x\}$ пересекает все гиперрёбра из $E(\mathcal{H})$. Значит, по лемме 4.14 множество $V_{2} \cup\{x\}$ содержит некоторое гиперребро $f \in E(\mathcal{H})$. Тогда $e \cap f=\{x\}$.
1) По теореме 4.17 , гиперграф $\mathcal{H}^{*}$ также является минимальным недвудольным. Применим пункт 1 к его вершине $e$ и ребру $x$ и получим доказываемое утверждение.

Продолжение темы о минимальных недвудольных гиперграфах можно найти в разделе 8.11 .

# 4.10 Теорема о чередующемся цикле 

Эта весьма интересная и достаточно сильная теорема Йео о правильно раскрашенном цикле имеет неожиданное применение - из нее очевидно следует теорема Котцига о графе с единственным паросочетанием 2.20.

Теорема 4.19. (А. Yeo, 1997.) Рёбра графа $G$ (кратные рёбра допускаются, петли - нет) раскрашены таким образом, что в любом иикле есть два последовательных одноцветных ребра. Тогда существует такая вершина $a \in V(G)$, что для каждой компоненты связности $U$ графа $G-a$ все рёбра из а к $U$ одноцветны.

Доказательство. Можно считать, что в графе нет кратных рёбер, так как любые два кратных ребра должны быть покрашены в один и тот же цвет. Простой путь или цикл мы будем называть чередующимся, если он покрашен так, что любые два соседних ребра одноцветны. Пути в графе мы считаем направленными от начала к концу.

Цвет ребра $e$ мы будем обозначать через $c(e)$. Пусть $c_{\text {start }}(P)$ и $c_{\text {end }}(P)$ - цвета первого и последнего рёбер пути $P$, соответственно. Для двух различных вершин $x, y$ определим множества цветов

$$
\begin{aligned}
C_{\text {start }}(x, y)= & \left\{c_{\text {start }}(P): P-\text { чередующийся } x y \text {-путь }\right\} \\
& C_{\text {end }}(x, y)=\left\{c_{\text {end }}(P): P-\text { чередующийся } x y \text {-путь }\right\}
\end{aligned}
$$

Выберем произвольную вершину $p_{1} \in V(G)$. Положим

$$
S=\left\{p_{1}\right\} \cup\left\{x \in V(G):\left|C_{\text {end }}\left(p_{1}, x\right)\right|=1\right\}
$$

Пусть $P=p_{1} \ldots p_{n}$ - самый длинный чередующийся путь с началом $p_{1}$, кончающийся в вершине множества $S$. Для цвета $i$ определим

$$
T_{i}=\left\{t \in V\left(G-p_{n}\right): i \in C_{\text {start }}\left(p_{n}, t\right).\right\}
$$

Наконец, пусть $C^{*}=C$ в случае $S=\left\{p_{1}\right\}$. При $|S|>1$, очевидно, $v(P)>1$. Тогда положим $c_{\text {end }}(P)=1$ и $C^{*}=C \backslash\{1\}$.

Для доказательства теоремы нам понадобятся два вспомогательных утверждения.
Лемма 4.19. Для любого ивета $i \in C^{*}$ множество $T_{i}$ не содержит ни одной вершины пути $P$.

Доказательство. Случай $|S|=1$ тривиален. Пусть $|S|>1$, тогда $p_{n} \neq p_{1}$. Предположим противное, пусть $p_{k} \in T_{i}$. Тогда существует чередующийся $p_{n} p_{k}$-путь $R$ с $c_{\text {start }}(R)=i \neq c_{\text {end }}(P)$. Рассмотрим два случая.

1. $c_{\text {end }}(R) \neq c\left(p_{k} p_{k+1}\right)$.

Тогда $p_{k} P p_{n}$ и $R$ образуют чередующийся цикл (см. рисунок 4.15a), противоречие.


Рис. 4.15: Общая вершина $T_{i}$ и пути $P$.
1. $c_{\text {end }}(R)=c\left(p_{k} p_{k+1}\right)$.

В этом случае из $c\left(p_{k-1} p_{k}\right) \neq c\left(p_{k} p_{k+1}\right)$ следует, что $c_{\text {end }}(R) \neq c\left(p_{k-1} p_{k}\right)$. Тогда $P^{\prime}=p_{1} P p_{k} R p_{n}$ - это чередующийся $p_{1} p_{n}$-путь с $c_{\text {end }}\left(P^{\prime}\right) \neq c_{\text {end }}(P)$ (см. рисунок 4.15 b ). Противоречие с $\left|C_{\text {end }}\left(p_{1}, p_{n}\right)\right|=1$.

Лемма 4.20. Пусть $i \in C^{*}, x \in T_{i}, y \notin T_{i}, x y \in E(G), c(x y)=j$. Тогда $y=p_{n} u j=i$.

Доказательство. 1. Докажем, что если не выполняется утверждение леммы, то существует такой чередующийся $p_{n} x$-путь $R$, что $c_{\text {start }}(R)=i u c_{\text {end }}(R) \neq j$.
По определению $T_{i}$ существует чередующийся $p_{n} x$-путь $Q$ с $c_{\text {start }}(Q)=i$. Если $c_{\text {end }}(Q) \neq j$, этот путь нам подходит. Значит, $c_{\text {end }}(Q)=j$ (см. рисунок 4.16a). По лемме 4.19 путь $Q$ не имеет общих вершин с $P$, кроме $p_{n}$. Значит, $P Q$ - это чередующийся $p_{1} x$-путь, который, очевидно, длиннее $P$. По выбору пути $P$ это означает, что $\left|C_{\text {end }}\left(p_{1}, x\right)\right| \geq 2$, то есть, существует другой чередующийся $p_{1} x$-путь $L$ с $c_{\text {end }}(L) \neq j$.



Рис. 4.16: Пути $P, Q$ и $L$.

Выберем вершину $w \in V(P Q) \cap V(L)$ так, чтобы внутренние вершины пути $w L x$ не лежали в $V(P Q)$. Разберем два случая.
a. $w \in V(P) \backslash\left\{p_{n}\right\}$ (см. рисунок 4.16 b$)$.

В этом случае $Q x L w$ - это чередующийся $p_{n} w$-путь с $c_{\text {start }}(Q x L w)=i$, откуда следует $w \in T_{i}$ - противоречие с леммой 4.19.
б. $w \in V(Q)$ (см. рисунок 4.17 a ).

a

b

Рис. 4.17: Пути $P, Q$ и $L$.
Тогда $c_{\text {start }}(w Q x)=c_{\text {start }}(w L x)$, иначе эти два пути образуют чередующийся цикл. Но тогда вспомним, что

$$
c_{c n d}\left(p_{n} Q w\right) \neq c_{\text {start }}(w Q x)=c_{\text {start }}(w L x)
$$

поэтому $R=p_{n} Q w L x$ - это чередующийся $p_{n} x$-путь. Если $w \neq p_{n}$, то $R$ и $Q$ имеют общее первое ребро, поэтому $c_{\text {start }}(R)=i$ (см. рисунок 4.17 a ). Если $w=p_{n}$, то из доказанного выше следует, что

$$
c_{\text {start }}(w L x)=c_{\text {start }}(Q)=i
$$

(см. рисунок 4.17 b ). В любом случае путь $R$ нам подходит.
1. Рассмотрим чередующийся $p_{n} x$-путь $R$ из пункта 1. Если $y \neq p_{n}$, то по лемме $4.19 R^{\prime}=R y$ - это чередующийся $p_{n} y$-путь с $c_{\text {start }}\left(R^{\prime}\right)=i$, то есть, $y \in T_{i}$, что противоречит условию.

Значит, $y=p_{n}$. Если при этом $i \neq j$, то $R^{\prime}$ - это чередующийся цикл, которых по условию нет.

Закончим доказательство теоремы 4.19. Докажем, что нам подойдет $a=p_{n}$. Предположим противное, пусть $U \ni x, y$ - компонента связности графа $G-p_{n}$ и $c\left(p_{n} x\right) \neq c\left(p_{n} y\right)$. Не умаляя общности можно считать, что $i=c\left(p_{n} x\right) \in C^{*}$.

Пусть $y \in T_{i}$. Тогда, так как $p_{n} \notin T_{i}$, по лемме 4.20 мы имеем $c\left(p_{n} y\right)=$ $i=c\left(p_{n} x\right)$, противоречие. Следовательно, $y \notin T_{i}$. Разумеется, $x \in T_{i}$. Пусть $x=x_{1} x_{2} \ldots x_{m}=y$ - это $x y$-путь в $G(U)$ (он может быть не чередующимся). Тогда найдется такой индекс $k$, что $x_{k} \in T_{i}$ и $x_{k+1} \notin T_{i}$. Но в этом случае по лемме 4.20 должно быть $x_{k+1}=p_{n}$, что не так. Полученное противоречие завершает доказательство теоремы.

В качестве очевидного следствия выведем теорему Котцига 2.20.
Следствие 4.6. Пусть $G$ - связный граф (возможно, с кратными рёбрами, но без петель), имеющий единственное совершенное паросочетание $M$. Тогда граф $G$ имеет мост, входящий в это паросочетание.

Доказательство. Покрасим рёбра паросочетания $M$ в цвет 1 , а остальные рёбра - в цвет 2 и применим теорему 4.19. Пусть $a$ - вершина, от которой все рёбра к каждой компоненте связности графа $G-a$ одноцветны. Эта вершина покрыта ровно одним ребром паросочетания $M$, а значит, существует компонента связности $U$ графа $G-a$, в которую от $a$ ведут рёбра цвета 1 . Но такое ребро ровно одно, следовательно, это как раз искомый мост.

# 4.11 Комментарии 

Ключевым утверждением этой главы является теорема Брукса. В разделе 4.2 приведены два доказательства: классическое доказательство методом чередующихся цепей и доказательство Ловаса с использованием связности, идеи которого восходят к работам Дирака. Далее следуют как раз эти результаты Дирака о критических графах.

В разделе 4.3 изложены факты о $k$-критических графах и доказана гипотеза Хайоша для $k=4$. Несмотря на название раздела, большая часть результатов принадлежит Дираку и доказана в 1950-е. Эти классические результаты можно найти и в других книгах, например, в [3]. Сама гипотеза Хайоша - очень сильное утверждение, из случая $k=5$, например, следует гипотеза 4 красок. Случаи $k \geq 5$ гипотезы Хайоша не доказаны.

В разделе 4.4 рассматривается вопрос о построении графов хроматического числа не менее $q$ с помощью ряда операций. Сначала рассказывается о первом появившемся методе - двум операциям, предложенным

Хайошем. Он назвал такие графы, полученные из $K_{q}$, $q$-конструируемыми и доказал в 1961 году, что граф имеет хроматическое число не менее $q$ если и только если содержит $k$-конструируемый подграф. Мы приводим лишь половину доказательства Хайоша, оставшаяся часть предложена в виде задачи ??. Доказательство теоремы Хайоша полностью можно прочитать, например, в книге Дистеля [8]. В нашей книге вместо этого приводится метод конструирования графов хроматического числа не менее $q$, предложенный в 1967 году Оре и относительно новая теорема Уркхарта [40] (1997 год) о том, что обе конструкции (и Хайоша, и Оре) на самом деле строят все графы хроматического числа не менее $q$. Однако, доказательство Уркхарта не предлагает эффективного алгоритма построения таких графов, так как в теореме 4.3 используется доказательство от противного.

Один из разделов главы посвящен отсутствию взаимосвязи между обхватом графа и его хроматическим числом. Кажется интуитивно ясным, что эти две величины никак не связаны, однако придумать конструкции графов со сколь угодно большими обхватом и хроматическим числом одновременно весьма непросто, в книге приведена лишь конструкция Мычильски графов сколь уголно болшого хроматического числа без треугольников. Теорема Эрдеша о существовании таких графов доказана несколько необычно: убраны все следы использования вероятностного пространства. Идею изложить доказательство именно так я почерпнул из книги Бонди и Мурти [3] (правда, там аналогичные пункту 1 доказательства теоремы 4.6 идеи использовались для доказательства другой теоремы).

Ключевыми вопросами о совершенных графах долгое время являлись две гипотезы Бержа, приведенные в начале соответствующего раздела. На первую из них достаточно быстро дал ответ Ловас. Теорема Ловаса о совершенных графах 4.7 дана с элегантным доказателством Гаспаряна. Между тем, исходное доказательство Ловаса весьма интересно (хотя и более сложно). Его можно найти в книгах Боллобаша [1] и Дистеля [8] (где приведены оба доказательства). Доказательство второй гипотезы Бержа дано относительно недавно и является длинным и техническим. Чуть более слабое утверждение - появившаяся еще до гипотезы Бержа теорема Галлаи 4.8 также имеет весьма непростое (но зато достаточно короткое) доказательство, в котором непросто разобраться. Это несколько модифицированное доказательство из книги Боллобаша [1].

Следующий раздел главы посвящен рёберным раскраскам, которые имеют свою специфику. Кроме правильных раскрасок в книге рассматривается двойственные им покрывающие раскраски, придуманные Гуптой в 1966 году. Он же доказад для них теоремы, аналогичные класси-

ческим теоремам Кёнига и Визинга для правильных раскрасок. Двойственные доказательства теорем о правильной и покрывающей раскрасках рёбер двудольного графа приведены так же, как в книге Бонди и Мурти [3]. Теорема Визинга доказана в сильной форме - для графов с кратными рёбрами, именно в такой форме она и была доказана Визингом в 1964 году. При желании это доказательство (придуманное в 1973 году Фурнье) можно записать проще для графов без кратных рёбер, что и сделано в книгах [3] и [8]. Доказательство теоремы Гупты о покрывающей раскраске ребер произвольного графа мне найти не удалось, пришлось его придумать. В книге [3] эта теорема дана в качестве упражнения (для графа без кратных рёбер) и утверждается, что проходит доказательство, аналогичное доказательству Фурнье теоремы Визинга, однако, мне не удалось повторить этот путь. В книге приведено доказательство, в котором теорема Гупты сводится к теореме Визинга.

Визинг придумал списочные раскраски в 1976 году, назвав их предписанными. Он же доказал списочную версию теоремы Брукса. Мы доказываем более общую теорему Бородина о $d$-раскрасках и выводим из нее списочную теорему Брукса. Результат Бородина в 1979 году независимо повторили Эрдеш, Рубин и Тэйлор [10] с намного более сложным доказательством, опирающимся на результат задачи ??. Впрочем, к этой задаче предлагается подсказка, дающая возможность придумать более простое доказательство, чем в [10]. Теория списочных раскрасок динамично развивается в настоящее время и разговор о ней будет продолжен далее в главе Планарные графы (замечательными теоремами Томассена) и в главе Ориентированные графы теоремой о списочных рёберных раскрасках двудольного графа.

В разделе 4.9 идет разговор о правильных раскрасках гиперграфов. Начало ему положено с теоремы 4.14 , которую мы с Н. В. Гравиным доказали в 2011 году [50]. Мне кажется, что именно так должен выглядеть аналог теоремы Брукса для раскрасок гиперграфов. В этой теореме, доказанной с помощью модификации метода чередующихзся цепей, речь идет о раскрасках в три и более цветов. Как и в случае обычной теоремы Брукса, вопрос о раскрасках вершин гиперграфов в 2 цвета стоит особняком. Этот вопрос является достаточно классическим, его изучение начато еще в 1974 году в статье Сеймура [29], именно ее результаты и изложены в конце главы. Разговор о раскрасках гиперграфов в два цвета будет продолжен в главе Ориентированные графы результатами Сеймура и Томассена.

Теорему Йео о чередующемся цикле [43], доказанную в 1997 году, не найти в сборниках по теории графов, но мне она представляется очень интересной. Особенно тем, что позволяет в очередной раз показать вза-

имосвязь разных частей теории графов и моментально вывести из нее теорему Котцига 2.20 .



# Глава 5 

## Связность

В этой главе мы рассматриваем графы без петель и кратных рёбер. Добавим подробностей в определение, данное во введении.

Определение 5.1. 1) Пусть $x, y \in V(G)$ - несмежные вершины. Обозначим через $\kappa_{G}(x, y)$ размер минимального множества $R \subset V(G)$ такого, что $R$ разделяет $x$ и $y$. Если $x$ и $y$ смежны, то положим $\kappa_{G}(x, y)=+\infty$. Назовем $\kappa_{G}(x, y)$ связностью вершин $x$ и $y$.
1) Пусть $X, Y \subset V(G)$. Обозначим через $\kappa_{G}(X, Y)$ размер минимального множества $R \subset V(G)$ такого, что $R$ разделяет $X$ и $Y$. Если такого множества нет, то положим $\kappa_{G}(X, Y)=+\infty$.

Замечание 5.1. 1) Во всем разделе мы будем для $x \in V(G)$ отождествлять обозначения $x$ и $\{x\}$. Соответственно, все данные для множеств определения переносятся и на вершины графа $G$ (как одновершинные множества).
1) Нетрудно понять, что вершинная связность графа удовлетворяет соотношению $\kappa(G)=\min _{x, y \in V(G)} \kappa_{G}(x, y)$.
2) Отметим, что в свете сказанного выше, пункт 1 последнего определения является частным случаем пункта 2.
3) Очевидно, в $k$-связном графе $G$ для любых двух множеств вершин $X, Y \subset V(G)$ выполнено $\kappa_{G}(X, Y) \geq k$.

## 5.1 Теорема Менгера

Это, безусловно, самое известное утверждение о связности графов. Мы докажем теорему Менгера и некоторые родственные ей факты. Возможно, это не совсем справедливо, но на все эти утверждения, как правило,

ссылаются одинаково - как на теорему Менгера. Иногда мы будем делать также.

Мы приведем теорему Менгера в чуть более общей формулировке Гёринга (2000 г) и с его доказательством.

Теорема 5.1. (K. Menger, 1927.) Пусть $X, Y \subset V(G), \kappa_{G}(X, Y) \geq k$, $|X| \geq k,|Y| \geq k$. Тогда в графе $G$ существуют $k$ непересекающихся $X Y$-путей.

Доказательство. (F. Göring, 2000.) Индукция по количеству вершин в графе. Доказывая утверждение для графа $G$ и пары множеств $X, Y$ мы будем считать утверждение уже доказанным для всех меньших графов. Рассмотрим два случая.

1. Существует множество $R$ из $k$ вершин, разделяющее $X$ и $Y$. Тогда $X \backslash R \neq \varnothing$ и $Y \backslash R \neq \varnothing$. Отметим, что никакой $X R$-путь не содержит вершины из $Y \backslash R$ (иначе существовал бы $X Y$-путь, не содержащий ни одной вершины множества $R$, см. рисунок 5.1 a ). Следовательно, любое множество $S$, отделяющее $X$ от $R$ в графе $G_{x}=G-(Y \backslash R)$, отделяет $X$ от $R$ и в графе $G$. Но тогда $S$ отделяет $X$ от $Y$ в графе $G$, следовательно, $|S| \geq k$.


Рис. 5.1: $X R, R Y$ и $X Y$-пути.
Таким образом, по индукционному предположению, существует $k$ непересекающихся $X R$-путей в графе $G_{x}$, а следовательно, и в графе $G$. Аналогично, существует $k$ непересекающихся $R Y$-путей в графе $G$. Отметим, что никакой $X R$-путь не пересекает никакой $R Y$-путь (иначе существовал бы $X Y$-путь, не содержащий ни одной вершины множества $R$, см. рисунок 5.1 b ). Так как $|R|=k$, то мы можем состыковать $X R$-пути и $R Y$-пути по вершинам множества $R$, получив $k$ непересекающихся $X Y$ путей (см. рисунок 5.1c).
1. Нет множества из $k$ вершин, разделяющего $X$ и $Y$. Случай, когда в графе $G$ нет рёбер, очевиден. Пусть $E(G) \neq \varnothing$. Тогда удалим из графа

произвольное ребро $x y$. Если условие теоремы выполняется в меньшем графе $G-x y$, то по индукционному предположению выполняется утверждение теоремы для графа $G-x y$, а следовательно, и для графа $G$.

Остается рассмотреть случай, когда существует множество $T \subset V(G)$, $|T| \leq k-1$, разделяющее $X$ и $Y$ в графе $G-x y$. Множества $X^{\prime}=X \backslash T$ и $Y^{\prime}=Y \backslash T$, очевидно, непусты. Как мы знаем, $T^{*}=T \cup\{x y\}$ разделяет $X$ и $Y$ в графе $G$, а $T_{x}=T \cup\{x\}$ - не разделяет (так как $\left|T_{x}\right| \leq k$ ). Отсюда следует, что одно из множеств $X^{\prime}$ и $Y^{\prime}$ лежит в $T_{x}$. Тогда не умаляя общности можно считать, что $X^{\prime}=\{x\}$. Аналогично, $Y^{\prime}=\{y\}$.

Таким образом, $T \supset X \backslash\{x\}$ и $T \supset Y \backslash\{y\}$. Учитывая $|T| \leq k-1$, $|X| \geq k$ и $|Y| \geq k$, мы получаем

$$
X \backslash\{x\}=Y \backslash\{y\}=T \quad \text { и } \quad|T|=k-1
$$

В этом случае легко увидеть искомые пути - это ребро $x y$ и $k-1$ вершина из $T=X \cap Y$.

Первый пункт следующего следствия и есть исходная формулировка теоремы Менгера, опубликованная им в 1927 году.

Следствие 5.1. 1) Пусть вершины $x, y \in V(G)$ несмежны, $\kappa_{G}(x, y) \geq k$. Тогда существует $k$ независимых путей из $x$ в $y$.
1) Пусть $x \in V(G), Y \subset V(G), x \notin Y, k=\min \left(|Y|, \kappa_{G}(x, Y)\right)$. Тогда существуют $k$ путей от $x$ до различных вершин множества $Y$, не имеющих общих внутренних вершин.

Доказательство. 1) Так как $x$ и $y$ несмежны, из $\kappa_{G}(x, y) \geq k$ следует, что $\left|\mathrm{N}_{G}(x)\right| \geq k,\left|\mathrm{~N}_{G}(y)\right| \geq k$ и любой простой $x y$-путь идёт из $x$ в $x_{1} \in \mathrm{~N}_{G}(x)$, далее в $y_{1} \in \mathrm{~N}_{G}(y)$ и затем в $y$ (возможно, вершины $x_{1}$ и $y_{1}$ совпадают). Тогда любое множество вершин $R$, отделяющее $\mathrm{N}_{G}(x)$ от $\mathrm{N}_{G}(y)$, отделяет вершину $x$ от вершины $y$. Следовательно, $|R| \geq k$. Тогда по теореме 5.1 существует $k$ непересекающихся $\mathrm{N}_{G}(x) \mathrm{N}_{G}(y)$-путей. Теперь легко найти и $k$ независимых $x y$-путей.
1) Очевидно, $\left|\mathrm{N}_{G}(x)\right| \geq k$. Так как $x \notin Y$, любое множество вершин $R$, отделяющее $\mathrm{N}_{G}(x)$ от $Y$, отделяет вершину $x$ от множества $Y$. Следовательно, $|R| \geq k$. Так как и $|Y| \geq k$, по теореме 5.1 существует $k$ непересекающихся $\mathrm{N}_{G}(x) Y$-путей в графе $G$, а следовательно, и $k$ непересекающихся путей от $x$ до различных вершин множества $Y$.

Следующее очевидное утверждение для двусвязных графов приведено ввиду его важности для раздела 7.2 .

Следствие 5.2. В двусвязном грабе для любых двух рёбер существует простой цикл, содержащий оба этих ребра.

Доказательство. Пусть это ребра $e=x y$ и $f=a b$. По теореме 5.1, существуют два пути от $\{x, y\}$ до $\{a, b\}$, не имеющие общих вершин. Вместе с рёбрами $e$ и $f$ эти пути образуют нужный нам цикл.

Теорема 5.2. (H. Whitney, 1932.) Пусть $G-k$-связный граф. Тогда для любых двух вершин $x, y \in V(G)$ существует $k$ независимых xy-nyтеи.

Доказательство. Индукция по $k$, база для $k=1$ очевидна. Докажем утверждение для $k$-связного графа, считая, что оно доказано для графов меньшей связности.

Если вершины $x$ и $y$ несмежны, то утверждение следует из следствия 5.1. Пусть вершины $x$ и $y$ смежны. Если $\kappa(G-x y) \geq k-1$, то все в порядке - по индукционному предположению существует $k-1$ независимых $x y$-путей в графе $G-x y$, а еще один путь - это ребро $x y$.

Пусть в $G-x y$ существует разделяющее множество $T,|T| \leq k-2$. Так как $T$ не является разделяющим множеством в $G$, легко понять, что в графе $G-(T \cup\{x y\})$ ровно две компоненты связности: $U_{x} \ni x$ и $U_{y} \ni y$. Пусть $T_{x}=T \cup\{x\}$. Если $U_{x} \neq\{x\}$, то $T_{x}$ отделяет $U_{x} \backslash\{x\}$ от $U_{y}$ в $G$, что невозможно (так как $\left|T_{x}\right| \leq k-1$ ). Тогда $U_{x}=\{x\}$. Аналогично, $U_{y}=\{y\}$. Таким образом, в графе $G$ не более $k$ вершин: это вершины множества $T, x$ и $y$. Противоречие с определением $k$-связного графа.

Удивительно, но аналогичное утверждение о рёберной связности, которое обычно называют "рёберная теорема Менгера", было доказано лишь в 1956 году как следствие теоремы Форда-Фалкерсона. Мы повторим этот путь и докажем рёберную теорему Менгера в главе 10.

Теорема 5.3. (G. A. Dirac.) Пусть $k \geq 2$. В $k$-связном графе для любых $k$ вершин существует простой иикл, содержащий все эти вершины.

Доказательство. Докажем теорему индукцией по $k$. База для $k=2-$ это тривиальное следствие теоремы 5.2 .

Пусть $k>2$. Рассмотрим $k$-связный граф $G$ и его вершины $v_{1}, \ldots$, $v_{k-1}, v_{k}$. Так как $G$ является $(k-1)$-связным графом, по индукционному предположению существует простой цикл $Z$, содержащий вершины $v_{1}, \ldots, v_{k-1}$. По пункту 2 следствия 5.1 существует $\min (v(Z), k)$ путей от $v_{k}$ до цикла $Z$ без общих внутренних вершин. Рассмотрим два случая.

1. $v(Z)<k$.

Тогда $V(Z)=\left\{v_{1}, \ldots, v_{k-1}\right\}$ и существуют непересекающиеся пути от $v_{k}$ до всех вершин цикла $Z$. В этом случае легко вставить $v_{k}$ в цикл $Z$ между его соседними вершинами и получить искомый цикл.
1. $v(Z) \geq k$.

Тогда существует $k$ непересекающихся путей от $v_{k}$ до цикла $Z$. Пусть $x_{1}, \ldots, x_{k} \in V(Z)$ - концы этих путей в порядке их следования по циклу (нумерация - циклическая по модулю $k$ ). Они делят цикл на $k$ дуг и внутренность одной из этих дуг (пусть это дуга $L$ с концами $x_{i}$ и $x_{i+1}$ ) не содержит ни одной из вершин $v_{1}, \ldots, v_{k-1}$. Тогда заменим дугу $L$ на путь от $x_{i}$ до $V_{k}$ и путь от $v_{k}$ до $x_{i+1}$, в результате получится искомый цикл.

# 5.2 Разделяющие множества в $k$-связном графе 

В этом разделе граф $G$ будет $k$-связным, мы не всегда будем об этом дополнительно упоминать в определениях и формулировках результатов.

### 5.2.1 Части разбиения, граница и внутренность

Мы обобщим на набор из нескольких разделяющих множеств понятие части разбиения, определенное во введении.

Определение 5.2. Пусть $\mathfrak{S}$ - набор из нескольких разделяющих множеств графа $G$ (которые могут содержать как вершины, так и ребра графа $G)$.

1) Множество $A \subset V(G)$ назовем частью $\mathfrak{S}$-разбиения, если никакие две вершины из $A$ нельзя разделить никаким множеством из $\mathfrak{S}$, но любая другая вершина графа $G$ отделена от множества $A$ хотя бы одним из множеств набора $\mathfrak{S}$.

Множество всех частей разбиения графа $G$ набором разделяющих множеств $\mathfrak{S}$ мы будем обозначать через $\operatorname{Part}(\mathfrak{S})$. В случае, когда неочевидно, какой граф разбивается, мы будем писать $\operatorname{Part}(G ; \mathfrak{S})$.
1) Вершину части $A \in \operatorname{Part}(\mathfrak{S})$ назовем внутренней, если она не входит ни в одно из множеств набора $\mathfrak{S}$. Множество таких вершин назовем внутренностью части $A$ и будем обозначать через $\operatorname{Int}(A)$.

Вершины, входящие в какие-либо множества из $\mathfrak{S}$, мы будем называть граничными, а все их множество - границей и обозначать через $\operatorname{Bound}(A)$.

Замечание 5.2. Отметим, что внутренняя вершина части $A \in \operatorname{Part}(\mathfrak{S})$ может быть концом ребра, входящего в множество $S \in \mathfrak{S}$.

Лемма 5.1. Пусть $\mathfrak{S}$ - набор разделяющих множеств в графе $G$, $A \in \operatorname{Part}(\mathfrak{S}), x \in \operatorname{Int}(A), y \in V(G) \backslash A, x y \in E(G)$. Тогда существует такое множество $S \in \mathfrak{S}$, что $x y \in S$.

Доказательство. Пусть вершина $x \in \operatorname{Int}(A)$ смежна с вершиной $y \in V(G) \backslash A$. Существует множество $S \in \mathfrak{S}$, отделяющее $y$ от $\operatorname{Int}(A)$. Тогда $x, y \notin S$, причем вершины $x$ и $y$ смежны. Следовательно, $x y \in S$.

Следствие 5.3. Пусть $\mathfrak{S}$ - набор разделяющих множеств в графе $G$, содержащих только вершины, $A \in \operatorname{Part}(\mathfrak{S}), \operatorname{Int}(A) \neq \varnothing$. Тогда $\operatorname{Bound}(A)$ отделяет $\operatorname{Int}(A)$ от $V(G) \backslash A$ в графе $G$.

Доказательство. По лемме 5.1 мы имеем $E_{G}(\operatorname{Int}(A), V(G) \backslash A)=\varnothing$.
Разделяющее множество $S \subset V(G)$ в $k$-связном графе $G$ должно содержать не менее чем $k$ вершин. Мы обозначим через $\mathfrak{R}_{k}(G)$ множество всех $k$-вершинных разделяющих множеств графа $G$ и будем изучать свойства множеств из $\mathfrak{R}_{k}(G)$.
Замечание 5.3. Пусть $S \in \mathfrak{R}_{k}(G), A \in \operatorname{Part}(S)$. Тогда $\operatorname{Int}(A) \neq \varnothing$, а индуцированный подграф $G(\operatorname{Int}(A))$ связен.

Однако, если $\mathfrak{S} \subset \mathfrak{R}_{k}(G), B \in \operatorname{Part}(\mathfrak{S})$, то возможно, что $\operatorname{Int}(B)=\varnothing$. Кроме того, при $\operatorname{Int}(B) \neq \varnothing$ индуцированный подграф $G(\operatorname{Int}(B))$ не обязательно связен.

Одно и то же множество вершин $A$ может быть частью разбиения графа $G$ различными наборами $k$-вершинных разделяющих множеств. Мы покажем, что границу и внутренность части $A$ можно определить независимо от набора множеств. Тем самым, понятие части разбиения приобретет самостоятельный смысл.

Лемма 5.2. Пусть $S \in \mathfrak{R}_{k}(G), A \in \operatorname{Part}(S), x \in S$. Тогда существует вершина $y \in \operatorname{Int}(A)$, смежная с $x$.

Доказательство. Предположим противное, пусть $x$ не смежна с $\operatorname{Int}(A)$. Тогда множество $S^{\prime}=S \backslash\{x\}$ отделяет непустое множество вершин $\operatorname{Int}(A)$ от непустого множества вершин $V(G) \backslash A$ (последнее непусто, так как является объединением всех отличных от $\operatorname{Int}(A)$ компонент связности графа $G-S$ ). Таким образом, граф $G-S^{\prime}$ несвязен, и при этом $\left|S^{\prime}\right|=k-1$, что противоречит $k$-связности графа $G$.

Теорема 5.4. Пусть $\mathfrak{S} \subset \mathfrak{R}_{k}(G), A \in \operatorname{Part}(\mathfrak{S})$. Тогда $\operatorname{Bound}(A)$ есть множество всех вершин части $A$, смежных хотя бы с одной вершиной из $V(G) \backslash A$.

Доказательство. Пусть $x \in \operatorname{Bound}(A)$. Существует такое множество $S \in \mathfrak{S}$, что $x \in S$. Множество вершин $S$ не разделяет $A$, следовательно, $A$ может пересекать внутренность не более чем одной части $\operatorname{Part}(S)$. Тогда существует такая часть $B \in \operatorname{Part}(S)$, что $\operatorname{Int}(B) \cap A=\varnothing$. По лемме 5.2 существует вершина $y \in \operatorname{Int}(B)$, смежная с $x$.

По следствию 5.3 ни одна из вершин множества $\operatorname{Int}(A)$ не может быть смежна с вершиной из $V(G) \backslash A$.

Определение 5.3. Пусть $S \in \mathfrak{R}_{k}(G)$, а $H$ - компонента связности графа $G-S$. Мы будем называть $H$ фрагментом. Множество $S$ будем называть границей фрагмента $H$ и обозначать через $\operatorname{Bound}(H)$.

Итак, пусть $H_{1}, \ldots, H_{m}$ - все компоненты связности графа $G-S$. Нетрудно понять, что тогда
$\operatorname{Part}(S)=\left\{H_{1} \cup S, \ldots, H_{m} \cup S\right\}, \quad \operatorname{Int}\left(H_{i} \cup S\right)=H_{i}, \quad \operatorname{Bound}\left(H_{i} \cup S\right)=S$.
Таким образом, фрагменты - это внутренности частей разбиения графа $G$ одним $k$-вершинным разделяющим множеством.

Покажем, что понятия фрагмента и его границы имеют самостоятельный смысл.

Лемма 5.3. Пусть $H$ - фрагмент в $k$-связном графе G. Тогда $\operatorname{Bound}(H)=\mathrm{N}_{G}(H)$.

Доказательство. Пусть $\operatorname{Bound}(H)=S$. Тогда $H=\operatorname{Int}(A)$ для некоторой части $A \in \operatorname{Part}(S)$. По лемме 5.2 , каждая вершина множества $S$ смежна хотя бы с одной вершиной из $H$, то есть, $S \subset \mathrm{~N}_{G}(H)$. Так как $S=\operatorname{Bound}(A)$ отделяет $H=\operatorname{Int}(A)$ от $V(G) \backslash A$, мы имеем $S=\mathrm{N}_{G}(A)$.

Следующая лемма покажет, что $\operatorname{Part}(\mathfrak{S})$ - действительно разбиение графа на части.

Лемма 5.4. Пусть $\mathfrak{S} \subset \mathfrak{R}(G)$, а $A, B \in \operatorname{Part}(\mathfrak{S})$ - две различные части с непустым пересечением. Тогда существует такое множество $S \in \mathfrak{S}$, что $A \cap B \subset S$.

Доказательство. Существует множество $S \in \mathfrak{S}$, отделяющее $A$ от $B$. Легко понять, что $A \cap B \subset S$.

Теорема 5.5. Пусть наборы $\mathfrak{S}_{1}, \ldots, \mathfrak{S}_{n} \subset \mathfrak{R}(G)$ попарно не пересекаются, $\mathfrak{S}=\cup_{i=1}^{n} \mathfrak{S}_{i}$. Рассмотрим все множества вериин вида

$$
A=\bigcap_{i=1}^{n} A_{i}
$$

где $A_{i} \in \operatorname{Part}\left(\mathfrak{S}_{i}\right)$. Выполняются следующие утверждения.

1) Любая часть $A \in \operatorname{Part}(\mathfrak{S})$ представляется в виде (5.1).
2) Из всех множеств вериин графа $G$, представимых в виде (5.1), частями $\operatorname{Part}(\mathfrak{S})$ являются те и только те, которые являются максимальными по включению среди множеств такого вида.
3) Если множество вериин $A \notin \operatorname{Part}(\mathfrak{S})$ представимо в виде (5.1), то $A$ является подмножеством одного из множеств набора $\mathfrak{S}$.

Доказательство. 1) Пусть $A \in \operatorname{Part}(\mathfrak{S})$. Для каждого $i \in\{1,2, \ldots, n\}$ ни одно из множеств набора $\mathfrak{S}_{i}$ не разделяет $A$, следовательно, существует часть $A_{i} \in \operatorname{Part}\left(\mathfrak{S}_{i}\right)$, содержащая $A$. Пусть $A^{\prime}=\cap_{i=1}^{n} A_{i}$. Включение $A \subset A^{\prime}$ очевидно.

Понятно, что никакое можество набора $\mathfrak{S}$ не разделяет $A^{\prime}$, следовательно, существует такая часть $B \in \operatorname{Part}(\mathfrak{S})$, что $A^{\prime} \subset B$. Таким образом, $A \subset A^{\prime} \subset B$, откуда следует, что $A=A^{\prime}=B$.
1) Пусть множество $A \subset V(G)$, представимое в виде (5.1) - максимальное по включению среди множеств такого вида. Тогда $A$ невозможно разделить никаким множеством из набора $\mathfrak{S}$. Если $A \notin \operatorname{Part}(\mathfrak{S})$, то существует такая часть $B \in \operatorname{Part}(\mathfrak{S})$, что $B \supseteq A$. Из пункта 1 следует противоречие с максимальностью $A$.

Пусть $A \in \operatorname{Part}(\mathfrak{S})$. Рассмотрим представление $A$ в виде (5.1) и предположим, что $A$ - не максимальное по включению среди множеств такого вида. Пусть $A \subset B$ и для $B$ существует представление вида (5.1). Тогда $B$ невозможно разделить никаким множеством из набора $\mathfrak{S}$, следовательно, $A$ не является частью $\operatorname{Part}(\mathfrak{S})$.
1) Пусть $A=\cap_{i=1}^{n} A_{i}$ (где $A_{i} \in \operatorname{Part}\left(\mathfrak{S}_{i}\right)$ ), причем $A \notin \operatorname{Part}(\mathfrak{S})$. Тогда существует такая часть $B \in \operatorname{Part}(\mathfrak{S})$, что $B \supseteq A$. Рассмотрим представление $B=\cap_{i=1}^{n} B_{i}$, где $B_{i} \in \operatorname{Part}\left(\mathfrak{S}_{i}\right)$. Так как $B \neq A$, то $A_{j} \neq B_{j}$ для какого-то $j$. Следовательно, $A \subset A_{j} \cap B_{j}$, а такое пересечение по лемме 5.4 является подмножеством одного из множеств набора $\mathfrak{S}_{j}$.

Лемма 5.5. Пусть наборы $\mathfrak{S}, \mathfrak{T} \subset \mathfrak{R}(G)$ не пересекаются, а часть $A \in P(\mathfrak{S})$ такова, что ни одно из множеств набора $\mathfrak{T}$ ее не разделяem. Тогда $A \in P(\mathfrak{S} \cup \mathfrak{T})$.

Доказательство. Так как ни одно из множеств набора $\mathfrak{S} \cup \mathfrak{T}$ не разделяет $A$, существует такая часть $B \in \operatorname{Part}(\mathfrak{S} \cup \mathfrak{T})$, что $A \subset B$. Кроме того, существует содержащая $B$ часть $A^{\prime} \in \operatorname{Part}(\mathfrak{S})$. Таким образом, $A \subset B \subset A^{\prime}$, откуда очевидно следует, что $A=B=A^{\prime}$.

# 5.2.2 Зависимые и независимые разделяющие множества 

Определение 5.4. Назовем множества $S, T \in \mathfrak{R}_{k}(G)$ независимыми, если $S$ не разделяет $T$ и $T$ не разделяет $S$. В противном случае мы будем называть эти множества зависимыми.

K сожалению, разделяющие множества, состоящие из $k \geq 2$ вершин, могут быть зависимыми. Именно с этим связаны основные трудности в изучении $k$-связных графов при $k \geq 2$.

Лемма 5.6. Пусть $S, T \in \mathfrak{R}_{k}(G)$ и часть $A \in \operatorname{Part}(S)$ таковы, что $T \cap \operatorname{Int}(A)=\varnothing$. Тогда $T$ не разделяет часть $A$ и, следовательно, $T$ не разделяет множество $S$.

Доказательство. Как мы уже отмечали, граф $G(\operatorname{Int}(A))$ связен. Любая вершина $x \in S \backslash T$ смежна хотя бы с одной из вершин множества $\operatorname{Int}(A)$ по лемме 5.2. Следовательно, граф $G(A \backslash T)$ связан, откуда очевидно следует, что $T$ не разделяет $A$ и $T$ не разделяет $S$.

Лемма 5.7. Пусть $S, T \in \mathfrak{R}_{k}(G)$ таковы, что множество $S$ не разделяет множество $T$. Тогда множество $T$ не разделяет множество $S$ (то есть, эти множества независимы).

Доказательство. Так как множество $S$ не разделяет $T$, множество $T$ может пересекать внутренность не более, чем одной из частей $\operatorname{Part}(S)$. Тогда существует такая часть $A \in \operatorname{Part}(S)$, что $\operatorname{Int}(A) \cap T=\varnothing$. По лемме 5.6, множество $T$ не разделяет $S$.

Итак, мы установили, что возможен один из двух случаев: либо множества $S$ и $T$ разделяют друг друга (тогда они зависимы), либо множества $S$ и $T$ не разделяют друг друга (тогда они независимы).

Следствие 5.4. Пусть множества $S, T \in \mathfrak{R}_{k}(G)$ независимы, а часть $A \in \operatorname{Part}(S)$ содержит $T$. Тогда в $\operatorname{Part}(T)$ есть часть, содержащая все отличные от $A$ части из $\operatorname{Part}(S)$, а все остальные части $\operatorname{Part}(T)$ являются подмножествами $A$.

Доказательство. Множество $S$ не пересекает внутренности отличной от $A$ части $\operatorname{Part}(T)$. По лемме 5.6 тогда множество $S$ не разделяет никакой отличной от $A$ части из $\operatorname{Part}(T)$. Поскольку $T \backslash S \neq \varnothing$, все эти части содержатся в одной части из $\operatorname{Part}(S)$.

Следствие 5.5. Пусть $H$ - фрагмент графа $G, T \in \mathfrak{R}_{k}(G), T \cap H \neq \varnothing$, причем множество $T$ независимо с границей фрагмента $H$. Тогда существует фрагмент $H^{\prime} \subsetneq H$ с границей $T$.

Доказательство. Пусть $S=\operatorname{Bound}(H)$, а часть $A \in \operatorname{Part}(S)$ такова, что $H=\operatorname{Int}(A)$. Из независимости $S$ и $T$ следует, что $T \subset A$. По следствию 5.4 существует часть $B \in \operatorname{Part}(T)$, лежащая в $A$. Из теоремы 5.4 понятно, что $\operatorname{Int}(B) \cap S=\varnothing$. Следовательно, $\operatorname{Int}(B)=B \backslash T \subsetneq \operatorname{Int}(A)$.

Изучим, как разбивает граф пара зависимых разделяющих множеств.
Лемма 5.8. Пусть множества $S, T \in \mathfrak{R}_{k}(G)$ зависимы, $\operatorname{Part}(S)=$ $\left\{A_{1}, \ldots, A_{m}\right\}, \operatorname{Part}(T)=\left\{B_{1}, \ldots, B_{n}\right\}, P=T \cap S, T_{i}=T \cap \operatorname{Int}\left(A_{i}\right)$, $S_{j}=S \cap \operatorname{Int}\left(B_{j}\right), G_{i, j}=A_{i} \cap B_{j}$. Тогда выполняются следующие утверждения.

1) Все множества $T_{1}, \ldots, T_{m} ; S_{1}, \ldots, S_{n}$ непусты.
2) $\operatorname{Part}(\{S, T\})=\left\{G_{i, j}\right\}_{i \in[1 . . m], j \in[1 . . n]}$, причем $\operatorname{Bound}\left(G_{i, j}\right)=P \cup T_{i} \cup S_{j}$.

Доказательство. 1) В силу леммы 5.6 и зависимости множеств $S$ и $T$, $T_{i}=T \cap \operatorname{Int}\left(A_{i}\right) \neq \varnothing$ и $S_{j}=S \cap \operatorname{Int}\left(B_{j}\right) \neq \varnothing$.
1) По теореме 5.5 части $\operatorname{Part}(\{S, T\})-$ это максимальные по включению среди множеств вида $G_{i, j}$, то есть, все такие множества: из пункта 1 следует, что $G_{\alpha, \beta} \not \subset G_{\gamma, \delta}$ при $(\alpha, \beta) \neq(\gamma, \delta)$. Утверждение $\operatorname{Bound}\left(G_{i, j}\right)=$ $P \cup T_{i} \cup S_{j}$ очевидно.

В следующей лемме мы используем обозначения из леммы 5.8.
Лемма 5.9. Пусть множества $S, T \in \mathfrak{R}_{k}(G)$ зависимы. Тогда выполняются следующие утверждения.

1) Пусть $i \neq x, j \neq y,\left|\operatorname{Bound}\left(G_{i, j}\right)\right| \geq k u\left|\operatorname{Bound}\left(G_{x, y}\right)\right| \geq k$. Тогда

$$
\begin{gathered}
\left|\operatorname{Bound}\left(G_{i, j}\right)\right|=\left|\operatorname{Bound}\left(G_{x, y}\right)\right|=k, \quad|\operatorname{Part}(S)|=|\operatorname{Part}(T)|=2 \\
\left|T_{i}\right|=\left|S_{y}\right|, \quad\left|T_{x}\right|=\left|S_{j}\right|
\end{gathered}
$$

1) Если все части $\operatorname{Part}(\{S, T\})$ содержат хотя бы по $k$ вершин, то в границе каждой части $\operatorname{Part}(\{S, T\})$ ровно $k$ вершин,

$$
|\operatorname{Part}(S)|=|\operatorname{Part}(T)|=2 \quad u \quad\left|T_{1}\right|=\left|T_{2}\right|=\left|S_{1}\right|=\left|S_{2}\right|
$$

Доказательство. 1) Заметим, что

$$
\begin{aligned}
2 k \leq\left|\operatorname{Bound}\left(G_{i, j}\right)\right| & +\left|\operatorname{Bound}\left(G_{x, y}\right)\right|= \\
2|P| & +\left|T_{i}\right|+\left|T_{x}\right|+\left|S_{j}\right|+\left|S_{y}\right| \leq|S|+|T|=2 k
\end{aligned}
$$

Значит, оба неравенства обращаются в равенства, откуда следует, что $T=T_{i} \cup T_{x} \cup P, S=S_{j} \cup S_{y} \cup P$ (а по лемме 5.8 это означает, что $|\operatorname{Part}(S)|=$ $|\operatorname{Part}(T)|=2$, см. рисунок 5.2 ) и $\left|\operatorname{Bound}\left(G_{i, j}\right)\right|=\left|\operatorname{Bound}\left(G_{x, y}\right)\right|=k$. Из

$$
\left|T_{i}\right|+\left|S_{j}\right|+|P|=\left|\operatorname{Bound}\left(G_{i, j}\right)\right|=k=|T|=\left|T_{i}\right|+\left|T_{x}\right|+|P|
$$

следует, что $\left|S_{j}\right|=\left|T_{x}\right|$. Аналогично доказывается, что $\left|S_{y}\right|=\left|T_{i}\right|$.

| $G_{i, j}$ |  |  |
| :--: | :--: | :--: |
| $S_{j}$ |  |  |
| $T_{i}$ | $P$ | $T_{x}$ |
|  | $S_{y}$ | $G_{x, y}$ |

Рис. 5.2: Разбиение графа двумя зависимыми множествами.
1) Достаточно применить пункт 1 сначала к паре частей $G_{1,1}$ и $G_{2,2}$, а затем к паре частей $G_{1,2}$ и $G_{2,1}$.

# 5.3 Удаление вершин с сохранением $k$-связности 

Очевидно, в любом связном графе $H$ существует такая вершина $v$, что граф $H-v$ связен: достаточно в качестве $v$ взять любую висячую вершину любого остовного дерева графа $H$. Для $k$-связного графа всё значительно сложнее: существуют $k$-связные графы, из которых невозможно удалить вершину с сохранением $k$-связности. Такие графы называются критическими $k$-связными графами. Простейшим примером критического двусвязного графа является простой цикл. Мы определим нерасщепимые $k$-связные графы и покажем, что из любого такого графа можно удалить вершину с сохранением $k$-связности.

Определение 5.5. Будем называть $k$-связный граф $G$ нерасщепимым, если не существует множества $S \in \mathfrak{R}_{k}(G)$ и фрагмента $H$ таких, что $H \subset S$.

Сначала покажем, что любой $k$-связный граф достаточно большой минимальной степени является нерасщепимым.

Лемма 5.10. Пусть $G-k$-связный граф с $\delta(G) \geq \frac{3 k-1}{2}$. Тогда $G-$ нерасщепимый.

Доказательство. Предположим противное, пусть у графа $G$ существует фрагмент, лежащий в множестве из $\mathfrak{R}_{k}(G)$. Рассмотрим среди всех таких фрагментов минимальный фрагмент $H$. Пусть $S, T \in \mathfrak{R}_{k}(G)$ таковы, что $H \subset T$ и $S=\operatorname{Bound}(H)$. Рассмотрим вершину $x \in H$. Она может быть смежна только с вершинами из $H \cup S$. Так как $d_{G}(x) \geq \frac{3 k-1}{2}$ и $|S|=k$, мы имеем $|H| \geq \frac{k-1}{2}+1=\frac{k+1}{2}$. Рассмотрим два случая.

1. Множества $S$ и $T$ независимы.

Тогда по следствию 5.5 существует фрагмент $H^{\prime} \subsetneq H$, что противоречит минимальности $H$.
1. Множества $S$ и $T$ зависимы.

Пусть $\operatorname{Part}(S)=\left\{A_{1}, \ldots, A_{m}\right\}, \operatorname{Part}(T)=\left\{B_{1}, \ldots, B_{n}\right\}$. Будем считать $H=\operatorname{Int}\left(A_{1}\right)$ и использовать обозначения из леммы 5.8. Тогда $T_{1}=$ $\operatorname{Int}\left(A_{1}\right)$, следовательно, $\left|T_{1}\right| \geq \frac{k+1}{2}$. Значит, для любого $i \in[2 . . m]$ мы имеем $\left|T_{i}\right| \leq \frac{k-1}{2}$. Не умаляя общности можно положить $\left|S_{1}\right| \geq\left|S_{2}\right|$, тогда $\left|S_{2}\right| \leq \frac{k}{2}$. Отметим, что

$$
\left|T_{1}\right|+\left|S_{1}\right|+|P|+\left|T_{i}\right|+\left|S_{2}\right|+|P| \leq|T|+|S|=2 k
$$

следовательно, $\left|T_{i}\right|+\left|S_{2}\right|+|P|<k$.


Рис. 5.3: Фрагменты $H$ и $H^{\prime}$.
Рассмотрим часть $G_{i, 2}=A_{i} \cap B_{2}$. Предположим, что $\operatorname{Int}\left(G_{i, 2}\right) \neq \varnothing$, тогда по следствию 5.3 состоящее менее чем из $k$ вершин множество $\operatorname{Bound}\left(G_{i, 2}\right)=T_{i} \cup S_{2} \cup P$ отделяет от остальных вершин графа непустое множество $\operatorname{Int}\left(G_{i, 2}\right)$, что противоречит $k$-связности графа $G$. Следовательно, $\operatorname{Int}\left(G_{i, 2}\right)=\varnothing$ для всех $i \in[2 . . m]$. Так как $A_{1} \subset T$ а $G_{1,2}=A_{1} \cap B_{2}$, то $\operatorname{Int}\left(G_{1,2}\right)=\varnothing$. Поскольку $B_{2}=\cup_{i \in[1 . . m]} G_{i, 2}$, то $\operatorname{Int}\left(B_{2}\right)=S_{2} \subset S$. Таким образом, мы нашли фрагмент $H^{\prime}=\operatorname{Int}\left(B_{2}\right)$, лежащий в множестве

$S \in \mathfrak{R}_{k}(G)$, причем $\left|H^{\prime}\right| \leq \frac{k}{2}$. Выше доказано, что при $\delta(G) \geq \frac{3 k-1}{2}$ такое невозможно.

Условие нерасщепимости существенно упорядочивает структуру взаимного расположения $k$-вершинных разделяющих множеств в $k$-связном графе. В следующей лемме мы воспользуемся обозначениями из леммы 5.8 .

Лемма 5.11. Пусть $G$ - нерасщепимый $k$-связный граф, а множества $S, T \in \mathfrak{R}_{k}(G)$ зависимы. Тогда каждое из них делит граф на две части, причем можно их занумеровать так, что $\operatorname{Part}(S)=\left\{A_{1}, A_{2}\right\}$, $\operatorname{Part}(T)=\left\{B_{1}, B_{2}\right\} u\left|\operatorname{Bound}\left(G_{1,2}\right)\right|=\left|\operatorname{Bound}\left(G_{2,1}\right)\right|=k$.
Замечание 5.4. Отметим, что в этой нумерации $\left|T_{1}\right|=\left|S_{1}\right|$ и $\left|T_{2}\right|=\left|S_{2}\right|$.
Доказательство. Пусть $\operatorname{Part}(S)=\left\{A_{1}, \ldots, A_{m}\right\}, \operatorname{Part}(T)=\left\{B_{1}, \ldots, B_{n}\right\}$. Изобразим разбиение графа множествами $S$ и $T$ в виде таблицы $m \times n$, где клетка с координатами $(i, j)$ соответствует части $G_{i, j}=A_{i} \cap B_{j}:$ мы запишем в этой клетке количество вершин в $\operatorname{Int}\left(G_{i, j}\right)$.

Предположим, что есть столбец (не умаляя общности, первый), в котором записаны только нули. Тогда

$$
\operatorname{Int}\left(A_{1}\right)=\bigcup_{j \in[1 . . n]} G_{1, j} \backslash S \quad \subset \quad T
$$

что противоречит нерасщепимости графа.
Таким образом, в каждой строке и в каждом столбце есть хотя бы один не ноль. Отсюда нетрудно сделать вывод, что существуют пары индексов $(\alpha, \beta)$ и $(\gamma, \delta)$ такие, что $\alpha \neq \gamma, \beta \neq \delta, \operatorname{Int}\left(G_{\alpha, \beta}\right) \neq \varnothing$ и $\operatorname{Int}\left(G_{\gamma, \delta}\right) \neq \varnothing$. Тогда $\left|\operatorname{Bound}\left(G_{\alpha, \beta}\right)\right| \geq k$ и $\left|\operatorname{Bound}\left(G_{\gamma, \delta}\right)\right| \geq k$. Теперь доказываемое утверждение следует из пункта 1 леммы 5.9 , нужно лишь положить $\alpha=\delta=1$ и $\beta=\gamma=2$.

Теорема 5.6. (Д. В. Карпов, А. В. Пастор, 2000.) Пусть $G$ - нерасщепимый $k$-связный граф, $H$ - минимальный по включению фрагмент графа $G$. Тогда для любой вершины $x \in H$ граф $G-x$ является $k$-связнымм.

Доказательство. Предположим противное. Тогда существует такое множество $T \in \mathfrak{R}_{k}(G)$, что $T \cap H \neq \varnothing$. Пусть $S \in \mathfrak{R}_{k}(G)$ и $A_{1} \in \operatorname{Part}(S)$ таковы, что $H=\operatorname{Int}\left(A_{1}\right)$. Если $S$ и $T$ независимы, то по следствию 5.5 существует фрагмент $H^{\prime} \varsubsetneqq H$, что противоречит минимальности $H$. Таким образом, $S$ и $T$ зависимы. Тогда по лемме 5.11 можно считать, что

$$
\operatorname{Part}(S)=\left\{A_{1}, A_{2}\right\}, \quad \operatorname{Part}(T)=\left\{B_{1}, B_{2}\right\}
$$

$$
\left|\operatorname{Bound}\left(G_{1,2}\right)\right|=\left|\operatorname{Bound}\left(G_{2,1}\right)\right|=k
$$

Если $\operatorname{Int}\left(G_{1,2}\right) \neq \varnothing$, то, так как $\left|\operatorname{Bound}\left(G_{1,2}\right)\right|=k, \operatorname{Int}\left(G_{1,2}\right) \subsetneq H-$ фрагмент, что противоречит минимальности $H$. Следовательно, $\operatorname{Int}\left(G_{1,2}\right)=\varnothing$, откуда из нерасщепимости графа немедленно следует $\operatorname{Int}\left(G_{1,1}\right) \neq \varnothing$ и $\operatorname{Int}\left(G_{2,2}\right) \neq \varnothing$, а значит, в границах этих частей хотя бы по $k$ вершин. По лемме 5.9 мы получаем, что $\left|\operatorname{Bound}\left(G_{1,1}\right)\right|=$ $\left|\operatorname{Bound}\left(G_{2,2}\right)\right|=k$, следовательно, $\operatorname{Int}\left(G_{1,1}\right)$ - фрагмент, причем $\operatorname{Int}\left(G_{1,1}\right) \subsetneq H$, что противоречит минимальности $H$.

Непосредственно из леммы 5.10 и теоремы 5.6 можно вывести следствие.

Следствие 5.6. (G. Chartrand, A. Kaugars, D. R. Lick, 1972.) Пусть $G-k$-связный граф, $\delta(G) \geq \frac{3 k-1}{2}$. Тогда существует такая вершина $x \in V(G)$, что граф $G-x$ является $k$-связным.

Именно это утверждение было первым результатом об удалении вершины с сохранением $k$-связности. Доказательство было гораздо более технически сложным, чем приведенное в этой книге.

# 5.4 Удаление ребер с сохранением $k$-связности 

В этом разделе мы будем вести разговор о $k$-связном графе $G$ и использовать для него следующие обозначения. Через $V_{k}$ мы обозначим множество всех вершин графа $G$, имеющих степень $k$, пусть

$$
V_{k+1}=V(G) \backslash V_{k}, \quad v_{k}=\left|V_{k}\right|, \quad v_{k+1}=\left|V_{k+1}\right|, \quad G_{k+1}=G\left(V_{k+1}\right)
$$

В тех случаях, когда из контекста неясно, о каком графе идет речь, мы будем применять обозначения $V_{k}(G), V_{k+1}(G)$ и так далее.

Определение 5.6. Назовем ребро $e \in E(G)$ критическим, если граф $G-e$ не является $k$-связным.

Назовем $k$-связный граф минимальным, если все его ребра - критические.

В любом связном графе $H$, отличном от дерева, существует такое ребро $e$, что граф $H-e$ связен: достаточно в качестве $e$ взять любое ребро, входящее в цикл. Таким образом, минимальные 1-связные графы - это деревья. Как это ни удивительно, ситуация с минимальными $k$-связными

графами во многом похожая. Наибольший вклад в исследования минимальных $k$-связных графов внёс немецкий математик Мадер, которому и принадлежат основные результаты этого раздела.

Для удобства работы с минимальными $k$-связными графами нам понадобится еще одно понятие.

Определение 5.7. Пусть $G-k$-связный граф. Назовём разрезом $k$-элементное разделяющее множество, содержащее хотя бы одно ребро. Обозначим через $\mathfrak{T}(G)$ множество всех разрезов $k$-связного графа $G$.

Рассмотрим разрез $T \in \mathfrak{T}(G)$ и несвязный граф $G-T$. Так как в $k$-связном графе разделяющее множество содержит хотя бы $k$ элементов, при добавлении в $G-T$ любого из рёбер разреза $T$ мы получим связный граф. Значит, $\operatorname{Part}(T)$ состоит из двух частей, а каждое ребро разреза $T$ соединяет вершины из разных частей.

Также отметим, что вершина $x \in T$ и ребро $e \in T$ не могут быть инцидентны друг другу - иначе $k$-связным граф $T$ можно сделать несвязным, удалив $k-1$ элементное множество $T \backslash\{e\}$.

Теперь определим границы разреза.
Определение 5.8. Пусть $T \in \mathfrak{T}(G)$.

1) Обозначим через $V(T)$ множество всех входящих в $T$ вершин, а через $W(T)$ - множество, состоящее из всех вершин, входящих в разрез $T$ и всех вершин, инцидентных рёбрам разреза $T$.
2) Пусть $\operatorname{Part}(T)=\left\{A_{1}, A_{2}\right\}$. Назовем множества $\mathrm{R}\left(\mathrm{A}_{1}\right)=\mathrm{A}_{1} \cap \mathrm{~W}(\mathrm{~T})$ и $\mathrm{R}\left(\mathrm{A}_{2}\right)=\mathrm{A}_{2} \cap \mathrm{~W}(\mathrm{~T})$ границами разреза $T$.

Отметим следующие очевидные свойства разрезов.
Замечание 5.5. Пусть $T \in \mathfrak{T}(G), \operatorname{Part}(T)=\left\{A_{1}, A_{2}\right\}$. Тогда выполняются следующие утверждения.

1) $A_{1} \cup A_{2}=V(G), A_{1} \cap A_{2}=V(T)$.
2) Границы разреза $T$ содержат по $k$ элементов. Каждая из границ разреза $T$ содержит $V(T)$ и по одному концу всех входящих в $T$ рёбер.
3) Если $A_{1}^{\prime}=A_{1} \backslash \mathrm{R}\left(\mathrm{A}_{1}\right) \neq \varnothing$, то $\mathrm{R}\left(\mathrm{A}_{1}\right)$ отделяет $A_{1}^{\prime}$ от $V(G) \backslash A_{1}$. В этом случае $\mathrm{R}\left(\mathrm{A}_{1}\right) \in \mathfrak{R}_{\mathrm{k}}(\mathrm{G})$, а каждая вершина из $\mathrm{R}\left(\mathrm{A}_{1}\right)$ смежна хотя бы с одной вершиной из $A_{1}^{\prime}$.

Вернемся к минимальным $k$-связным графам и критическим рёбрам. Обозначим через $\mathfrak{T}^{\prime}(G)$ множество всех разрезов минимального $k$-связного графа $G$, содержащих одно ребро и $k-1$ вершину.

Ребро $a b$ графа $G$ является критическим, если и только если в гра$\operatorname{de} G-a b$ существует ( $k-1$ )-вершинное разделяющее множество, то есть,

существует разрез $T_{a b}$ в графе $G$, содержащий ребро $a b$ и $k-1$ вершину. Таким образом, для любого критического ребра $k$-связного графа $G$ (и, в частности, для любого ребра минимального $k$-связного графа $G$ ) существует разрез из $\mathfrak{T}(G)$, содержащий это ребро.

Лемма 5.12. (W. Mader.) Пусть $G-k$-связный граф, $a, b, c \in V_{k+1}(G)$, ребра $a b, a c \in E(G)$ - критические, а разрель $T, S \in \mathfrak{T}(G)$ таковы, что $a b \in T, a c \in S$. Пусть $\operatorname{Part}(T)=\left\{H_{a}, \bar{H}_{a}\right\}$, $\operatorname{Part}(S)=\left\{F_{a}, \bar{F}_{a}\right\}$, где $a \in H_{a}, a \in F_{a}$. Тогда $\left|H_{a}\right|>\left|\bar{F}_{a}\right|$.

Доказательство. Пусть $A=H_{a} \cap F_{a}, B=\bar{H}_{a} \cap \bar{F}_{a}$. Будем рассматривать $A$ и $B$ как части $\operatorname{Part}(\{S, T\})$ и соответственно определим у них границу (множество вершин части, входящих в $S$ или $T$ ) и внутренность. Пусть

$$
\begin{aligned}
P=S \cap T, \quad T_{1}=T \cap \operatorname{Int}\left(F_{a}\right), \quad & T_{2}=T \cap \operatorname{Int}\left(\bar{F}_{a}\right) \\
& S_{1}=S \cap \operatorname{Int}\left(H_{a}\right), \quad S_{2}=S \cap \operatorname{Int}\left(\bar{H}_{a}\right)
\end{aligned}
$$

Определенные выше множества изображены на рисунке 5.4. Отметим, что некоторые из этих множеств могут быть пусты.


Рис. 5.4: Множества $S, T$ и части разбиения.
Очевидно, $\operatorname{Bound}(A)=T_{1} \cup S_{1} \cup P, \operatorname{Bound}(B)=T_{2} \cup S_{2} \cup P$, откуда следует $|\operatorname{Bound}(A)|+|\operatorname{Bound}(B)|=2 k-2$. Поскольку

$$
H_{a} \backslash\left(H_{a} \cap \bar{F}_{a}\right)=T_{1} \cup \operatorname{Int}(A), \quad \bar{F}_{a} \backslash\left(H_{a} \cap \bar{F}_{a}\right)=S_{2} \cup \operatorname{Int}(B)
$$

то достаточно доказать, что $|\operatorname{Int}(A)|>|\operatorname{Int}(B)|$ и $\left|T_{1}\right| \geq\left|S_{2}\right|$.
Так как $a$ не принадлежит множествам $S$ и $T$, то $\operatorname{Int}(A) \ni a$. Рассмотрим два случая.

1. $\operatorname{Int}(A)=\{a\}$.

Ровно два ребра выходят из вершины $a$ вне части $A-$ это ребра $a b \in$ $T$ и $a c \in S$. Остальные инцидентные $a$ ребра могут выходить лишь в

часть $A$ и из $\operatorname{Int}(A)=\{a\}$ легко сделать вывод $|\operatorname{Bound}(A)| \geq d_{G}(a)-2 \geq$ $k-1$. Следовательно, $|\operatorname{Bound}(B)|=2 k-2-|\operatorname{Bound}(A)| \leq k-1$. Таким образом,

$$
\left|T_{1}\right|+|P|+\left|T_{2}\right|=|V(T)|=k-1 \geq|\operatorname{Bound}(B)|=\left|S_{2}\right|+|P|+\left|T_{2}\right|
$$

откуда $\left|T_{1}\right| \geq\left|S_{2}\right|$.
Смежные вершины $a$ и $c$, очевидно, не могут быть разделены множеством $T \not \partial a c$, поэтому $c \in H_{a}$. Аналогично, $b \in F_{a}$. Тогда $a, b, c \notin B$. Следовательно, ни одна из вершин $\operatorname{Int}(B)$ не смежна с вершинами не из $B$. Если $\operatorname{Int}(B) \neq \varnothing$, то $(k-1)$-вершинное множество $\operatorname{Bound}(B)$ отделяет $\operatorname{Int}(B)$ от $V(G) \backslash B$, что противоречит $k$-связности графа $G$. Следовательно, $\operatorname{Int}(B)=\varnothing$ и $|\operatorname{Int}(B)|<|\operatorname{Int}(A)|$, нужное нам неравенство доказано.
1. $\operatorname{Int}(A) \neq\{a\}$, следовательно, $\operatorname{Int}(A) \backslash\{a\} \neq \varnothing$.

Очевидно, $b, c \notin A$. Значит, никакая вершина множества $\operatorname{Int}(A) \backslash\{a\}$ не смежна с вершинами не из $A$, то есть, множество вершин $\operatorname{Bound}(A) \cup\{a\}$ отделяет непустое множество $\operatorname{Int}(A) \backslash\{a\}$ от $V(G) \backslash A$. Из $k$-связности графа $G$ можно сделать вывод $|\operatorname{Bound}(A)| \geq k-1$, откуда аналогично рассуждениям пункта 1 получаем $|\operatorname{Bound}(B)| \leq k-1, \operatorname{Int}(B)=\varnothing$ и $|\operatorname{Int}(B)|<|\operatorname{Int}(A)|$.

Теорема 5.7. (W. Mader, 1972.) Пусть $G$ - минимальный $k$-связный граф. Тогда $G_{k+1}-$ лес.

Доказательство. Предположим противное, пусть $a_{1} a_{2} \ldots a_{n}$ - простой цикл в $G_{k+1}$. Из минимальности графа $G$ следует, что существует разрез $S_{i} \in \mathfrak{T}^{\prime}(G)$, содержащий $a_{i-1} a_{i}$. Пусть $H_{i} \in \operatorname{Part}\left(S_{i}\right)$ - часть, содержащая $a_{i}$. Тогда по лемме 5.12 мы имеем

$$
\left|H_{1}\right|>\left|H_{2}\right|>\cdots>\left|H_{n}\right|>\left|H_{1}\right|
$$

что невозможно.
Следствие 5.7. (W. Mader, 1972.) Пусть $G$ - минимальный $k$-связный граф. Тогда $v_{k}(G) \geq \frac{(k-1) \cdot v(G)+2}{2 k-1}$.

Доказательство. Из каждой вершины множества $V_{k+1}$ выходит не менее, чем $k+1$ ребро, сумма степеней вершин графа $G_{k+1}$ не более $2 v_{k+1}-2$ (так как это лес), следовательно, не менее

$$
(k+1) v_{k+1}-2 v_{k+1}+2=(k-1) v_{k+1}+2=(k-1) v(G)-(k-1) v_{k}+2
$$

ребер выходит из $V_{k+1}$ в $V_{k}$. Так как в каждую из $v_{k}$ вершин множества $V_{k}$ входит не более $k$ ребер, мы получаем неравенство

$$
(k-1) v(G)-(k-1) v_{k}+2 \leq k v_{k}
$$

откуда немедленно следует доказываемое утверждение.
Замечание 5.6. В 1979 году Мадер доказал более сильное утверждение: для минимального $k$-связного графа $G$ :

$$
v_{k}(G) \geq \frac{(k-1) \cdot v(G)+2 k}{2 k-1}
$$

Эта оценка для любого $k$ - точная, но ее доказательство - весьма сложное.

Из теоремы 5.7 легко вывести утверждение для минимальных графов малой связности, доказанное Халиным на 3 года раньше.

Теорема 5.8. (R. Halin, 1969.) Пусть $G$ - минимальный $k$-связный граф, $2 \leq k \leq 3$. Тогда в каждом треугольнике графа $G$ не менее двух вершин степени $k$.

Доказательство. По теореме 5.7, в каждом цикле, а стало быть, и в треугольнике графа $G$ есть вершина степени $k$. Остается доказать, что не существует треугольника, в котором одна вершина имеет степень $k$, а две другие - степень более $k$.

Предположим, что такой треугольник $x x^{\prime} y$ есть: $x, x^{\prime} \in V_{k+1}, y \in V_{k}$. В силу минимальности графа, существует такой разрез $T \in \mathfrak{T}^{\prime}(G)$, что $x x^{\prime} \in T$. Так как граф $G-T$ несвязен, а $y x, y x^{\prime} \in E(G)$, мы имеем $y \in T$. Пусть $\operatorname{Part}(T)=\left\{A, A^{\prime}\right\}$, где $A \ni x$ и $A^{\prime} \ni x^{\prime}$. Введем обозначения $R=\mathrm{R}(\mathrm{A}), R^{\prime}=\mathrm{R}\left(\mathrm{A}^{\prime}\right), A_{0}=A \backslash R, A_{0}^{\prime}=A^{\prime} \backslash R^{\prime}$.

В силу $d_{G}(x) \geq k+1$ мы имеем $A_{0} \neq \varnothing$. Тогда по замечанию 5.5 оказывается, что вершина $y \in R$ имеет смежную вершину $z \in A_{0}$. Аналогично, $y$ смежна с вершиной $z^{\prime} \in A_{0}^{\prime}$. Легко видеть, что $z, z^{\prime}, x, x^{\prime}$ - четыре разные вершины, откуда следует $k=d_{G}(y) \geq 4$, потиворечие.

Халин доказал и более сильное утверждение: при $k \in\{2,3\}$ в любом цикле минимального $k$-связного графа есть хотя бы две вершины степени $k$.

# 5.5 Деревья разбиения 

Главный вопрос этого раздела - а как же расположены относительно друг друга $k$-вершинные разделяющие множества в $k$-связном графе? Как они разбивают на части граф и друг друга? Начнем с классического и почти очевидного случая точек сочленения в связном графе (то есть, $k=1$ ).

Затем мы перейдем к произвольному $k$ и расскажем о дереве разбиения $k$-связного графа набором из попарно независимых $k$-разделяющих множеств. С помощью этой конструкции мы полностью изучим взаимное расположение двухвершинных разделяющих множеств в двусвязном графе, а также части, на которые они разбивают граф.

### 5.5.1 Точки сочленения и блоки в связном графе

Итак, вернемся к простым вещам. В этом разделе пусть $G$ - связный граф, вспомним о его блоках и точках сочленения, определенных во введении.

Применив к связному графу $G$ тяжелую артиллерию из уже доказанных фактов, можно рассмотреть набор $\mathfrak{R}_{1}(G)$ из всех точек сочленения графа $G$. Сильно упрощает ситуацию тот факт, что любые две точки сочленения независимы (поскольку разбить точку сочленения на две части невозможно).

Рассмотрим следующий процесс. Выберем точку сочленения $a$ и "разрежем" по ней $G$. Строго говоря, если $\operatorname{Part}(a)=\left\{B_{1}, \ldots, B_{k}\right\}$, мы перейдем к рассмотрению связных графов $G\left(B_{1}\right), \ldots, G\left(B_{k}\right)$. Возьмем один из графов и выберем в нем точку сочленения, после чего перейдем к рассмотрению новых частей, и так далее, пока все полученные графы не окажутся двусвязными.

Лемма 5.13. Пусть а - точка сочленения графа $G$, а $U \in \operatorname{Part}(G ; a)$. Тогда выполнены следующие утверждения.

1) Пусть $b \in U$ - точка сочленения графа $G$, причем $b \neq a$. Тогда $b-$ точка сочленения графа $G(U)$.
2) Любая точка сочленения $b^{\prime}$ графа $G(U)$ является точкой сочленения графа $G$, причем $b^{\prime} \neq a$.

Доказательство. 1) Из определения ясно, что $\operatorname{Int}(U)$ - компонента связности графа $G-a$. Следовательно, граф $G-\operatorname{Int}(U)$ связен и не содержит вершину $b$, поэтому множество $V(G) \backslash \operatorname{Int}(U)$ содержится в одной компоненте связности $W$ графа $G-b$. Рассмотрим отличную от $W$ компоненту связности $W^{\prime}$ графа $G-b$. Понятно, что $W^{\prime} \subset U$ и $a \notin W^{\prime}$,

поэтому $W^{\prime}$ - одна из компонент связности графа $G(U)-b$, которую $b$ отделяет в этом графе от вершины $a$. Следовательно, $b$ - точка сочленения графа $G(U)$.
1) Очевидно, $b^{\prime} \neq a$ (так как $G(U)-a-$ компонента графа $G$ ). Вершина $b^{\prime}$ разбивает множество $G(U)$ на несколько компонент связности, из которых ровно одна содержит вершину $a$. Пусть $W$ - одна из компонент связности графа $G(U)-b^{\prime}$, не содержащих $a$. Так как вершины из $\operatorname{Int}(U)$ не смежны с вершинами из $V(G) \backslash U$, то $b^{\prime}$ отделяет $W$ от $a$ и в графе $G$, то есть, является точкой сочленения графа $G$.

По лемме 5.13, мы вне зависимости от порядка действий проведем разрезы по всем точкам сочленения графа $G$ и только по ним. В результате мы получим множества вершин всех блоков графа $G$. Это нетрудно доказать: получатся множества вершин графа $G$, индуцированные подграфы на которых двусвязны. Пусть $B$ - одна из полученных в итоге частей, тогда любая вершина $c \notin B$ была "отрезана" от $B$ на некотором шаге, следовательно, отделяется от $B$ какой-то из точек сочленения. Значит, $G(B)$ - максимальный по включению двусвязный подграф графа $G$, то есть, блок.

Однако, даже при $k=2$ построить аналогичную конструкцию методом последовательных разрезов двусвязного графа по двухвершинным разделяющим множествам не получается, потому что более чем одновершинные разделяющие множества графа могут быть зависимы, то есть, могут разбивать друг друга на части.

Воспользовавшись нашей системой обозначений, можно сказать, что множества вершин блоков графа $G$ - это части $\operatorname{Part}\left(\mathfrak{R}_{1}(G)\right)$. Такой подход гораздо лучше обобщается на графы большей связности и их минимальные разделяющие множества.

# 5.5.2 Дерево разбиения 

Определение 5.9. Пусть $G-k$-связный граф, $\mathfrak{S} \subset \mathfrak{R}_{k}(G)$, причем все множества набора $\mathfrak{S}$ попарно независимы.

1) Построим дерево разбиения $T(G, \mathfrak{S})$ следующим образом. Вершины одной доли $T(G, \mathfrak{S})$ - это множества из $\mathfrak{S}$, а вершины другой доли части $\operatorname{Part}(\mathfrak{S})$. Обозначать вершины $T(G, \mathfrak{S})$ мы будем так же, как соответствующие множества вершин графа $G$. Вершины $S \in \mathfrak{S}$ и $A \in \operatorname{Part}(\mathfrak{S})$ смежны тогда и только тогда, когда $S \subset A$.
2) Построим граф $G^{\mathfrak{S}}$ на множестве вершин $V(G)$ следующим образом: возьмем граф $G$ и соединим рёбрами все пары несмежных вершин, входящих хотя бы в одно из множеств набора $\mathfrak{S}$.

Построение $T(G, \mathfrak{S})$ аналогично построению дерева блоков и точек сочленения. Аналогичными будут и его свойства.

Теорема 5.9. Пусть $G-k$-связный граф, а $\mathfrak{S} \subset \mathfrak{R}_{k}(G)$ - набор, состоящий из попарно независимых множеств. Тогда выполняются следующие утверждения.

1) $T(G, \mathfrak{S})-$ это дерево.
2) Для каждого множества $S \in \mathfrak{S}$ выполнено $d_{T(G, \mathfrak{S})}(S)=|\operatorname{Part}(S)|$. Более того, для каждой части $A \in \operatorname{Part}(S)$ существует единственная часть $B \in \operatorname{Part}(\mathfrak{S})$, такая что $B \subset A$ и $B$ смежна с $S$ в $T(G, \mathfrak{S})$. Все висячие вершины дерева $T(G, \mathfrak{S})$ соответствуют частям $\operatorname{Part}(\mathfrak{S})$.
3) Множество $S$ разделяет в графе $G$ части $B, B^{\prime} \in \operatorname{Part}(\mathfrak{S})$ тогда и только тогда, когда $S$ разделяет $B$ и $B^{\prime}$ в $T(G, \mathfrak{S})$.

Перед доказательством теоремы отметим ряд свойств графа $G^{\mathfrak{S}}$.
Лемма 5.14. Пусть $G-k$-связный граф, а $\mathfrak{S} \subset \mathfrak{R}_{k}(G)$ - набор, состоящий из попарно независимых множеств. Тогда выполняются следующие утверждения.

1) $\mathfrak{S} \subset \mathfrak{R}_{k}\left(G^{\mathfrak{S}}\right)$. Более того, $\operatorname{Part}(G ; \mathfrak{S})=\operatorname{Part}\left(G^{\mathfrak{S}} ; \mathfrak{S}\right)$.
2) Пусть $\mathfrak{T} \subset \mathfrak{S}, B \in \operatorname{Part}(G ; \mathfrak{T})$, а множество $R \in \mathfrak{R}\left(G^{\mathfrak{S}}(B)\right)$ не содержит рёбра, соединяющие пары вершин, входящих в какое-либо множество набора $\mathfrak{S}$. Тогда $R \in \mathfrak{R}(G) \cdot \varnothing$
3) Граф $G^{\mathfrak{S}}(B)$ является $k$-связным.

Доказательство. 1) Рассмотрим любое множество $S \in \mathfrak{S}$. Так как множества набора $\mathfrak{S}$ попарно независимы, никакое ребро из $E\left(G^{\mathfrak{S}}\right) \backslash E(G)$ не может соединять внутренние вершины двух разных частей $\operatorname{Part}(G ; S)$. Таким образом, вершины разделены одним из множеств набора $\mathfrak{S}$ в графе $G$ тогда и только тогда, когда они разделены этим множеством в $G^{\mathfrak{S}}$, откуда очевидно следуют утверждения пункта 1.


Рис. 5.5: Построение пути в графе $G^{\mathfrak{S}}(B)$.
1) Пусть $x, y \in B$, а множество $R$ не отделяет $x$ от $y$ в графе $G$, а следовательно, и в $G^{\mathfrak{S}}$. Рассмотрим кратчайший $x y$-путь $P$ в графе $G^{\mathfrak{S}}-R$.

Предположим, что он содержит вершину $z \notin B$ (см. рисунок 5.5). Тогда существует множество $T \in \mathfrak{T}$, отделяющее $z$ от $B$. При движении от $z$ в обе стороны по пути $P$ мы попадем в вершины множества $T$, которые в $G^{\mathfrak{S}}$ смежны. Но тогда существует более короткий путь: можно заменить участок пути, содержащий $z$, на ребро между двумя вершинами множества $T$. Противоречие с выбором пути $P$ показывает, что $V(P) \subset B$, а значит, $P$ - путь в $G^{\mathfrak{S}}(B)-R$. Но такого пути нет по условию. Следовательно, $R \in \mathfrak{R}(G)$.
1) Так как граф $G-k$-связный, $\mathfrak{R}_{k-1}(G)=\varnothing$. Тогда по пункту 2 и $\mathfrak{R}_{k-1}\left(G^{\mathfrak{S}}(B)\right)=\varnothing$, то есть, граф $G^{\mathfrak{S}}(B)$ также является $k$-связным.

Доказательство теоремы 5.9. Будем доказывать все утверждения теоремы индукцией по количеству множеств в наборе $\mathfrak{S}$, причем не фиксируя $k$-связный граф $G$. База для пустого набора очевидна.

Докажем индукиионный переход. Рассмотрим граф $G^{\prime}=G^{\mathfrak{S}}$. Из леммы 5.9 следует, что разбиения графов $G$ и $G^{\prime}$ набором $\mathfrak{S}$ одинаковы, будем обозначать это разбиение через $\operatorname{Part}(\mathfrak{S})$. Более того, тогда $T(G, \mathfrak{S})=$ $T\left(G^{\prime}, \mathfrak{S}\right)$. Поэтому достаточно доказать утверждения теоремы для графа $G^{\prime}$.

Пусть $S \in \mathfrak{S}, \operatorname{Part}(S)=\left\{A_{1}, \ldots, A_{n}\right\}, G_{i}=G^{\prime}\left(A_{i}\right)$. Как мы знаем, все эти графы $k$-связны. Пусть набор $\mathfrak{S}_{i}$ состоит из всех множеств набора $\mathfrak{S}$, лежащих в $A_{i}$ и отличных от $S$. Тогда каждое множество из $\mathfrak{S} \backslash\{S\}$ лежит ровно в одном из наборов $\mathfrak{S}_{1}, \ldots, \mathfrak{S}_{n}$.


Рис. 5.6: Дерево $T(G, \mathfrak{S})$.

Пусть $U_{i} \in \operatorname{Part}\left(G_{i} ; \mathfrak{S}_{i}\right)$ - часть, содержащая $S$. По лемме 5.14 для любой части $U \in \operatorname{Part}\left(G_{i} ; \mathfrak{S}_{i}\right)$ граф $G^{\prime}(U)$ является $k$-связным, а значит, его не разделяет ни одно из множеств набора $\mathfrak{S}$, не лежащих в $U$. Множество $S$ лежит в части $U_{i}$, но также не разделяет ее, так как $U_{i} \subset A_{i} \in \operatorname{Part}(G ; S)$. Это означает, что $\operatorname{Part}\left(G_{i} ; \mathfrak{S}_{i}\right) \subset \operatorname{Part}\left(G^{\prime} ; \mathfrak{S}\right)$, при-

чем именно часть $U_{i}$ содержит $S$. Следовательно,

$$
\operatorname{Part}\left(G^{\prime} ; \mathfrak{S}\right)=\bigcup_{i=1}^{n} \operatorname{Part}\left(G_{i} ; \mathfrak{S}_{i}\right)
$$

причем объединение - дизъюнктное, а части $\operatorname{Part}(\mathfrak{S})$, содержащие множество $S$ - это $U_{1}, \ldots, U_{n}$. Таким образом, утверждение 2 теоремы доказано для множества $S$, для остальных множеств из $\mathfrak{S}$ доказательство аналогично.

Каждая часть $\operatorname{Part}\left(G_{i} ; \mathfrak{S}_{i}\right)$, кроме $U_{i}$, смежна в $T_{i}=T\left(G_{i}, \mathfrak{S}_{i}\right)$ с теми же вершинами, что в $T(G, \mathfrak{S})$. Для части $U_{i}$ в $T(G, \mathfrak{S})$ добавляется ребро к множеству $S$. Поэтому $T(G, \mathfrak{S})-S$ распадается ровно на $n$ связных подграфов: это графы $T_{i}$, где $i \in\{1, \ldots, n\}$ (см. рисунок 5.6). По индукционному предположению, все эти графы - деревья, а значит, выполнены утверждения пунктов 1 и 3 теоремы.

Как мы видим, свойства дерева разбиения аналогичны хорошо известным нам свойствам классического дерева блоков и точек сочленения.

# 5.5.3 Дерево разбиения двусвязного графа 

Далее граф $G$ будет двусвязным. Объектом рассмотрения будут множества из $\mathfrak{R}_{2}(G)$.

Определение 5.10. Назовем множество $S \in \mathfrak{R}_{2}(G)$ одиночным, если оно независимо со всеми другими множествами из $\mathfrak{R}_{2}(G)$. Обозначим через $\mathfrak{O}(G)$ набор, состоящий из всех одиночных множеств графа $G$.

В 1966 году Татт описал структуру взаимного расположения двухвершинных разделяющих множеств в двусвязном графе именно с помощью дерева, которое он назвал $T(G)$. Это дерево - почти что дерево разбиения двусвязного графа одиночными разделяющими множествами (только эти множества и само дерево были определены в книге Татта более сложным образом). Мы построим похожее дерево с позиции разработанной выше техники.

Понятно, что одиночные множества попарно независимы, что позволяет нам дать следующее определение.

Определение 5.11. 1) Дерево разбиения $\mathrm{BT}(G)$ двусвязного графа $G-$ это дерево $T(G ; \mathfrak{O}(G))$.
1) Будем использовать обозначение $\operatorname{Part}(G)$ вместо $\operatorname{Part}(G ; \mathfrak{O}(G))$ и называть части этого разбиения просто частями графа $G$.

2) Часть $A \in \operatorname{Part}(G)$ назовем крайней, если она соответствует висячей вершине дерева разбиения $\mathrm{BT}(G)$.

Замечание 5.7. 1) Из теоремы 5.9 следует, что $\mathrm{BT}(G)$ - дерево, все висячие вершины которого соответствуют крайним частям графа $G$.
1) Если $A \in \operatorname{Part}(G)$ - крайняя часть, то $\operatorname{Bound}(A)$ - одиночное множество графа $G$.

Лемма 5.15. Пусть $S$ - одиночное множество двусвязного графа $G$, а $x \in S$. Тогда выполняются следующие утверждения.

1) Если одиночное множество $S$ имеет степень $d_{\mathrm{BT}(G)}(S)=d$, то $d_{G}(x) \geq d$. Если $d_{G}(x)=d$, то вершины множества $S$ несмежны.
2) $d_{G}(x) \geq 3$.

Доказательство. 1) По теореме 5.9 мы имеем $|\operatorname{Part}(S)|=d_{\mathrm{BT}(G)}(S)=d$, а во внутренности каждой из $d$ частей $\operatorname{Part}(S)$ есть вершина, смежная с $x$ (иначе граф недвусвязен). Поэтому $d_{G}(x) \geq d$, а в случае равенства все смежные с $x$ вершины лежат во внутренностях частей $\operatorname{Part}(S)$.
1) Пусть $d_{G}(x)=2$. По пункту 1 тогда $|\operatorname{Part}(S)|=2$ и вершины множества $S$ несмежны. Значит, $\mathrm{N}_{G}(x) \in \mathfrak{R}_{2}(G)$ - множество, зависимое с $S$, противоречие.

Теперь наша задача - понять смысл частей графа $G$.
Определение 5.12. Для двусвязного графа $G$ обозначим через $G^{\prime}$ граф $G^{\mathfrak{O}(G)}$ (то есть граф, полученный из $G$ добавлением всех отсутствующих ребер вида $a b$, где $\{a, b\} \in \mathfrak{O}(G)$ ).

Опишем важное свойство частей графа и одиночных множеств, аналогичное свойству блоков и точек сочленения (см. лемму 5.13). Это свойство позволит нам "разрезать" двусвязный граф по одиночному множеству.

Лемма 5.16. Для двусвязного графа $G$ выполняются следующие утверждения.

1) Множество $S \in \mathfrak{R}_{2}(G)$ разделяет вершины $a, b \in V(G)$ в графе $G$, если и только если $S$ разделяет их в $G^{\prime}$. В частности, $\mathfrak{R}_{2}(G)=\mathfrak{R}_{2}\left(G^{\prime}\right)$.
2) Пусть $S \in \mathfrak{R}_{2}(G)$ - неодиночное множество, $S \subset A \in \operatorname{Part}(G)$. Тогда $S \in \mathfrak{R}_{2}\left(G^{\prime}(A)\right)$, причем это множество - неодиночное и в $G^{\prime}(A)$.

Доказательство. 1) При построении $G^{\prime}$ мы соединяем дополнительными рёбрами только пары вершин, составляющих одиночное множество, а такие вершины не разделены ни одним из множеств набора $\mathfrak{R}_{2}(G)$. Отсюда легко следуют доказываемые утверждения.

1) Пусть $S^{\prime} \in \mathfrak{R}_{2}(G)$ - зависимое с $S$ множество. По пункту 1 , мы имеем $S, S^{\prime} \in \mathfrak{R}_{2}\left(G^{\prime}\right)$, причем эти множества зависимы и в графе $G^{\prime}$. Так как граф $G^{\prime}(A)$ двусвязен, нельзя разделить две вершины множества $S \subset A$ в графе $G^{\prime}$, удалив менее двух вершин из части $A$. Следовательно, $S^{\prime} \subset A$. Тогда $S$ и $S^{\prime}$ разделяют друг друга и в графе $G^{\prime}(A)$. Следовательно, $S, S^{\prime} \in \mathfrak{R}_{2}\left(G^{\prime}(A)\right)$, причем эти множества зависимы.

Следующая лемма характеризует неодиночные множества. Похожую характеристику использовал в своей книге Татт.

Лемма 5.17. Пусть $S \in \mathfrak{R}_{2}(G)$ - неодиночное множество. Тогда $|\operatorname{Part}(S)|=2$, причем для каждой части $A \in \operatorname{Part}(S)$ граф $G(A)$ недоусвязен и имеет точку сочленения, отделяющую а от $b$.

Доказательство. Так как $S$ - неодиночное, существует зависимое с ним множество $S^{\prime} \in \mathfrak{R}_{2}(G)$. Множество $S^{\prime}$, как мы знаем, разделяет $S$. Значит, не существует $a b$-пути по вершинам $A$ в графе $G$, который не пересекается с $S^{\prime}$. Однако, если $S^{\prime}$ не пересекает $\operatorname{Int}(A)$, то такой путь, очевидно, существует. Противоречие.

Таким образом, $S^{\prime}$ пересекает внутренность каждой части $\operatorname{Part}(S)$, откуда следует, что частей ровно две. Более того, если $x=S^{\prime} \cap \operatorname{Int}(A)$, то $x$ отделяет друг от друга вершины $a$ и $b$ в $G(A)$.

Теорема 5.10. Пусть $G$ - двусвязный граф без одиночных множеств. Тогда либо $G$ трёхсвязен, либо $G$ - это простой иикл.

Замечание 5.8. Напомним, что по нашему определению трёхсвязный граф должен содержать хотя бы 4 вершины. В частности, треугольник не является трёхсвязным графом и две альтернативы из теоремы 5.10 взаимно исключающие.

Доказательство теоремы 5.10. Предположим, что граф $G$ не трёхсвязен. Для любых множества $S=\{a, b\} \in \mathfrak{R}_{2}(G)$ и части $A \in \operatorname{Part}(S)$ мыь докажем, что $G(A)$ - это простой ab-nyтъ.

Доказательство будет индукцией по $|A|$. База для случая, когда часть $A$ имеет ровно одну внутреннюю вершину, очевидна. Докажем переход. Пусть мы хотим доказать утверждение для части $A \in \operatorname{Part}(S)$, а для меньших частей утверждение уже доказано. Пусть $H=G(A)$. Так как $S$ - неодиночное, по лемме 5.17 граф $H$ имеет точку сочленения $x$, отделяющую $a$ от $b$. Пусть $U_{a}$ и $U_{b}$ - компоненты связности графа $H-x$, содержащие $a$ и $b$ соответственно (см. рисунок 5.7 a ). Из двухвязности графа $G$ следует, что других компонент связности в графе $H-x$ нет (такая компонента связности выделилась бы и в $G-x$ ).

Пусть $U_{a}^{\prime}=U_{a} \backslash\{a\} \neq \varnothing$. Тогда $R_{a}=\{a, x\}$ отделяет $U_{a}^{\prime}$ от остальных вершин в графе $G$. Следовательно, по индукционному предположению, граф $G\left(U_{a}^{\prime} \cup R_{a}\right)=G\left(U_{a} \cup\{x\}\right)$ - простой $a x$-путь. Если $U_{a}=\{a\}$, то $\mathrm{N}_{H}(a)=\{x\}$ и $G\left(U_{a} \cup\{x\}\right)$ - также простой $a x$-путь. Аналогично, $G\left(U_{b} \cup\{x\}\right)$ - простой $b x$-путь. Следовательно, граф $G(A)$ - это простой $a b$-путь (см. рисунок 5.7 b ).

По лемме 5.17 мы знаем, что $\operatorname{Part}(S)=\left\{A_{1}, A_{2}\right\}$. Как мы доказали, оба графа $G\left(A_{1}\right)$ и $G\left(A_{2}\right)$ - простые пути между вершинами множества $S$, откуда очевидно следует, что $G$ - простой цикл.

Следствие 5.8. Для каждой части $A \in \operatorname{Part}(G)$ граф $G^{\prime}(A)$ либо трёхсвязен, либо является ииклом.

Доказательство. По лемме 5.14 мы знаем, что граф $G^{\prime}(A)$ двусвязен. Предположим, $S \in \mathfrak{R}_{2}\left(G^{\prime}(A)\right)$. По лемме 5.14 мы имеем $S \in \mathfrak{R}_{2}(G)$. Множество $S$ не может быть одиночным в $G$, так как разделяет часть $A \in \operatorname{Part}(\mathfrak{O}(G))$. По лемме 5.16 тогда $S$ - неодиночное разделяющее множество в $G^{\prime}(A)$. Следовательно, в $G^{\prime}(A)$ нет одиночных множеств, а значит, по теореме 5.10 этот граф либо трёхсвязен, либо является циклом.

Определение 5.13. Назовём часть $A$ ииклом, если граф $G^{\prime}(A)$ - простой цикл и блоком, если граф $G^{\prime}(A)$ трёхсвязен. Если часть $A$ - цикл, то мы будем называть $|A|$ длиной цикла $A$.

Таким образом, мы знаем, что каждая часть двусвязного графа $G$ цикл или блок.

Следствие 5.9. Если часть $A \in \operatorname{Part}(G)$ - иикл, то все вершины из $\operatorname{Int}(A)$ имеют степень 2 в графе $G$.

Доказательство. Если $x \in \operatorname{Int}(A)$, то рёбра графа $G$ выходят из $x$ только к вершинам части $A$, а таких рёбер, очевидно, ровно два.


Рис. 5.7: Двусвязный граф без одиночных множеств.

Изучим, как расположены неодиночные разделяющие множества графа $G$.

Теорема 5.11. Для двусвязного графа $G$ выполнены следующие утверждения.

1) Пусть $A \in \operatorname{Part}(G)$ - иикл длины хотя бы 4. Тогда любая пара его несоседних вершин образует неодиночное разделяющее множество графа $G$.
2) Любое неодиночное множество $R \in \mathfrak{R}_{2}(G)$ лежит в некоторой части $A \in \operatorname{Part}(G)$, являющейся ииклом длины хотя бы 4 и состоит из двух несоседних вершин этого иикла.

Доказательство. 1) Пусть $A=\left\{a_{1}, a_{2}, \ldots, a_{k}\right\}$, причем вершины указаны в циклическом порядке, $R=\left\{a_{1}, a_{m}\right\}$, где $2<m<k$. Тогда $R \in \mathfrak{R}_{2}\left(G^{\prime}(A)\right)$ и делит граф $G^{\prime}(A)$ на две части: $U_{1}=\left\{a_{1}, a_{2}, \ldots, a_{m}\right\}$ и $U_{2}=\left\{a_{m}, a_{m+1}, \ldots, a_{1}\right\}$. По лемме 5.14 мы имеем $R \in \mathfrak{R}_{2}(G)$. Очевидно, $R \notin \mathfrak{O}(G)$.
1) Множество $R$ независимо со всеми одиночными множествами графа $G$, а потому лежит в одной из частей $A \in \operatorname{Part}(G)$. По лемме 5.16 тогда $R \in \mathfrak{R}_{2}\left(G^{\prime}(A)\right)$. Из нашей классификации (следствие 5.8) ясно, что тогда $A$ - цикл длины хотя бы 4 . Теперь понятно, что $R$ состоит из двух несоседних вершин этого цикла.

Следствие 5.10. Пусть $G$ - двусвязный граф, а $R \in \mathfrak{R}_{2}(G)$. Тогда $R$ не содержит внутренних вершин частей-блоков графа $G$.

Доказательство. Пусть $B \in \operatorname{Part}(G)$ - блок. Если $R$ - одиночное множество и $x \in R \cap B$, то $R \in \operatorname{Bound}(B)$. Если же $R$ - неодиночное, то $R \cap \operatorname{Int}(B)=\varnothing$ по теореме 5.11 .

Следующая лемма покажет нам еще одно полезное свойство частей двусвязного графа. Нам понадобится понятие подразбиения графа, определенное во введении (определение 1.14.)

Лемма 5.18. Пусть $G$ - двусвязный граф, $A \in \operatorname{Part}(G)$. Тогда $G \supset G^{\prime}(A)$.

Доказательство. Пусть $a b \in E\left(G^{\prime}(A)\right) \backslash E(G)$. Тогда $\{a, b\} \in \mathfrak{O}(G)$. Пусть $U_{a, b} \in \operatorname{Part}(\{a, b\})$ - часть, не содержащая $A$. Тогда существует $a b$-путь $S_{a, b}$ по вершинам части $U_{a, b}$ в графе $G$. Заменим ребро $a b$ на путь $S_{a, b}$.

В результате нескольких таких замен мы получим подграф $H$ графа $G$. Пусть $a b$ и $x y$ - два разных замененных ребра (возможно, они

имеют общий конец). Тогда части $U_{a, b}$ и $U_{x, y}$ разеделены частью $A$ в $\mathrm{BT}(G)$, поэтому, не имеют общей внутренней вершины. Следовательно, никакие два добавленных пути не имеют общей внутренней вершины, а значит, граф $H$ является подразбиением $G^{\prime}(A)$.

На этом закончим изучение собственно дерева разбиения двусвязного графа и перейдём к его применению.

# 5.5.4 Применение дерева разбиения двусвязного графа 

В этом разделе мы применим дерево разбиения двусвязного графа для описания ряда его свойств. Начнем с теорем об оценках хроматического числа графа $G$ через хроматические числа его частей.

## Части разбиения и хроматическое число

Понятно, что хроматическое число связного графа равно максимуму хроматических чисел его классических двусвязных блоков. В этом разделе мы докажем верхние оценки на хроматическое число двусвязного графа через хроматические числа его подграфов, индуцированных на частях разбиения. Эти оценки с помощью структуры дерева разбиения получаются очень просто. Аналогично доказываются оценки на списочное списочное хроматическое число двусвязного графа.

Теорема 5.12. Для двусвязного графа $G$ выполнены следующие утверждения.

1) 

$$
\chi(G) \leq \chi\left(G^{\prime}\right)=\max _{A \in \operatorname{Part}(G)} \chi\left(G^{\prime}(A)\right)
$$

1) 

$$
\chi(G) \leq \max _{A \in \operatorname{Part}(G)} \chi(G(A))+1
$$

1) 

$$
\operatorname{ch}(G) \leq \max _{A \in \operatorname{Part}(G)} \operatorname{ch}(G(A))+2
$$

Доказательство. Разобьем дерево $\mathrm{BT}(G)$ на уровни, пусть уровень 0 состоит из любой части $B \in \operatorname{Part}(G)$, в каждый следующий уровень $\ell+1$ войдут вершины, не вошедшие в уровни $0, \ldots, \ell$ и смежные хотя бы с одной вершиной уровня $\ell$. По построению дерева $\mathrm{BT}(G)$ понятно, что

четные уровни состоят из частей разбиения, а нечетные - из одиночных множеств. Мы будем красить вершины частей графа $G$ в порядке, заданном разбиением на уровни.

1) Достаточно построить правильную раскраску графа $G^{\prime}$ в

$$
k=\max _{A \in \operatorname{Part}(G)} \chi\left(G^{\prime}(A)\right)
$$

цветов. Граф $G^{\prime}(B)$ мы, очевидно, можем покрасить в $k$ цветов. Пусть вершины частей из уровней менее $2 \ell>0$ уже покрашены. Рассмотрим часть $A \in \operatorname{Part}(G)$ уровня $2 \ell$, тогда она смежна в $\mathrm{BT}(G)$ ровно с одним одиночным множеством $S$ уровня $2 \ell-1$ и в части $A$ покрашены только две вершины множества $S$, причем в разные цвета, так как они смежны в $G^{\prime}$. Понятно, что существует правильная раскраска графа $G^{\prime}(A)$ в $k$ цветов. Поскольку вершины множества $S$ в этой раскраске разноцветны, можно считать, что их цвета именно такие, как в раскраске вершин частей предыдущих уровней.
1) Достаточно построить правильную раскраску графа $G$ в

$$
m+1=\max _{A \in \operatorname{Part}(G)} \chi(G(A))+1
$$

цветов. Граф $G(B)$ мы можем покрасить даже в $m$ цветов. Пусть вершины частей из уровней менее $2 \ell>0$ уже покрашены. Рассмотрим часть $A \in \operatorname{Part}(G)$ уровня $2 \ell$, тогда она смежна в $\mathrm{BT}(G)$ ровно с одним одиночным множеством $S$ уровня $2 \ell-1$ и в части $A$ покрашены только две вершины множества $S=\{a, b\}$. Пусть вершины $a$ и $b$ покрашены в цвета $i$ и $j$, возможно, совпадающие.

Если $i=j$, то покрасим вершины $G(A)$ правильным образом в $m$ цветов, не используя цвет $i$, а потом перекрасим вершины $a$ и $b$ в цвет $i$. Если $i \neq j$, то покрасим вершины $G(A)$ правильным образом в $m$ цветов так, чтобы $a$ была покрашена в цвет $i$, не используя при этом цвет $j$, а потом перекрасим вершину $b$ в цвет $j$. В любом случае понятно, что получится правильная раскраска вершин части $A$, согласованная с раскраской вершин частей предыдущих уровней.
1) Пусть вершины частей из уровней менее $2 \ell>0$ уже покрашены. Рассмотрим часть $A \in \operatorname{Part}(G)$ уровня $2 \ell$, тогда она смежна в $\mathrm{BT}(G)$ ровно с одним одиночным множеством $S$ уровня $2 \ell-1$ и в части $A$ покрашены только две вершины множества $S=\{x, y\}$.

В списке каждой вершины графа $G(A)$ хотя бы $\operatorname{ch}(G(A))+2$ цвета. Удалим из списков цвета вершин $x$ и $y$, оставшихся цветов хватит для правильной раскраски оставшихся вершин части $A$.

Замечание 5.9. В доказательстве утверждения 2 теоремы 5.12 мы можем произвольно выбрать часть $B$, с которой начинается покраска, а для этой части не нужно использовать дополнительный цвет. Поэтому при вычислении максимума в формуле (5.2) можно не прибавлять 1 к хроматическому числу графа $G(A)$ для одной из частей $A \in \operatorname{Part}(G)$ (именно эту часть нужно будет выбрать в качестве $B$ ).

Аналогично, в утверждении 3 мы можем произвольно выбрать часть $B$, с которой начинается покраска, а для этой части не нужно использовать дополнительные два цвета. Поэтому при вычислении максимума можно не прибавлять 2 к $\operatorname{ch}(G(A))$ для одной из частей $A \in \operatorname{Part}(G)$ (именно эту часть нужно будет выбрать в качестве $B$ ).

# Критические двусвязные графы 

Дерево $\mathrm{BT}(G)$ помогает понять, как устроены критические двусвязные графы. (Напомним, что двусвязный граф называется критическим, если теряет двусвязность при удалении любой вершины.)

Теорема 5.13. 1) Двусвязный граф $G$ является критическим, если и только если все его части-блоки и части-треугольники имеют пустую внутренность.
1) Пусть $A \in \operatorname{Part}(S)$ - крайняя часть критического двусвязного графа $G$, смежная в $\mathrm{BT}(G)$ с одиночным множеством $S$. Тогда $A$ цикл с хотя бы 4 вершинами, и все вершины $A$, кроме двух вершин множества $S$, имеют в графе $G$ степень 2.
2) Критический двусвязный граф имеет хотя бы четыре вершины степени 2 .

Доказательство. 1) Из леммы 5.11 очевидно, что вершины, не входящие в множества из $\mathfrak{R}_{2}(G)$ (то есть вершины, удаление которых не нарушает двусвязность графа $G$ ) - это как раз внутренние вершины блоков и треугольников графа $G$.
1) Пусть $A$ - крайняя часть графа $G$. По пункту 1 , тогда $A$ - цикл длины хотя бы 4 , а $S$ состоит из двух соседних вершин этого цикла. Остальные (хотя бы две) вершины $A$ - внутренние и по следствию 5.9 имеют степень 2 в графе $G$ (см. рисунок 5.8 a ).
2) Если граф $G$ имеет хотя бы одно одиночное множество, то у графа $G$ не менее двух крайних частей, утверждение очевидно следует из пункта 2. Пусть одиночных множеств у графа $G$ нет. Критический двусвязный граф, очевидно, не является трёхсвязным и содержит хотя бы 4 вершины. Значит, по теореме 5.10 граф $G$ - цикл длины не менее 4 , в этом случае утверждение очевидно.



Рис. 5.8: Критические двусвязные графы.

Более того, теперь понятно, как устроены критические двусвязные графы, у которых ровно 4 вершины степени 2. Во-первых, это цикл из четырех вершин. Теперь рассмотрим такой граф $G$ не менее чем с пятью вершинами. Тогда дерево $\mathrm{BT}(G)$ должно иметь ровно две висячие вершины, то есть, все некрайние блоки и все одиночные множества имеют степень два в $\mathrm{BT}(G)$. Значит, каждое одиночное множество делит граф ровно на две части (для неодиночных множеств это всегда так).

Рассмотрим некрайнюю часть $A \in \operatorname{Part}(G)$. Так как $d_{\mathrm{BT}(G)}(A)=2$, граница $A$ состоит ровно из двух одиночных множеств, то есть, имеет 3 или 4 вершины. Докажем, что $\operatorname{Int}(A)=\varnothing$. Если $A-$ блок или треугольник, то это доказано в теореме 5.13. Если $A$ - цикл длины хотя бы 4 , то его внутренняя вершина имеет степень 2 в графе $G$, как уже доказывалось выше, то есть, количество вершин степени два увеличивается.

Таким образом, некрайняя часть $\operatorname{Part}(G)$ может быть треугольником, четырёхугольником или блоком из четырёх вершин, причем ее вершины покрываются двумя одиночными множествами, смежными с этой частью в дереве $\mathrm{BT}(G)$. Пример критического двусвязного графа $G$ с 4 вершинами степени 2 приведен на рисунке 5.8 b .

# Минимальные двусвязные графы 

Перейдем к изучению структуры минимальных двусвязных графов - то есть таких, которые теряют двусвязность при удалении любого ребра.

Теорема 5.14. Двусвязный граф $G$ является минимальным тогда и только тогда, когда выполняются следуюшие условия:
(1) Если $\{a, b\} \in \mathfrak{R}_{2}(G)$, то вершины а и $b$ несмежны;
(2) Для любого блока $A$ графа $G$ граф $G(A)$ пуст (то есть, не имеет ни одного ребра).
Доказательство. $\Rightarrow$. Пусть $G$ - минимальный двусвязный граф. Предположим, что $S=\{a, b\} \in \mathfrak{R}_{2}(G), \operatorname{Part}(S)=\left\{A_{1}, \ldots, A_{n}\right\}, a b \in E(G)$. Так

как $G$ двусвязен, обе вершины $a$ и $b$ смежны с $\operatorname{Int}\left(A_{j}\right)$. Граф $G\left(\operatorname{Int}\left(A_{j}\right)\right)$ связен, поэтому существует $a b$-путь, внутренние вершины которого лежат в $\operatorname{Int}\left(A_{j}\right)$ и их множество непусто. Таким образом, в графе $G-a b$ существует $n \geq 2$ непересекающихся по внутренним вершинам $a b$-путей, откуда следует двусвязность графа $G-a b$. Противоречие с минимальностью $G$ показывает, что условие (1) выполнено.

Пусть $A$ - блок графа $G ; x, y \in A, x y \in E(G)$. Граф $G^{\prime}(A)$ трёхсвязен, следовательно, по теореме Менгера существует три независимых $x y$-пути в графе $G^{\prime}$. По лемме 5.18 граф $G$ содержит подразбиение $G^{\prime}(A)$, поэтому также содержит три $x y$-пути без общих внутренних вершин. Следовательно, граф $G-x y$ содержит два таких пути, а значит, он двусвязен. Противоречие с минимальностью $G$. Таким образом, условие (2) выполнено.
$\Leftrightarrow$. Пусть $G$ - не минимальный граф, а ребро $x y \in E(G)$ таково, что граф $G-x y$ двусвязен. Понятно, что существует такая часть $A \in \operatorname{Part}(G)$, что $x, y \in A$. Из условия (2) следует, что $A$ - цикл. Пусть $z \in A \backslash\{x, y\}$. Тогда множество $T=\{z, x y\}$ делит цикл $G^{\prime}(A)$ на две компоненты связности $U_{x} \ni x$ и $U_{y} \ni y$.

Докажем, что что $x$ и $y$ не связаны в $G^{\prime}-T$. Предположим противное и рассмотрим кратчайший $x y$-путь $P$ в $G^{\prime}-T$. Понятно, что $V(P)$ содержит вершину $b \notin A$. Рассмотрим одиночное множество $S$, отделяющее $b$ от $A$. Так как $x, y \in A$, при движении от $b$ по пути $P$ в обе стороны мы попадем в две разные вершины множества $S$. Эти вершины смежны в $G^{\prime}$, заменим участок пути $P$, содержащий $b$ на ребро $e$ между двумя вершинами множества $S$ и получим более короткий $x y$-путь $P^{\prime}$ в графе $G^{\prime}$. Так как $V\left(P^{\prime}\right) \subset V(P)$ и ребро $e \notin T$ (из условия (1) следует, что $\{x, y\} \notin \mathfrak{R}_{2}(G)$, поэтому $e \neq x y$ ), путь $P^{\prime}$ соединяет $x$ с $y$ и в графе $G^{\prime}-T$, противоречие с выбором пути $P$.

Следовательно, граф $G-T$ несвязен, а значит, граф $G-x y$ недвусвязен. Полученное противоречие показывает, что граф $G$ минимален.

Далее отметим несколько свойств минимальных двусвязных графов. Напомним два обозначения для минимального двусвязного графа $G$ :
$V_{2}(G)$ - множество всех вершин степени $2 ;$
$V_{3}(G)$ - множество всех вершин степени более 2.
Следствие 5.11. Пусть $G$ - минимальный двусвязный граф. Тогда выполняются следуюшие утверждения.

1) Если $A$ - блок графа $G$, то $\operatorname{Int}(A)=\varnothing$.
2) Пусть $A$ - крайняя часть графа $G$, смежная в $\operatorname{BT}(G)$ с одиночным множеством $S$. Тогда $A$ - иикл, а все его вершины, кроме двух вершин множества $S$, имеют степень 2 в графе $G$.

3) Множество $V_{3}(G)$ состоит из всех вершин, входящих в одиночные множества графа $G$. Множество $V_{2}(G)$ состоит из всех внутренних вершин частей графа $G$.
4) Если $S$ - одиночное множество графа $G$, то $d_{\mathrm{BT}(G)}(S) \geq 3$.

Доказательство. 1) Пусть $x \in \operatorname{Int}(A)$, рассмотрим ребро $x y \in E(G)$. Понятно, что $y \in A$, таким образом, граф $G(A)$ имеет ребро, что противоречит теореме 5.14 .
1) Так как $A$ - крайняя часть, то $\operatorname{Int}(A) \neq \varnothing$. Значит, $A$ - цикл и утверждение очевидно из следствия 5.9.
2) Прямое следствие леммы 5.15 и пункта 1.
3) Пусть это не так и $S=\left\{y, y^{\prime}\right\}$ смежно в $\mathrm{BT}(G)$ с двумя частями $A_{1}$ и $A_{2}$.

Если $A_{i}$ - блок, то $y$ не смежна ни с одной вершиной $A_{i}$, как показано в пункте 1. Если $A_{i}$ - цикл, то вершина $y$ может быть смежна только с двумя соседними вершинами этого цикла, но одна из соседних с $y$ вершин - это $y^{\prime}$, которая по теореме 5.14 несмежна с $y$. Таким образом, $d_{G}(y) \leq 2$, противоречие с леммой 5.15 .

# 5.6 Стягивание рёбер в $k$-связном графе 

Определение 5.14. Назовём $k$-связный граф $G$ минимальным по стягиванию, если для любого ребра $e \in E(G)$ граф $G \cdot e$ не является $k$-связным.

Не секрет, что в любом связном графе можно стянуть любое ребро без потери связности. При $k \in\{2,3\}$ мы докажем, что единственным минимальным по стягиванию $k$-связным графом является $K_{k+1}$. Отметим, что в любом $k$-связном графе по определению хотя бы $k+1$ вершина, так что $K_{k+1}$ во всех смыслах является минимальным $k$-связным графом.

При $k \geq 4$ существуют различные минимальные по стягиванию $k$-связные графы и чем больше $k$, тем сложнее их структура и тем меньше про них известно. В случае $k=4$ мы опишем структуру минимальных по стягиванию $k$-связных графов.

### 5.6.1 Двусвязные и трёхсвязные графы

Теорема 5.15. Пусть $G$ - двухвязный граф, отличный от $K_{3}$. Тогда существует такое ребро $e \in E(G)$, что граф $G \cdot e$ двухвязен.

Доказательство. Предположим, что это неверно. Так как $v(G) \geq 4$, тогда для любого ребра $a b \in E(G)$ множество $\{a, b\} \in \mathfrak{R}_{2}(G)$. Рассмотрим минимальный фрагмент $H$, отделяемый множеством такого вида, пусть $a b \in E(G), A \in \operatorname{Part}(\{a, b\}), H=\operatorname{Int}(A)$. По лемме 5.2 , существует вершина $c \in H$, смежная с $a$. Тогда $\{a, c\} \in \mathfrak{R}_{2}(G)$.


Рис. 5.9: Фрагменты $H$ и $H^{\prime}$.
Очевидно, множества $\{a, b\}$ и $\{a, c\}$ независимы. Из $c \in H=\operatorname{Int}(A)$ по следствию 5.5 следует, что существует фрагмент $H^{\prime} \varsubsetneqq H$ с границей $\{a, c\}$ - противоречие с минимальностью $H$.

Лемма 5.19. Пусть $G-k$-связный граф, $S, T \in \mathfrak{R}_{k}(G), A \in \operatorname{Part}(S)$, $T \supset \operatorname{Int}(A)$. Тогда множества $S$ и $T$ зависимы.

Доказательство. Пусть $S$ и $T$ независимы, тогда $T \subset A$. Пусть часть $A^{\prime} \in \operatorname{Part}(S)$ отлична от $A$. Тогда $T \cap \operatorname{Int}\left(A^{\prime}\right)=\varnothing$ и из леммы 5.6 следует, что $T$ не разделяет $A^{\prime} \supset(S \backslash T)$. Тогда, поскольку $S \backslash T \neq \varnothing$, то $T$ не разделяет $V(G) \backslash T \subset V(G) \backslash \operatorname{Int}(A)$, то есть, $T$ не является разделяющим множеством. Противоречие.

Теорема 5.16. (W. T. Tutte.) Пусть $G-$ трёхсвязный граф, отличный от $K_{4}$. Тогда существует такое ребро $e \in E(G)$, что граф $G \cdot e$ трёхсвязен.

Доказательство. Предположим, что это неверно. Так как $v(G) \geq 5$, тогда для любого ребра $a b \in E(G)$ существует множество $T_{a, b} \in \mathfrak{R}_{3}(G)$, $T_{a b} \ni a, b$. Рассмотрим минимальный фрагмент $H$ в графе $G$, отделяемый множеством, содержащим две вершины одного ребра. Пусть $a b \in E(G)$, $T_{a b}=\{a, b, c\}, A \in \operatorname{Part}\left(T_{a b}\right)$ и $H=\operatorname{Int}(A)$. По лемме 5.2 , существует вершина $d \in H$, смежная с $a$. Рассмотрим множество $T_{a d}=\{a, d, x\} \in \mathfrak{R}_{3}(G)$.

Если $T_{a b}$ и $T_{a d}$ независимы, то по следствию 5.5 существует фрагмент $H^{\prime} \subsetneq H$ с границей $T_{a d}$ - противоречие с минимальностью $H$. Значит, эти два множества зависимы, то есть, разбивают друг друга. Поскольку $T_{a b} \backslash\{a\}$ состоит только из двух вершин, то $T_{a b} \cap T_{a d}=\{a\}$ и $T_{a d}$ отделяет $b$ от $c$. Так как каждая часть $\operatorname{Part}\left(T_{a d}\right)$ по лемме 5.8 должна

содержать хотя бы одну вершину из $T_{a b} \backslash T_{a d}$, то $\left|\operatorname{Part}\left(T_{a d}\right)\right|=2$. Предположим, что $\operatorname{Part}\left(T_{a d}\right)=\left\{B_{1}, B_{2}\right\}$. Тогда по лемме 5.8 часть $A$ распадается в $\operatorname{Part}\left(\left\{T_{a b}, T_{a d}\right\}\right)$ на две части $F_{1}=A \cap B_{1}$ и $F_{2}=A \cap B_{2}$ (см. рисунок 5.10 a ) с границами $S_{1}=\{a, d, b\}$ и $S_{2}=\{a, d, c\}$.


Рис. 5.10: Множества $T_{a b}$ и $T_{a d}$.
Предположим, что $\operatorname{Int}\left(F_{1}\right) \neq \varnothing$. Тогда существует непустой фрагмент $H_{1} \subset \operatorname{Int}\left(F_{1}\right) \subsetneq H$ с границей $S_{1}$, противоречие с минимальностью $H$. Таким образом, $\operatorname{Int}\left(F_{1}\right)=\varnothing$ и, аналогично, $\operatorname{Int}\left(F_{2}\right)=\varnothing$, а значит, $\operatorname{Int}(A)=\{d\}$. Следовательно, $\mathrm{N}_{G}(d) \subset T_{a b}$ и $d_{G}(d) \leq 3$. Так как в трёхсвязном графе нет вершин степени менее 3 , вершина $d$ смежна с тремя вершинами $a, b$ и $c$ (см. рисунок 5.10 b ).

Рассмотрим разделяющее множество $T_{c d} \supset\{d\}=\operatorname{Int}(A)$. Отметим, что $T_{c d}$ не разделяет $T_{a b}=\{a, b, c\}$, так как вершины $a$ и $b$ смежны. Следовательно, $T_{c d}$ и $T_{a b}$ независимы, но это невозможно по лемме 5.19. Противоречие показывает, что трёхсвязный граф на более чем 4 вершинах не может быть минимальным по стягиванию.

# 5.6.2 Минимальные по стягиванию 4-связные графы 

Структура минимальных по стягиванию 4 -связных графов много сложнее, но есть возможность её изучить и описать, чем мы и займёмся в этом разделе. Сначала мы докажем, что любой такой граф является 4 -регулярным и любое его ребро входит в треугольник, потом дадим более подробное описание класса минимальных по стягиванию 4 -связных графов.

В следующих леммах и теореме речь пойдёт о минимальных по стягиванию 4 -связных графах. В таком графе $G$ с $v(G)>5$ для каждого ребра $a b \in E(G)$ существует такое множество $T_{a b} \in \mathfrak{R}_{4}(G)$, что $a, b \in T_{a b}$. Мы будем использовать это обозначение в доказательствах.

Лемма 5.20. Пусть $G$ - минимальный по стягиванию 4-связный граф, множество $S \in \mathfrak{R}_{4}(G)$ содержит а и смежную с ней вершину, $H-$

фрагмент с границей $S$. Тогда а входит в треугольник ахх', где $x \in H$, $d_{G}(x)=4$.

Доказательство. Для графа на 5 вершинах утверждение леммы очевидно. Поэтому достаточно рассмотреть минимальный по стягиванию 4 -связный граф $G$ с $v(G)>5$. Будем доказывать утверждение индукцией по $|H|$. Базу составит очевидный случай $H=\{y\}$ (см. рисунок 5.11a). В этом случае $d_{G}(y)=4$, причём $y$ смежна только с вершинами множества $S$. Тогда нам подойдут $x=y$ и $x^{\prime}$ - смежная с $a$ вершина множества $S$.


Рис. 5.11: Множество $S$ и фрагмент $H$.

Предположим, что $|H| \geq 2$, а для меньших фрагментов утверждение леммы уже доказано. Пусть $A, A^{\prime} \in \operatorname{Part}(S), \operatorname{Int}(A)=H$. Рассмотрим два случая.

1. Существует такое независимое с $S$ множество $T \in \mathfrak{R}_{4}(G)$, что $T \cap H \neq \varnothing$ и $T$ содержит а и смежную с ней вершину.
Очевидно, $T \subset A$. Тогда по следствию 5.5 существует фрагмент $H^{\prime} \varsubsetneqq H$ с границей $T$ (см. рисунок 5.11 b ). По индукционному предположению, существует искомый треугольник с $x \in H^{\prime} \subset H$.
1. Любое такое множество $T \in \mathfrak{R}_{4}(G)$, что $T \cap H \neq \varnothing$ и $T$ содержит а и смежную с ней вершину, зависимо с $S$.
По лемме 5.2 , существует вершина $b \in H$, смежная с $a$. Рассмотрим множество $T_{a b}$. В нашем случае $T_{a b}$ и $S$ зависимы. Пусть $T_{a b}=\left\{a, b, c_{1}, c_{2}\right\}$. Так как $T_{a b}$ пересекает внутренности всех частей $\operatorname{Part}(S)$, можно считать, что $c_{2} \in \operatorname{Int}\left(A^{\prime}\right)$. Рассмотрим два случая.
2.1. $c_{1} \notin \operatorname{Int}(A)$.

В этом случае $T_{a b} \cap \operatorname{Int}(A)=\{b\}$. Так как $|\operatorname{Int}(A)|=|H| \geq 2$, существует такая часть $B \in \operatorname{Part}\left(\left\{S, T_{a b}\right\}\right)$, что $B \subset A, \operatorname{Int}(B) \neq \varnothing$. Тогда $|\operatorname{Bound}(B)| \geq 4$. Пусть $B=A \cap F$, где $F \in \operatorname{Part}\left(T_{a b}\right)$ (см. рисунок 5.12 a ). Отметим, что $\operatorname{Bound}(B)$ по лемме 5.8 состоит из вершины $b$

и вершин множества $S$, лежащих в $F$, которых не более трёх (ведь $S$ пересекает внутренность отличной от $F$ части $\operatorname{Part}\left(T_{a b}\right)$ ). Всё сказанное выше означает, что $|\operatorname{Bound}(B)|=4$. Таким образом, $a, b \in \operatorname{Bound}(B)$, $\operatorname{Bound}(B) \in \mathfrak{R}_{4}(G)$, множества $\operatorname{Bound}(B)$ и $S$ независимы - этот случай мы разобрали выше.


Рис. 5.12: Множества $S$ и $T_{a b}$.
2.2. $c_{1} \in \operatorname{Int}(A)$.

В этом случае $T_{a b} \backslash A=\left\{c_{2}\right\}$. Так как $T_{a b}$ должно пересекать внутренность всех частей $\operatorname{Part}(S)$, то их только две: $A$ и $A^{\prime}$.

Пусть $S=\left\{a, d_{1}, d_{2}, d_{3}\right\}$. Одна из вершин $d_{1}, d_{2}, d_{3}$ смежна с $a$, но мы не будем это использовать и делать между ними различия. В нашем случае $S \cap T_{a b}=\{a\}$ и множество $T_{a b}$ разделяет $S \backslash T_{a b}=\left\{d_{1}, d_{2}, d_{3}\right\}$. Следовательно, существует часть $F \in \operatorname{Part}\left(T_{a b}\right)$, для которой $\left|F \cap\left\{d_{1}, d_{2}, d_{3}\right\}\right|=1$. Не умаляя общности положим $F \cap\left\{d_{1}, d_{2}, d_{3}\right\}=\left\{d_{1}\right\}$, тогда

$$
B=A \cap F \in \operatorname{Part}\left(\left\{S, T_{a b}\right\}\right)
$$

причём $\operatorname{Bound}(B)=\left\{a, b, c_{1}, d_{1}\right\}$ (см. рисунок 5.12 b ). Предположим, что $\operatorname{Int}(B) \neq \varnothing$. Тогда $a, b \in \operatorname{Bound}(B), \operatorname{Bound}(B) \in \mathfrak{R}_{4}(G)$, множества $\operatorname{Bound}(B)$ и $S$ независимы - этот случай рассмотрен выше. Следовательно, $\operatorname{Int}(B)=\varnothing$. Пусть $B^{\prime}=F \cap A^{\prime}$, тогда $\operatorname{Bound}\left(B^{\prime}\right)=\left\{a, c_{2}, d_{1}\right\}$, откуда очевидно, что $\operatorname{Int}\left(B^{\prime}\right)=\varnothing$. Следовательно $\operatorname{Int}(F)=S \cap \operatorname{Int}(F)=\left\{d_{1}\right\}$. Тогда $d_{G}\left(d_{1}\right)=4, \mathrm{~N}_{G}\left(d_{1}\right)=T_{a b}=\left\{a, b, c_{1}, c_{2}\right\}$.

Проанализируем результаты разобранных случаев и заметим, что на настоящий момент мы доказали следующее утверждение.

Пусть множество $S \in \mathfrak{R}_{4}(G)$ содержит $a$ и смежную с ней вершину, $H-$ фрагмент с границей $S$. Тогда $a$ входит в треугольник $a z z^{\prime}$, где одна из вершин $z$ и $z^{\prime}$ лежит в $H$.

Действительно, это утверждение есть ослабленное утвержденение леммы. В случаях 1 и 2.1 мы осуществили спуск к меньшим фрагментам.

Осуществляя этот спуск, мы рано или поздно придем к очевидному случаю фрагмента из одной вершины или к случаю 2.2. В рассматриваемом случае 2.2 доказали существование треугольника $a b d_{1}$.

Применим доказанное утверждение к множеству $S$, вершине $d_{1}$ и фрагменту $\operatorname{Int}\left(A^{\prime}\right)$. Так как в $\operatorname{Int}\left(A^{\prime}\right)$ лежит ровно одна вершина из $\mathrm{N}_{G}\left(d_{1}\right)=\left\{a, b, c_{1}, c_{2}\right\}-$ вершина $c_{2}-$ и она не может быть смежна с $b, c_{1} \notin A^{\prime}$, то получаем, что вершины $a$ и $c_{2}$ смежны (см. рисунок 5.13a).

Теперь рассмотрим множество $T_{d_{1} c_{1}}$. По лемме 5.19 , множество $T_{d_{1} c_{1}}$ должно быть зависимо с $T_{a b}=\operatorname{Bound}(F)$ (так как $T_{d_{1} c_{1}} \supset \operatorname{Int}(F)=\left\{d_{1}\right\}$ ). Следовательно, $T_{d_{1} c_{1}}$ разделяет $T_{a b} \backslash T_{d_{1} c_{1}} \subset\left\{a, b, c_{2}\right\}$. Поскольку вершина $a$ смежна и с $b$, и с $c_{2}$, то это означает $a \in T_{d_{1} c_{1}}$. Тогда множество $T_{d_{1} c_{1}}$ зависимо с $S$ (иначе в очередной раз вспомним про разобранный случай 1). Таким образом, $T_{d_{1} c_{1}}=\left\{d_{1}, c_{1}, a, z\right\}$, где $z \in \operatorname{Int}\left(A^{\prime}\right)$.


Рис. 5.13: Множества $S, T_{a b}$ и $T_{d_{1} c_{1}}$.
Множество $T_{d_{1} c_{1}}$ должно разделять $S \backslash T_{d_{1} c_{1}}=\left\{d_{2}, d_{3}\right\}$, поэтому $\left|\operatorname{Part}\left(T_{d_{1} c_{1}}\right)\right|=2$ и $T_{d_{1} c_{1}}$ делит $A$ на две части с границами $\left\{c_{1}, a, d_{1}, d_{2}\right\}$ и $\left\{c_{1}, a, d_{1}, d_{3}\right\}$ (см. рисунок 5.13 b ). Одна из этих частей содержит $b$ и потому непуста, а её граница содержит $a$ и смежную с ней вершину $d_{1}$, лежит в $A$ и независима с $S$. Это опять разобранный выше случай 1.

Все случаи разобраны, лемма доказана.
Лемма 5.21. (N. Martinov, 1990.) Минимальный по стягиванию 4-связный граф является 4-регулярным.

Доказательство. Для графа на 5 вершинах утверждение леммы очевидно. Поэтому достаточно рассмотреть минимальный по стягиванию 4 -связный граф $G$ с $v(G)>5$. Пусть $v \in V(G)$ и $d_{G}(v)>4$. По лемме 5.20 существует вершина $u \in \mathrm{~N}_{G}(v), d_{G}(u)=4$ и вершина $u_{1} \in \mathrm{~N}_{G}(u)$, $d_{G}\left(u_{1}\right)=4$. Рассмотрим множество $T_{u u_{1}}$, пусть $A_{1}, A_{1}^{\prime} \in \operatorname{Part}\left(T_{u u_{1}}\right)$. По лемме 5.20 существуют вершины $u_{2}, u_{3} \in \mathrm{~N}_{G}(u), u_{2} \in \operatorname{Int}\left(A_{1}\right)$,

$u_{3} \in \operatorname{Int}\left(A_{1}^{\prime}\right), d_{G}\left(u_{2}\right)=d_{G}\left(u_{3}\right)=4$ (см. рисунок 5.14a). Отметим, что вершины $u_{2}$ и $u_{3}$ несмежны. Таким образом, $\mathrm{N}_{G}(u)=\left\{v, u_{1}, u_{2}, u_{3}\right\}$.

Рассмотрим множество $T_{u u_{2}}$, пусть $A_{2}, A_{2}^{\prime} \in \operatorname{Part}\left(T_{u u_{2}}\right)$. По лемме 5.20 в $\mathrm{N}_{G}(u)$ существуют вершины степени 4 , одна из которых лежит в $\operatorname{Int}\left(A_{2}\right)$, а другая - в $\operatorname{Int}\left(A_{2}^{\prime}\right)$. Это могут быть только вершины $u_{1}$ и $u_{3}$, потому они несмежны (см. рисунок 5.14 b ). Аналогично, $u_{1}$ и $u_{2}$ несмежны.


Рис. 5.14: Окрестность вершины $v$.
Теперь заметим, что по лемме 5.20 каждая из вершин $u_{1}, u_{2}$ и $u_{3}$ должна входить в треугольник вместе с вершиной $u$. Следовательно, все эти три вершины смежны с $v$. Таким образом, любая вершина $u \in \mathrm{~N}_{G}(v)$ степени 4 имеет трёх попарно несмежных соседей степени 4 , лежащих в $\mathrm{N}_{G}(v)$ (см. рисунок 5.14 c ).

Пусть $K$ - компонента связности графа $G\left(N_{G}(v)\right)-v$, содержащая $u$. По доказанному утверждению все вершины из $K$ имеют степень 4 в графе $G$ и смежны только с $v$ и другими вершинами из $K$. Вершина $v$ не может быть точкой сочленения в графе $G$, поэтому $V(G)=K \cup\{v\}$.

Тогда вершина $v$ входит в любое множество из $\mathfrak{R}_{4}(G)$. Следовательно, граф $G-v$ является минимальным по стягиванию трёхсвязным графом, то есть, по теореме 5.16 это $K_{4}$. Но тогда $G-4$-регулярный граф на 5 вершинах.

Теорема 5.17. (N. Martinov, 1990.) Для 4-связного графа $G$ следующие два утверждения равносильны.
$1^{\circ}$ Граф $G$ - минимальный по стягиванию.
$2^{\circ}$ Степень каждой вершины графа $G$ равна 4 , каждое ребро входит в треугольник.

Доказательство. $2^{\circ} \Rightarrow 1^{\circ}$. Если ребро $a b$ входит в треугольник $a b c$, то в графе $G \cdot a b$ окрестность вершины $c$ будет трёхвершинным множеством, поэтому граф $G \cdot a b$ не 4 -связен.
$1^{\circ} \Rightarrow 2^{\circ}$. По лемме 5.21 , граф $G$ является 4 -регулярным. Найдём треугольник с ребром $u v \in E(G)$. Рассмотрим разделяющее множество $T_{u v}$,

пусть $A_{1}, A_{2} \in \operatorname{Part}\left(T_{u v}\right)$. По лемме 5.20 , существуют треугольники $u u_{1} u_{1}^{\prime}$ и $u u_{2} u_{2}^{\prime}$, где $u_{1} \in \operatorname{Int}\left(A_{1}\right), u_{2} \in \operatorname{Int}\left(A_{2}\right)$.

Если хотя бы одна из вершин $u_{1}^{\prime}, u_{2}^{\prime}$ - это $v$, то мы нашли искомый треугольник. Если же $u_{1}^{\prime} \neq v$ и $u_{2}^{\prime} \neq v$, то из $d_{G}(u)=4$ следует, что $u_{1}^{\prime}=u_{2}^{\prime} \in T_{u v}$. Обозначим эту вершину через $u^{\prime}$ (см. рисунок 5.15a).


Рис. 5.15: Множество $T_{u v}$.
Так как $d_{G}\left(u^{\prime}\right)=4$, и $u \in \mathrm{~N}_{G}\left(u^{\prime}\right) \cap T_{u v}$, то одно из множеств $\operatorname{Int}\left(A_{1}\right)$ и $\operatorname{Int}\left(A_{2}\right)$ содержит единственную вершину из $\mathrm{N}_{G}\left(u^{\prime}\right)$. Не умаляя общности предположим, что это $\operatorname{Int}\left(A_{1}\right)$. Тогда $u_{1}$ - единственная вершина из $\operatorname{Int}\left(A_{1}\right)$, смежная с $u$ и единственная вершина из $\operatorname{Int}\left(A_{1}\right)$, смежная с $u^{\prime}$. Если $\operatorname{Int}\left(A_{1}\right) \neq\left\{u_{1}\right\}$, то трёхэлементное множество $\left(T_{u v} \backslash\left\{u, u^{\prime}\right\}\right) \cup\left\{u_{1}\right\}$ отделяет $\operatorname{Int}\left(A_{1}\right) \backslash\left\{u_{1}\right\}$ от остальных вершин графа, что в четырёхсвязном графе невозможно. Следовательно, $\operatorname{Int}\left(A_{1}\right)=\left\{u_{1}\right\}$, тогда $\mathrm{N}_{G}\left(u_{1}\right)=T_{u v}$ (см. рисунок 5.15 b ) и, в частности, в графе $G$ есть треугольник $u v u_{1}$.

Из теоремы 5.17 легко вывести следующий факт.
Следствие 5.12. В минимальном по стягиванию 4-связном графе $G$ все вершины имеют степень 4 , а окрестность каждой вершины разбивается на две пары смежных вершин.

Доказательство. Предположим, что для вершины $a$ это не так. Пусть

$$
\mathrm{N}_{G}(a)=\left\{b_{1}, b_{2}, b_{3}, b_{4}\right\}, \quad A=\{a\} \cup \mathrm{N}_{G}(a)
$$

По теореме 5.17 , ребро $a b_{1}$ входит в треугольник, не умаляя общности положим, что это треугольник $a b_{1} b_{2}$. Тогда $b_{1} b_{2} \in E(G)$, следовательно, $b_{3} b_{4} \notin E(G)$. Ребро $a b_{3}$ также входит в треугольник и это должен быть треугольник $a b_{3} b_{1}$ или $a b_{3} b_{2}$. Из двух аналогичных вариантов рассмотрим первый. Таким образом, $b_{1} b_{3} \in E(G)$, следовательно, $b_{2} b_{4} \notin E(G)$. Значит, ребро $a b_{4}$ входит в треугольник $a b_{1} b_{4}$, то есть, $b_{1} b_{4} \in E(G)$ (см. рисунок 5.16 ).



Рис. 5.16: Окрестность вершины $a$.

Но тогда $V(G)=A$, так как иначе 3 -вершинное множество $\left\{b_{2}, b_{3}, b_{4}\right\}$ отделяет $\left\{a, b_{1}\right\}$ от $V(G) \backslash A$, что в 4 -связном графе невозможно. Следовательно, $G$ - полный граф на 5 вершинах, для которого доказываемое утверждение выполняется.

Следующая теорема даст детальную характеризацию минимальных по стягиванию 4 -связных графов. Напомним, что для произвольного графа $G$ через $G^{2}$ обозначается граф на множестве вершин $V(G)$, в котором соединены рёбрами те и только те пары вершин, что находятся на расстоянии не более 2 в графе $G$.

Теорема 5.18. (N. Martinov.) Множество всех минимальных по стягиванию 4-связных графов состоит из графов следующих двух видов.
$1^{\circ} C_{n}^{2} n p u n \geq 5$.
$2^{\circ}$ Рёберные графы $H_{E}$ для 4 -рёберно-циклически связных кубических графов $H$.

Доказательство. Легко видеть, что любой граф из этих двух серий является однородным графом степени 4. То, что граф $C_{n}^{2}$ является 4 -связным, можно проверить непосредственно. Понятно, что из 4 -циклической связности графа $H$ следует 4 -связность графа $H_{E}$. Нетрудно убедиться, что каждое ребро любого графа указанных двух серий входит в треугольник, поэтому по теореме 5.18 все они являются минимальными по стягиванию 4 -связными графами.

Рассмотрим минимальный по стягиванию 4 -связный граф $G$. Как мы знаем, для любой вершины $v \in V(G)$ её окрестность разбивается на две пары смежных вершин. Рассмотрим два случая.

1. Пусть для любой вершины $v \in V(G)$ подграф $G\left(N_{G}(v)\right)$ представляет из себя два несмежных ребра, то есть, каждое ребро графа $G$ входит ровно в один треугольник.
Докажем, что тогда $G=H_{E}$ для некоторого кубического графа $H$. Пусть вершины $H$ соответствуют треугольникам графа $G$, а две вершины $a, b \in V(H)$ смежны тогда и только тогда, когда соответствующие треугольники имеют общую вершину. Очевидно, получится кубический

граф $H$. Легко видеть, что $H_{E}=G$. Из 4-связности $G$ следует 4-рёберноциклическая связность графа $H$.
1. Пусть для некоторой вершины $v \in V(G)$ подграф $G\left(N_{G}(v)\right)$ содержит хотя бы 3 ребра.
Учитывая следствие 5.12 сделаем вывод, что тогда $G\left(N_{G}(v)\right)$ содержит простой путь из трёх ребер, а все вершины из $\mathrm{N}_{G}(v) \cup\{v\}$ можно занумеровать $a_{1}, a_{2}, a_{3}, a_{4}, a_{5}$ так, что $a_{i} a_{i+1}, a_{i} a_{i+2} \in E(G)$. (Естественно, все индексы должны лежать в [1..5].) В этой нумерации $v=a_{3}$, см. рисунок 5.17 a.

Предположим, что для некоторого $k \geq 5$ в графе есть различные вершины $a_{1}, \ldots, a_{k}$ с аналогичным свойством: $a_{i} a_{i+1}, a_{i} a_{i+2} \in E(G)$. (Все индексы должны лежать в $[1 . . k]$.) Пусть $H-$ граф с

$$
V(H)=\left\{a_{1}, \ldots, a_{k}\right\} \quad \text { и } \quad E(H)=\left\{a_{i} a_{j}: i, j \in[1 . . k],|i-j| \leq 2\right\}
$$

Тогда $d_{H}\left(a_{i}\right)=4$ при $i \in[3 . . k-2], d_{H}\left(a_{2}\right)=d_{H}\left(a_{k-1}\right)=3$ и $d_{H}\left(a_{1}\right)=$ $d_{H}\left(a_{k}\right)=2$. Посмотрим, с чем может быть смежна вершина $a_{k-1}$. В результате мы либо убедимся, что наш граф является квадратом цикла, либо продлим цепочку на новую вершину $a_{k+1}$, смежную с $a_{k-1}$ и $a_{k}$, после чего будем рассматривать соседей вершины $a_{k}$. Рассмотрим случаи.


Рис. 5.17: Граф $G$.
2.1. $a_{k-1} a_{1} \in E(G)$.

Тогда $H^{\prime}=H+a_{1} a_{k-1}-$ подграф графа $G$, в котором лишь три вершины имеют степень менее $4-$ это $a_{1}, a_{2}$ и $a_{k}$ (см. рисунок 5.17 b ). Следовательно, $V(G)=V(H)$, иначе трёхвершинное множество $\left\{a_{1}, a_{2}, a_{k}\right\}$ отделяет $\left\{a_{3}, a_{4}, \ldots, a_{k-1}\right\}$ от $V(G) \backslash V(H)$, что невозможно в четырёхсвязном графе.

Тогда остаётся единственный способ сделать граф $H^{\prime} 4$-регулярным графом $G$ : нужно добавить рёбра $a_{1} a_{k}$ и $a_{2} a_{k}$, в результате получится, что $G=C_{k}^{2}$ (граф $G$ - это квадрат цикла $a_{1} a_{2} \ldots a_{k}$, см. рисунок 5.17 c ).

2.2. $a_{k-1} a_{2} \in E(G)$.

Тогда $H^{\prime}=H+a_{k-1} a_{2}$ - подграф графа $G$, в котором степени вершин $a_{2}, a_{3}, \ldots, a_{k-1}$ равны 4 , а степени вершин $a_{1}$ и $a_{k}$ равны 2 . Следовательно, $V(G) \backslash V\left(H^{\prime}\right) \neq \varnothing$. В этом случае двухвершинное множество $\left\{a_{1}, a_{k}\right\}$ отделяет $\left\{a_{2}, a_{3}, a_{4}, \ldots, a_{k-1}\right\}$ от $V(G) \backslash V\left(H^{\prime}\right)$ (см. рисунок 5.18 a ), что невозможно в четырёхсвязном графе.


Рис. 5.18: Граф $G$.
2.3. $a_{k-1}$ смежна с вершиной $a_{k+1} \notin V(H)$.

Ребро $a_{k-1} a_{k+1}$ должно входить в треугольник. Если это треугольник $a_{k-1} a_{k} a_{k+1}$, то мы "продлили" нашу цепочку на одну вершину (см. рисунок 5.18 b ).

Предположим, что треугольник - другой. Этот треугольник может быть либо $a_{k-1} a_{k+1} a_{k-2}$, либо $a_{k-1} a_{k+1} a_{k-3}$ (третья вершина треугольника должна быть смежна с $a_{k-1}$, см. рисунок 5.19 a ). Значит, $d_{H}\left(a_{k-2}\right)<4$ или $d_{H}\left(a_{k-3}\right)<4$, что возможно только при $k-2 \leq 2$ или $k-3 \leq 2$. Первое противоречит $k \geq 5$, а второй случай возможен при $k=5$. Таким образом, единственный оставшийся вариант - это $k=5$ и треугольник $a_{2} a_{4} a_{6}$.


Рис. 5.19: Граф $G$.
В этом случае рассмотрим граф $H^{\prime}$, полученный из $H$ добавлением вершины $a_{6}$ и рёбер $a_{2} a_{6}, a_{4} a_{6}$. Мы имеем

$$
d_{H^{\prime}}\left(a_{2}\right)=d_{H^{\prime}}\left(a_{3}\right)=d_{H^{\prime}}\left(a_{4}\right)=4, \quad d_{H^{\prime}}\left(a_{1}\right)=d_{H^{\prime}}\left(a_{5}\right)=d_{H^{\prime}}\left(a_{6}\right)=2
$$

Если $V(G) \backslash V\left(H^{\prime}\right) \neq \varnothing$, то трёхвершинное множество $\left\{a_{1}, a_{5}, a_{6}\right\}$ отделяет $\left\{a_{2}, a_{3}, a_{4}\right\}$ от $V(G) \backslash V\left(H^{\prime}\right)$, что невозможно в четырёхсвязном графе (см. рисунок 5.19 b ).

Таким образом, $V\left(H^{\prime}\right)=V(G)$. Чтобы сделать граф $H^{\prime} 4$-регулярным графом $G$ на тех же 6 вершинах, нам нужно добавить все 3 возможных ребра $a_{1} a_{5}, a_{1} a_{6}, a_{5} a_{6}$ (см. рисунок 5.19 c ). Нетрудно проверить, что полученный граф $G$ - это квадрат цикла $a_{1} a_{2} a_{3} a_{4} a_{5} a_{6}$ длины 6.

# 5.6.3 Трёхсвязные графы: происхождение от колеса 

В этом разделе основным объектом нашего исследования станет трёхсвязный граф $G$ и его разделяющие множества.

Определение 5.15. Назовем колесом граф $W_{n}$ на вершинах $p, q_{1}, \ldots, q_{n}$ (где $n \geq 3$ ), в котором проведены рёбра $p q_{i}$ и $q_{i} q_{i+1}$ для всех $i \in[1 . . n]$ (нумерация вершин - циклическая).


Рис. 5.20: Колесо $W_{8}$.

Понятно, что любое колесо - трёхсвязный граф. Татт доказал, что с каждым отличным от колес трёхсвязным графом $G$ можно провести одну из двух операций, переводящих его в трёхсвязный граф, содержащий на одно ребро меньше. Эти операции - удаление ребра и стягивание ребра, не входящего в треугольник. Действуя в обратном порядке, можно для каждого $m \geq 6$ построить списки всех трёхсвязных графов с $m$ рёбрами.

Теорема 5.19. (W. T. Tutte, 1966.) Пусть $G$ - трёхсвязный граф, отличный от колеса. Тогда выполняется хотя бы одно из двух утверждений.
$1^{\circ}$ Существует такое ребро $e \in E(G)$, что граф $G-e$ трёхсвязен.
$2^{\circ}$ Существует такое ребро $e \in E(G)$, что граф $G \cdot$ е трёхсвязен и ребро е не входит ни в один треугольник.

Доказательство. Пусть $G$ - минимальный трёхсвязный граф $G$, отличный от колеса. Достаточно показать, что для $G$ выполняется утверждение $2^{\circ}$. Предположим противное. Вспомним, что по следствию 5.7 в минимальном трёхсвязном графе есть вершина степени 3 и рассмотрим два случая.

1. Существует такая вершина $x \in V(G)$, что $d_{G}(x)=3, \mathrm{~N}_{G}(x)=$ $\left\{y, t_{1}, t_{2}\right\}$ и $y t_{1}, y t_{2} \notin E(G)$.
Тогда ребро $x y$ не входит ни в один треугольник. Так как утверждение $2^{\circ}$ не выполнено, существует множество $S=\{x, y, z\} \in \mathfrak{R}_{3}(G)$. Тогда множество $T=\mathrm{N}_{G}(x) \in \mathfrak{R}_{3}(G)$ зависимо с $S$, а значит, $\operatorname{Part}(S)=\left\{A_{1}, A_{2}\right\}$ и множество $S$ отделяет $t_{1} \in \operatorname{Int}\left(A_{1}\right)$ от $t_{2} \in \operatorname{Int}\left(A_{2}\right)$ (см. рисунок 5.21). Теперь очевидно, что $t_{1} t_{2} \notin E(G)$ и ребро $x t_{1}$ не входит ни в один треугольник.

Нетрудно понять, что $|\operatorname{Part}(T)|=2$ и внутренность одной из этих частей - это $\{x\}$. Пусть $\operatorname{Part}(T)=\left\{B_{1}, B_{2}\right\}, \operatorname{Int}\left(B_{1}\right)=\{x\}$. Рассмотрим часть $F=A_{1} \cap B_{2} \in \operatorname{Part}(\{S, T\})$. Так как $t_{1} y \notin E(G)$ и $d_{G}\left(t_{1}\right) \geq 3$, существует хотя бы одна отличная от $t_{1}$ вершина $v \in \operatorname{Int}\left(A_{1}\right)$. Понятно, что $v \in \operatorname{Int}(F)$, стало быть, $F$ - непустая часть. Следовательно, её граница $\operatorname{Bound}(F)=\left\{y, t_{1}, z\right\} \in \mathfrak{R}_{3}(G)$.


Рис. 5.21: Случай 1.
Предположим, что существует множество $S^{\prime}=\left\{x, t_{1}, u\right\} \in \mathfrak{R}_{3}(G)$. В этом случае $S^{\prime}$ должно быть зависимо с $T$ и отделять $y$ от $t_{2}$. Вспомним, что $y \in A_{2}, t_{2} \in \operatorname{Int}\left(A_{2}\right)$, откуда понятно, что $u \in \operatorname{Int}\left(A_{2}\right)$ (иначе $S^{\prime}$ не разделяет часть $\left.A_{2} \in \operatorname{Part}(S)\right)$. Следовательно, $S^{\prime}$ зависимо с $S$, то есть, отделяет $y$ от $z$, а это означает, что $S^{\prime}$ зависимо с $\operatorname{Bound}(F)$. При этом, $S^{\prime}$ не пересекает внутренность $F$, что невозможно.

Полученное противоречие показывает, что граф $G \cdot t x_{1}$ трёхсвязен и для ребра $t x_{1}$ выполняется утверждение $2^{\circ}$ (очевидно, это ребро не входит в треугольник).

1. Для любой вершины $x \in V(G)$ степени 3 в графе $G\left(\mathrm{~N}_{G}(x)\right)$ хотя бы два ребра.
Пусть $d_{G}\left(x_{2}\right)=3, \mathrm{~N}_{G}\left(x_{2}\right)=\left\{x_{1}, x_{3}, y\right\}$, причем $x_{1} y, x_{3} y \in E(G)$ (см. рисунок 5.22 a ). Пусть $d_{G}(y)=3$. Если при этом $V(G) \neq\left\{x_{1}, x_{2}, x_{3}, y\right\}$, то $\left\{x_{1}, x_{3}\right\}$ отделяет $\left\{y, x_{2}\right\}$ от остальных вершин графа, что в трехсвязном графе невозможно. Значит, $V(G)=\left\{x_{1}, x_{2}, x_{3}, y\right\}$ и в этом случае граф $G$ - это $K_{4}$ (он же колесо $W_{3}$ ). Далее пусть $d_{G}(y)>3$.

Предположим, что в нашем графе нашелся простой путь $x_{1} x_{2} \ldots x_{k}$, где $k \geq 3$, все эти вершины смежны с вершиной $y$ и

$$
d_{G}\left(x_{2}\right)=\cdots=d_{G}\left(x_{k-1}\right)=3, \quad d_{G}(y)>3
$$


a

b

Рис. 5.22: Случай 2.
По теореме 5.8 в треугольнике $y x_{k-1} x_{k}$ должно быть хотя бы две вершины степени 3. Так как $d_{G}(y)>3$, мы имеем $d_{G}\left(x_{k}\right)=3$ и, аналогично, $d_{G}\left(x_{1}\right)=3$. Если $x_{1} x_{k} \in E(G)$, то граф $G-$ это колесо $W_{k}$. Пусть $x_{1} x_{k} \notin E(G)$ и вершина $x_{k}$ смежна с новой вершиной $x_{k+1}$ (см. рисунок 5.22 b ). Отметим, что $\mathrm{N}_{G}\left(x_{k}\right)=\left\{x_{k-1}, x_{k+1}, y\right\}$ и между этих трех вершин должны быть проведены два ребра графа $G$. Мы знаем, что $x_{k-1} x_{k} \in E(G)$ и $x_{k-1} x_{k+1} \notin E(G)$, следовательно, $y x_{k+1} \in E(G)$. Таким образом, мы продлили нашу цепочку ещё на одну вершину.

# 5.7 Разбиение вершин на связные множества 

Достаточно хорошо известно, что вершины двусвязного графа $G$ можно разбить на два связных множества заданных размеров, в сумме дающих $v(G)$. (Доказательство этого факта - несложное упражнение на дерево блоков и точек сочленения.) Вполне естественно, что обобщение этого факта верно и для графов большей связности - это теорема, независимо доказанная Дьори и Ловасом. Удивительно то, что эта теорема

имеет достаточно короткое и симпатичное (хотя весьма непростое!) доказательство.

Теорема 5.20. (E. Györi, 1976; L. Lovász, 1977.) Пусть $G-k$-связный граф на $n$ вершинах, $v_{1}, \ldots, v_{k} \in V(G)$, а натуральные числа $n_{1}, \ldots, n_{k}$ таковы, что $\sum_{i=1}^{k} n_{i}=n$. Тогда множество вершин графа $G$ можно разбить на $k$ таких связных подмножеств $V_{1}, \ldots, V_{k}$, что $\left|V_{i}\right|=n_{i}$ $u v_{i} \in V_{i}$ для каждого $i \in[1 . . k]$.

Приведем доказательство этой теоремы, основанное на работе Хойера и Томаса. Начнем с того, что переформулируем теорему так, чтобы было удобно этот факт доказывать.

Лемма 5.22. Пусть $G-k$-связный граф с $v(G)=n, v_{1}, \ldots, v_{k} \in V(G)$, а натуральные числа $m_{1}, \ldots, m_{k}$ таковы, что $\sum_{i=1}^{k} m_{i}<n$. Пусть $V_{1} \ni v_{1}, \ldots, V_{k} \ni v_{k}$ - непересекающиеся связные множества вершин графа $G$, причем $\left|V_{i}\right|=m_{i}$ для каждого $i \in[1 . . k]$. Тогда существуют такие непересекающиеся связные множества $V_{1}^{\prime} \ni v_{1}, \ldots, V_{k}^{\prime} \ni v_{k}$ вершин графа $G$, что $\left|V_{1}^{\prime}\right|=m_{1}+1 u\left|V_{i}^{\prime}\right|=m_{i}$ для всех $i \in[2 . . k]$.

Очевидно, что теорема 5.20 следует из леммы 5.22 - можно, начиная с $V_{i}=\left\{v_{i}\right\}$ для всех $i \in\{1,2, \ldots, k\}$ шаг за шагом увеличить наши связные множества до нужных размеров.

Далее мы будем доказывать эту лемму. Начнем с терминологии, которая для этого потребуется. До конца раздела мы считаем, что выполнено условие леммы 5.22 .

Пусть $G_{i}=G\left(V_{i}\right), \quad S=V(G) \backslash\left(\cup_{i=1}^{k} V_{i}\right)$.
Определение 5.16. Пусть $i \in[2 . . k]$.

1) Для вершины $x \in V_{i}$ ее резервуар $R(x)$ - это множество всех вершин из $V_{i}$, достижимых в графе $G_{i}-x$ из $v_{i}$. Положим $R\left(v_{i}\right)=\varnothing$.
2) Последовательность вершин $z_{0}=v_{i}, \ldots, z_{p}$ из множества $V_{i}$ (возможно, $p=0$ ) - каскад в графе $G_{i}$, если для всех $s \in[1 . . p-1]$ выполнено условие $z_{s+1} \notin R\left(z_{s}\right)$.
Замечание 5.10. 1) Отметим, что $x \notin R(x)$ по определению.
1) Для любой вершины $a \in V(G)$ множество $R(a)$ - связное в графе $G_{i}$. Более того, для любой вершины $x \notin R(a)$ множество $R(a)-$ связное в графе $G_{i}-x$.
Лемма 5.23. Пусть $a, b \in V_{i}$, причем $a \notin R(b)$. Тогда $R(a) \supset R(b) \cup\{b\}$.
Доказательство. Из $a \notin R(b)$ следует, что $b$ отделяет $a$ от $v_{i}$. Тогда $a$ не отделяет $b$ от $v_{i} \in R(b)$, а следовательно, $M=R(b) \cup\{b\}$ - связное множество в графе $G_{i}-a$. Так как $v_{i} \in M$, мы имеем $M \subset R(a)$.

Следствие 5.13. Пусть $z_{0}, z_{1}, \ldots, z_{p}-$ каскад в $G_{i}, s \in[1 . . p]$. Тогда выполнены следующие утверждения:

1) $R\left(z_{s}\right) \supset R\left(z_{s-1}\right) \cup\left\{z_{s-1}\right\}$
2) $z_{s}$ несмежна с $R\left(z_{s-1}\right)$.

Доказательство. 1) Прямое следствие леммы 5.23 и определения каскада.
1) Очевидно, так как $z_{s-1}$ отделяет $z_{s}$ от $R\left(z_{s-1}\right)$.

Определение 5.17. 1) Назовём конфигурацией графы $G_{1}, G_{2}, \ldots, G_{k}$, удовлетворяющие условию леммы 5.22 , и по одному каскаду в каждом из графов $G_{2}, \ldots, G_{k}$.
1) Вершина называется каскадной для данной конфигурации, если входит в один из каскадов и отлична от $v_{2}, \ldots, v_{k}$.
2) Положим $\operatorname{rk}\left(v_{2}\right)=\cdots=\operatorname{rk}\left(v_{k}\right)=0$. Определим ранг каскадных вершин рекурсивно. Каскадная вершина $z$, смежная с $V_{1}$, имеет $\operatorname{rk}(z)=1$. У остальных каскадных вершин ранг пока не определен.

Пусть каскадные вершины $z, z^{\prime}$ таковы, что $\operatorname{rk}\left(z^{\prime}\right)=r, z$ смежна с $R\left(z^{\prime}\right)$ и ранг $z$ пока не определен. Тогда положим $\operatorname{rk}(z)=r+1$.

Замечание 5.11. 1) Ранг какадной вершины может остаться неопределенным поле окончания процесса.
1) Ввиду следствия 5.13 вершины $z$ и $z^{\prime}$ из определения ранга принадлежат разным каскадам.

Определение 5.18. Пусть дана конфигурация $\mathcal{G}$.

1) Назовем конфигурацию нормальной, если у каждой каскадной вершины определен ранг и для каждого $i \in[2 . . k]$ ранги вершин каскада графа $G_{i}$ строго возрастают (то есть, если этот каскад $z_{0}, \ldots, z_{p}$ и $p \geq 1$, то $\left.\operatorname{rk}\left(z_{1}\right)<\cdots<\operatorname{rk}\left(z_{p}\right)\right)$.
2) Для каждого $r$ определим $\rho_{r}(\mathcal{G})$ как сумму размеров резервуаров всех каскадных вершин ранга $r$.
3) Назовём хвостом такое ребро $a b \in E(G)$, что $a \in S$, а $b$ принадлежит резервуару некоторой каскадной вершины. Рангом хвоста $a b$ назовём наименьший ранг такой каскадной вершины $z$, что $b \in R(z)$.

Определение 5.19. 1) Рассмотрим все нормальные конфигурации. Выберем из них те, у которых максимально $\rho_{1}$. Затем из оставшихся конфигураций выберем те, у которых максимально $\rho_{2}$. И так далее, наконец, выберем те конфигурации, у которых максимально $\rho_{r}$. Все полученные в итоге конфигурации назовем $r$-оптимальными.
1) Назовем конфигурацию $\mathcal{G}$ оптимальной, если она $r$-оптимальна для любого $r$.

Замечание 5.12. 1) Если $r \leq t$, то любая $t$-оптимальная конфигурация является $r$-оптимальной.
1) Вершина $v_{i}$ является каскадом в $G_{i}$, причем ее ранг определять не нужно. Поэтому, нормальные конфигурации существуют. Значит, существуют $r$-оптимальные конфигурации для любого натурального числа $r$.
2) Максимальный ранг каскадной вершины не превосходит количества каскадных вершин, которое, в свою очередь, не превосходит $n$. Поэтому, $n$-оптимальная конфигурация является оптимальной. В частности, это означает, что оптимальные конфигурации существуют.
3) Если $a b \in E(G)$ - хвост и $b \in R(z)$, то $z \notin\left\{v_{2}, \ldots v_{k}\right\}$, так как резервуары всех этих вершин пусты.

Далее мы докажем два свойства оптимальных конфигураций, из которых будет несложно следовать лемма 5.22 .

Лемма 5.24. Если существует оптимальная конфигурация, имеющая хвост, то утверждение леммы 5.22 выполнено.

Доказательство. Рассмотрим все $r$-оптимальные конфигурации с хвостом ранга $r$ (такие в нашем случае есть) и выберем из них конфигурацию $\mathcal{G}$ с минимальным $r$. Пусть хвост $a b$ таков, что $a \in S$, а $z \in V_{i}-$ каскадная вершина наименьшего ранга, для которой $b \in R(z)$. Рассмотрим несколько случаев.

1. $z$ является точкой сочленения графа $G_{i}$.

Пусть $U$ - компонента связности графа $G_{i}-z$, не содержащая $v_{i}$. Тогда существует такая вершина $u \in U$, что граф $G_{i}-u$ связен. Положим $W_{i}=V_{i} \cup\{a\} \backslash\{u\}$ (см. рисунок 5.23 a ). Очевидно, множество $W_{i}$ связно, $\left|W_{i}\right|=m_{i}$. Построим новую конфигурацию $\mathcal{G}^{\prime}$, заменив $V_{i}$ на $W_{i}$, после чего из всех каскадов уберем вершины ранга более $r$.

Так как конфигурация $\mathcal{G}$ была нормальной, у всех каскадных вершин ранга не более $r$ ранг по-прежнему определен и не изменился, не изменились и все их резервуары, кроме $R(z)$, в который добавилась вершина $a$. В новой конфигурации $\mathcal{G}^{\prime}$ при $1 \leq s \leq r-1$ мы имеем $\rho_{s}\left(\mathcal{G}^{\prime}\right)=\rho_{s}(\mathcal{G})$, но $\rho_{r}\left(\mathcal{G}^{\prime}\right)=\rho_{r}(\mathcal{G})+1$ (так как $R(z)$ увеличился). Мы получили противоречие с $r$-оптимальностью конфигурации $\mathcal{G}$.
1. $z$ не является точкой сочленения графа $G_{i}$.

Если $\operatorname{rk}(z)=1$, то положим $V_{1}^{\prime}=V_{1} \cup\{z\}, V_{i}^{\prime}=V_{1} \cup\{a\} \backslash\{z\}$, эти множества, очевидно, связны (см. рисунок 5.23 b ). Положив $V_{j}^{\prime}=V_{j}$ при $j \notin\{1, i\}$, мы получим нужные в лемме 5.22 связные множества.

Пусть $\operatorname{rk}(z)=r>1$, тогда $z$ смежна с $y \in R\left(z^{\prime}\right)$, где $z^{\prime}$ - каскадная вершина ранга $r-1$. В этом случае положим $W_{i}=V_{i} \cup\{a\} \backslash\{z\}$ (см.

рисунок 5.23 c ). Построим новую конфигурацию $\mathcal{G}^{\prime}$, заменив $V_{i}$ на $W_{i}$, после чего из всех каскадов уберем вершины ранга не менее $r$.

Так как конфигурация $\mathcal{G}$ была нормальной, у всех каскадных вершин ранга не более $r-1$ ранг по-прежнему определен и не изменился, не изменились и все их резервуары. В новой конфигурации $\mathcal{G}^{\prime}$ при $1 \leq s \leq r-1$ мы имеем $\rho_{s}\left(\mathcal{G}^{\prime}\right)=\rho_{s}(\mathcal{G})$, а значит $\mathcal{G}^{\prime}$ является $(r-1)$-оптимальной (напомним, что $r$-оптимальная конфигурация $\mathcal{G}$ является и $(r-1)$-оптимальной). Однако, ребро $z y$ в конфигурации $\mathcal{G}^{\prime}$ является хвостом ранга $r-1$. Противоречие с минимальностью ранга хвоста $a b$.

Лемма 5.25. Пусть $\mathcal{G}$ - оптимальная конфигурация, $i \in\{2, \ldots, k\}$, а $z_{0}=v_{i}, \ldots, z_{p}-$ каскад графа $G_{i}$ (возможно, $p=0$ ). Пусть ребро $a b$ таково, что вершина $a \in V_{i}$ не входит в резервуар ни одной из каскадных вершин, а вершина b либо лежит в $V_{1}$, либо входит в резервуар одной из каскадных вершин. Тогда $a=z_{p}$.

Доказательство. Предположим, что $a \neq z_{p}$. Тогда по следствию 5.13 вершина $a$ не совпадает ни с одной из вершин $z_{0}, \ldots, z_{p}$. Попробуем добавить $a$ в каскад графа $G_{i}$.

Сразу же отметим, что у нас получится определить ранг вершины $a$, так как $a$ смежна с $b$ и либо $b \in V_{1}$ (тогда $\operatorname{rk}(a)=1$ ), либо $b \in R\left(z^{\prime}\right)$, где $z^{\prime}$ - каскадная вершина. Во втором случае мы знаем, что $\operatorname{rk}\left(z^{\prime}\right)$ определен (так как конфигурация нормальная), а значит, $\operatorname{rk}(a) \leq \operatorname{rk}\left(z^{\prime}\right)+1$.

Итак, пусть $\operatorname{rk}(a)=r$. Если $r>\operatorname{rk}\left(z_{p}\right)$, то положим $a=z_{p+1}$ (это можно сделать, так как $a \notin R\left(z_{p}\right)$ ). Мы увеличили каскад графа $G_{i}$, не изменив остальные, что противоречит оптимальности конфигурации $\mathcal{G}$.

Пусть $r \leq \operatorname{rk}\left(z_{p}\right)$. Это означает, что $p \neq 0$. Найдем такое $j \geq 0$, что $\operatorname{rk}\left(z_{j}\right)<r \leq \operatorname{rk}\left(z_{j+1}\right)$. Тогда добавим в каскад графа $G_{i}$ вершину $z_{j+1}^{\prime}=a$ и исключим из него $z_{j+1}, \ldots, z_{p}$, а также все вершины рангов более $r$ из остальных каскадов. Полученная конфигурация $\mathcal{G}^{\prime}$, очевидно, нормальна, все каскадные вершины рангов не более $r-1$ из $\mathcal{G}$ есть и


Рис. 5.23: Конфигурация с хвостом.

в $\mathcal{G}^{\prime}$, причем с теми же резервуарами. Следовательно, $\rho_{s}\left(\mathcal{G}^{\prime}\right)=\rho_{s}(\mathcal{G})$ для всех $s \in\{1, \ldots, r-1\}$.

Все каскадные вершины ранга $r$ из $\mathcal{G}$ (кроме, возможно, $z_{j+1}$ ) есть и в $\mathcal{G}^{\prime}$, причем с теми же резервуарами. При этом, добавилась вершина $a$ ранга $r$ и, возможно, исчезла вершина $z_{j+1}$ ранга $r$. Из $a \notin R\left(z_{j+1}\right)$ по лемме 5.23 следует, что $R(a) \supset R\left(z_{j+1}\right) \cup\left\{z_{j+1}\right\} \supseteq R\left(z_{j+1}\right)$. Поэтому, $\rho_{r}\left(\mathcal{G}^{\prime}\right)>\rho_{r}(\mathcal{G})$, что противоречит оптимальности $\mathcal{G}$.


Рис. 5.24: Разделяющее множество $W$.

Доказательство леммы 5.22. Рассмотрим оптимальную конфигурацию $V_{1}, V_{2} \ldots, V_{k}$ - выше сказано, почему такая существует. Для каждого $i \in\{2, \ldots, k\}$ конфигурация включает в себя каскад, пусть $w_{i}-$ последняя вершина этого каскада. (Возможно, $w_{i}=v_{i}$.) Обозначим $A$ объединение $V_{1}$, всех каскадных вершин и их резервуаров, а $B$ - объединение $S$ и всех вершин из $V_{2} \cup \cdots \cup V_{k}$, не вошедших в каскады и резервуары каскадных вершин (см. рисунок 5.24). В силу лемм 5.24 и 5.25 , множество $W=\left\{w_{2}, \ldots, w_{k}\right\}$ из $k-1$ вершины отделяет $A$ от $B$, что противоречит $k$-связности графа $G$.

# 5.8 Комментарии 

Глава начинается с самого известного утверждения из теории связности - теоремы Менгера, которая приведена в разных формах для удобства последующего применения. Помимо приведенного в книге доказательства существует много других, в том числе весьма симпатичных, еще два доказательства теоремы Менгера можно найти в книге Дистеля [8].

Эта глава отличается от всех остальных тем, что в ней изложен мой взгляд на связность графов и включено некоторое количество сообственных результатов, а многие классические результаты даны с новыми доказательствами. Одним из важнейших понятий главы является понятие части разбиения графа набором разделяющих множеств. В разделе 5.2

приведены основные определения и свойства, в основном по статье [51]. Материал этого раздела достаточно прост и очень важен для прочтения всей остальной части главы, так как является удобным языком, на котором излагаются следующие разделы.

Далее рассказано об удалении вершин и ребер из $k$-связного графа с сохранением $k$-связности. В первом случае, начало исследования было положено в 1972 году работой [6], в книге приведен более сильный результат, полученный автором совместно с А. В. Пастором в 2000 году [57]. Все результаты раздела об удалении рёбер принадлежат Мадеру и были опубликованы в 1972-79 годах на немецком языке. Кроме последней теоремы Халина, доказаннной ранее, в 1969 году. Эта теорема является несложным следствием результатов Мадера, откуда она и выведена в книге. Насколько мне известно, доказательства этих классических фактов так и не переведены на английский. Заинтересовавшимся рекомендую обзор Мадера [25], где можно найти эти и многие другие результаты, а также некоторые открытые вопросы.

В следующем разделе 5.5 рассказывается о конструкции дерева разбиения $k$-связного графа, обобщающей классическое дерево блоков и точек сочленения, описанное во введении. Этак конструкция придумана в 2013 году [53] и позволяет упорядочить структуру разбиения графа. В качестве частного случая приводится конструкция дерева разбиения двусвязного графа, почти что аналогичная придуманной Таттом в 1966 году [38]. На мой взгляд, данное Таттом описание его конструкции весьма непросто. Возможно, из-за этого столь важная конструкция редко применялась. Надеюсь, наш язык описания окажется более удобным. Показан ряд применений дерева разбиения двусвязного графа: для оценки хроматического числа графа, для описания минимальных и критических двусвязных графов. В главе Планарные графы (раздел 6.3.1) на языке частей разбиения двусвязного графа сформулирована и доказана классическая теорема Маклейна о планарности.

В разделе 5.6 обсуждается вопрос о стягивании рёбер в $k$-связном графе без потери $k$-связности. Вопрос о существовании такого ребра для для двусвязных и трёхсвязных графов несложен, доказательство соответствующих теорем принадлежит Татту [38]. При больших $k$ существуют минимальные по стягиванию графы - в которых такого ребра нет. Про структуру таких графов при $k \geq 5$ почти ничего не известно, а вот структура минимальных по стягиванию 4-связных графов полностью описана Мартиновым в 1990 году [26]. Эти результаты и составляют основное содержание раздела. В конце раздела доказана знаменитая теорема Татта о "происхождении трёхсвязных графов от колеса". На мой взгляд, доказательство с использованием принятой в этой книге терми-

нологии получилось достаточно простым и элегантным.
И наконец, в последнем разделе главы доказывается замечательная теорема Дьори-Ловаса о разбиении вершин $k$-связного графа на $k$ связанных множеств заданных размеров [14], [21]. Даже удивительно, что столь красивую теорему не найти в сборниках по теории графов! В книге приведено доказательство по статье Робина и Томаса [15].

В заключении отмечу, что многое, что мне хотелось бы сказать про связность графов, осталось за рамками этой главы - автору пришлось себя ограничить, ведь это обзорная книга по теории графов, а не только по связности. Гораздо больше именно по связности графов можно найти в [56]. Это пока что $\beta$-версия будущей книги, в планах на ближайшее время ее значительное пополнение. Однако, уже сейчас в книге достаточно много материала.

ГЛАВА 5. СВЯЗНОСТЬ

# Глава 6 

## Планарные графы

## 6.1 Плоские и планарные графы

Определение 6.1. Граф называется планарным, если его можно изобразить на плоскости так, чтобы его рёбра не пересекались во внутренних точках.

Строго говоря, это определение недостаточно: нужно сказать, как же мы изображаем рёбра. Однако мы не будем вдаваться в подробности, выходящие за пределы теории графов и будем считать, что рёбра - ломаные.

Кроме того, во всем разделе будет считаться очевидным совсем неочевидный факт - теорема Жордана - которую мы сформулируем так: любая замкнутая несамопересекающаяся ломаная делит плоскость на две части, которые мы будем называть областями.

Плоским графом (или плоским изображением) мы будем называть конкретное изображение планарного графа на плоскости без пересечений и самопересечений рёбер.

### 6.1.1 Грань и её граница

Каждый плоский граф делит плоскость на несколько частей, которые мы будем называть гранями. Множество всех граней плоского графа $G$ будем обозначать через $F(G)$.

Грани являются важным элементом плоского графа, именно они отличают плоский граф от планарного графа, который можно изобразить на плоскости. С точки зрения теории графов все грани равноправны. Однако, визуально одна из граней отличается от всех остальных -

это внешняя грань - единственная неограниченная грань. В доказательствах бывает полезно это отличие, так как позволяет более наглядно формулировать утверждения. Остальные грани мы будем называть внутренними.

Перейдем к определению границы грани.
Рассмотрим ребро $e$ плоского графа $G$. Либо по разные стороны от $e$ расположены разные грани (тогда ребро $e$ - граничное ребро этих двух граней), либо по обе стороны от $e$ - одна и та же грань, тогда назовем ребро $e$ внутренним ребром этой грани.

Граничные вершины грани $d$ - это вершины, от которых можно дойти до внутренних точек этой грани, не пересекая её граничных и внутренних рёбер. Понятно, что концы внутренних и граничных рёбер грани $d-$ это её граничные вершины. Граница грани $d$ - это подграф $B(d)$ графа $G$, множество вершин которого составляют граничные вершины, а множество рёбер - внутренние и граничные рёбра грани $d$. Размер границы грани $d$ мы определим, как количество граничных рёбер этой грани плюс удвоенное количество внутренних рёбер. Обозначать эту величину будем через $b(d)$.

Таким образом, если сложить размеры границ всех граней, получится удвоенное количество рёбер.

Если граница внейшней грани плоского графа $G$ - цикл, мы будем называть его внешним ииклом графа $G$.

Границы граней имеют важное значение для изучения плоских графов. Отметим следующее очевидное свойство.
Лемма 6.1. Для плоского графа $G$ выполнены следуюшие утверждения.

1) Если $e$ - внутреннее ребро грани $d$, то $e-$ мост.
2) Границы граней рёберно двусвязного плоского графа - простые циклы.
Доказательство. 1) Пусть ребро $e$ лежит в цикле $C$. Как мы уже писали выше, цикл делит плоскость на две области, а грань $d$ может лежать только в одной из них.
1) Непосредственное следствие пункта 1.

Если границы двух разных граней двусвязного плоского графа совпадают, то несложно доказать, что этот граф - простой цикл. В остальных случаях граница грани однозначно определяет грань.

# 6.1.2 Разные изображения одного графа 

Если рассматривать плоский граф $H$ - изображение абстрактного графа $G$ на плоскости, игнорируя его "плоские" свойства, то графы $H$ и $G$

изоморфны. Поэтому, как правило, мы будем одинаково обозначать абстрактный планарный граф и его конкретное изображение на плоскости - плоский граф. В большинстве случаев это не приведёт к путанице. Однако, плоские графы имеют важное отличие от планарных, а именно, еще один тип элементов, кроме вершин и рёбер - грани. Возникает вопрос, а можно ли по-разному изобразить на плоскости один и тот же планарный граф? А какие изображения данного графа нужно считать одинаковыми? Мы планируем всячески избегать топологических подробностей, а потому дадим чисто комбинаторное определение, чуть усилив определение изоморфизма графов 1.53 - все-таки, у плоских графов есть не только вершины и рёбра, но и грани.

Определение 6.2. Пусть $G$ и $G^{\prime}$ - два плоских графа, а отображение $\varphi: V(G) \rightarrow V\left(G^{\prime}\right)$ - изоморфизм графов, удовлетворяющий следующему условию: множество вершин $U \subset V(G)$ является множеством граничных вершин некоторой грани графа $G$, если и только если $\varphi(U)$ является множеством граничных вершин некоторой грани графа $G^{\prime}$. Тогда $\varphi$ - изоморфизм плоских графов $G$ и $G^{\prime}$, а сами эти плоские графы изоморфны.

Мы будем считать изоморфные плоские графы одинаковыми - в самом деле, изоморфизм плоских графов легко продолжить на множество рёбер и граней так, что сохранится отношение инцидентности - вершины (рёбра) одной грани графа $G$ будут переходить в вершины (рёбра) одной грани графа $G^{\prime}$. Таким образом, все изучаемые в этой главе свойства у изоморфных плоских графов будут одинаковы. Еще раз подчеркнем, что нас интересуют только комбинаторные свойства, а никак не топологические - с ними ситуация сложнее.

Можно придумать пример графа, имеющего неизоформные изображения. В разделе 6.4 будет доказано, что трёхсвязный планарный граф имеет единственное с точностью до изоморфизма плоское изображение.

# 6.1.3 Плоскость и сфера 

Отметим, что граф является планарным тогда и только тогда, когда его можно изобразить на сфере без пересечения рёбер во внутренних точках. Это очевидно, так как плоскость и сфера переводятся друг в друга стереографической проекцией. (Поставим сферу на плоскость, точку касания назовём южным полюсом, противоположную точку - северным полюсом $N$. Каждая точка $A \neq N$ сферы перейдёт в точку пересечения плоскости и луча $N A$. Переводя изображение графа со сферы на плос-

кость нужно лишь выбрать северный полюс так, чтобы он не совпадал ни с одной из вершин графа и не попадал на рёбра.)

В плоском изображении планарного графа есть неограниченная внешняя грань, которая визуально сильно отличается от всех остальных, а в сферическом изображении такой грани нет. Грань сферического изображения графа, содержащая северный полюс будет соответствовать при стереографической проекции внешней грани плоского изображения. Таким образом, перемещая северный полюс на разные грани, можно любую грань сферического изображения сделать внешней гранью в плоском изображении графа. Это лишний раз подчеркивает, что на самом деле внешняя грань не отличается от остальных.

# 6.2 Формула Эйлера 

В разных плоских изображениях планарного графа $G$ получаются разные грани. Однако, их количество является инвариантом графа, как говорит нам формула Эйлера.

Теорема 6.1. (L. Euler, 1752.) Пусть $G$ - плоский граф с $v$ вершинами, е рёбрами и $f$ странами, имеющий $k$ компонент связности. Тогда $v-e+f=1+k$.

Доказательство. Доказательство теоремы легко делается индукцией по количеству рёбер. База для случая, когда граф $G$ - лес, очевидна, ибо в этом случае $f=1, e=v-k$.

Пусть для графов с меньшим числом вершин формула Эйлера уже доказана. Предположим, что в графе есть цикл, пусть ребро $\ell$ входит в цикл. Тогда по ребру $\ell$ граничат две разные страны, которые объединяются в одну в графе $G-\ell$. Таким образом, в графе $G-\ell$ есть $v$ вершин, $e-1$ ребро и $f-1$ страна. Теперь формула Эйлера для $G$ следует из формулы Эйлера для $G-\ell$, которая верна по индукционному предположению.

Мы всегда будем обозначать количество вершин, рёбер и граней плоского графа $G$ буквами $v, e$ и $f$ соответственно.

Следствие 6.1. Пусть $G$ - планарный граф без петель и кратных рёбер, $v \geq 3$. Тогда выполняются следующие утверждения.

1) $e \leq 3 v-6$.
2) Если граф $G$ - двудолъный, то е $\leq 2 v-4$.

Доказательство. 1) Нетрудно проверить, что размер границы каждой грани графа $G$ не менее 3 . В самом деле, пусть в границе некоторой грани не более двух рёбер. Так как кратных рёбер нет, граница этой грани не содержит цикла. Следовательно, все ее рёбра - внутренние, тогда такое ребро всего одно, откуда легко вывести, что в графе всего две вершины, противоречие. Таким образом, в каждой грани хотя бы три ребра, а сумма количеств рёбер в границах всех граней, как уже замечено выше, есть $2 e$. Следовательно, $2 e \geq 3 f$ или $f \leq \frac{2 e}{3}$.

Тогда из формулы Эйлера следует

$$
v-\frac{e}{3}=v-e+\frac{2 e}{3} \geq v-e+f \geq 2
$$

откуда следует доказываемое неравенство.
1) Поскольку в двудольном графе нет циклов длины 3 , аналогично первому пункту выводится, что размер границы каждой грани графа $G$ не менее 4 , то есть, $f \leq \frac{e}{2}$. Подставив это неравенство в формулу Эйлера, получим доказываемое утверждение.

Следствие 6.2. Пусть $G$ - планарный граф без петель и кратных рёбер. Тогда $\delta(G) \leq 5$.

Доказательство. В случае $v \leq 2$ утверждение очевидно. Пусть $v \geq 3$ и при этом $\delta(G) \geq 6$. Тогда $6 v \leq 2 e$, то есть, $e \geq 3 v$ - противоречие со следствием 6.1.

Замечание 6.1. Непосредственно из доказательства следствия 6.1 следует, что утверждения следствий 6.1 и 6.2 также выполнены для графов, у которых нет граней размера 1 и 2 (но, возможно, есть кратные рёбра).

Следствие 6.3. $K_{5}$ и $K_{3,3}$ - непланарные графы.
Доказательство. 1) Пусть $K_{5}$ планарен. Для этого графа $v=5, e=10$. Тогда по пункту 1 следствия 6.1 мы имеем $10=e \leq 3 v-6=9$, что неверно.
1) Пусть $K_{3,3}$ планарен. Для этого двудольного графа $v=6, e=9$. Тогда по пункту 2 следствия 6.1 мы имеем $9=e \leq 2 v-4=8$, что неверно.

# 6.3 Теорема Куратовского 

Нам понадобится понятие подразбиения графа, определенное во введении (определение 1.14.)

Лемма 6.2. Пусть $x, y \in V(G)$, $x y \in E(G)$. Тогда выполняются следующие утверждения.

1) Если $G \cdot x y \supset K_{3,3}$, то $G \supset K_{3,3}$.
2) Если $G \cdot x y \supset K_{5}$, то $G \supset K_{5}$ или $G \supset K_{3,3}$.

Доказательство. Пусть $w=x \cdot y$, а $H$ - подграф $G \cdot x y$, являющийся подразбиением $K_{3,3}$ или $K_{5}$. Если $w \notin V(H)$ то, очевидно, $G \supset K_{3,3}$ или $G \supset K_{5}$, соответственно.

Остается рассмотреть случай, когда $w \in V(H)$. Построим подграф $H^{\prime}$ графа $G$ следующим образом: $V\left(H^{\prime}\right)=V(H) \backslash\{w\} \cup\{x, y\}$. Все рёбра из $E(H)$, не инцидентные $w$, включим в $E\left(H^{\prime}\right)$. Для каждого ребра а $w \in E(H)$ в графе $G$ есть хотя бы одно из рёбер ах или ау, включим его в $E\left(H^{\prime}\right)$ (если есть оба этих ребра, возьмем любое из них. Наконец, поместим в $E\left(H^{\prime}\right)$ ребро $x y$. Рёбра графа $H^{\prime}-x y$, инцидентные вершине $x$, назовем красными, а рёбра графа $H^{\prime}-x y$, инцидентные вершине $y$ - синими. Тогда суммарное количество красных и синих рёбер равно $d_{H}(w)$.

Если в графе $H^{\prime}$ ровно $d_{H}(w)$ красных рёбер, то $H^{\prime}-y$ - подграф графа $G$, изоморфный $H$. В этом случае доказательство леммы закончено. Аналогично для синих рёбер.

Пусть $a y$ - единственное синее ребро в $H^{\prime}$. Тогда ребру $a w \in E(H)$ соответствует путь $a y x$ в графе $H^{\prime}$, то есть, $H^{\prime}$ является подразбиением графа $H$. В этом случае лемма доказана, аналогично для случая, когда есть ровно одно красное ребро.

Пусть теперь и красных, и синих рёбер не менее, чем по два. Тогда $d_{H}(w) \geq 4$, откуда сразу же следует, что $H \supset K_{5}, d_{H}(w)=4$. Пусть тогда $z_{1}, z_{2}, z_{3}, z_{4}$ - четыре оставшихся вершины графа $H$, соответствующие вершинам $K_{5}$. Каждая пара из вершин $w, z_{1}, z_{2}, z_{3}, z_{4}$ соединена в $H$ путём - подразбиением соответствующего ребра графа $K_{5}$. Разные пути не имеют общих внутренних вершин. Этим путям соответствуют пути в графе $H^{\prime}$. Не умаляя общности можно считать, что в графе $H^{\prime}$ есть $x z_{1}$-путь, $x z_{2}$-путь, $y z_{3}$-путь и $y z_{4}$-путь. Тогда нетрудно заметить, что $H^{\prime} \supset K_{3,3}$ : каждая из вершин $x, z_{3}, z_{4}$ соединена путём с каждой из вершин $y, z_{1}, z_{2}$, разные пути не имеют общих внутренних вершин.

Теорема 6.2. (K. Kuratowski, 1930) Граф $G$ (возможно, имеющий кратные рёбра и петли) непланарен, если и только если $G \supset K_{5}$ или $G \supset K_{3,3}$.

Доказательство. (Ю. Макарычев, 1997.)
$\Leftarrow$. В следствии 6.3 показана непланарность $K_{5}$ и $K_{3,3}$, тогда и любое подразбиение каждого из этих графов непланарно (граф не может стать планарным из-за замены ребра цепочкой рёбер).

$\Rightarrow$. Покажем, что любой граф, не содержащий подразбиений $K_{5}$ и $K_{3,3}$, планарен. Предположим противное и рассмотрим минимальный контрпример $G$ (непланарный граф, не содержащий подразбиений $K_{5}$ и $K_{3,3}$ ). Любой не содержащий подразбиений $K_{5}$ и $K_{3,3}$ граф с меньшим чем $G$ числом вершин или с таким же, как у $G$ числом вершин и меньшим числом рёбер обязательно является планарным. Тогда легко понять, что $\delta(G) \geq 3$. (Добавление в граф вершин степени 0 и 1 не делает его непланарным. Очевидно, минимальный контрпример не может быть подразбиением графа с меньшим числом вершин и потому не содержит вершин степени 2.)

Также несложно понять, что $G$ не имеет петель и кратных рёбер. В самом деле, пусть $e-$ петля графа $G$. Тогда граф $G-e$ планарен и из его планарности следует планарность графа $G$ (можно без труда дорисовать петлю к плоскому изображению $G-e$ ). Теперь пусть $G$ имеет два кратных ребра $e$ и $f$. Тогда граф $G-e$ планарен и из его планарности следует планарность графа $G$ (можно без труда дорисовать ребро $e$ вдоль ребра $f$ в плоском изображении $G-e$ ).

1. Пусть $x y \in E(G)$. Рассмотрим граф $G \cdot x y$, пусть $w=x \cdot y$. По лемме 6.2 мы имеем $G \cdot x y \not \supset K_{5}, G \cdot x y \not \supset K_{3,3}$, следовательно, граф $G \cdot x y$ планарен. Пусть $G^{\prime}=G-x-y=G \cdot x y-w$ (изоморфность этих двух графов очевидна). Изучим свойства графа $G^{\prime}$.
Лемма 6.3. $\delta\left(G^{\prime}\right) \geq 2$.
Доказательство. Предположим противное, пусть $z \in V\left(G^{\prime}\right), d_{G^{\prime}}(z) \leq 1$. Если $d_{G^{\prime}}(z)=0$, то $d_{G}(z) \leq 2$, противоречие с доказанным выше. Пусть $d_{G^{\prime}}(z)=1$. Тогда $d_{G}(z)=3$, вершина $z$ смежна в графе $G$ с обеими вершинами $x$ и $y$ и еще одной вершиной $u$. Отметим, что граф $G-x y$ планарен, изобразим его на плоскости без пересечений рёбер. Рассмотрим вершину $z$ и три выходящие из нее ребра $z x, z y$ и $z u$. Легко понять, что мы можем дорисовать ребро $x y$ вдоль пути $x z y$ так, чтобы оно не пересекало $z u$ и остальные рёбра графа (см. рисунок 6.1). Тем самым, мы установили планарность $G$, противоречие.

Лемма 6.4. Граф $G^{\prime}$ не содержит $\theta$-нодерафа (то есть, подграфа из трёх независимых путей между двумя вершинами, который в некотором смысле является подразбиением буквы $\theta$ ).

Доказательство. Изобразим планарный граф $G \cdot x y$ на плоскости без пересечений рёбер. Удалим с этого изображения вершину $w$, получив тем самым изображение графа $G^{\prime}$. Пусть $f$ - грань $G^{\prime}$ (в полученном плоском изображении), содержащая вершину $w$ (см. рисунок 6.2 a , толстые рёбра).



Рис. 6.1: Ребро $x y$.

Назовем рёбра границы грани $f$ чёрными, пусть $H$ - граф из чёрных рёбер. Так как граф $H$ - граница грани, то из теоремы Жордана легко выводится, что $H \not \supset \theta$ (так мы будем обозначать отсутствие $\theta$-подграфа у графа $H$ ). Действительно, $\theta$-подграф делит плоскость на три области, а грань $f$ лежит в одной из этих областей. Значит, от внутренних точек грани $f$ нельзя дойти, не пересекая рёбра графа, до рёбер одного из трёх путей $\theta$-подграфа, то есть, эти рёбра не могут быть граничными рёбрами грани $f$. Мы покажем, что $G^{\prime}=H$ и, тем самым, завершим доказательство леммы.

Предположим противное, пусть $G^{\prime} \neq H$, тогда существуют рёбра в графе $G^{\prime}$, не входящие в границу грани $F$. Такие рёбра должны быть отделены от вершины $w$ каким-то простым циклом, являющимся частью границы грани $F$. Таким образом, существует простой цикл $C$ в графе $H$, в одной части относительно которого лежит вершина $w$ (и, разумеется, все рёбра из $H-C$ ), и есть рёбра графа $G^{\prime}$ в другой части относительно $C$. Назовём эти рёбра красными (см. рисунок 6.2 a , тонкие рёбра). Возможно, не все рёбра графа $G^{\prime}$ являются чёрными или красными: в графе $H$ такой цикл $C$ может быть неединственным. Все остальные рёбра графа $G^{\prime}$ назовём синими, тогда каждое синее ребро отделено от вершины $w$ каким-то простым циклом $C^{\prime}$ графа $H$, причем $C^{\prime} \neq C$ (см. рисунок 6.2 a , пунктирные рёбра).


Рис. 6.2: Графы $G^{\prime}$ и $G^{*}$.

Рассмотрим граф $G^{*}$, полученный из $G$ удалением всех красных рёбер. Этот граф очевидно планарен, рассмотрим его изображение на плоскости. Смежные вершины $x$ и $y$ изображены в одной части относительно цикла $C$, не умаляя общности, будем считать, что вне цикла. Мы исправим изображение графа $G^{*}$ так, чтобы внутри цикла $C$ ничего не было нарисовано. Рассмотрим граф $G^{*}-x-y$. Все его рёбра - это черные рёбра из графа $H-C$ и синие рёбра. Каждое синее ребро отделено от цикла $C$ каким-то простым циклом $C^{\prime}$ графа $H-C$, так что достаточно изобразить вне $C$ все рёбра графа $H-C$, после чего оставшиеся синие рёбра можно изобразить внутри соответствующих им циклов графа $H-C$.

Пусть $H^{\prime}$ - компонента графа $H-C$. Тогда существует не более одной вершины $v$ в цикле $C$, смежной с вершинами из $H^{\prime}$, иначе в $H$ был бы $\theta$ подграф, что, как мы доказали выше, невозможно. Если такая вершина $v$ есть, то мы изобразим $H^{\prime}$ вне цикла $C$ в маленькой окрестности вершины $v$ так, чтобы изображение не пересекало выходящих из $v$ вне цикла $C$ рёбер (см. рисунок 6.2 b ). Если же такой вершины $v$ нет, изобразить $H^{\prime}$ вне $C$ еще проще. Так поступим с каждой компонентой графа $H-C$.

Таким образом, существует плоское изображение графа $G^{*}$, в котором внутри цикла $C$ ничего нет. Там-то мы и изобразим красные рёбра, они по своему определению могут быть изображены в одной части относительно цикла $C$ ! Тем самым, мы установили планарность графа $G$ и пришли к противоречию. Значит, $G^{\prime}=H$, откуда немедленно следует $G^{\prime} \not \supset \theta$.
1. Вернемся к доказательству теоремы. Пусть $x y \in E(G)$. Так как $G-x-y \not \supset \theta$, любые два цикла графа $G-x-y$ имеют не более одной общей вершины. Рассмотрим крайний блок $B$ графа $G-x-y$. Так как $\delta(G-x-y) \geq 2$ по лемме 6.3 , блок $B$ не может состоять из двух вершин. Значит, $B$ двусвязен, то есть, имеет простой цикл $Z$. Если есть вершина $v \in B \backslash V(Z)$, то по теореме Менгера существует два пути от $v$ до различных вершин $Z$ без общих внутренних вершин, а значит, $G-x-y \supset \theta$, что противоречит лемме 6.4. Если цикл $Z$ имеет диагональ, то опять же $G-x-y \supset \theta$, что невозможно. Таким образом, $B=Z$.

Тогда у цикла $Z$ не более одной вершины имеет степень более двух в графе $G-x-y$, остальные же хотя бы две вершины цикла $Z$ имеют степень два в графе $G-x-y$. Из $\delta(G) \geq 3$ следует, что каждая из этих вершин смежна в графе $G$ хотя бы с одной из вершин $x$ и $y$. Следовательно, если $U=V(Z) \cup\{x, y\}$, то $G(U) \supset \theta$. Отсюда немедленно следует, что $G-U-$ пустой граф: если $v v^{\prime} \in E(G)$ и $v, v^{\prime} \notin U$, то $G-v-v^{\prime} \supset \theta$, что противоречит лемме 6.4.

Предположим, что существует вершина $v \in V(G), v \notin U$. Тогда $v$ смежна в графе $G-x-y$ не более, чем с одной вершиной цикла $Z$ и из $\delta(G-x-y) \geq 2$ следует, что существует вершина $v^{\prime} \notin U$, смежная с $v$. Противоречие с доказанным выше. Таким образом, $G-x-y=Z$. Тем самым, мы получили $G=G(U)$. Значит, любая вершина цикла $Z$ смежна в графе $G$ хотя бы с одной из вершин $x$ и $y$. Пусть $Z=a_{1} a_{2} \ldots a_{k}$, тогда $k \geq 3$. Если все вершины цикла $Z$ смежны и с $x$, и с $y$, то, очевидно, $G \supset K_{5}$, противоречие.

Предположим, что $a_{1} x \in E(G), a_{1} y \notin E(G)$ и $a_{2} x \in E(G)$.
Изобразим (очевидно, планарный) граф $G-a_{2} x$ на плоскости без пересечений рёбер. Так как из вершины $a_{1}$ выходит только одно ребро вне цикла $Z$ (это ребро $a_{1} x$ ), то мы без труда сможем дорисовать вдоль пути $a_{2} a_{1} x$ ребро $a_{2} x$ так, чтобы оно не пересекало рёбер графа $G-a_{2} x$ (см. рисунок 6.3). Тем самым мы установили планарность графа $G$ и получили противоречие.


Рис. 6.3: Ребро $a_{2} x$.
Таким образом, остается единственный случай: $k$ четно, $k \geq 4$, вершины цикла $Z$ с четными номерами смежны с $x$, а вершины цикла $Z$ с нечетными номерами смежны с $y$. Легко видеть, что в этом случае $G \supset K_{3,3}$. Полученное противоречие показывает, что минимального контрпримера $G$ не существует и завершает доказательство теоремы.

# 6.3.1 Части разбиения и планарность 

Понятно, что связный граф планарен тогда и только тогда, когда планарен любой его блок. В этом разделе мы докажем аналогичный критерий планарности для двусвязных графов - в терминах частей разбиения этого графа. Нам понадобится вспомнить определения одиночного множества и блока двусвязного графа (см. раздел 5.5.3).

Теорема 6.3. (S. MacLane, 1937.) Пусть $G$ - двусвязный граф, а $G^{\prime}$ граф, полученный из $G$ добавлением всех ребер вида $a b$, где $\{a, b\}$ - одиночное множество графа $G$. Тогда граф $G$ планарен, если и только если для любой части-блока $B \in \operatorname{Part}(G)$ граф $G^{\prime}(B)$ планарен.

Доказательство. $\Leftarrow$. Так как цикл планарен, граф $G^{\prime}(B)$ планарен для любой части $B \in \operatorname{Part}(G)$.

Пусть граф $G$ непланарен. Тогда по теореме 6.2 граф $G$ имеет подграф $H$ - подразбиение $K_{5}$ или $K_{3,3}$. Поскольку графы $K_{5}$ и $K_{3,3}$ трёхсвязны, то любое двухвершинное разделяющее множество графа $H$ не разделяет множество его главных вершин $M$. Поэтому, существует такая часть $B \in \operatorname{Part}(G)$, что $B \supset M$.

Предположим, что существует такая вершина $x \in V(H)$, что $x \notin B$. Тогда эта вершина лежит на пути $S_{a, b}$ между какими-то двумя главными вершинами $a, b \in B$. Пусть $x \in A \in \operatorname{Part}(G)$. Так как $\mathrm{BT}(G)-$ дерево, существует смежное с $B$ в $\mathrm{BT}(G)$ (то есть, входящее в границу $B$ ) одиночное множество $R=\left\{y, y^{\prime}\right\}$, отделяющее $A$ от $B$. Тогда, если мы пойдем по пути $S_{a, b}$ от $x$ в обе стороны, мы попадем в вершины множества $R$. Заменим участок пути между $y$ и $y^{\prime}$ на ребро $y y^{\prime}$. После нескольких таких операций вершины вне части $A$ кончатся и мы получим граф $H^{\prime}$ - подразбиение $K_{5}$ или $K_{3,3}$ - вершины которого лежат в $B$. Так как мы проводили только рёбра между парами вершин, образующих одиночное множество, входящее в границу части $B$, то $H^{\prime}$ - это подграф $G^{\prime}(B)$. Значит, $G^{\prime}(B) \supset K_{5}$ или $G^{\prime}(B) \supset K_{3,3}$, что противоречит планарности $G^{\prime}(B)$.
$\Rightarrow$. Пусть $G^{\prime}(B)$ непланарен. По лемме 5.18 существует подграф $H$ графа $G$, являющейся подразбиением $G^{\prime}(B)$. Тогда, очевидно, и граф $H$ непланарен, что противоречит планарности графа $G$.

# 6.4 Изображения трёхсвязного графа 

В этом разделе мы изучим свойства плоских изображений трёхсвязного графа и докажем, что такое изображение единственно с точностью до изоморфизма. Начнем с изучения границ граней плоского трёхсвязного графа.

Определение 6.3. Цикл $C$ графа $G$ назовём неразделяющим, если множество его вершин не является разделяющим, то есть, граф $G-V(C)$ является связным.

Лемма 6.5. Пусть $G$ - трёхсвязный плоский граф. Тогда множество границ его граней есть в точности множество его неразделяющих индуцированных циклов.

Доказательство. Пусть $C$ - неразделяющий индуцированный цикл в $G$. Тогда в одной из областей, на которые $C$ делит плоскость - назовём ее $d$ - нет вершин графа $G$. Так как индуцированный цикл $C$ не

имеет диагоналей, внутри $d$ рёбер тоже нет. Значит $d$ - грань, а цикл $C-$ её граница.

Наоборот, пусть цикл $C$ - граница грани $d$ графа $G$. Предположим, что $C$ имеет диагональ $x y$. Вершины $x$ и $y$ делят цикл $C$ на две дуги $C_{1}$ и $C_{2}$. Граф $G-x-y$ должен быть связен ввиду трёхсвязности графа $G$, поэтому у цикла $C$ должна быть трансверсаль $P$, концы которой - внутренние вершины дуг $C_{1}$ и $C_{2}$ соответственно. Понятно, что и диагональ $x y$, и трансверсаль $P$ должны проходить вне грани $d$, но тогда они пересекаются, что невозможно.

Докажем, что граф $G-V(C)$ связен. Пусть $u, v \in V(G) \backslash V(C)$. По теореме Уитни 5.2, в трёхсвязном графе $G$ существуют три независимых $u v$-пути $P_{1}, P_{2}$ и $P_{3}$, которые делят плоскость на три области. Грань $d$ лежит в одной из этих частей, пусть это часть, граница которой образована путями $P_{2}$ и $P_{3}$. Тогда $\operatorname{Int}\left(P_{1}\right)$ не пересекается с границей грани $d-$ циклом $C$ - а значит, вершины $u$ и $v$ связаны в $G-V(C)$.

Таким образом, граница грани графа $G$ является индуцированным неразделяющим циклом.

Теорема 6.4. (H. Whitney, 1933.) Любые два плоских изображения трёхсвязного графа изоморфны как плоские графы.

Доказательство. Пусть $G$ - трёхсвязный граф, а $G_{1}$ и $G_{2}$ - его плоские изображения. Тогда существует изоморфизм графов (не учитывающий грани)

$$
\varphi: V\left(G_{1}\right) \rightarrow V\left(G_{2}\right)
$$

Нам нужно показать, что $\varphi$ - изоморфизм плоских графов, то есть, переводит границы граней $G_{1}$ в границы граней $G_{2}$. Отметим, что по лемме 6.5 границы граней плоского графа $G_{1}$ - это в точности неразделяющие индуцированные циклы графа $G_{1}$, а границы граней плоского графа $G_{2}$ - это в точности неразделяющие индуцированные циклы $G_{2}$. Это свойство множеств вершин не имеет отношения к плоскому изображению, поэтому сохраняется при изоморфизме графов. Таким образом, $U \subset V\left(G_{1}\right)$ - множество вершин неразделяющего индуцированного цикла в $G_{1}$ (то есть, границы грани $G_{1}$ ) если и только если $\varphi(U)$ - множество вершин неразделяющего индуцированного цикла в $G_{2}$ (то есть, границы грани $G_{2}$ ). Следовательно, $\varphi$ - изоморфизм плоских графов, то есть, два изображения трёхсвязного планарного графа $G$ изоморфны.

Таким образом, в случае трёхсвязного планарного графа отождествление графа и его плоского изображения корректно.

# 6.5 Двойственный граф 

Пусть $G$ - связный плоский граф. Мы определим двойственный к нему граф $G^{*}$ следующим образом. Вершины $G^{*}$ будут соответствовать граням графа $G$, внутри каждой грани $a$ графа $G$ мы отметим соответствующую ей вершину $a^{*}$ графа $G^{*}$. Будем говорить, что вершина $a^{*}$ двойственна грани $a$.

Пусть $e \in E(G)$ - ребро, по которому граничат две грани $a$ и $b$ графа $G$ (возможно, $a=b$ ). Ему будет соответствовать ребро $e^{*}$ двойственного графа $G^{*}$, соединяющее двойственные странам $a$ и $b$ вершины $a^{*}$ и $b^{*}$. Назовём ребро $e^{*}$ двойственным к $e$. Если $a$ совпадает с $b$ (или, что равносильно, ребро $e-$ мост), то двойственное ребро $e^{*}$ оказывается петлёй. Вершины $a^{*}, b^{*} \in V\left(G^{*}\right)$ оказываются соединены таким количеством рёбер, сколько общих рёбер имеют границы граней $a$ и $b$. Таким образом, существует естественная биекция между рёбрами $G$ и рёбрами $G^{*}$ (каждому ребру графа $G$ ставится в соответствие двойственное). Следовательно, $e(G)=e\left(G^{*}\right)$.

Граф $G^{*}$ зависит не только от графа $G$, но и от изображения этого графа на плоскости, потому мы определяем $G^{*}$ для плоского графа $G$. Для разных плоских изображений одного планарного графа могут получиться неизоморфные двойственные графы. Поэтому двойственный граф $G^{*}$ также будет конкретным изображением на плоскости: его вершины мы изобразим внутри соответствующих граней. Ребро $e^{*} \in E\left(G^{*}\right)$, соединяющее вершины $a^{*}, b^{*} \in V\left(G^{*}\right)$ мы проведём так, чтобы оно пересекало соответствующее ему ребро $e \in E(G)$. Наглядно очевидно, что это можно сделать так, чтобы рёбра $G^{*}$ не пересекались во внутренних точках. Зафиксируем на каждом ребре графа $G$ по точке, которую назовём серединой этого ребра. Точку $a^{*}$ внутри грани $a$ можно соединить непересекающимися путями с серединами всех входящих в границу грани $a$ рёбер (а если ребро $e_{a}$ - мост, с обеих сторон от которого расположена грань $a$, то можно провести и два таких пути, из которых получится двойственная $e_{a}$ петля $e_{a}^{*}$ графа $G^{*}$.

Разумеется, двойственный граф не зависит ни от того, какие точки мы выберем внутри граней исходного графа $G$, ни от того, какие точки мы назовем серединами рёбер: нетрудно доказать, что получатся изоморфные плоские графы.

Итак, вершины графа $G^{*}$ соответствуют граням графа $G$, а рёбра графа $G^{*}$ соответствуют рёбрам графа $G$. Совершенно естественно получается, что грани $G^{*}$ должны соответствовать вершинам графа $G$. Это становится понятным из нашего способа "рисования" графа $G^{*}$ : рассмотрим вершину $v \in V(G)$ и все грани, в которые она входит. Эти грани можно

считать упорядоченными по часовой стрелке, соседние грани имеют общее ребро, инцидентное вершине $v$, каждому такому ребру соответствует двойственное ребро графа $G^{*}$, соединяющее двойственные этим вершинам грани. Таким образом, выходящие из $v$ рёбра графа $G$ перейдут в опоясывающие вершину $v$ рёбра графа $G^{*}$, образующие границу грани $v^{*}$ плоского графа $G^{*}$. Мы будем говорить, что грань $v^{*}$ двойственна вершине $v$.

Итак, мы имеем биекцию, сопоставляющую вершинам, рёбрам и граням плоского графа $G$ двойственные им грани, рёбра и вершины двойственного графа $G^{*}$. Отметим, что биекция сохраняет все виды отношения инцидентности объектов плоского графа:

- если $e \in E(G)$ соединяет вершины $a$ и $b$ графа $G$, то двойственное ребро $e^{*} \in E(G)$ является общим ребром двойственных граней $a^{*}$ и $b^{*}$;
- если ребро $e \in E(G)$ является общим ребром граней $f$ и $g$ графа $G$, то двойственное ребро $e^{*} \in E(G)$ соединяет двойственные вершины $f^{*}$ и $g^{*}$.

Еще раз подчеркнём, что мосты $G$ двойственны петлям $G^{*}$ и, наоборот, петли $G$ двойственны мостам $G^{*}$.

Определение 6.4. Пусть $G$ - плоский граф, а $G^{*}$ - его двойственный граф.

1) Для $A \subset V(G)$ обозначим через $A^{*}$ множество граней графа $G^{*}$, двойственных вершинам из $A$.
2) Для $A \subset E(G)$ обозначим через $A^{*}$ множество рёбер графа $G^{*}$, двойственных рёбрам из $A$.
3) Пусть $A$ - множество из нескольких граней графа $G$. Обозначим через $A^{*}$ множество вершин графа $G^{*}$, двойственных граням из $A$.

Во всех случаях назовём $A^{*}$ двойственным множеством множества $A$.
Теперь покажем, что $\left(G^{*}\right)^{*} \simeq G$. В самом деле, это становится понятным из сказанного выше, так как грани $G^{*}$ соответствуют вершинам $G$, в качестве точек на гранях двойственного графа $G^{*}$ можно выбрать вершины исходного графа $G$. В дальнейшем мы будем считать, что $\left(G^{*}\right)^{*}=G$.

Поэтому, можно говорить, что соответствующие объекты двойственных плоских графов двойственны друг другу.
Замечание 6.2. Пусть $G$ и $G^{*}$ - двойственные друг другу плоские графы. Тогда $\left(A^{*}\right)^{*}=A$ для любого множества $A$, состоящего из вершин, граней или рёбер графа $G$.
Задача 6.1. Докажите, что найдётся такой плоский граф $G$ со сколь угодно большим числом вершин, что графы $G$ и $G^{*}$ изоморфны.

Существует несколько способов определить двойственный граф для несвязного графа $G$. Мы выберем способ, наиболее удобный для последующего применения, например, в разделах 7.5 и 13.2.3. Пусть $G_{1}, \ldots, G_{n}-$ все компоненты плоского графа $G$. Будем считать, что двойственные графы $G_{1}^{*}, \ldots, G_{n}^{*}$ имеют непересекающиеся множества вершин и положим $G^{*}=\cup_{i=1}^{n} G_{i}^{*}$.

При таком определении для несвязного графа $\left(G^{*}\right)^{*}=G$ и сохраняется описанная выше биекция между множествами $E\left(G^{*}\right)$ и $E(G)$, правда, биекции между гранями $G$ и вершинами $G^{*}$ нет.

В дальнейшем нам неоднократно понадобится следующая несложная лемма о связи двойственности и стягивания-удаления рёбер.

Лемма 6.6. Для дойственных друг другу плоских графов $G$ и $G^{*}$ выполнены следующие утверждения.

1) Если ребро $e-$ не мост графа $G$, то $(G-e)^{*} \simeq G^{*} * e^{*}$.
2) Если ребро $e^{*}-$ не мост графа $G^{*}$, то $(G * e)^{*} \simeq G^{*}-e^{*}$.

Доказательство. 1) Пусть $e^{*}=a^{*} b^{*}$. Тогда ребро $e^{*}-$ не петля, а значит, грани $a$ и $b$ различны. Удаление ребра $e$ из графа $G$ означает, что грани $a$ и $b$ склеиваются в одну (мы удалили их граничное ребро), что означает стягивание ребра $e^{*}=a^{*} b^{*}$ в двойственном графе $G^{*}$. Следовательно, $(G-e)^{*} \simeq G^{*} * e^{*}$.
1) Аналогично (поменяем местами $G$ и $G^{*}$ и вспомним, что $\left(G^{*}\right)^{*}=G$ и $\left(e^{*}\right)^{*}=e$ ) доказывается, что $\left(G^{*}-e^{*}\right)^{*} \simeq G * e$. Перейдя еще раз к двойственным графам, получим доказываемое утверждение.

Исторически раскраски граней плоского графа появились едва ли не раньше раскрасок вершин - со знаменитой гипотезы 4 красок, о которой речь пойдет позже.

Определение 6.5. 1) Раскраска граней плоского графа $G$ называется правильной, если две грани, имеющие общее ребро, покрашены в разные цвета.
1) Для плоского графа $G$ мы будем обозначать через $\chi^{*}(G)$ минимальное количество цветов, для которого существует правильная раскраска граней графа $G$.

Замечание 6.3. Нетрудно понять, что правильные раскраски граней плоского графа $G$ взаимно однозначно соответствуют правильным раскраскам вершин двойственного графа $G^{*}$. Поэтому, $\chi^{*}(G)=\chi\left(G^{*}\right)$ и $\chi(G)=\chi^{*}\left(G^{*}\right)$

Мы будем неоднократно возвращаться к понятию двойственного графа. В разделе 7.5 мы поговорим об алгебраическом аспекте двойственности плоских графов, а именно, о связи циклического пространства и пространства разрезов у плоских двойственных графов. В разделе 13.2.3 мы увидим связь $k$-потоков плоского графа и $k$-раскрасок двойственного графа.

# 6.6 Триангуляции 

Определение 6.6. 1) Будем называть грань треугольником, если ее граница - это треугольник.

1) Плоский граф называется триангуляцией, если каждая его грань треугольник. Кратные рёбра при этом допускаются (однако, они не могут быть рёбрами одной грани), петли запрещены.
2) Триангулировать плоский граф значит провести в нём дополнительные рёбра так, чтобы получилась триангуляция.

Замечание 6.4. 1) Понятно, что триангуляция $T$ - рёберно двусвязный граф, так как каждое ребро графа $T$, очевидно, входит в циклтреугольник.
1) Двойственный граф триангуляции $T^{*}$ - рёберно двусвязный кубический граф.

Сначала докажем, что каждый плоский граф без петель можно триангулировать.

Лемма 6.7. 1) Пусть $G$ - плоский граф без петель, причём в границе каждой грани не менее трёх вершин. Тогда существует триангуляиия $T$, остовным подграбом которой является $G$.
1) Пусть $d$ - гранъ $G$, а $t(d)$ - количество треугольников, на которые оказалась разбита гранъ $d$ в триангуляиии $T$. Тогда $t(d)=b(d)-2$ в случае, когда граница грани $d$ - связный граф и $t(d) \geq b(d)$ если граница грани $d$ несвязна.

Доказательство. Пусть $d$ - грань нашего графа, граница которой не треугольник. Рассмотрим два случая: граф $B(d)$ связен и граф $B(d)$ несвязен.

1. Граф $B(d)$ связен.

Мысленно раздвоим каждое внутреннее ребро грани $d$, превратив $B(d)$ в цикл $Z$, проходящий каждое граничное ребро грани $d$ ровно один раз

и каждое внутреннее ребро - ровно два раза, грань $d$ будет внутренней областью цикла $Z$. При этом, некоторые вершины в цикле $Z$ могут повторяться.

Триангулировать грань $d$ значит триангулировать внутренность цикла $Z$. В цикле $Z$ ровно $b(d)$ рёбер, поэтому при его триангуляции получится ровно $b(d)-2$ треугольника. Единственное, за чем при триангуляции нужно проследить - новые рёбра должны соединять различные вершины. Докажем вспомогательное утверждение.

Пусть $Z$ - иикл, $v(Z) \geq 3$, вершины иикла $Z$ покрашены так, что иветов хотя бы три и любые две соседние вершины покрашены в разные ивета. Тогда можно триангулировать внутреннюю область иикла $Z$ так, что все проведённые диагонали иикла соединяют вершины разных иветов.

Доказательство. Индукция по количеству вершин. База для цикла из трёх вершин очевидна, докажем переход. Пусть $Z=v_{1} v_{2} \ldots v_{k}$ (нумерация вершин - циклическая), $k \geq 4$. Очевидно, найдётся диагональ $a_{i} a_{i+2}$, соединяющая две вершины разных цветов. Эта диагональ разрезает цикл $Z$ на треугольник $a_{i} a_{i+1} a_{i+2}$ и меньший цикл $Z^{\prime}$. Единственная возможная проблема - вершины цикла $Z^{\prime}$ могут быть покрашены в два цвета, иначе, применив к циклу $Z^{\prime}$ индукционное предположение, мы завершим доказательство.

Пусть вершина $a_{i+1}$ покрашена в цвет 3 , а вершины цикла $Z^{\prime}$ покрашены в цвета 1 и 2 . Тогда цвета вершин цикла $Z^{\prime}$ чередуются, следовательно, $v\left(Z^{\prime}\right)$ чётно, то есть, $v\left(Z^{\prime}\right) \geq 4$. Таким образом, в исходном цикле $Z$ была единственная вершина $a_{i+1}$ цвета 3 и хотя бы по две вершины цветов 1 и 2 . Тогда отрезав треугольник диагональю $a_{i+1} a_{i+3}$ (очевидно, её концы разноцветные), мы получим меньший цикл $Z^{\prime \prime}$, среди вершин которого представлены все три цвета. По индукционному предположению, мы триангулируем внутренность цикла $Z^{\prime \prime}$ и завершим доказательство.

Вернёмся к доказательству леммы. Покрасим $b(d)$ вершин цикла $Z$ в $v(B(d)) \geq 3$ цветов так, чтобы в один цвет были покрашены одинаковые вершины. Тогда любые две соседние вершины разноцветны. По доказанному выше утверждению, мы можем триангулировать внутренность цикла $Z$ так, чтобы проведённые рёбра имели разноцветные концы, то есть, не были петлями, что и требовалось доказать.
1. Граф $B(d)$ несвязен.

Пусть теперь граф $B(d)$ несвязен, а $x$ и $y$ - две вершины из разных компонент связности графа $B(d)$. Проведём ребро $x y$ внутри грани $d$.

Это ребро будет внутренним для грани $d$, поэтому $b(d)$ увеличится на 2 . Будем действовать таким образом, пока граница грани не окажется связной. При этом, мы провели хотя бы одно ребро и получили размер грани $d$ в новом графе $b^{\prime}(d) \geq b(d)+2$. По доказанному выше, в результате триангуляции грани получится хотя бы $b^{\prime}(d)-2 \geq b(d)$ треугольников. Таким образом, в этом случае $t(d) \geq b(d)$.

Замечание 6.5. Если в плоском графе $G$ нет петель, $v(G) \geq 3$ и никакая грань не является циклом из двух кратных рёбер, то в границе каждой грани хотя бы три вершины и мы можем триангулировать этот граф, воспользовавшись леммой 6.7 .

Понятно, что триангуляция - недвудольный граф. А что можно сказать о раскраске вершин триангуляции в три цвета? Достаточно несложно понять, что триангуляция, имеющая такую раскраску не может иметь вершин нечетной степени. А можно ли покрасить в три цвета вершины триангуляции, если все они имеют четную степень? Хивуд в 1898 году впервые высказал гипотезу о том, что это эти два условия равеосильны. И сейчас в некоторых источниках следующую теорему называют теоремой Хивуда, хотя она была доказана только много лет спустя, в 1961 году. Мы же будем называть ее теоремой о 3 красках.

На настоящий момент известно несколько доказательств этой теоремы, в том числе использующих неграфскую технику. Есть несколько чисто графских доказательств, одно из которых - доказательство Головиной и Яглома 1961 года, видимо, является исторически первым. Это доказательство, записанное в нашей терминологии, будет приведено ниже.

Теорема 6.5. (Л. И. Головина, И. М. Яглом, 1961.) Пусть $T$ - плоская триангуляиия. Тогда $\chi(T)=3$, если и только если степени всех вершин $T$ четны.

Доказательство. Сначала отметим, что для любой вершины $a \in T$ граф $T\left(\mathrm{~N}_{T}(a)\right)$ содержит цикл длины $d_{T}(a)$ (так как концы соседних в плоском изображении рёбер, выходящих из $a$ - различны и смежны). Обозначим этот цикл через $Z_{T, a}$.
$\Leftarrow$. Достаточность условия очевидна. В самом деле, пусть вершина $a$ имеет нечетную степень. Тогда цикл $Z_{T, a}$ нечетен и для его правильной покраски нужно задействовать все три цвета, но в этом случае невозможно покрасить вершину $a$.
$\Rightarrow$. Пусть все вершины $T$ имеют четную степень. Докажем существование правильной раскраски вершин $T$ в три цвета индукцией по $v(T)$. База для случая $v(T)=3$ очевидна.

Докажем индукционный переход. Пусть $v(T)>3$. Пусть $a \in V(T)-$ вершина минимальной степени. По замечанию 6.1 мы имеем $d_{T}(a) \leq 5$. Так как эта степень четна, $d_{T}(a) \in\{2,4\}$. Случай $d_{T}(a)=2$ очевиден: тогда $\mathrm{N}_{T}(a)=\left\{b_{1}, b_{2}\right\}$, а причем вершины $b_{1}$ и $b_{2}$ соединены двумя кратными рёбрами $e$ и $e^{\prime}$. Несложно понять, что граф $T^{\prime}=T-a-e^{\prime}-$ меньшая чем $T$ триангуляция, все вершины которой имеют четную степень. Тогда $\chi\left(T^{\prime}\right)=3$ по индукционному предположению, а вершину $a$ несложно докрасить.

Пусть $d_{T}(a)=4, \mathrm{~N}_{T}(a)=\left\{b_{1}, b_{2}, b_{3}, b_{4}\right\}$, причем эти вершины указаны в порядке обхода по циклу $Z=Z_{T, a}$ (см. рисунок 6.4 a ). Тогда граница одной из граней графа $H=T-a-$ цикл $Z$ (пусть эта грань - внутренняя), а границы всех остальных граней - треугольники.

Назовем пару вершин $b_{i}, b_{i+2}$ хорошей, если $b_{i} \neq b_{i+2}$ и $b_{i} b_{i+2} \notin E(T)$ и плохой в противном случае. Если пара $b_{1}, b_{3}$ - плохая, то либо $b_{1}=b_{3}$, либо во внешней области цикла $Z$ проведено ребро $b_{1} b_{3}$. Очевидно, тогда пара вершин $b_{2}, b_{4}-$ хорошая.


Рис. 6.4: Триангуляции $T$ и $T^{\prime}$.
Итак, в любом случае будем считать, что пара $b_{2}, b_{4}$ - хорошая. Тогда граф $T^{\prime}=H \# b_{2} b_{4}$ - меньшая чем $T$ триангуляция, пусть $b=b_{2} \# b_{4}$ (см. рисунок 6.4 b ). Все степени вершин триангуляции $T^{\prime}$ четны (так как $d_{T^{\prime}}\left(b_{1}\right)=d_{T}\left(b_{1}\right)-2, d_{T^{\prime}}\left(b_{3}\right)=d_{T}\left(b_{3}\right)-2, d_{T^{\prime}}(b)=d_{T}\left(b_{2}\right)+d_{T}\left(b_{2}\right)-4$, а степени остальных вершин в $T$ и $T^{\prime}$ одинаковы). Следовательно, по индукционному предположению триангуляция $T^{\prime}$ имеет правильную раскраску $\rho^{\prime}$ в 3 цвета. Не умаляя общности будем считать, что $\rho^{\prime}(b)=1$.

Построим правильную расркаску $\rho$ вершин $T$ в 3 цвета. Для всех вершин $v \in V(T) \backslash\left\{a, b_{2}, b_{4}\right\}$ положим $\rho(v)=\rho^{\prime}(v)$. Пусть $\rho\left(b_{2}\right)=\rho\left(b_{4}\right)=$ $\rho^{\prime}(b)$. Предположим, что $Z_{T, b_{2}}=a b_{1} x_{1} \ldots x_{t} b_{3}$ и $Z_{T, b_{4}}=a b_{3} y_{1} \ldots y_{s} b_{1}$. Очевидно, оба числа $s$ и $t$ нечетны. Тогда цикл $Z^{\prime}=Z_{T^{\prime}, b}=b_{1} x_{1} \ldots x_{t} b_{3} y_{1} \ldots y_{s}$ покрашен в $\rho^{\prime}$ в цвета 2 и 3 , а значит, находящиеся в нем на нечетном расстоянии вершины $b_{1}$ и $b_{3}$ имеют один и тот же цвет. Не умаляя общности

будем считать, что $\rho^{\prime}\left(b_{1}\right)=\rho^{\prime}\left(b_{3}\right)=2$. Таким образом, вершины цикла $Z_{T, a}$ покрашены в раскраске $\rho$ в цвета 1 и 2 . Тогда, положив $\rho(a)=3$, мы получим правильную раскраску вершин триангуляции $T$ в три цвета.

# 6.7 Вокруг 4CC 

Безусловно, самым известным утверждением в теории графов является гипотеза четырёх красок (4СС, то есть, 4 Color Conjecture), которую теперь часто называют 4СТ (4 Color Theorem), поскольку имеется её доказательство. За первым доказательством 1977 года последовало более четкое и ясное доказательство. Однако, и сейчас актуален вопрос о доказательстве этого утверждения, не настолько опирающемся на использования компьютера. Представим эту гипотезу в математической формулировке.

Гипотеза четырёх красок. (F. Guthrie, 1852.) Грани любого плоского графа без мостов можно правильным образом покрасить в 4 цвета.

Сразу же понятно, что в плоском графе, грани которого мы пытаемся правильно раскрасить, не должно быть мостов: мосты в двойственном графе переходят в петли. Из замечания 6.3 ясно, что 4СС эквивалентна следующему утверждению: $\chi(G) \leq 4$ для любого планарного графа $G$.

С 1878 года, когда 4 СС впервые попала к математикам, и по наше время многие пытались и пытаются гипотезу сначала доказать, теперь - придумать короткое доказательство. Однако, пока эти попытки безуспешны. В 1879 году Кемпе опубликовал первую попытку доказать 4 CC , однако, на самом деле доказал лишь раскрашиваемость в 5 цветов.

В 1880 году Тэйт опубликовал свой подход к доказательству 4СС. Гипотеза Тэйта о гамильтоновом цикле в планарном графе оказалась ошибочной (мы подробно разберём этот вопрос в одном из разделов), но теорема об эквивалентной переформулировке 4 CC оказалась очень полезной: в последующих работах авторы доказывали не собственно 4 CC , а эквивалентную переформулировку о рёберных раскрасках триангуляции.

Определение 6.7. Пусть $T$ - триангуляция. Назовём Тэйтовой раскраской триангуляции $T$ такую раскраску рёбер $T$ в три цвета, что все рёбра каждой грани разноцветны.

На всякий случай подчеркнём, что далее рассматриваются графы без петель, иначе вопросы о правильной раскраске вершин бессмысленны.

Теорема 6.6. (P. G. Tait, 1880.) Следующие четыре утверждения равносильны.
$1^{\circ}$ Для любого плоского графа $G$ выполняется $\chi(G) \leq 4$.
$2^{\circ}$ Для любого рёберно двусвязного плоского графа $G$ выполняется $\chi^{*}(G) \leq 4$.
$3^{\circ}$ Для любого рёберно двусвязного плоского кубического графа $G$ выполняется $\chi^{\prime}(G)=3$.
$4^{\circ}$ Для любой триангуляции $T$ существует Тэйтова раскраска.
Доказательство. $1^{\circ} \Rightarrow 2^{\circ}$. Рёберно двусвязный граф $G$ не имеет мостов, следовательно, его двойственный граф $G^{*}$ не имеет петель. Тогда $\chi^{*}(G)=\chi\left(G^{*}\right) \leq 4$.
$2^{\circ} \Rightarrow 3^{\circ}$. Пусть $G$ - рёберно двусвязный кубический граф. У него есть правильная раскраска $\rho^{*}$ граней в 4 цвета. Поскольку всё равно, как нумеровать цвета, мы будем считать, что $\rho^{*}$ принимает значения из $\mathbb{Z}_{2} \times \mathbb{Z}_{2}=\{(0,0),(0,1),(1,0),(1,1)\}$.

Так как $G$ - рёберно двусвязный граф, каждое ребро $e \in E(G)$ разделяет две разные грани $a$ и $b$. Мы положим $\rho^{\prime}(e)=\rho^{*}(a)+\rho^{*}(b)$ (сложение по модулю 2 по каждой координате). Так как $a \neq b$, то $\rho^{*}(a) \neq \rho^{*}(b)$, следовательно, $\rho^{\prime}(e) \neq(0,0)$. Таким образом, $\rho^{\prime}$ - раскраска рёбер графа $G$ в три цвета.

Докажем, что раскраска $\rho^{\prime}$ - правильная. Пусть $v$ - вершина графа $G$, а $a, b, c$ - три содержащие её грани. Как уже отмечалось, все эти грани различны, любые две из них имеют общее ребро. Следовательно, $\rho^{*}(a), \rho^{*}(b)$ и $\rho^{*}(c)$ - три разных цвета, откуда очевидно следует, что все три цвета инцидентных вершине $v$ рёбер

$$
\rho^{*}(a)+\rho^{*}(b), \quad \rho^{*}(a)+\rho^{*}(c), \quad \rho^{*}(b)+\rho^{*}(c)
$$

также различны. Таким образом, $\rho^{\prime}$ - правильная раскраска рёбер $G$ в 3 цвета, следовательно, $\chi^{\prime}(G)=3$ (так как очевидно, что $\chi^{\prime}(G) \geq 3$ ).
$3^{\circ} \Rightarrow 1^{\circ}$. Достаточно рассмотреть связный граф $G$ с $v(G) \geq 3$. По лемме 6.7 , граф $G$ является подграфом триангуляции $H$. Рассмотрим рёберно двусвязный кубический граф $H^{*}$. Как мы знаем, существует правильная раскраска $\rho^{\prime}$ рёбер этого графа в 3 цвета. Пусть $H_{i, j}^{*}$ - подграф $H^{*}$ на рёбрах цветов $i, j \in\{1,2,3\}$ в раскраске $\rho^{\prime}$. Тогда $d_{H_{i, j}^{*}}(v)=2$ для любой вершины $v \in V\left(H^{*}\right)$, следовательно, $H_{i, j}^{*}$ - объединение нескольких циклов. Легко видеть, что существует правильная раскраска $\rho_{i, j}^{*}$ граней графа $H_{i, j}^{*}$ в два цвета.

Рассмотрим произвольную грань $a$ графа $H^{*}$. Пусть $a_{12}$ - грань $H_{12}^{*}$, частью которой является $a$, а $a_{13}$ - грань $H_{13}^{*}$, частью которой является $a$

(понятно, что $a_{12}$ и $a_{13}$ определены однозначно). Положим

$$
\rho^{*}(a)=\left(\rho_{1,2}^{*}\left(a_{1,2}\right), \rho_{1,3}^{*}\left(a_{1,3}\right)\right)
$$

Мы получили раскраску граней графа $H^{*}$ в четыре цвета. Покажем, что эта раскраска является правильной. Рассмотрим имеющие общее ребро $e$ грани $a$ и $b$ графа $H^{*}$, пусть $a=a_{1,2} \cap a_{1,3}, b=b_{1,2} \cap b_{1,3}$ - определённые выше представления в виде пересечений граней. Если $\rho^{\prime}(e) \in\{1,2\}$, то $a_{1,2} \neq b_{1,2}$, причём эти грани графа $H_{1,2}^{*}$ граничат по ребру $e$, следовательно, $\rho_{1,2}^{*}\left(a_{1,2}\right) \neq \rho_{1,2}^{*}\left(b_{1,2}\right)$, а тогда и $\rho^{*}(a) \neq \rho^{*}(b)$. Если $\rho^{\prime}(e)=3$, аналогично $\rho_{1,3}^{*}\left(a_{1,3}\right) \neq \rho_{1,3}^{*}\left(b_{1,3}\right)$ и $\rho^{*}(a) \neq \rho^{*}(b)$.

Таким образом, $\chi(G) \leq \chi(H)=\chi^{*}\left(H^{*}\right) \leq 4$, что и требовалось доказать.
$3^{\circ} \Rightarrow 4^{\circ}$. Очевидно, двойственный граф $T^{*}$ триангуляции $T$ является рёберно двусвязным кубическим графом, а правильная раскраска его рёбер в 3 цвета - Тэйтовой раскраской рёбер $T$.
$4^{\circ} \Rightarrow 3^{\circ}$. Пусть $G$ - кубический рёберно двусвязный плоский граф. Очевидно, двойственный граф $G^{*}$ - триангуляция, а Тэйтова раскраска триангуляции $G^{*}$ является правильной раскраской рёбер $G$ в три цвета.

Успешные попытки доказательства 4СТ состоят примерно в следующем. Доказывается существование Тэйтовой раскраски рёбер любой триангуляции. Предполагается противное и рассматривается минимальный контрпример. На первом этапе рассматривается множество так называемых неизбежных конфигураций и доказывается, что в каждой триангуляции обязательно есть одна из них (и, в частности, в минимальном контрпримере $T$ ). На втором этапе показывается, что вопрос о раскраске рёбер триангуляции $T$ можно свести к вопросу о раскраске меньшей триангуляции (что невозможно для минимального контрпримера). Это делается отдельно для случая каждой неизбежной конфигурации с использованием компьютера. Остаётся лишь добавить, что в первом доказательстве было около 2000 неизбежных конфигураций, а во втором доказательстве - 633. Понятно, что в доказательстве "неизбежности" этих конфигураций также не обходится без перебора. Всё это делает открытым вопрос о коротком (или хотя бы не настолько переборном) доказательстве 4CC.

Однако, среди неизбежных конфигураций есть такие, в случае наличия которых легко доказывается раскрашиваемость графа. Мы разберём случай триангуляции сферы, содержащей вершину степени не более 4. Нам понадобится обобщение классического понятия Тэйтовой раскраски.

Определение 6.8. Пусть $G$ - плоский граф.

1) Назовём Тэйтовой раскраской графа $G$ раскраску рёбер этого графа в три цвета, в которой три ребра любой грани-треугольника покрашены в разные цвета. По умолчанию будем считать, что рёбра всегда красятся в цвета 1,2 и 3 .
2) Пусть треугольный граф $G^{T}$ плоского графа $G$ - это граф, вершины которого соответствуют рёбрам $G$, и две вершины смежны тогда и только тогда, когда соответствующие рёбра являются рёбрами одной треугольной грани.

Мы считаем граф $G^{T}$ плоским: пусть его вершины изображены как середины рёбер графа $G$, а рёбра - как "средние линии" граней.
1) Пусть $d$ - треугольная грань графа $G$. Будем говорить, что ребро графа $G^{T}$ - на грани $d$, если оно изображено как средняя линия этой грани.

Замечание 6.6. Нетрудно понять, что Тэйтова раскраска плоского графа $G$ - это правильная раскраска его треугольного графа $G^{T}$.

Определение 6.9. 1) Пусть $\rho$ - Тэйтова раскраска графа $G$. Обозначим через $G^{i, j}(\rho)$ подграф графа $G^{T}$ на вершинах цветов $i$ и $j$.
1) Подграф $H$ графа $G^{T}$ назовём двуцветным графом в $G$, если $H$ представляется в виде $G^{i, j}(\rho)$ для некоторой Тэйтовой раскраски $\rho$ графа $G$ и пары цветов $i, j$.

Следующее тривиальное замечание будет важным инструментом в наших доказательствах.

Замечание 6.7. 1) Рёбра графа $G$, соответствующие вершинам ненулевой степени в графе $G^{i, j}(\rho)$, покрашены правильным образом в два цвета: $i$ и $j$. Легко понять, что граф $G^{i, j}(\rho)$ однозначно задает раскраску $\rho$ : в третий цвет нужно покрасить все рёбра графа $G$, по которым не проходит $G^{i, j}(\rho)$.
1) Пусть $H$ - двуцветный граф в $G$. Отметим, что несмотря на название, его вершины не покрашены в два цвета (разумеется, это можно сделать, причем, как правило, не единственным способом). Двуцветный граф содержит по одному ребру на каждой треугольной грани $G$. Каждая компонента графа $H$ - путь или четный цикл.

Двуцветный граф $H$ может быть представлен в виде $G^{i, j}(\rho)$ разными способами: это может получиться для разных Тэйтовых раскрасок $\rho$ и пар цветов. Мы специально не фиксируем цвета вершин двуцветного графа! Каждая правильная раскраска вершин $H$ в два цвета задает его представление в виде $G^{i, j}(\rho)$ и, следовательно, Тэйтову раскраску $\rho$.

Лемма 6.8. Пусть $G$ - двусвязный плоский граф, все грани которого, кроме одной грани $d$ - треугольники, а граница грани $d$ имеет $k$ рёбер. Тогда выполняются следующие утверждения.

1) Для любого двуцветного графа $H$ в $G^{T}$ кониъ всех его путей лежат на рёбрах грани $d$, а суммарное количество рёбер в этих путях имеет ту же четность, что и $k$.
2) Пусть $\rho$ - Тэйтова раскраска $G$, а $k_{i}$ - это количество рёбер грани $d$, покрашенных в ивет $i$. Тогда числа $k, k_{1}, k_{2}$ и $k_{3}$ имеют одинаковую четность.

Доказательство. 1) Так как каждое ребро входит ровно в две грани, и только грань $d$ - не треугольник, то все вершины $H$, соответствующие рёбрам грани $d$ имеют степень 1 , а все остальные вершины - степень 2. Значит, граф $H$ есть объединение нескольких циклов и нескольких путей с концами на граничных рёбрах $d$. Поскольку граф $H$ двудолен, то все циклы четны. Следовательно, суммарная длина путей имеет ту же четность, что и число граней-треугольников в $G$, которое, что нетрудно проверить, имеет ту же четность, что и количество рёбер в $d$ (то есть, $k$ ).
1) Количество концов путей в двуцветном графе $G^{i, j}(\rho)$, очевидно, четно. С другой стороны, это количество есть $k_{i}+k_{j}$, откуда очевидно следует доказываемое утверждение.

Теорема 6.7. Пусть триангуляиия $G$ не имеет Тэйтовой раскраски, а любая меньшая триангуляция имеет Тэйтову раскраску. Тогда выполняются следующие утверждения.

1) $G$ не имеет кратных рёбер.
2) Любой треугольник в $G$ - граница грани.
3) Любой иикл длины 4 в $G$ отделяет две грани от остальных, то есть, в одной из областей, на которые этот иикл делит плоскость, нет вериин $G$.

Доказательство. Очевидно $v(G)>3$.

1) Предположим, что $G$ имеет два кратных ребра $e$ и $e^{\prime}$, соединяющих $x$ и $y$, и эти два ребра образуют цикл $C$. Пусть $V_{1}$ - множество из $x, y$ и всех вершин $G$ внутри цикла $C$, а $V_{2}$ - из $x, y$ и всех вершин вне $C ; G_{i}=G\left(V_{i}\right)$. Все грани графа $G_{i}$ являются треугольниками, кроме одной грани, граница которой - цикл $C$ из рёбер $e$ и $e^{\prime}$. Тогда $H_{i}=G_{i}-e^{\prime}$ - триангуляция, причем меньшая, чем $G$.

Обе триангуляции $H_{1}$ и $H_{2}$ имеют Тэйтовы раскраски, пусть это $\rho_{1}$ и $\rho_{2}$, соответственно. Можно считать, что эти раскраски согласованы на общем ребре: $\rho_{1}(e)=\rho_{2}(e)$. Положим $\rho\left(e^{\prime}\right)=\rho(e)=\rho_{1}(e)$. Любое

из остальных рёбер триангуляции $T$ входит ровно в одну из триангуляций $H_{1}$ и $H_{2}$. Для $f \in E\left(H_{1}\right)$ мы положим $\rho(f)=\rho_{1}(f)$, а для $f \in E\left(H_{2}\right)$ положим $\rho(f)=\rho_{2}(f)$. Нетрудно понять, что $\rho-$ Тэйтова раскраска триангуляции $G$. Противоречие.
1) Предположим, что $G$ имеет цикл $x y z$, не являющийся границей грани. Пусть $V_{1}$ - множество из $x, y, z$ и всех вершин $G$ внутри цикла $C$, а $V_{2}$ - из $x, y, z$ и всех вершин вне $C$. Понятно, что $H_{i}=G\left(V_{i}\right)-$ триангуляция, причем меньшая, чем $G$.

Обе триангуляции $H_{1}$ и $H_{2}$ имеют Тэйтовы раскраски, пусть это $\rho_{1}$ и $\rho_{2}$ соответственно. Каждая из раскрасок $\rho_{1}$ и $\rho_{2}$ красит рёбра $x y, x z$ и $y z$ в разные цвета, поэтому можно считать, что раскраски совпадают на этих рёбрах. Далее аналогично пункту 1 мы построим Тэйтову раскраску триангуляции $G$ и придём к противоречию.
1) Начнем как в предыдущих пунктах. Пусть $C=x_{1} x_{2} x_{3} x_{4}$ - цикл длины 4 в $G$, причем и внутри $C$, и вне $C$ есть хотя бы по одной вершине. Пусть $V_{1}$ - это множество вершин, лежащих внутри цикла $C$ или на цикле, $V_{2}$ - это множество вершин, лежащих вне цикла $C$ или на цикле, $G_{i}=G\left(V_{i}\right)$.

Рассмотрим граф $G_{2}$. В этом графе ровно одна грань - четырёхугольник (граница этой грани - цикл $C$ ), все остальные грани - треугольники. Пусть плоский граф $H_{2}$ получен из $G_{2}$ добавлением ребра $x_{1} x_{3}$, проведённого внутри цикла $C$, а плоский граф $F_{2}$ получен из $G_{2}$ добавлением ребра $x_{2} x_{4}$, проведённого внутри цикла $C$ (см. рисунок 6.5). Понятно, что $H_{2}$ и $F_{2}$ - триангуляции, причём меньшие, чем $G$. Тогда у этих двух графов (а значит, и у $G_{2}$ ) есть Тэйтовы раскраски,


Рис. 6.5: Графы $G, H_{2}$ и $F_{2}$.
По лемме 6.8 в Тэйтовой раскраске графа $G_{2}$ количество рёбер каждого цвета на цикле $C$ должно быть четным. Тогда рёбер какого-то цвета в цикле $C$ нет. Не умаляя общности положим, что все рёбра цикла $C$ покрашены в цвета 1 и 2 .

Пусть $y_{12}, y_{23}, y_{34}, y_{41}$ - середины соответствующих рёбер цикла $C$. Рассмотрим граф $Q=G_{2}^{1,2}(\rho)$. Это двуцветный граф, содержащий два пути с концами на рёбрах $C$, и эти пути имеют длины одинаковой четности. Так как граф $Q$ - плоский, два его пути не пересекаются. Значит, они соединяют середины соседних рёбер цикла $C$ : либо это $y_{12} y_{23}$-путь и $y_{34} y_{41}$-путь (см. рисунок 6.6 a , в этом случае назовём $Q$ двуиветным графом типа 1 , если пути нечетные и типа 2 , если пути четные), либо - $y_{23} y_{34}$-путь и $y_{41} y_{12}$-путь (см. рисунок 6.6 b , назовём $Q$ двуцветным графом типа 3 , если пути нечетные и типа 4 , если пути четные). Пусть $p(i)$ - количество двуцветных подграфов графа $G^{T}$, имеющих тип $i$.


Рис. 6.6: Типы 1, 2, 3 и 4.

Обе триангуляции $H_{2}$ и $F_{2}$ имеют Тэйтовы раскраски, в которых рёбра цикла $C$ покрашены в цвета 1 и 2 (назовём такие раскраски хорошими). Раскраска $\rho$ может быть продолжена до хорошей Тэйтовой раскраски триангуляции $H_{2}$ если и только если добавив к $G_{2}^{12}(\rho)$ рёбра $y_{12} y_{23}$ и $y_{34} y_{41}$ мы не получим нечётных циклов (мы должны получить подграф графа $H_{2}^{T}$ на вершинах цветов 1 и 2 ), то есть, если и только если граф $G_{2}^{12}(\rho)$ имеет тип 1,3 или 4 . Аналогично, продолжить $\rho$ до хорошей Тэйтовой раскраски триангуляции $F_{2}$ можно если и только если граф $G_{2}^{12}(\rho)$ имеет тип 1,2 или 3 .

Таким образом, возможны три случая: $p(1) \neq 0, p(3) \neq 0$, или одновременно $p(2) \neq 0$ и $p(4) \neq 0$. Разберём эти случаи.

1. $p(1) \neq 0$.

Пусть $Q$ - двуцветный граф типа 1. Покрасим в цвет 3 рёбра $G$, не входящие в $Q$. Нетрудно покрасить входящие в $Q$ рёбра триангуляции $G$ в цвета 1 и 2 , так, чтобы получилась раскраска $\rho^{\prime}$ с $\rho^{\prime}\left(x_{1} x_{2}\right)=\rho^{\prime}\left(x_{3} x_{4}\right)=1$, $\rho^{\prime}\left(x_{2} x_{3}\right)=\rho^{\prime}\left(x_{4} x_{1}\right)=2$ (тип $A$, см. рисунок 6.7 a ), а также раскраска $\rho^{*}$ с $\rho^{*}\left(x_{1} x_{2}\right)=\rho^{*}\left(x_{4} x_{1}\right)=1, \rho^{*}\left(x_{2} x_{3}\right)=\rho^{*}\left(x_{3} x_{4}\right)=2$ (тип $B$, см. рисунок 6.7 b ).
1. $p(3) \neq 0$.



Рис. 6.7: Раскраски двуцветного графа с двумя нечетными путями.

Аналогично предыдущему случаю, теперь мы можем получить либо раскраску типа $A$ (см. рисунок 6.7 c ), либо раскраску $\rho^{\prime \prime}$, в которой $\rho^{\prime \prime}\left(x_{1} x_{2}\right)=$ $\rho^{\prime \prime}\left(x_{2} x_{3}\right)=1$ и $\rho^{\prime \prime}\left(x_{4} x_{1}\right)=\rho^{\prime \prime}\left(x_{3} x_{4}\right)=2$ (тип $C$, см. рисунок 6.7 d ).
1. $p(2) \neq 0$ и $p(4) \neq 0$.

Пусть $Q$ - двуцветный граф типа 2. В нем есть четные $y_{12} y_{23}$-путь и $y_{34} y_{41}$-путь, поэтому нетрудно получить Тэйтову раскраску типа $C$ (см. рисунок 6.8 a ). Аналогично, из двуцветного графа типа 4 можно получить Тэйтову раскраску типа $B$ (см. рисунок 6.8 b ).



Рис. 6.8: Раскраски двуцветного графа с двумя четными путями.
Таким образом, существуют Тэйтовы раскраски графа $G_{2}$ хотя бы двух типов из $A, B$ и $C$. Аналогичное утверждение верно и для Тэйтовых раскрасок графа $G_{1}$. Таким образом, у графов $G_{1}$ и $G_{2}$ существуют Тэйтовы раскраски одного типа (из $A, B$ и $C$ ), то есть, совпадающие на общих рёбрах графов $G_{1}$ и $G_{2}$ - рёбрах цикла $C$. Объединив эти две раскраски, мы получим Тэйтову раскраску триангуляции $G$. Противоречие.

Следствие 6.4. Пусть триангуляиия $G$ не имеет Тэйтовой раскраски, а любая меньшая триангуляция имеет Тэйтову раскраску. Тогда $\delta(G) \geq 5$.

Доказательство. Очевидно, триангуляция не содержит вершин степени 1. Пусть $x \in V(G), d_{G}(x)=2$. Так как $G-$ не треугольник, то существует два кратных ребра, соединяющих две вершины из $\mathrm{N}_{G}(x)$ (по одному ребру в каждой из двух различных граней, содержащих $x$ ). Это противоречит пункту 1 теоремы 6.7 .

Пусть $x \in V(G), 3 \leq d_{G}(x) \leq 4$. Можно считать, что $v(G) \geq 6$, иначе легко построить Тэйтову ираскраску $G$. Тогда вершины из окрестности $x$ образуют в $G$ цикл из 3 или 4 вершин, по обе стороны от которого есть другие вершины, что противоречит пунктам 2 и 3 теоремы 6.7.

# 6.8 Списочные раскраски планарных графов 

В этом разделе мы изучим списочные раскраски планарных графов. Списочные раскраски определены в разделе 4.8. Для планарных графов мы приведём списочные версии известных классических теорем: теоремы о пяти красках и теоремы Грёцша. Во втором случае доказательство много проще исходного доказательства классической версии. Все результаты раздела относительно новые и принадлежат Томассену.

Теорема 6.8. (C. Thomassen, 1994.) Для любого плоского графа $G$ выполняется $\operatorname{ch}(G) \leq 5$.

Доказательство. Ввиду леммы 6.7, достаточно доказать теорему для случая, когда $G$ - триангуляция. Мы переформулируем теорему так, чтобы она удобнее доказывалась по индукции.

Пусть $G$ - плоский граф, все грани которого, кроме внешней - треугольники, а $C=v_{1} v_{2} \ldots v_{k}$ - внешний цикл. Предположим, что вершины $v_{1}$ и $v_{2}$ уже покрашены в различные ивета, а каждой непокрашенной вершине $v$ соответствует список иветов $L(v)$ так, что $\ell\left(v_{i}\right) \geq 3$ для $i \in[3 . . k] u \ell(u)=5$ для каждой вершины $u \in V(G) \backslash V(C)$. Тогда раскраска может быть продолжена до правильной раскраски всего графа $G$ с данными списками.

Доказательство. Пусть $\rho$ - правильная раскраска вершин графа $G$ по данным спискам, которую мы строим. Рассмотрим несколько случаев.

1. $G=C$. В этом случае доказательство очевидно.
2. Цикл $C$ имеет хорду $v_{i} v_{j}$.

В этом случае хорда делит цикл $C$ на два цикла $C_{1}$ и $C_{2}$, пусть ребро $v_{1} v_{2}$ лежит в цикле $C_{1}$. Кроме того, хорда разбивает на две части граф $G$ : это граф $G_{1}$ с внешним циклом $C_{1}$ и граф $G_{2}$ с внешнем циклом $C_{2}$. По индукционному предположению, сначала мы можем покрасить $G_{1}$,

потом перейдём к покраске $G_{2}$. На внешнем цикле $C_{2}$ покрашено ровно две соседние вершины: это $v_{i}$ и $v_{j}$, их цвета очевидно различны. Понятно, что ограничения на длины списков соблюдаются и мы по индукционному предположению можем покрасить $G_{2}$, построив тем самым раскраску вершин графа $G$ с данными списками.
1. Цакл не имеет хорд, $G \neq C$.

Пусть $\mathrm{N}_{G}\left(v_{k}\right)=\left\{v_{1}, u_{1}, \ldots, u_{m}, v_{k-1}\right\}$, причем вершины указаны в порядке следования по часовой стрелке в нашем изображении. Так как все внутренние грани $G$ - треугольники, $v_{1} u_{1} \ldots u_{m} v_{k-1}$ - путь в графе $G$. Выберем два отличных от $\rho\left(v_{1}\right)$ цвета $i, j \in L\left(v_{k}\right)$ и удалим их из $L\left(u_{1}\right), \ldots, L\left(u_{m}\right)$. Покрасим меньший граф $G^{\prime}=G-v_{k}$ (это можно сделать по индукционному предположению: на внешнем цикле $C^{\prime}=v_{1} v_{2} \ldots v_{k-1} u_{m} u_{m-1} \ldots u_{1}$ покрашены две вершины $v_{1}$ и $v_{2}$, списки остальных вершин цикла $C^{\prime}$ имеют не менее трёх цветов, а списки вершин графа $G^{\prime}-V\left(C^{\prime}\right)$ - по 5 цветов). После этого выберем из цветов $i, j$ отличный от $\rho\left(v_{k-1}\right)$ положим $\rho\left(v_{k}\right)$ равным этому цвету. Очевидно, получилась правильная раскраска $G$ по данным спискам.

Теперь легко доказать теорему для любой триангуляции $G$ - достаточно лишь покрасить две вершины цикла-границы внешней грани в два разных цвета, которые в их списках, безусловно, есть.

Следствие 6.5. (F. Kempe, 1879.) Для любого планарного графа $G$ выполняется $\chi(G) \leq 5$.

Отметим, что существует плоский граф $G$, для которого $\operatorname{ch}(G)=5$, поэтому результат Томассена - наилучший возможный.

Доказательство следующей теоремы основано на тех же принципах, но технически гораздо сложнее. Трудности возникают не на пустом месте: исходное доказательство классической теоремы Грёцша, которая является следствием этой теоремы, много длиннее.

Теорема 6.9. (C. Thomassen, 2003.) Пусть $G$ - плоский граф, причём $g(G) \geq 5$. Тогда $\operatorname{ch}(G) \leq 3$.

Доказательство. Пусть каждой вершине $v$ соответствует список иветов $L(v)$. Будем строить правильную раскраска вершин $\rho$ по заданным спискам. Назовем вершину $v$ покрашенной, если её цвет $\rho(v)$ уже задан, в этом случае $\ell(v)=1$. Назовем вершину $v$ опасной, если $\ell(v)=2$. Мы изменим утверждение так, чтобы его было удобнее доказывать по индукции.

Лемма 6.9. Пусть $G$ - плоский граф, $g(G) \geq 5$, а $C$ - граница внешней грани графа $G$. Пусть некоторые вершины графа покрашены без нарушения правильности, причём они образуют простой путь или иикл $P=$ $v_{1} v_{2} \ldots v_{q}(q \leq 6)$, который является подграфом $C$.

Пусть все опасные вершины лежат на $C$, никакие две опасные вершины не смежны, каждая опасная вершина смежна не более, чем с одной покрашенной и выполняется одно из следующих трёх условий:
$(P 1) \quad v(P) \leq 6$, причём если $P$ - путь, то опасные вершины не смежны с кониами $P$.
$(P 2) \quad v(P) \leq 5$, причём если $P$ - путь, то хотя бы один из концов пути $P$ не смежен с опасными вершинами.
$(P 3) \quad v(P) \leq 4$.
Тогда раскраска может быть продолжена до правильной раскраски всего графа $G$ с данными списками.

Доказательство. Будем считать, что для любого меньшего чем $G$ графа, удовлетворяющего условию, утверждение уже доказано. Рассмотрим несколько случаев.

В некоторых случаях мы будем разбивать граф на части и по очереди применять индукционное предположение к этим частям без предварительной раскраски вершин. При таком алгоритме действий не будет появляться новых опасных вершин.

Во ряде случаев мы будем красить некоторые вершины графа и удалять эти вершины из графа, а их цвета - из списков их соседей. При таком алгоритме действий могут появляться новые опасные вершины.

В каждом случае мы будем считать, что граф не удовлетворяет условию ни одного из рассмотренных ранее случаев.
Замечание 6.8. Пусть $H$ - подграф графа $G$, в котором покрашенные вершины образуют простой путь или цикл $P_{H}$ (подграф $P$ ). Легко понять, что путь $P_{H}$ является подграфом границы внешней грани графа $H$ и поэтому к графу $H$ можно применить индукционное предположение.

Перейдём к разбору случаев.

# 1. Граф $G$ недвусвязен. 

Если граф $G$ несвязен, то можно доказать утверждение отдельно для каждой его компоненты. Пусть граф $G$ связен. Как известно, в недвусвязном графе $G$ не менее двух крайних блоков. Пусть $B$ - тот из крайних блоков, который содержит меньше вершин пути $P$. Обозначим через $a$ единственную входящую в $B$ точку сочленения (см. рисунок 6.9a). Понятно, что блок $B$ содержит не более трёх вершин из $P$.

Пусть $G_{1}=G-\operatorname{Int}(B)$. Очевидно, к графу $G_{1}$ можно применить индукционное предположение. В результате в графе $B$ окажется покрашенной точка сочленения $a$ и входящие в блок $B$ вершины пути $P$. В случае $\operatorname{Int}(B) \cap V(P) \neq \varnothing$ в блоке $B$ покрашена только вершина $a$, тогда положим $P^{\prime}=\{a\}$.

Пусть $\operatorname{Int}(B) \cap V(P) \neq \varnothing$. Так как внутренние вершины разных блоков несмежны, в этом случае $P$ - путь, блок $B$ содержит участок $P^{\prime}$ этого пути от точки сочленения $a$ до одного из концов.

Так как граф $B$ двусвязен, то границей его внешней грани будет цикл $Z$, содержащий $a$. Поскольку новых опасных вершин не добавилось, то все опасные вершины графа $B$ лежат на внешнем цикле $Z$ и ввиду $g\left(G_{2}\right) \geq 5$ и $v\left(P^{\prime}\right) \leq 3$ ни одна из них не смежна с двумя покрашенными вершинами. Таким образом, к графу $B$ можно применить индукционное предположение. В результате мы получим искомую раскраску вершин всего графа $G$.


Рис. 6.9: Случаи 1 и 3.

Далее во всех случаях граф $G$ двусвязен. Поэтому граница его внешней грани - внешний иикл $C$. Занумеруем его вершины так, чтобы вершины $P$ начинались с первой: $C=v_{1} \ldots v_{q} \ldots v_{k}$.
1. Среди вершин $v_{k}$ и $v_{q+1}$ есть опасные.

Если $\ell\left(v_{k}\right)=2$, то вершина $v_{k}$ смежна не более, чем с одной покрашенной и мы покрасим $v_{k}$, не нарушая правильности раскраски. Если $\ell\left(v_{q+1}\right)=2$, то покрасим $v_{q+1}$, не нарушая правильности раскраски. Отметим, что в этом случае $v_{k} \neq v_{q+1}$ Мы дополнительно покрасили не более чем две вершины пути $\left(v_{k}\right.$ и $\left.v_{q+1}\right)$. В силу $(P 1)-(P 3)$, теперь покрашено не более шести вершин. Так как исходно опасные вершины не были смежны друг с другом, дополнительно покрашенные вершины не смежны с опасными. При необходимости изменим $q$ и перенумеруем вершины так, чтобы покрашенные вершины снова образовывали путь $v_{1} \ldots v_{q}$.

Легко понять, что после произведённых действий граф удовлетворяет условию (P1), теперь вершины $v_{k}$ и $v_{q+1}$ - не опасные.

1. Трансверсаль $L$ отрезает от $C$ иикл $C^{\prime}$ из 5 или 6 вершин, причём во внутренней области цикла $C^{\prime}$ содержится хотя бы одна вершина графа $G$.
Пусть $V=V\left(C^{\prime}\right), W$ - вершины, лежащие во внешней области $C^{\prime}$, а $U-$ вершины, лежащие во внутренней области $C^{\prime}$ (см. рисунок 6.9 b ). Пусть $G_{1}=G(V \cup W), G_{2}=G(V \cup U)$. Понятно, что $W \neq \varnothing$ и $U \neq \varnothing$. Применим индукционное предположение к графу $G_{1}$ (этот граф меньше $G$, цикл $C$ - граница его внешней грани) и покрасим все его вершины, в частности, все вершины цикла $C^{\prime}$. Теперь посмотрим на граф $G_{2}$ : целиком покрашен его внешний цикл $C^{\prime}$ из 5 или 6 вершин, все внутренние вершины имеют список из 3 цветов. По индукционному предположению, можно докрасить вершины $G_{2}$, завершив тем самым покраску вершин $G$ по данным спискам.
1. (a). У иикла $C$ есть хорда.
(б). У иикла $C$ есть трансверсаль $L=v_{s} u v_{t}$, причем в случае $q \geq 5$ трансверсаль $L$ отлична от $v_{q-2} u v_{q+1}$ и $v_{3} u v_{k}$.
(в). У иикла $C$ есть трансверсаль $L=v_{s} u w v_{t}$, где $v_{s}, v_{t} \notin \operatorname{Int}(P)$ и хотя бы одна из вершин $v_{s}$ и $v_{t}$ - опасная или конеи, пути $P$.
Назовём трансверсали из условий (а), (б) и (в) плохими и предположим, что хотя бы одна плохая трансверсаль $L$ с концами $v_{s}, v_{t}$ у цикла $C$ есть. Она делит цикл $C$ на две дуги $N_{2}=v_{s} v_{s+1} \ldots v_{t}$ и $N_{1}=v_{t} v_{t+1} \ldots v_{s}$. Пусть $n_{i}=\left|\operatorname{Int}\left(N_{i}\right) \cap V(P)\right|$. Выберем нумерацию так, чтобы $n_{2} \leq n_{1}$, тогда $n_{2} \leq 2$. Можно считать, что вершины из $P$, лежащие на $N_{1}$ образуют путь - подграф $P$ : иначе $v_{s}, v_{t} \in \operatorname{Int}(P), v_{1}, v_{q} \in \operatorname{Int}\left(N_{1}\right)$ и $\operatorname{Int}\left(N_{2}\right) \subset V(P)$ (см. рисунок 6.10a). Тогда условие (в) не может быть выполнено, следовательно, $v(L) \leq 3$ и из $g(G) \geq 5$ следует, что $n_{2}=n_{1}=2$. В этом случае мы переименуем дуги.
Замечание 6.9. Будем считать, что не существует плохой трансверсали, отрезающей от цикла $C$ дугу, лежащую строго в $N_{2}$, иначе мы рассмотрим эти трансверсаль и дугу вместо $L$ и $N_{2}$.

Пусть цикл $C_{1}$ образован дугой $N_{1}$ и трансверсалью $L$, а цикл $C_{2}-$ дугой $N_{2}$ и трансверсалью $L, V_{i}$ - множество из всех вершин цикла $C_{i}$ и вершин, лежащих внутри этого цикла, $H_{i}=G\left(V_{i}\right)$. Отметим, что $V_{1} \cup V_{2}=V(G), V_{1} \cap V_{2}=V(L)$. По построению, к графу $H_{1}$ можно применить индукционное предположение и покрасить его вершины по данным спискам. В результате покрашенными в графе $H_{2}$ окажутся вершины трансверсали $L$ и лежащие в $\operatorname{Int}\left(N_{2}\right)$ вершины пути $P$.

Мы хотим проверить условие и применить к графу $H_{2}$ индукционное предположение. Отметим, что опасная вершина $v$ графа $H_{2}$ - это опас-

ная вершина графа $G$, причём $v \in \operatorname{Int}\left(N_{2}\right)$. Следовательно, в графе $H_{2}$ нет пар смежных опасных вершин.

Докажем, что опасная вершина $v \in \operatorname{Int}\left(N_{2}\right)$ не может быть смежна с кониом пути $P$, лежащим на дугее $N_{2}$.
Пусть $v \in \operatorname{Int}\left(N_{2}\right)$ - опасная вершина, смежная, например, с вершиной $v_{q} \in V(P) \cap V\left(N_{2}\right)$. Ввиду отсутствия хорды, соединяющей вершину дуги $N_{2}$ с вершиной из $\operatorname{Int}\left(N_{2}\right)$, это означает, что $v=v_{q+1}$, но такой случай рассмотрен в пункте 2 .

Осталось разобраться с рёбрами, соединяющие опасные вершины с покрашенными и покрашенные вершины друг с другом. В графе $H_{2}$ появились новые покрашенные вершины - вершины трансверсали $L$.


Рис. 6.10: Случай 4.
Рассмотрим случай (в), пусть $L=v_{s} u w v_{t}$, причём $v_{s}, v_{t} \notin \operatorname{Int}(P)$. Тогда $\operatorname{Int}\left(N_{2}\right) \cap V(P)=\varnothing$ и покрашенные вершины графа $H_{2}$ - это ровно четыре вершины $L$, что подходит под условие $(P 3)$ (см. рисунок 6.10 b ). Никакие две вершины $L$ не смежны ввиду $g(G) \geq 5$. Пусть $v \in \operatorname{Int}\left(N_{2}\right)$ - опасная вершина. Если она смежна с двумя покрашенными, то из $g(G) \geq 5$ следует, что $v$ смежна с $v_{s}$ и $v_{t}$. Однако, по условию (в) одна из вершин $v_{s}$ и $v_{t}$ - опасная или конец пути $P$ и не может быть смежна с опасной вершиной $v$, противоречие.

Рассмотрим случаи (a) и (б), пусть $L=v_{s} v_{t}$ или $L=v_{s} u v_{t}$. Тогда покрашенные вершины образуют путь $P^{\prime}$ - подграф $C_{2}$, содержащий $L$ и лежащие в $\operatorname{Int}\left(N_{2}\right)$ вершины пути $P$, которых $n_{2} \leq 2$. Таким образом, $v\left(P^{\prime}\right) \leq 5$. Ввиду $g(G) \geq 5$ никакие две вершины пути $P^{\prime}$ не смежны, кроме, возможно, концов пути $P^{\prime}$.

Предположим, что две покрашенные вершины одного цвета смежны. Как сказано выше, это могут быть только концы пути $P^{\prime}$. Из $g(G) \geq 5$ следует, что $v\left(P^{\prime}\right)=5$, а значит, $L=v_{s} u v_{t}$ и $n_{2}=2$. Тогда путь $P^{\prime}$ состоит из трансверсали $L$ и двух соседних с ее концом вершин дуги $N_{2}$. Не умаляя общности можно считать, что $P^{\prime}=v_{t} u v_{s} v_{s+1} v_{s+2}$. Вершина $v_{s+2}-$ это конец пути $P$, не умаляя общности, можно считать, что $v_{s+2}=v_{q}$.

Если $t \neq s+3$, то хорда $v_{t} v_{s+2}$ является плохой трансверсалью, противоречащей замечанию 6.9. Значит, $t=s+3=q+1$ (см. рисунок 6.10c). Так как раскраска вершин пути $P$ была правильной, $v_{q+1} \notin V(P)$. Но тогда $L=v_{q-2} u v_{q+1}$, что по условию случая (б) невозможно.

Пусть $v \in \operatorname{Int}\left(N_{2}\right)$ - опасная вершина, смежная с двумя покрашенными вершинами. Так как $v \in \operatorname{Int}\left(N_{2}\right)$, имеем $\operatorname{Int}\left(N_{2}\right) \notin V(P)$. Из $g(G) \geq 5$ следует $v\left(P^{\prime}\right) \geq 4$, а значит, можно считать, что $P^{\prime}=v_{t} u v_{s} v_{s+1} \ldots v_{q}$, где $q \in\{s+1, s+2\}$. Вершина $v_{q}$ является концом пути $P$ и не может быть смежна с $v$. Так как $g(G) \geq 5$, тогда $v\left(P^{\prime}\right)=5$ (то есть, $q=s+2$ ), а $v$ смежна с $v_{t}$ и $v_{s+1}$ (см. рисунок 6.10 d ). Однако, вспомним, что $v \in \operatorname{Int}\left(N_{2}\right)$ и по замечанию 6.9 не существует хорды $v v_{s+1}$. Противоречие. Таким образом, никакая опасная вершина графа $H_{2}$ не смежна с двумя покрашенными.

При $v\left(P^{\prime}\right)=5$ один из концов пути $P^{\prime}$ (тот, что совпадает с концом $P$ ) несмежен с опасными вершинами, как требует условие (P2). Следовательно, к графу $H_{2}$ можно применить индукционное предположение. Во всех случаях применим индукционное предположение к $H_{2}$ и покрасим его вершины, тем самым, завершив покраску вершин исходного графа $G$ по заданным спискам.
Замечание 6.10. В рассматриваемых далее случаях граф $G$ и цикл $C$ удовлетворяет следующим свойствам.

1) У цикла $C$ нет хорд. Учитывая пункт 2 можно сделать вывод, что опасные вершины несмежны с концами пути $P$. Следовательно, выполняется условие $(P 1)$.
2) Если у цикла $C$ есть трансверсаль $T$ длины 2 , то $q \geq 5$ и либо $T=v_{q-2} u v_{q+1}$, либо $T=v_{3} u v_{k}$. В частности, один конец трансверсали $T$ является одной из покрашенных вершин $v_{3}$ и $v_{q-2}$, а другой конец непокрашенной вершиной.
3) У цикла $C$ не может быть трансверсали длины 3 , один из концов которой является опасной вершиной или концом пути $P$, а другой непокрашенной вершиной.
4. Пусть граф $G$ не удовлетворяет условиям разобранных ранее случаев.
В этом случае мы выберем множество $W$ из нескольких вершин цикла $C$.
(1). Если $v_{q+2}$ - неопасная, то $W=\left\{v_{q}\right\}$.
(2). Если $v_{q+2}$ - опасная, а $v_{q+4}$ - неопасная и $v_{q+4} \neq v_{1}$, то $W=$ $\left\{v_{q+1}, v_{q+2}\right\}$.
(3). Если $v_{q+2}$ - опасная, а $v_{q+4}$ - опасная или $v_{q+4}=v_{1}$, то $W=$ $\left\{v_{q+1}, v_{q+2}, v_{q+3}\right\}$.

Ввиду замечания 6.10 выполнено условие $(P 1)$. Поэтому, вершина $v_{q+1}$ - неопасная, а в случае, когда $v_{q+2}-$ опасная, вершина $v_{q+3}-$ неопасная и $v_{q+3} \neq v_{1}$. Поэтому, описанные выше три варианта покрывают все возможности.

Пусть $G^{\prime}=G-W$. Мы покрасим вершины множества $W$ в цвета из их списков так, чтобы раскраска была правильной. Для каждой вершины $u \in V\left(G^{\prime}\right)$ мы определим список цветов $L^{\prime}(u)$, который получен из $L(u)$ удалением цветов всех соседей вершины $u$ из множества $W$. Из $g(G) \geq 5$ следует, что вершина $u$ не может быть смежна с двумя вершинами множества $W$, поэтому $\ell^{\prime}(u) \geq \ell(u)-1$.

Покраска вершин множества $W$.
В результате покраски некоторых вершин графа и удаления их цветов из списков соседей, могут появляться новые опасные вершины. Оставшиеся опасные вершины из исходной раскраски графа $G$ мы будем называть старыми. Разберём случаи. В случае (1) ничего красить не нужно.

В случае (3) мы имеем $\ell\left(v_{q+3}\right)=\ell\left(v_{q+1}\right)=3$. Пусть $v_{q+4} \neq v_{1}$. Тогда, так как у цикла $C$ нет хорд, $v_{q+3}$ не смежна ни с одной из вершин пути $P$ и мы можем покрасить её в цвет $\rho\left(v_{q+3}\right) \notin L\left(v_{q+4}\right)$. Если $v_{q+4}=v_{1}$, то $v_{q+3}$ не смежна ни с одной из вершин пути $P$, кроме $v_{1}$ и мы можем покрасить её в цвет $\rho\left(v_{q+3}\right) \neq \rho\left(v_{1}\right)$. После этого несложно докрасить $v_{q+2}$ без нарушения правильности раскраски, а затем, так как $\ell\left(v_{q+1}\right)=3$, докрасим и эту вершину. В результате новых опасных вершин на цикле $C$ не появилось.

В случае (2) сначала красим $v_{q+2}$, а затем $v_{q+1}$ (это возможно, так как $\ell\left(v_{q+1}\right)=3$ ). Единственной новой опасной вершиной на цикле $C$ в результате могла стать $v_{q+3}$, однако ввиду отсутствия хорд у иикла $C$ и того, что вершина $v_{q+3}$ несмежна со старыми опасными вершинами, которые еще не покрашены.

В графе $G^{\prime}$ покрашенные вершины образуют путь $P^{\prime}$ - подграф границы внешней грани ( $P^{\prime}=P$ в случаях (2) и (3), $P^{\prime}=v_{1} v_{2} \ldots v_{q-1}$ в случае (1)).

Пусть $v \in V(C)$ - старая опасная вершина и $\ell^{\prime}(v)=1$.
Тогда $v$ должна быть смежна с вершиной множества $W$. Так как у цикла $C$ нет хорд, то мы имеем дело со случаем (3) и $v=v_{q+4} \neq v_{1}$. Но при покраске множества $W$ мы позаботились о том, чтобы выполнялось $\ell^{\prime}\left(v_{q+4}\right)=2$. Противоречие показывает, что для каждой опасной вершины $v$ мы имеем $\ell^{\prime}(v)=2$.

Рассмотрим новую опасную вершину $v$ графа $G^{\prime}$. Эта вершина смежна с одной из удаленных вершин множества $W$, лежащих на внешнем

цикле графа $G$. Следовательно, $v$ лежит на границе внешней грани графа $G^{\prime}$.

По пункту 2 замечания 6.10 каждая новая опасная вершина смежна не более, чем с одной покрашенной вершиной, причём отличной от концов пути $P^{\prime}$. Поэтому, ни одно из рёбер внешней грани не соединяет концы пути $P^{\prime}$ с опасными вершинами, то есть, выполнено условие ( $P 1$ ). Единственное, что может помешать применить к графу $G^{\prime}$ индукционное предположение - это случай, когда две опасные вершины смежны (этот случай мы разберём позже). Если же такой проблемы не возникло, то мы применим к графу $G^{\prime}$ индукционное предположение и в результате получим искомую раскраску вершин всего графа $G$ по заданным спискам.

Лемма 6.10. Пусть две опасные вершины и и и графа $G^{\prime}$ смежны. Тогда $u, w \notin V(C)$.

Доказательство. По построению, новые опасные вершины на цикле $C$ появлялись только в случае (2), причём не были смежны со старыми опасными вершинами. Поэтому, можно считать, что $w \notin V(C)$ - новая опасная вершина и $w$ смежна с вершиной $v_{t} \in W$. Так как новые опасные вершины возникали только в случаях (2) и (3), мы имеем $v_{t} \notin V(P)$. Пусть $u=v_{i}$ лежит на цикле $C$. Тогда у цикла $C$ есть трансверсаль $v_{t} u v_{i}$, где $v_{t}, v_{i} \notin V(P)$ - противоречие с замечанием 6.10.

Итак, рассмотрим случай, когда в графе $G^{\prime}$ есть две смежные опасные вершины $u, w \notin V(C)$. По лемме 6.10 каждая из вершин $u$ и $w$ должна быть смежна с вершиной множества $W$.

Пусть в графе $G$ вершина $u$ смежна с $v_{s}$, а $w$ смежна с $v_{t}$, где $v_{s}, v_{t} \in W$ и $s<t$. Тогда у цикла $C$ есть трансверсаль $L=v_{s} u w v_{t}$. Поскольку $g\left(G^{\prime}\right)=5$, то $t \geq s+2$. Это возможно лишь в случае (3) при $s=q+1$ и $t=q+3$ (см. рисунок 6.11a). Трансверсаль $L$ отрезает от цикла $C$ цикл $C^{\prime}$ длины 5. Поскольку граф не удовлетворяет условию случая 2 , то внутри цикла $C^{\prime}$ нет вершин.


Рис. 6.11: Смежные опасные вершины $u$ и $v$.

Лемма 6.11. 1) У иикла $C$ не существует отличной от $L$ трансверсали $T$ с $v(T) \leq 5$, соединяющей $v_{q+1}$ и $v_{q+3}$.
1) В графе $G^{\prime}$ существует единственная пара смежных опасных вершин - это вершины и и $w$.

Доказательство. 1) Пусть трансверсаль $T$ отделяет от $C$ цикл $Z$ (содержащий $v_{q+2}$ ). Поскольку $v(T) \leq 5$, то $v(Z) \leq 6$. Поскольку $g(G) \geq 5$, то хотя бы одна из вершин $u$ и $w$ не лежит на $T$. Так как граф $G^{\prime}$ плоский, а внутри цикла $C^{\prime}$ нет вершин, то эта вершина лежит внутри цикла $Z$ (см. рисунок 6.11 b ). Тогда граф $G$ удовлетворяет условию пункта 3 , противоречие.
1) Если в графе $G^{\prime}$ есть еще одна пара смежных опасных вершин, то существует отличная от $L$ трансверсаль длины 4 , соединяющая $v_{q+1}$ и $v_{q+3}$, что противоречит пункту 1 леммы.

Мы хотим покрасить вершины и и $w$, не нарушая правильности раскраски.
Пусть $w$ смежна с покрашенной вершиной (то есть, вершиной пути $P$ ). Тогда у цикла $C$ существует трансверсаль $N_{w}=v_{q+3} w v_{i}$, где $v_{i} \in V(P)$. По замечанию 6.10 тогда $q \geq 5$ и либо $N_{w}=v_{k} w v_{3}$, либо $N_{w}=v_{q+1} w v_{q-2}$. Второй вариант очевидно невозможен, а значит, вершина $w$ в этом случае смежна с $v_{3}$ (см. рисунок 6.11c).

Пусть $u$ смежна с покрашенной вершиной. Тогда у цикла $C$ существует трансверсаль $N_{u}=v_{q+1} u v_{i}$, где $v_{i} \in V(P)$. По замечанию 6.10 тогда $q \geq 5$ и $N_{u}=v_{q+1} u v_{q-2}$ (см. рисунок 6.11 c ). При этом, $q-2 \in\{3,4\}$, а значит, если каждая из вершин $u$ и $w$ смежна с покрашенной, то в графе $G$ есть цикл длины не более 4 (это $w u v_{3}$ при $q=5$ и $w u v_{4} v_{3}$ при $q=6$, см. рисунок 6.11 c ). Противоречие с $g(G) \geq 5$.

Значит, хотя бы одна из вершин $u$ и $w$ несмежна с покрашенными вершинами - пусть это $w$. Так как $\ell^{\prime}(u)=\ell^{\prime}(w)=2$, можно сначала покрасить $u$, затем $w$.

Рассмотрим граф $H=G^{\prime}-u-w$.
Удалим цвета вершин $u$ и $w$ из списков их соседей, в результате для каждой вершины $z \in V(H)$ получится список цветов $L^{*}(z)$. Никакая вершина $z \in V(H)$ не смежна одновременно с $u$ и $w$, так как $g\left(G^{\prime}\right) \geq 5$. Следовательно, $\ell^{*}(u) \geq \ell^{\prime}(u)-1$. По лемме 6.11 , никакая отличная от $u$ и $w$ опасная вершина графа $G^{\prime}$ не смежна ни с $u$, ни с $w$, поэтому $\ell^{*}(z) \geq 2$ для каждой непокрашенной вершины $z \in V(H)$.

Лемма 6.12. Пусть вершина $v_{i} \in V(C)$ такова, что $\ell^{*}\left(v_{i}\right)=2$. Тогда $\ell\left(v_{i}\right)=2$.

Доказательство. Понятно, что $v_{i} \notin V(P)$. В рассматриваемом случае (3) при удалении вершин множества $W$ не появлялось новых опасных вершин на цикле $C$, поэтому $\ell^{\prime}\left(v_{i}\right)=\ell\left(v_{i}\right)$. Предположим, что $\ell^{\prime}\left(v_{i}\right)=3$. Тогда $v_{i}$ смежна с $u$ или $w$, следовательно, в графе $G$ у цикла $C$ есть трансверсаль $v_{i} u v_{q+1}$ или $v_{i} w v_{q+3}$, оба конца которой не покрашены. Это невозможно по замечанию 6.10 .

Так как внутренность цикла $C^{\prime}$ пуста, в графе $G$ с вершиной $v_{q+2}$ смежны только $v_{q+1}$ и $v_{q+3}$. Опасные вершины графа $H$, не лежащие на $C$, очевидно, смежны с $v_{q+1}, v_{q+3}, u$ или $w$, поэтому, лежат на границе внешней грани графа $H$.

Лемма 6.13. Опасная вершина графа $H$ не может быть смежна ни с $v_{1}$, ни с $v_{q}$, то есть, выполняется условие (P1).

Доказательство. Пусть $v$ - опасная вершина графа $H$, смежная с $v_{1}$ или $v_{q}$. Предположим, что $v \in V(C)$. Ввиду леммы 6.12 тогда $v$ - опасная вершина графа $G$, что противоречит условию ( $P 1$ ).

Значит, вершина $v \notin V(C)$ смежна в графе $G$ с $\left\{v_{q+1}, v_{q+3}, u, w\right\}$. Если $v$ смежна с $v_{q+1}$ или $v_{q+3}$, то у цикла $C$ существует трансверсаль длины 2 с концом $v_{1}$ или $v_{q}$, что противоречит замечанию 6.10 .

Если $v$ смежна с $w$, то у цикла $C$ существует трансверсаль $v_{q} v w v_{q+3}$ или $v_{1} v w v_{q+3}$. Один конец такой трансверсали совпадает с концом пути $P$, а другой - непокрашенная вершина, что противоречит замечанию 6.10. Аналогично разбирается случай, когда $v$ смежна с $u$.

Лемма 6.14. Никакие две опасные вершины графа $H$ не смежны.
Доказательство. Предположим, что две опасные вершины $x$ и $y$ графа $H$ смежны. Тогда ввиду леммы 6.11 хотя бы одна из них (пусть это $x$ ) не является опасной в графе $G^{\prime}$, то есть, $x$ смежна с $u$ или $w$ и $\ell^{\prime \prime}(x)=\ell(x)-1=2$. Пусть вершина $x$ смежна с $w$.


Рис. 6.12: Смежные опасные вершины $x$ и $y$.

Если $y$ смежна с $u, w$ или $v_{q+3}$, то $g(G)<5$, противоречие. Если $y$ смежна с $v_{q+1}$, то существует трансверсаль $v_{q+1} y x w v_{q+3} \neq L$ (см. рисунок 6.12a), противоречие с леммой 6.11.

Остается случай, когда $y=v_{i}$ лежит на цикле $C$. По лемме 6.12 , тогда $\ell^{*}\left(v_{i}\right)=\ell\left(v_{i}\right)=2$. У цикла $C$ существует трансверсаль $v_{q+3} w x v_{i}$, один из концов которой - опасная вершина $v_{i}$ графа $G$, а другой - непокрашенная в исходной раскраске вершина $v_{q+3}$ (см. рисунок 6.12 b ). Противоречие с замечанием 6.10. Все варианты для вершины $y$ разобраны.

Случай, когда $x$ смежна в графе $G$ с вершиной $u$ аналогичен.

Таким образом, к графу $H$ можно применить индукционное предположение и раскрасить его вершины в соответствии с их списками. Тем самым, мы покрасим все вершины графа $G$ и закончим разбор последнего случая. Лемма 6.9 доказана.

Утверждение теоремы является частным случаем утверждения леммы 6.9 .

Теорема 6.10. (H. Grötzsch, 1958) Пусть $G$ - плоский граф с $g(G) \geq 4$. Тогда $\chi(G) \leq 3$.

Доказательство. Мы изменим утверждение так, чтобы его было удобнее доказывать по индукции.

Пусть $G$ - плоский граф, $g(G) \geq 4, C-$ граница внешней грани. Тогда $\chi(G) \leq 3$. Более того, если $C$ - иикл из 4 или 5 вершин, то любая правильная раскраска иикла $C$ в 3 ивета может быть продолжена до правильной раскраски всего графа в 3 ивета.

Доказательство. Будем считать, что для любого меньшего чем $G$ графа, удовлетворяющего условию, утверждение уже доказано. Если в графе $G$ нет циклов длины 4 , то утверждение следует из леммы 6.9. Предположим, что единственным циклом длины 4 является внешний цикл $C$. Если его вершины не были покрашены, то мы легко можем покрасить их правильным образом в 3 цвета. Добавим на одном из рёбер цикла $C$ новую вершину степени 2 , покрасим её не нарушая правильности раскраски и опять же воспользуемся утверждением леммы 6.9.

Предположим, что в графе $G$ существует цикл $Z$ длины 4 , отличный от $C$. Пусть $U$ - множество вершин графа $G$ внутри цикла $Z$, а $W$ множество вершин вне цикла $Z$ (см. рисунок 6.13a). Очевидно, $W \neq \varnothing$. Рассмотрим два случая.

1. Пусть $U \neq \varnothing$.

Разрежем граф $G$ по циклу $Z$ : пусть $G_{1}=G-U$ и $G_{2}=G-W$. Отметим, что внешним циклом $G_{1}$ является $C$. Очевидно, можно применить к графу $G_{1}$ индукционное предположение и покрасить все его вершины в 3 цвета правильным образом. В графе $G_{2}$ в результате будут покрашены только вершины внешнего цикла $Z$ и по индукционному предположению мы можем докрасить вершины графа $G_{2}$, получив правильную раскраску графа $G$ в три цвета.


Рис. 6.13: Цикл $a_{1} a_{2} a_{3} a_{4}$.
1. Пусть $U=\varnothing$.

Тогда $Z=a_{1} a_{2} a_{3} a_{4}$ - грань графа $G$. Очевидно, $a_{1} a_{3}, a_{2} a_{4} \notin E(G)$. Объединим вершины $a_{1}$ и $a_{3}$ : пусть $G_{1}=G \# a_{1} a_{3}, b=a_{1} \# a_{3}$ (см. рисунок 6.13 b ). Если $g\left(G_{1}\right) \geq 4$, то по индукционному предположению существует правильная раскраска $\rho$ вершин графа $G_{1}$ в 3 цвета. Тогда положим $\rho^{\prime}\left(a_{1}\right)=\rho^{\prime}\left(a_{3}\right)=\rho(b)$ и $\rho^{\prime}(v)=\rho(v)$ для $v \in V(G) \backslash\left\{a_{1}, a_{3}\right\}$. Так как $a_{1} a_{3} \notin E(G)$, полученная раскраска $\rho^{\prime}$ - правильная раскраска вершин графа $G$ в четыре цвета.

Остаётся случай, когда $g\left(G_{1}\right)=3$. Аналогично рассмотрим граф $G_{2}=G \# a_{2} a_{4}$ и получим, что $g\left(G_{2}\right)=3$. Что же отсюда следует? Тогда в графе $G$ существуют трансверсали $S_{1}=a_{1} x y a_{3}$ и $S_{2}=a_{2} u w a_{4}$ цикла $Z$, которые проходят во внешней области цикла $Z$ (внутри грани не может проходить трансверсаль). Значит, $S_{1}$ и $S_{2}$ пересекаются. Так как граф $G$ - плоский, пути $S_{1}$ и $S_{2}$ имеют общую вершину. Не умаляя общности, пусть $x=u$ (см. рисунок 6.13 c ). Но в этом случае в графе $G$ есть треугольник $a_{1} x a_{2}$, противоречие с $g(G) \geq 4$.

Остаётся лишь заметить, что утверждение теоремы является частным случаем доказанного.

Мы еще раз вернемся к списочным раскраскам планарных графов в разделе 8.7.2, где с помощью ориентации планарного графа докажем

существование списочной раскраски в 3 цвета у двудольного планарного графа.

# 6.9 Пути и циклы в планарном графе 

В 1880 году Тэйт в одной из попыток доказательства гипотезы четырёх красок предположил, что любой 3 -регулярный трёхсвязный планарный граф имеет гамильтонов цикл. Гипотеза Тэйта оказалась совсем неочевидной, даже неверной. Лишь в 1946 году её опроверг Татт, построив контрпример. Доказательство отсутствия гамильтонова цикла в примере Татта делается только перебором. Этот контрпример долгое время оставался единственным известным, лишь в 1968 году Е.Я.Гринберг придумал критерий гамильтоновости планарных графов, который, в частности, помогает построить контрпримеры к гипотезе Тэйта и проверить отсутствие в них гамильтонова цикла без перебора.

### 6.9.1 Негамильтоновы планарные графы

Теорема 6.11. (Е. Я. Гринберг, 1968.) Пусть $G$ - плоский граф без петель с гамильтоновым циклом $C$, который делит плоскости на две области $R$ и $R^{\prime}$. Пусть $k_{i}$ и $k_{i}^{\prime}$ - количества граней размера $i$ в $R$ и $R^{\prime}$ соответственно. Тогда

$$
\sum_{i=1}^{v(G)}(i-2)\left(k_{i}-k_{i}^{\prime}\right)=0
$$

Доказательство. Отметим, что в гамильтоновом графе $G$, очевидно, нет мостов и граница любой грани - простой цикл. Поэтому, размер границы каждой его грани не более $v(G)$. Пусть $\varepsilon$ и $\varepsilon^{\prime}$ - количества рёбер графа $G$, лежащих внутри областей $R$ и $R^{\prime}$ соответственно. Так как $C$ - гамильтонов цикл графа $G$, то область $R$ разбита на $\varepsilon+1$ граней, а область $R^{\prime}-$ на $\varepsilon^{\prime}+1$ граней. Получаем соотношения

$$
\sum_{i=1}^{v(G)} k_{i}=\varepsilon+1, \quad \sum_{i=1}^{v(G)} k_{i}^{\prime}=\varepsilon^{\prime}+1
$$

Каждое внутреннее ребро области $R$ входит в границы двух внутренних граней области $R$, а каждое ребро цикла $C$ - в границу одной внутренней грани этой области. Аналогичное соотношение верно и для $R^{\prime}$.

Следовательно,

$$
\sum_{i=1}^{v(G)} i \cdot k_{i}=2 \varepsilon+e(C), \quad \sum_{i=1}^{v(G)} i \cdot k_{i}^{\prime}=2 \varepsilon^{\prime}+e(C)
$$

Из формул (6.2) и (6.3) получаем

$$
\sum_{i=1}^{v(G)} i \cdot\left(k_{i}-k_{i}^{\prime}\right)=2\left(\varepsilon-\varepsilon^{\prime}\right)=\sum_{i=1}^{v(G)} 2\left(k_{i}-k_{i}^{\prime}\right)
$$

откуда немедленно следует доказываемое утверждение.
На основании формулы (6.1) легко можно построить негамильтонов планарный граф. Так, Гринберг построил трёхсвязный кубический плоский граф, в котором ровно одна грань имеет 9 рёбер, а все остальные по 5 или 8 рёбер (см. рисунок 6.14). Левая часть соотношения (6.1) в таком графе, очевидно, не делится на 3 , так как сравнима по модулю 3 с $(9-2)\left(k_{9}-k_{9}^{\prime}\right)= \pm 7$. Следовательно, этот граф - не гамильтонов.


Рис. 6.14: Граф Гринберга.

# 6.9.2 Теорема Томассена о пути в планарном графе 

В 1956 году Татт доказал, что любой четырёхсвязный планарный граф гамильтонов. На самом деле, Татт доказал более сильную теорему 6.14. В 1975 году Пламмер предположил, что любой 4 -связный планарный

граф является Гамильтоново-связным, а именно, для любых двух вершин $u, v \in V(G)$ существует гамильтонов путь с концами $u$ и $v$. Все эти и некоторые другие результаты мы получим в качестве следствий из теоремы Томассена.

Определение 6.10. 1) Пусть $H$ - подграф плоского графа $G$. Назовём $H$-компонентой любую компоненту связности графа $G-H$.
1) Назовём вершину $x \in V(H)$ контактом $H$-компоненты $U$, если она смежна хотя бы с одной из вершин $U$. Через $W(U)$ обозначим множество всех контактов $U$, пусть $w(U)=|W(U)|$.

Теорема 6.12. (C.Thomassen, 1983.) Пусть $G$ - двусвязный плоский граф, цикл $C$ - граница его грани, $v \in V(C)$, е $\in E(C)$, а $u \neq v-$ вершина графа $G$. Тогда существует чи-путь $P$, проходящий по ребру е и удовлетворяющий следуюшим условиям:
$1^{\circ} w(U) \leq 3$ для любой $P$-компоненты $U$;
$2^{\circ} w(U)=2$ для любой $P$-компоненты $U$, содержащей хотя бы одну вершину цикла $C$.

Замечание 6.11. Из теоремы 6.12 следует, что мы можем найти чипуть, удовлетворяющий условиям $1^{\circ}$ и $2^{\circ}$, а также $v u$-путь, проходящий через произвольную вершину $w \in V(C)$ и удовлетворяющий этим же условиям.

Доказательство. Не умаляя обности можно считать, что $C$ - внешний цикл графа $G$. Докажем теорему индукцией по $v(G)$. База для $v(G)=3$ очевидна.

В случае, когда $e=v u$, путь $P=v u$ нам, очевидно, подходит. Поэтому, далее можно считать, что $u$ не является концом $e$ (если $u$ инцидентно $e$, а $v$ - нет, то $u \in V(C)$ и мы можем поменять местами вершины $v$ и $u)$.

Будем называть разбиением такие вершины $x$ и $y$ цикла $C$, что $\{x, y\}$ разделяет $G$ на два подграфа $G_{1}$ и $G_{2}$ (не обязательно связных), удовлетворяющих следующим условиям

$$
\begin{aligned}
& V\left(G_{1}\right) \cap V\left(G_{2}\right)=\{x, y\}, \quad v \in V\left(G_{1}\right), \quad e \in E\left(G_{2}\right), \\
& V\left(G_{1}\right) \backslash\{x, y, v\} \neq \varnothing, \quad V\left(G_{2}\right) \backslash\{x, y\} \neq \varnothing .
\end{aligned}
$$

Допускается случай $v \in\{x, y\}$.
Разберём несколько случаев.

1. Пусть существует разбиение.

Среди всех разбиений выберем пару вершин $x, y$ так, что $v\left(G_{2}\right)$ минимально. Пусть $G_{1}^{\prime}=G_{1}+x y, G_{2}^{\prime}=G_{2}+x y$, а $G_{2}^{*}-$ граф, полученный из $G_{2}^{\prime}-x y$ добавлением новой вершины $v^{\prime}$, смежной с $x$ и $y$ (см. рисунок 6.15). Очевидно, графы $G_{1}^{\prime}, G_{2}^{\prime}$ и $G_{2}^{*}$ двусвязны. Внешние циклы $C_{1}$ графа $G_{1}^{\prime}$ и $C_{2}$ графа $G_{2}^{\prime}$ образованы соответствующими частями цикла $C$ и ребром $x y$. Внешний цикл $C_{2}^{*}$ графа $G_{2}^{*}$ - получается из $C_{2}-x y$ добавлением вершины $v^{\prime}$ и рёбер $x v^{\prime}$ и $v^{\prime} y$. Тогда $v \in V\left(C_{1}\right)$, $e \in E\left(C_{2}\right)$ и $e \in E\left(C_{2}^{*}\right)$. Отметим, что $v\left(G_{2}^{\prime}\right)<v(G)$ и $v\left(G_{1}^{\prime}\right)<v(G)$, поэтому, к графам $G_{1}^{\prime}$ и $G_{2}^{\prime}$ можно применять индукционное предположение. Рассмотрим несколько случаев.
1.1. $u \in V\left(G_{1}\right)$.

По индукционному предположению мы найдём $v u$-путь $P_{1}$ в графе $G_{1}^{\prime}$, проходящий по ребру $x y$ и $x y$-путь $P_{2}$ в графе $G_{2}^{\prime}$, проходящий по ребру $e$, удовлетворяющие условиям $1^{\circ}$ и $2^{\circ}$ (см. рисунок 6.16 a ). Пусть $P-v u$ путь, полученный из $P_{1}$ заменой ребра $x y$ на путь $P_{2}$. Тогда $P$ содержит ребро $e$. Так как $V(P) \supset\{x, y\}=V\left(G_{1}\right) \cap V\left(G_{2}\right)$, любая $P$-компонента есть либо $P_{1}$-компонента графа $G_{1}^{\prime}$, либо $P_{2}$-компонента графа $G_{2}^{\prime}$, следовательно, $P$ удовлетворяет условиям $1^{\circ}$ и $2^{\circ}$.
1.2. $u \in V\left(G_{2}\right), v \in\{x, y\}$.

Пусть $v=x$. По индукционному предположению мы найдём $v u$-путь $P_{2}$ в графе $G_{2}^{\prime}$, проходящий по ребру $e$ и удовлетворяющий условиям $1^{\circ}$ и $2^{\circ}$. Рассмотрим два случая.
1.2.1. $x y \notin E\left(P_{2}\right)$.

Докажем, что путь $P_{2}$ подходит и для графа $G$. Если $x, y \in V\left(P_{2}\right)$, то граф $G_{1}^{\prime}$ распадается на несколько $P_{2}$-компонент с контактами $x$ и $y$, а остальные $P_{2}$-компоненты графа $G$ - это $P_{2}$-компоненты графа $G_{2}$. Таким образом, условия $1^{\circ}$ и $2^{\circ}$ для графа $G$ выполнены.

Пусть $y \notin V\left(P_{2}\right)$. Тогда $x=v \in V\left(P_{2}\right)$. Рассмотрим $P_{2}$-компоненту $Y \ni y$ графа $G_{2}^{\prime}$. По условию $2^{\circ}, w(Y)=2$ (одним из контактов $Y$ является вершина $x=v$, см. рисунок 6.16 b ). Понятно, что $Y^{\prime}=V\left(G_{1}\right) \cup Y$


Рис. 6.15: Графы $G, G_{1}^{\prime}, G_{2}^{\prime}$ и $G_{2}^{*}$.



Рис. 6.16: Построение пути: случаи 1.1 и 1.2.1.

будет $P_{2}$-компонентой графа $G$, причём $W\left(Y^{\prime}\right)=W(Y)$. Таким образом, условия $1^{\circ}$ и $2^{\circ}$ для графа $G$ в этом случае выполнены.
1.2.2. $x y \in E\left(P_{2}\right)$.

В этом случае мы по индукционному предположению найдём $x y$-путь $P_{1}$ в графе $G_{1}^{\prime}$, удовлетворяющий условиям $1^{\circ}$ и $2^{\circ}$ и проходящий по произвольному ребру $f \neq x y$. Тогда $x y \notin P_{1}$ и, аналогично пункту 1.1, путь $P$, полученный из $P_{2}$ заменой ребра $x y$ на путь $P_{1}$, удовлетворяет условиям $1^{\circ}$ и $2^{\circ}$ для графа $G$.


Рис. 6.17: Построение пути: случай 1.3.
1.3. $u \in V\left(G_{2}\right), v \notin\{x, y\}$.

В этом случае две различные вершины входят в $V(G) \backslash V\left(G_{2}^{*}\right)$, поэтому, $v\left(G_{2}^{*}\right)<v(G)$ и к графу $G_{2}^{*}$ можно применить индукционное предположение: найдём в этом графе $v^{\prime} u$-путь $P_{2}$, проходящий по ребру $e$ и удовлетворяющий условиям $1^{\circ}$ и $2^{\circ}$. Не умаляя общности предположим, что $P_{2}$ проходит по ребру $v^{\prime} y$. Тогда найдём $v x$-путь $P_{1}$ в графе $G_{1}^{\prime}$, проходящий по ребру $x y$ и удовлетворяющий условиям $1^{\circ}$ и $2^{\circ}$.

Предположим, что $x \in V\left(P_{2}\right)$ (см. рисунок 6.17 a ). Тогда аналогично пункту 1.1 получается, что путь $P=v P_{1} y P_{2} u$ - это $v u$-путь в графе $G$, содержащий ребро $e$ и удовлетворяющий условиям $1^{\circ}$ и $2^{\circ}$.

Пусть $x \notin V\left(P_{2}\right)$. Тогда расмотрим $P_{2}$-компоненту $X \ni x$ графа $G_{2}^{*}$. По условию $2^{\circ}, w(X)=2$. Понятно, что $W(X) \ni v^{\prime}$, пусть $W(X)=\left\{v^{\prime}, z\right\}$ (см. рисунок 6.17 b ). Так как входящее в $P_{2}$ ребро $e$ лежит на внешнем цикле $C_{2}$ графа $G_{2}$, то второй контакт $z$ должен также лежать на цикле $C_{2}^{*}$. Тогда $z$ - точка сочленения графа $G_{2}$, отделяющая $X$ от $u$,

следовательно, множество $\{y, z\}$ отделяет $X$ от $u$ в графе $G$ (см. рисунок 6.17 c ).

Пусть $H_{2}=G_{2}-X$. Отметим, что $V\left(H_{2}\right)$ содержит хотя бы три вершины: это $u$ и концы ребра $e$. Поэтому, $\{y, z\}$ является разбиением, причём роль графа $G_{2}$ в этом случае достанется меньшему графу $H_{2}$ что противоречит минимальности $v\left(G_{2}\right)$.
1. Пусть разбиений нет.
2.1. $O$ структуре графа.

Далее пусть $P_{1}$ - дуга цикла $C$ от $v$ до одного из концов ребра $e$ (назовём его $w_{1}$ ), не содержащая $e$ и $u$. (Если $v$ инцидентна $e$, то $P_{1}$ состоит из единственной вершины $v$.) Пусть $H=G-V\left(P_{1}\right), P_{2}=C-V\left(P_{1}\right)$. Пусть $v_{1}$ - общий конец ребра $e$ и пути $P_{2}$, а $v_{2}$ - второй конец пути $P_{2}$ (возможно, $v_{2}=v_{1}$ ). Рассмотрим внутреннюю грань $d$ графа $G$, содержащую ребро $e$. Пусть $e_{1}$ - второе ребро границы грани $d$, инцидентное $v_{1}$ (см. рисунок 6.18a).

Пусть $B$ - блок графа $H$, содержащий ребро $e_{1}$, цикл $C^{\prime}$ - граница внешней грани $B$, а $e_{1}^{\prime}=v_{1} v_{1}^{\prime}$ - второе ребро $C^{\prime}$, инцидентное $v_{1}$. (Возможно, $E(B)=e_{1}$, тогда $C^{\prime}$ - это не цикл, а ребро $e_{1}$ и, соответственно, $\left.e_{1}^{\prime}=e_{1}.\right)$

Мы хотим доказать, что $B$ содержит все вершины пути $P_{2}$. Разберём несколько случаев.
2.1.1. Ребро $e_{1}^{\prime}$ не лежит на цикле $C$.

В этом случае блок $B$ и путь $P_{2}$ имеют ровно одну общую вершину $-v_{1}$. Следовательно, $v_{1}^{\prime} \notin V(C)$. Рассмотрим $C$-компоненту $K \ni v_{1}^{\prime}$ графа $G$. Очевидно, $K \supset V(B) \backslash v_{1}$. Из двусвязности $G$ следует, что $K$ имеет отличный от $v_{1}$ контакт $z \in V(C)$.

Поскольку $v_{1}$ отделяет $V\left(P_{2}\right)$ от $B$, то $z \notin V\left(P_{2}\right)$. Следовательно, все контакты $K$ лежат на пути $P_{1}$. Тогда выберем в качестве $z$ из этих контактов ближний к вершине $v$ по пути $P_{1}$ (см. рисунок 6.18 a , возможно, $z=v$ ). Если $v_{2} \neq v_{1}$, то $\left\{z, v_{1}\right\}$ отделяет $B$ от $v_{2}$ в графе $G$, а следовательно, $\left\{z, v_{1}\right\}$ - разбиение (граф $G_{1}$ в этом случае содержит вершину $v_{2} \notin\left\{v, v_{1}, z\right\}$, а граф $G_{2}$ - вершину $v_{1}^{\prime} \notin\left\{v_{1}, z\right\}$ ). Противоречие.

Следовательно, $v_{1}=v_{2}$, то есть, блок $B$ содержит единственную вершину пути $P_{2}$.
2.1.2. Пусть $e_{1}^{\prime}$ лежит на цикле $C$.

Предположим, что $V(B) \not \supset V\left(P_{2}\right)$. В этом случае $v_{2} \neq v_{1}$ и существует входящая в блок $B$ точка сочленения $w \in V\left(P_{2}\right)$, которая отделяет от $B$ от $v_{2}$ в графе $H$. Поскольку $e_{1}^{\prime}$ лежит на цикле $C$, то $w \neq v_{1}$ и блок $B$ содержит участок пути $P_{2}$ от $v_{1}$ до $w$ (см. рисунок 6.18 b ). Так как граф $G$ двусвязен, существуют вершины из $V\left(P_{1}\right)$, до которых можно



Рис. 6.18: Блок $B$.

дойти от $v_{2}$, не проходя через $w$ и вершины пути $P_{1}$ (например, $v$ - такая вершина). Пусть $z$ - самая дальняя из этих вершин по пути $P_{1}$ от $v$ (возможно, $z=v$ ). Нетрудно понять, что тогда $\{z, w\}$ - разбиение (в этом случае граф $G_{1}$ содержит вершину $v_{2} \notin\{v, z, w\}$, а граф $G_{2}$ содержит вершину $v_{1} \notin\{z, w\})$. Противоречие. Таким образом, $V(B) \supset V\left(P_{2}\right)$.
2.2. Продолжсим изучение структуры графа $G$.

Рассмотрим $P_{1}$-компоненту $U \ni u$ и $C$-компоненту $U^{\prime} \ni u$. Если $U \not \supset$ $V(B)$, то $U^{\prime}$ не имеет контакта на $P_{2}$. В этом случае поменяем пути местами: заменим $P_{1}$ на дугу $P_{1}^{\prime}$ цикла $C$ от $v$ до $v_{1}$, не содержащую $e$ - это ребро $v v_{2}$ плюс путь $P_{2}$. В таком случае роль пути $P_{2}$ достанется $P_{2}^{\prime}=P_{1}-v$, а этот путь содержится в той же $P_{1}^{\prime}$-компоненте, что и вершина $u$.

Итак, остается рассмотреть ситуацию, когда $P_{1}$-компонента $U$ содержит и вершину и, и блок $B$, который в свою очередь содержит nуть $P_{2}$.
2.3. Построение пути.

Если $u \in V(B)$, положим $u^{\prime}=u$, если же $u$ содержится в другом блоке графа $G(U)$, пусть $u^{\prime} \in V(B)$ - точка сочленения, отделяющая $u$ от $B$.

По индукционному предположению, в двусвязном графе $B$ существует $v_{1} u^{\prime}$-путь $T^{\prime}$, содержащий $v_{2}$. Положим $T=v P_{1} w_{1} v_{1} T^{\prime} u^{\prime}-v u^{\prime}$-путь, содержащий ребро $e=w_{1} v_{1}$ и вершину $v_{2}$. На основе пути $T$ мы будем конструировать искомый путь $S$. Изначально положим $S=T$.

Пусть $D=G(V(B) \cup V(C))$. По доказанному выше, внешний цикл блока $B$ содержит $v_{1} v_{2}$-путь $P_{2}$. Пусть $v_{1} v_{2}$-путь $Q$ - отличная от $P_{2}$ дуга внешнего цикла блока $B$, см. рисунок 6.19a. Понятно, что контакты $D$-компонент, принадлежащие блоку $B$, могут лежать только на пути $Q$. Следовательно, любая $T^{\prime}$-компонента графа $B$, не пересекающаяся с $Q$, не смежна с $D$-компонентами и путём $P_{1}$. Поэтому, такая $T^{\prime}$-компонента останется $S$-компонентой графа $G$ с тем же множеством контактов. Таким образом, нам нужно будет рассмотреть все $T^{\prime}$-компоненты графа $B$,

пересекающиеся с $V(Q)$, и все $D$-компоненты графа $G$ и изменить путь $S$ внутри этих $D$-компонент так, чтобы контакты каждой $S$-компоненты удовлетворяли условиям $1^{\circ}$ и $2^{\circ}$.

Рассмотрим $D$-компоненту $J$ и её контакты. Так как $B$ - блок графа $H=G-P_{1}$, то $J$ имеет не более одного контакта в $V(B)$. Если такой контакт есть, обозначим его через $b_{J}$. Из двусвязности графа $G$ следует, что $J$ имеет хотя бы один контакт на пути $P_{1}$. Пусть $x_{J}$ и $y_{J}$ - два крайних контакта из $W(J)$ на $P_{1}$ (самый близкий к $v$ и самый далёкий от $v$ по пути $P_{1}$, соответственно, возможно, $x_{J}=y_{J}$ ). Пусть $L_{J}=x_{J} P_{1} y_{J}$ (см. рисунок 6.19a).

Назовём $D$-компоненту $J$ особой, если $u \in J$ и неособой в противном случае. Понятно, что особая $D$-компонента не более чем одна. Рассмотрим несколько случаев.



Рис. 6.19: $D$-компонента и ее контакты.
2.3.1. Существует такая $D$-компонента $J$, что $W(J) \subset V\left(P_{1}\right)$.

Тогда $J$ - отличная от $U$ компонента связности графа $H=G-P_{1}$, следовательно, $u \notin J$, то есть, компонента $J$ - неособая. Из двусвязности графа $G$ следует, что $x_{J} \neq y_{J}$. Пусть $L_{J}^{\prime}$ - это произвольный $x_{J} y_{J}$-путь по вершинам $J$. Тогда $L_{J} \cup L_{J}^{\prime}$ - это цикл, во внутренней области которого, возможно, располагаются некоторые $D$-компоненты, которые мы назовём $J$-внутренними. Из планарности графа $G$ следует, что все контакты любой $J$-внутренней компоненты расположены на $L_{J}$. Пусть $M$ объединение вершин $J$ и всех $J$-внутренних компонент, если они есть (см. рисунок 6.19 b ).

Понятно, что граф $F=G\left(M \cup L_{J}\right)$ - двусвязный. Пусть $G^{\prime}$ - граф, полученный из $G-M$ заменой пути $L_{J}$ на новое ребро $x_{J} y_{J}$ (изображенное вдоль пути $L_{J}$ ). Этот граф также является двусвязным, его внешний цикл $C^{\prime}$ получается из $C$ заменой $L_{J}$ на ребро $x_{J} y_{J}$. Понятно, что $v \in V\left(C^{\prime}\right), u \in V\left(G^{\prime}\right), e \in E\left(C^{\prime}\right)$.

Применим индукционное предположение к графу $G^{\prime}$ и найдем удовлетворяющий условиям $1^{\circ}$ и $2^{\circ}$ и-путь $P^{\prime}$, содержащий $e$. Если путь $P^{\prime}$ не проходит по новому ребру $x_{J} y_{J}$, то путь $P^{\prime}$ подходит и для графа $G$ (это доказывается аналогично случаю 1.2.1). Пусть $P^{\prime}$ проходит по $x_{J} y_{J}$. Тогда по индукционому предположению мы построим $x_{J} y_{J}$-путь $P_{F}$ в графе $F$, удовлетворяющий $1^{\circ}$ и $2^{\circ}$. Аналогично случаю $1.1, v u$-путь $P$, полученный из $P^{\prime}$ заменой ребра $x_{J} y_{J}$ на путь $P_{F}$, подойдёт для графа $G$.

Таким образом, мы можем считать, что контакт $b_{J}$ существует для каждой $D$-компоненты $J$. Тогда из планарности графа $G$ для любой $D$-компоненты $J^{\prime} \neq J$ следует, что $W\left(J^{\prime}\right)$ не содержит внутренних вершин пути $L_{J}$.

Сначала мы по очереди рассмотрим все неособые $D$-компоненты $J$, для которых контакт $b_{J} \in T^{\prime}$. Рассматривая очередную $D$-компоненту $J$, мы будем менять только участок $L_{J}$ пути $S$, поэтому измененный путь $S$ будет по-прежнему содержать ребро $e$, участок $T^{\prime}$ и участок $L_{J^{\prime}}$ для любой еще не рассмотренной $D$-компоненты $J^{\prime}$. В изменениях будут участвовать только вершины рассматриваемых $D$-компонент и пути $P_{1}$.

Продолжим рассматривать случаи.

a

b

Рис. 6.20: Изменение пути: случай $b_{J} \in V\left(T^{\prime}\right)$.
2.3.2. $J$ - неособая $D$-компонента, $b_{J} \in V\left(T^{\prime}\right)$.

Пусть $x_{J} \neq y_{J}$ (см. рисунок 6.20 a ). Граф $F=G\left(J \cup V\left(L_{J}\right) \cup\left\{b_{J}\right\}\right)+y_{J} b_{J}$ (см. рисунок 6.20 b ) двусвязен (он представляет собой цепочку из блоков, в которой первый (содержащий $L_{J}$ ) и последний (содержащий $b_{J}$ ) замкнули ребром $y_{J} b_{J}$ ). По индукционому предположению мы построим $x_{J} b_{J}$-путь $P_{J}$ в графе $F$, содержащий ребро $y_{J} b_{J}$ и удовлетворяющий условиям $1^{\circ}$ и $2^{\circ}$. Заменим участок $L_{J}$ пути $S$ на $x_{J} P_{J} y_{J}$. Очевидно, получится простой путь. Новый путь $S$ содержит $x_{J}, y_{J}$ и $b_{J}$, поэтому любая $S$-компонента $X$ графа $G$, для которой $X \cap V(F) \neq \varnothing$, является $P_{J}$-компонентой графа $F$ и удовлетворяет условиям $1^{\circ}$ и $2^{\circ}$.

Если же $x_{J}=y_{J}$, то $J$ - это $S$-компонента с двумя контактами, в этом случае не будем менять путь $S$, он и так удовлетворяет условиям $1^{\circ}$ и $2^{\circ}$.
2.3.3. $J$ - неособая $D$-компонента, $b_{J} \notin V\left(T^{\prime}\right)$.

Как мы знаем, $b_{J} \in V(Q)$. Таким образом, $b_{J}$ принадлежит $T^{\prime}$-компоненте $Y$ графа $B$, пересекающей путь $Q$. При рассмотрении $T^{\prime}$-компоненты $Y$ мы обязательно позаботимся и о всех $D$-компонентах, имеющих контакт в $Y$.
2.3.4. $Y-T^{\prime}$-компонента графа $B, Y \cap V(Q) \neq \varnothing$.

По свойству $2^{\circ}$ мы имеем $w(Y)=2$. Так как концы пути $Q-$ вершины $v_{1}, v_{2} \in V\left(T^{\prime}\right)$, то у $Y$ есть два контакта на $Q$ - пусть это $p$ (первый по пути $Q$ от $v_{1}$ ) и $r$. Значит, $W(Y)=\{p, r\}$. Пусть $N=p Q r$. Тогда именно на $N$ могут располагаться вершины, смежные с $D$-компонентами (то есть, их контакты) и вершины, смежные с путём $P_{1}$ - пусть все эти вершины образуют множество $W_{N}$.

Если $W_{N}=\varnothing$, то $Y$ - это $S$-компонента с тем же множеством контактов $W(Y)$, в этом случае мы не будем менять путь $S$, так как $Y$ удовлетворяет условиям $1^{\circ}$ и $2^{\circ}$.


Рис. 6.21: Компонента $Y$, множество компонент $K$ и их контакты.
Пусть $W_{N} \neq \varnothing$, обозначим через $p^{\prime}$ ближайшую к $p$ вершину из $W_{N}$, а через $r^{\prime}$ - ближайшую к $r$ (возможно, $p^{\prime}=r^{\prime}$ ), пусть $N^{\prime}=p^{\prime} N r^{\prime}$. Обозначим через $K$ объединение всех $D$-компонент, контакты которых лежат в множестве $W_{N}$ (то есть, на дуге $N^{\prime}$ ). Тогда $K \cup Y$ - это $S$-компонента графа $G$.

Отметим на пути $P_{1}$ все контакты $K \cup Y$ (то есть, все контакты $D$-компонент, составляющих $K$ и все вершины, смежные с $W_{N}$ ). Пусть $x$ ближайшая к $v$, а $y$ - ближайшая к $v_{1}$ отмеченная вершина (возможно, $x=y$ ). Введенные выше обозначения можно увидеть на рисунке 6.21.

Если $x=y$, то $K \cup Y-$ это $S$-компонента, не пересекающаяся с внешним циклом $C$ и имеющая три контакта: $W(K \cup Y)=W(Y) \cup\{x\}$. В этом случае мы не будем менять путь $S$, так как $Y$ удовлетворяет условиям $1^{\circ}$ и $2^{\circ}$.

Остаётся случай $x \neq y$, обозначим ху-участок пути $P_{1}$ через $L$. $B$ этом случае мы изменим путь $S$ внутри $K \cup Y \cup V(L)$, сохранив в нём вершины $x, y, p$ и $r$. Поэтому $S$-компоненты, отличные от $K \cup Y$, не изменятся. Мы проверим, что в результате изменений $K \cup Y$ распадётся на $S$-компоненты, удовлетворяющие условиям $1^{\circ}$ и $2^{\circ}$.

Пусть $F=G(K \cup Y \cup V(L))$. Если граф $F$ не двусвязен, то нетрудно понять, что все вершины из $V(L)$ лежат в одном блоке графа $F-$ назовём этот блок $F^{\prime}$. Если граф $F$ двусвязен, то положим $F^{\prime}=F$.

Продолжим разбор случаев.
2.3.4.1. $V\left(F^{\prime}\right) \cap V(B)=\varnothing$.

Очевидно, в этом случае граф $F$ недвусвязен (так как $V(F) \cap V(B)=$ $Y \neq \varnothing$ ), то есть $F^{\prime} \neq F$. В случае, когда $p^{\prime} \neq r^{\prime}$ нетрудно понять, что путь $N^{\prime}$ лежит в блоке $F^{\prime}$, то есть, $V\left(F^{\prime}\right) \cap V(B) \neq \varnothing$, противоречие. Значит, $p^{\prime}=r^{\prime}$, то есть, на дуге $N$ расположен ровно один контакт $D$-компонент. Следовательно, граф $F-F^{\prime}$ связен и отделяется от $F^{\prime}$ одной точкой сочленения $t \in V\left(F^{\prime}\right)$ (см. рисунок 6.22).


Рис. 6.22: Случай $V\left(F^{\prime}\right) \cap V(B)=\varnothing$.
По индукционому предположению мы построим в двусвязном графе $F^{\prime}$ ху-путь $P_{F}$, удовлетворяющий условиям $1^{\circ}$ и $2^{\circ}$ и содержащий вершину $t$. Заменим $x y$-участок $L$ пути $S$ на путь $P_{F}$. Новый путь $S$ содержит $x, y, t, p$ и $r$. Поэтому, $V(F) \backslash V(S)$ разбивается на $S$-компоненты.

Одна из этих $S$-компонент - это $V\left(F-F^{\prime}\right)$, у неё три контакта: $p, r$ и $t$. Эта $S$-компонента, очевидно, не пересекается с внешним циклом $C$ и, следовательно, удовлетворяет условиям $1^{\circ}$ и $2^{\circ}$.

Остальные $S$-компоненты, лежащие в $V(F)$ - это $P_{F}$-компоненты графа $F^{\prime}$. Пусть $H$ - одна из них. Тогда $H \cap V(B)=\varnothing$, следовательно, $H$ отделена точкой сочленеия $t$ от $p$ и $r$, а значит, контакты $H$, как $S$-компоненты графа $G$ и как $P_{F}$-компоненты графа $F^{\prime}$ - одни и те же, то есть, $H$ удовлетворяет условиям $1^{\circ}$ и $2^{\circ}$.
2.3.4.2. Пусть $V\left(F^{\prime}\right) \cap V(B) \neq \varnothing$.

Пусть $Z$ - внешний цикл графа $F^{\prime}$. В этом случае цикл $Z$ должен пересекать дугу $Q$ внешнего цикла графа $B$, причем легко понять, что вершины $p^{\prime}$ и $r^{\prime}$ будут лежать в $V(Z) \cap V(Q)$. Пусть $Z^{\prime}$ - это пересекающая $V(B)$ дуга цикла $Z$ с концами $p^{\prime}$ и $r^{\prime}$.

Если граф $F$ не двусвязен, то каждая компонента связности графа $F-F^{\prime}$ отделяется от $F^{\prime}$ одной точкой сочленения. Так как $V\left(F-F^{\prime}\right) \subset V(B)$, все эти точки сочленения лежат на дуге $Z^{\prime}$. Для каждой вершины $z \in V\left(Z^{\prime}\right)$ обозначим через $F_{z}$ множество, состоящее из $z$ и вершин всех компонент связности графа $F-F^{\prime}$, отделяемых вершиной $z$ от $F^{\prime}$.

Вершины из $V(F)$, смежные с $p$ или $r$, могут лежать на дуге $Z^{\prime}$ или на границах компонент связности графа $F-F^{\prime}$. Таким образом, множество $\cup_{z \in V\left(Z^{\prime}\right)} F_{z}$ содержит все вершины графа $F$, смежные с $p$ или $r$. Обозначим через $W_{p}$ множество всех вершин $z \in V\left(Z^{\prime}\right)$, для которых $F_{z}$ содержит вершину, смежную с $p$, а через $W_{r}$ - множество всех вершин $z \in V\left(Z^{\prime}\right)$, для которых $F_{z}$ содержит вершину, смежную с $r$. Обозначим через $w_{p}$ самую дальнюю от $p^{\prime}$ по пути $Z^{\prime}$ вершину из $W_{p}$ (если $W_{p}=\varnothing$, положим $w_{p}=p^{\prime}$ ), а через $w_{r}$ - самую ближнюю к $p^{\prime}$ вершину из $W_{r}$ (если $W_{r}=\varnothing$, положим $w_{r}=r^{\prime}$ ). Возможно, $w_{p}=w_{r}$. Введенные обозначения показаны на рисунке 6.23 .

Докажем, что на дуге $Z^{\prime}$ указанные вершины следуют в порядке $p^{\prime}, w_{p}, w_{r}, r^{\prime}$. Если $w_{p}=p^{\prime}$ или $w_{r}=r^{\prime}$, утверждение очевидно. Предположим, что $w_{p} \neq p^{\prime}$ и $w_{r} \neq r^{\prime}$. Тогда существует $p w_{p}$-путь, все внутренние вершины которого лежат в $F_{w_{p}}$ и $r w_{r}$-путь, все внутренние вершины которого лежат в $F_{w_{r}}$. Так как граф $G$ - плоский, то указанные пути не пересекаются, откуда немедленно следует, что вершины $p^{\prime}, w_{p}, w_{r}, r^{\prime}$ расположены на дуге $Z^{\prime}$ в указанном порядке. Следовательно, вершины множества $F_{z}$ могут быть смежны и с $p$, и с $r$ в единственном случае: $z=w_{p}=w_{r}$.

Пусть $t$ - любая из вершин, лежащую на дуге $Z^{\prime}$ между $w_{p}$ и $w_{r}$ (при $w_{p}=w_{r}$ обязательно $t=w_{r}$ ). Тогда при $z \neq t$ вершины из $F_{z}$ смежны не более, чем с одной из вершин $p$ и $r$.

По индукционному предположению мы построим в двусвязном графе $F^{\prime}$ ху-путь $P_{F}$, удовлетворяющий условиям $1^{\circ}$ и $2^{\circ}$ и содержащий



Рис. 6.23: Случай $V\left(F^{\prime}\right) \cap V(B) \neq \varnothing$.

вершину $t$. Заменим $x y$-участок $L$ пути $S$ на путь $P_{F}$. Новый путь $S$ содержит вершины $x, y, t, p$ и $r$. Поэтому, $V(F) \backslash V(S)$ разбивается на $S$-компоненты.

Пусть $S$-компонента $X$ не пересекает $V\left(F^{\prime}\right)$. Тогда $X \subset F_{z}$ для некоторой вершины $z \in V\left(Z^{\prime}\right) \cap V\left(P_{F}\right)$, а значит, $X$ имеет не более трёх контактов: $z, p$ и $r$. Очевидно, $X$ не может пересекать $V(C)$ и, следовательно, она удовлетворяет условиям $1^{\circ}$ и $2^{\circ}$.

Пусть $S$-компонента $X$ пересекает $V\left(F^{\prime}\right)$. Тогда $X$ - это объединение $P_{F}$-компоненты $X^{\prime}$ графа $F^{\prime}$ и множеств $F_{z}$ для всех вершин $z \in X^{\prime} \cap V\left(Z^{\prime}\right)$. Если $X^{\prime} \cap V\left(Z^{\prime}\right)=\varnothing$, то $X$ не смежна ни с $p$, ни с $r$ и $X=X^{\prime}$. В этом случае контакты $X$, как $S$-компоненты графа $G$ и как $P_{F}$-компоненты графа $F^{\prime}$ - одни и те же, то есть, $S$-компонента $X$ удовлетворяет условиям $1^{\circ}$ и $2^{\circ}$.

Пусть $X^{\prime} \cap V\left(Z^{\prime}\right) \neq \varnothing$. Так как $P_{F}$-компонента $X^{\prime}$ графа $F^{\prime}$ пересекает внешний цикл $Z$ графа $F^{\prime}$, то $\left|W\left(X^{\prime}\right)\right|=2$. Введем обозначения $Z_{p}^{\prime}=p^{\prime} Z^{\prime} t$ и $Z_{r}^{\prime}=r^{\prime} Z^{\prime} t$. Отметим, что путь $P_{F}$ содержит участок от $x$ до $t$ и участок от $t$ до $y$, и тем самым отделяет $Z_{p}^{\prime}$ от $Z_{r}^{\prime}$ и оба эти участка цикла $Z$ от пути $L$. Таким образом, $X^{\prime}$ может пересекать лишь одно из множеств $V\left(Z_{p}^{\prime}\right)$ и $V\left(Z_{r}^{\prime}\right)$ и не может пересекать $L$, а значит, $X^{\prime}$ не пересекает внешний цикл $C$. Не умаляя общности предположим, что $X^{\prime} \cap V\left(Z_{p}^{\prime}\right) \neq \varnothing$ и $X^{\prime} \cap V\left(Z_{r}^{\prime}\right)=\varnothing$. В этом случае $X$ не смежна с $r$, поэтому $W(X) \subset W\left(X^{\prime}\right) \cup\{p\}$, то есть, у $S$-компоненты $X$ не более трёх контактов и она удовлетворяет условиям $1^{\circ}$ и $2^{\circ}$.

Если все $D$-компоненты графа $G-$ неособые, то $u=u^{\prime}$ и построенный $v u^{\prime}$-путь $S$ удовлетворяет всем требованиям теоремы.

2.3.5. $J$ - особая $D$-компонента.


Рис. 6.24: Особая $D$-компонента.
Понятно, что тогда $b_{J}=u^{\prime} \in V(S)$. Рассмотрим граф

$$
F=G\left(J \cup V\left(L_{J}\right) \cup\left\{u^{\prime}\right\}\right)+y_{J} u^{\prime}
$$

Выше (пункт 2.2.1, см. рисунок 6.20 b ) уже объяснялось, что этот граф двусвязен. Найдём в нём $x_{J} u$-путь $N$, содержащий ребро $y_{J} u^{\prime}$ и удовлетворяющий условиям $1^{\circ}$ и $2^{\circ}$.

Если путь $N$ проходит ребро $y_{J} u^{\prime}$ в направлении от $y_{J}$ к $u^{\prime}$, то положим $P=v S x_{J} N y_{J} S u^{\prime} N u$ (см. рисунок 6.24 a ). Если путь $N$ проходит ребро $y_{J} u^{\prime}$ в направлении от $u^{\prime}$ к $y_{J}$, то положим $P=v S x_{J} N u^{\prime} S y_{J} N u$ (см. рисунок 6.24 b ). В результате мы включили в этот путь весь путь $N$, кроме ребра $y_{J} u^{\prime}$ и весь путь $S$, кроме участка $x_{J} S y_{J}=L_{J}$. Поэтому, путь $P$ содержит ребро $e$. По построению пути $P$, каждая $P$-компонента графа $G$ является либо $N$-компонентой графа $F$, либо $S$-компонентой графа $G-J-L_{J}$, следовательно, путь $P$ удовлетворяет условиям $1^{\circ}$ и $2^{\circ}$, то есть, соответствует всем требованиям теоремы.

Напрямую из этой теоремы следует гипотеза Пламмера.
Теорема 6.13. (C.Thomassen, 1983.) Пусть $G-4$-связный планарный граф, $v(G) \geq 5, v, u \in V(G)$. Тогда в $G$ существует гамильтонов путь с концами $v$ и и.

Доказательство. Пусть цикл $C$ - граница грани, содержащая $v$ и $e \in E(C)$. Пока выберем ребро $e$ произвольно с единственным условием: чтобы оно не было инцидентно $v$. Позже, при необходимости, мы конкретизируем выбор.

Построим $v u$-путь $P$, удовлетворяющий условиям $1^{\circ}$ и $2^{\circ}$ теоремы 6.12 и проходящий через ребро $e$. Пусть путь $P$ - не гамильтонов, тогда существует $P$-компонента $U$ с $w(U) \leq 3$. Так как граф $G$ - четырёхсвязный, это означает, что $V(P)=W(U)$. Из выбора ребра $e$ следует, что $v(P) \geq 3$, поэтому $w(U) \geq 3$. По условию $2^{\circ}$ теоремы 6.12 это означает, что $U$ не пересекает цикл $C$, то есть, все вершины этого цикла содержатся в $P$. Таким образом, $v(P)=v(C)=3$, то есть, $u \in V(C)$ - один из концов ребра $e$ и, одновременно - вершина, смежная с $v$.

Тогда рассмотрим грань, граница которой $C^{\prime}$ содержит $v$, но не содержит $u$. Так как $d_{G}(v) \geq 4$, такая грань очевидно есть (вершина $v$ входит хотя бы в четыре грани, и границы лишь двух из них содержат ребро $u v$ ). Выбрав $e$ как неинцидентное $v$ ребро цикла $C^{\prime}$, мы получим по теореме 6.12 , удовлетворяющий условиям $1^{\circ}$ и $2^{\circ}$ vu-путь $P^{\prime}$, для которого описанная выше ситуация невозможна, и поэтому $P^{\prime}$-компонент нет. Таким образом, мы найдём гамильтонов $v u$-путь в графе $G$.

Следствие 6.6. Пусть $G-4$-связный плоский граф, $v(G) \geq 5$. Тогда для любого ребра $e \in E(G)$ в графе $G$ существует гамильтонов иикл, содержащий $e$.

Доказательство. Пусть $e=u v \in E(G)$. По теореме 6.13 в графе есть гамильтонов $v u$-путь $P$. Понятно, что $u v \notin E(P)$. Тогда $P+u v$ - гамильтонов цикл в графе $G$, проходящий по ребру $e$.

# 6.9.3 Теорема Татта о цикле в планарном графе 

Другим следствием теоремы Томассена будет классическая теорема Татта, с помощью которой он доказывал существование гамильтонова цикла в 4 -связном планарном графе.

Теорема 6.14. (W. T. Tutte, 1956.) Пусть $G$ - связный плоский граф, ребро $e \in E(G)$ - не мост, циклы $C$ и $C^{\prime}$ - границы содержащих $e$ граней, а $e^{\prime}$ - отличное от е ребро цикла $C$. Тогда существует иикл $Z$, содержащий рёбра е и $e^{\prime}$ и удовлетворяющий следующим условиям:
$1^{\circ} w(U) \leq 3$ для любой $Z$-компоненты $U$;
$2^{\circ} w(U)=2$ для любой $Z$-компоненты $U$, содержащей хотя бы одну вершину $V(C) \cup V\left(C^{\prime}\right)$.

Доказательство. Пусть $e=v u$. Докажем теорему индукцией по $v(G)$. Отметим, что $Q=C \cup C^{\prime}-e-$ граница грани графа $G-e$, содержащая ребро $e^{\prime}$.

Базу составит случай, когда граф $G-e$ двусвязен. Применим теорему 6.12 к графу $G-e$, вершинам $v$ и $u$, циклу $Q$ и его ребру $e^{\prime}$. Мы

получим $v u$-путь $P$, удовлетворяющий условиям $1^{\circ}$ и $2^{\circ}$ и содержащий $e^{\prime}$. Добавив ребро $e$, замкнём этот путь в искомый цикл $Z$.

Пусть граф $G$ не двусвязен. Тогда рёбра $e$ и $e^{\prime}$ лежат в одном блоке графа $G$, назовём его $B$. Построим искомый цикл $Z$ для блока $B$, вершины остальных блоков либо добавятся в $Z$-компоненты $B$, не увеличив число их контактов, либо разобьются на новые $Z$-компоненты с одним контактом - отделяющей их от $B$ точкой сочленения.


Рис. 6.25: Случай, когда граф $G-e$ недвусвязен.
Пусть $G$ двусвязен, но $G-e$ недвусвязен. Тогда граф $G$ имеет разделяющее множество $\{z, e\}$ (где $z \in V(G)$ ), а значит, граф $G-e$ имеет точку сочленения $z$, разбивающую его на два графа $G_{1}$ и $G_{2}$, где

$$
V\left(G_{1}\right) \cap V\left(G_{2}\right)=\{z\}, \quad V\left(G_{1}\right) \ni u, \quad V\left(G_{2}\right) \ni v
$$

Пусть $G_{1}^{\prime}=G_{1}+u z, G_{2}^{\prime}=G_{2}+v z$. Не умаляя общности будем считать, что $e^{\prime} \in E\left(G_{1}^{\prime}\right)$. Поскольку $e$ - общее ребро циклов $C$ и $C^{\prime}$, а вершина $z$ разделяет в $G-e$ концы ребра $e$, то $z$ - также общая вершина циклов $C$ и $C^{\prime}$.

В графе $G-e$ грани с границами $C$ и $C^{\prime}$ склеиваются в одну грань с границей $K=C+C^{\prime}-e$. Изобразим новые рёбра $u z$ и $v z$ как диагонали грани $K$. В результате в графе $G_{1}^{\prime}$ получатся две грани с границами $C_{1}$ и $C_{1}^{\prime}$ (имеющими общее ребро $u z$ ), а в графе $G_{2}^{\prime}$ - грани с границами $C_{2}$ и $C_{2}^{\prime}$ (имеющие общее ребро $v z$ ). Объединение этих четырёх граней содержит грань $K$, а следовательно, и ребро $e^{\prime}$ (см. рисунок 6.25).

По индукционному предположению, существуют удовлетворяющие условиям $1^{\circ}$ и $2^{\circ}$ цикл $Z_{1}$ в графе $G_{1}^{\prime}$, проходящий по $u z$ и $e^{\prime}$ и цикл $Z_{2}$ в графе $G_{2}^{\prime}$, проходящий по $v z$. Положим $Z=\left(Z_{1}-u z\right)+e+\left(Z_{2}-v z\right)$. Это простой цикл, содержащий ребро $e$ и вершины $u, v, z$. Поэтому, любая $Z$-компонента $U$ содержится либо в $V\left(G_{1}\right)$, либо в $V\left(G_{2}\right)$. Мы рассмотрим первый случай, второй аналогичен. Тогда множество контактов $U$, как $Z$-компоненты графа $G$ и как $Z_{1}$-компоненты графа $G_{1}^{\prime}$ - одно и то же. Следовательно, $w(U) \leq 3$. Если $U$ содержит вершину одного из

циклов $C$ или $C^{\prime}$, то она содержит вершину одного из циклов $C_{1}$ или $C_{1}^{\prime}$ и следовательно, $w(U)=2$.

Из теоремы Татта следует более сильное утверждение о гамильтоновых циклах в 4 -связном планарном графе, чем следствие 6.6. Доказательство следующей теоремы очень похоже на вывод гипотезы Пламмера из теоремы Томассена.

Теорема 6.15. (W.T.Tutte, 1956.) Пусть $G-4$-связный плоский граф без кратных рёбер, $v(G) \geq 5$. Тогда для любых двух рёбер е и $e^{\prime}$, входящих в границу одной грани, существует гамильтонов цикл, содержащий е и $e^{\prime}$.

Доказательство. Пусть цикл $K_{1}$ - граница грани, содержащей оба ребра $e$ и $e^{\prime}$, а цикл $K_{2}$ - граница второй грани, содержащей $e$. По теореме 6.14 , существует цикл $Z$, проходящий по рёбрам $e$ и $e^{\prime}$, удовлетворяющий условиям $1^{\circ}$ и $2^{\circ}$.

Предположим, что цикл $Z$ - не гамильтонов, тогда существует $Z$-компонента $U$. По теореме 6.14 выполняется условие $w(U) \leq 3$. Однако, из четырёхсвязности графа $G$ следует, что $W(U)$ не может быть разделяющим множеством графа $G$. Следовательно, $V(Z)=W(U)$ и $Z$-компонента $U$ - единственная, то есть, содержит все не входящие в цикл $Z$ вершины графа. Поскольку циклов из двух вершин в графе $G$ нет, то $v(Z)=w(U)=3$. Следовательно, по условию $2^{\circ}$ теоремы 6.14 мы имеем $V(Z) \supset\left(V\left(K_{1}\right) \cup V\left(K_{2}\right)\right)$. Тогда $v\left(K_{1}\right)=v\left(K_{2}\right)=3$ и $V\left(K_{1}\right)=V\left(K_{2}\right)=V(Z)$, то есть, все три цикла совпадают. Так как границы двух содержащих $e$ граней совпадают, то очевидно $G=Z$ и граф $G$ гамильтонов.

А что же можно сказать о циклах в кубических планарных графах? Пусть не гамильтоновых (гипотеза Тэйта выше уже опровергнута), но хотя бы достаточно длинных?

Напомним, что граф $G$ является 4 -циклически-связным, если никакое множество рёбер $F \subset E(G),|F| \leq 3$, не разделяет $E(G-F)$, то есть, все рёбра графа $G-F$ соединяют вершины одной компоненты связности, а остальные компоненты связности этого графа - изолированные вершины.

Теорема 6.16. Пусть $G$ - вершинно трёхсвязный, 4-циклически-связный кубический плоский граф, $v(G) \geq 3$. Тогда для любых двух рёбер е и $e^{\prime}$, входящих в границу одной грани, существует простой цикл длины не менее $\frac{3}{4} \cdot v(G)$, содержащий е и $e^{\prime}$.

Доказательство. Пусть цикл $K_{1}$ - граница грани, содержащей оба ребра $e$ и $e^{\prime}$, а цикл $K_{2}$ - граница второй грани, содержащей $e$. По теореме 6.14 существует цикл $Z$, проходящий по рёбрам $e$ и $e^{\prime}$, удовлетворяющий условиям $1^{\circ}$ и $2^{\circ}$. Очевидно, $v(Z) \geq 3$.

Предположим, что цикл $Z-$ не гамильтонов, тогда существует $Z$-компонента $U$. По теореме 6.14 мы имеем $w(U) \leq 3$. Однако, из трёхсвязности графа $G$ и условия $v(Z) \geq 3$ следует, что $w(U)=3$. Пусть $W(U)=\left\{w_{1}, w_{2}, w_{3}\right\}$. Так как $d_{G}\left(w_{i}\right)=3$, то у каждой вершины $w_{i}$ существует ровно одно ребро $f_{i}$, не входящее в цикл $Z(i \in[1 . .3])$. Отметим, что множество рёбер $F=\left\{f_{1}, f_{2}, f_{3}\right\}$ отделяет $U$ от $V(Z)$ и, так как граф $G$ является 4 -циклически-связным а $v(G) \geq 3$, остаётся единственная возможность: $|U|=1$.

Таким образом, все компоненты связности графа $G-Z$ - изолированные вершины. Каждая изолированная вершина $u$ графа $G-Z$ смежна с тремя вершинами цикла $Z$, а каждая вершина цикла $Z$ смежна не более, чем с одной вершиной, не входящей в $Z$. Поэтому в цикле $Z$ не менее чем $\frac{3 v(G)}{4}$ вершин.

# 6.10 $К$-планарные графы 

В этом разделе мы рассмотрим графы, которые могут быть изображены на плоскости с ограничением на количество пересечений каждого ребра с другими.

Определение 6.11. Граф $G$ назовём $k$-планарным, если его можно изобразить на плоскости так, чтобы каждое ребро пересекало не более чем $k$ других.

Как известно, в планарном графе $G$ без петель и кратных рёбер, $e(G) \leq 3(v(G)-2)$, причём оценка точная и достигается для любой триангуляции. Для $k \leq 4$ и $k$-планарного графа $G$ мы докажем оценку $e(G) \leq(k+3)(v(G)-2)$. Серии примеров покажут, что эта оценка точна для $k=1$ и $k=2$.

Теорема 6.17. (J. Pach, G. Toth, 1997.) Пусть $k \leq 4$. Тогда для $k$-планарного графа $G$ без петель и кратных рёбер выполняется неравенство $e(G) \leq(k+3)(v(G)-2)$.

Доказательство. Мы будем рассматривать $k$-планарный граф $G$ как его изображение на плоскости с минимальным количеством пересечений рёбер.

Назовём два кратных ребра графа параллельными, если хотя в одной из областей относительно образованного этими рёбрами цикла нет вершин графа.

Для удобства доказательства мы разрешим в графе $G$ кратные рёбра, но запретим параллельные рёбра.

Предположим, что утверждение теоремы неверно. Рассмотрим контрпример с минимальным количеством точек пересечения рёбер - пусть это $k$-планарный граф $G$.

Зафиксируем максимальный по количеству рёбер остовный плоский подграф $M$ графа $G$. Так как $v(M) \geq 3$, то легко видеть, что в границе каждой грани графа $M$ хотя бы три вершины.

Все рёбра из $F=E(G) \backslash E(M)$ пересекают рёбра графа $M$. Пусть $f \in F$. Назовём полуребром часть ребра $f$ от вершины до ближайшей точки пересечения с ребром из $M$. Таким образом, каждое ребро множества $F$ имеет два непересекающихся полуребра. Для любой грани $d$ графа $M$ обозначим через $h(d)$ количество полурёбер, выходящих из вершин грани $d$ вовнутрь грани $d$ (будем называть их полурёбрами грани $d$ ).

Начнём с нескольких лемм. Напомним, что во всем доказательстве теоремы $k \in[0 . .4]$.

Лемма 6.15. Пусть $d$ - грань графа $M$ со связной границей. Пусть участок ребра $f \in F$ лежит внутри грани d. Тогда кониы этого участка не могут принадлежать одному ребру границы $d$.

Доказательство. Предположим противное. Назовём зацеплением ребра $f \in F$ за ребро $e \in B(d)$ участок ребра $f$, лежащий внутри грани $d$, с концами на $e$. Пусть $X_{1} Y_{1}, \ldots, X_{n} Y_{n}$ - все зацепления за ребро $e=x y$, причем $X_{i}$ - конец, ближний к $x$, а $Y_{i}$ - конец, ближний к $y$. Рассмотрим минимальное по включению зацепление $X_{j} Y_{j}$. Пусть оно образовано ребром $f \in F, F_{j}$. Обозначим через $F_{j}$ и $S_{j}$ участки с концами $X_{j}$ и $Y_{j}$ ребер $f$ и $e$, соответственно. Внутри замкнутой ломаной, образованной $S_{j}$ и $F_{j}$, нет вершин графа $G$ (это часть грани $d$ ). Пусть ребро $f^{\prime}$ пересекает $S_{j}$. Если при этом $f^{\prime}$ не пересекает $F_{j}$, то $f^{\prime}$ дважды пересекает ребро $e$ между $X_{j}$ и $Y_{j}$ и образует зацепление, что противоречит минимальности $X_{j} Y_{j}$. Таким образом, все рёбра, пересекающие $S_{j}$, пересекают и $F_{j}$.

Нарисуем путь $S_{j}^{\prime}$ вдоль ребра $e$ (очень близко к этому ребру) вне грани $d$ (см. рисунок 6.26) и заменим участок ребра $f$ между концами $S_{j}^{\prime}$ на $S_{j}^{\prime}$. По доказанному выше, в результате замены новых пересечений не прибавилось, но исчезли 2 пересечения ребер $f$ и $e$. Мы получили изображение графа $G$ с меньшим числом пересечений, противоречие.



Рис. 6.26: Зацепление.

Следствие 6.7. Пусть $d$ - грань графа $M$ со связной границей, а ребро $f \in F$ содержит полуребро грани $d$. Тогда $f$ не может пересекать ребро грани d, имеющее с $f$ общую вершину.

Утверждение непосредственно следует из леммы 6.15 .
Лемма 6.16. Пусть $d$ - грань графа $M$ со связной границей $B(d)$, причем $b(d) \geq 3$. Тогда $h(d) \leq(b(d)-2)(k+1)-1$.

Доказательство. Начнем со случая $b(d)=3$. В этом случае очевидно, что $B(d)$ - треугольник на различных вершинах, которые мы обозначим через $a, b$ и $c$. Пусть из этих вершин выходит $h_{a}, h_{b}$ и $h_{c}$ полурёбер в грани $d$, соответственно. Нам нужно доказать, что $h(d)=h_{a}+h_{b}+h_{c} \leq k$.

Отметим, что по следствию 6.7 любое полуребро грани $d$, выходящее из вершины $a$, пересекает ребро $b c$. Аналогично для остальных двух вершин. Поэтому, $h_{a} \leq k, h_{b} \leq k$ и $h_{c} \leq k$.

Из сказанного выше следует, что любые два полуребра грани $d$, выходящие из разных вершин, пересекаются. Поэтому $n p u h_{a}+h_{b} \geq k$ немедленно получаем $h_{c}=0$ (полуребро грани $d$, выходящее из $c$, в этом случае пересечёт $k$ выходящих из $a$ и $b$ полурёбер и ребро $a b$, что невозможно). Таким образом, случай $k=1$ можно считать рассмотренным, а в остальных случаях ограничим перебор условиями $h_{a}<k, h_{b}<k$ и $h_{c}<k$.

Пусть $h_{a}+h_{b}+h_{c} \geq k+1, h_{a} \geq h_{b} \geq h_{c}$. Если $h_{c} \geq 2$, то $h_{a}+h_{b} \geq 4 \geq k$ и мы получаем, что $h_{c}=0$, противоречие. Значит, $h_{c} \leq 1$, откуда опять же $h_{a}+h_{b} \geq k$ и $h_{c}=0$. Таким образом, $h_{a}+h_{b} \geq k+1$. Так как $h_{a}, h_{b}<k$, мы имеем $h_{a} \geq h_{b} \geq 2$, следовательно, $k \geq 3$.

Отметим, что $h_{a} \geq \frac{k+1}{2}$, что при $k \leq 4$ означает $h_{a} \geq k-1$. Тогда рассмотрим два полуребра, выходящих из вершины $b$, пусть $e$ и $e^{\prime}-$ содержащие их рёбра. Оба ребра $e$ и $e^{\prime}$ пересекают ребро $a c$ и $k-1$ полуребер, выходящих из $a$. Поэтому $e$ и $e^{\prime}$ не пересекают рёбер графа $M-a c$ и друг друга, а следовательно, $M^{\prime}=(M-a c)+e+e^{\prime}-$ плоский подграф

графа $G$ и $e\left(M^{\prime}\right)=e(M)+1$. Противоречие с максимальностью $M$. В случае $b(d)=3$ лемма доказана.

Пусть теперь $b(d)=s \geq 4$ и для граней с меньшим размером границы утверждение уже доказано. Как и в лемме 6.7 , мысленно раздвоим каждое внутреннее ребро грани $d$, превратив $B(d)$ в цикл $Z$, проходящий каждое граничное ребро грани $d$ ровно один раз и каждое внутреннее ребро - ровно два раза, грань $d$ будет внутренней областью цикла $Z$. В цикле $Z$, как нам известно, ровно $s$ рёбер, пусть $Z=a_{1} a_{2} \ldots a_{s}$ (среди этих вершин, возможно, есть совпадающие, но любые две соседние вершины обязательно различны). Рассмотрим два случая.

1. Полуребро, выходящее из вершины $a_{j}$, пересекает ребро $a_{i} a_{i+1}$ в точке $P$ и выполняется одно из двух условий:

- на участке ребра от $a_{i}$ до $P$ нет точек пересечения и $a_{j} \neq a_{i-1}$;
- на участке ребра от $a_{i+1}$ до $P$ нет точек пересечения и $a_{j} \neq a_{i+2}$.


Рис. 6.27: Рёбра $e$ и $f$.

Рассмотрим первый случай (второй аналогичен). Пусть $e$ - ребро, выходящее из $a_{j}$ и проходящее через точку $P$. Тогда рассмотрим граф $G^{\prime}=G-e+f$, в котором ребро $f=a_{j} a_{i}$ проведено сначала вдоль ребра $e$ (почти до точки $P$ ), потом вдоль ребра $a_{i} a_{i+1}$ в грани $d$ (см. рис. 6.27). Это можно сделать так, чтобы новое ребро $f$ пересекло лишь те рёбра, что пересекают полуребро ребра $e$ от $a_{j}$ до $P$, то есть, не более $k$ рёбер. Поэтому, граф $G^{\prime}$ является $k$-планарным. Новое ребро делит грань графа $M$ на две грани $d_{1}$ и $d_{2}$, в границе каждой из которых не менее трёх вершин (по следствию 6.7 мы имеем $a_{j} \neq a_{i}$ и $a_{j} \neq a_{i+1}$ ), поэтому, в графе $G^{\prime}$ нет ребра, параллельного $f$.

Новое ребро $f$ пересекает лишь те рёбра, что пересекает удаленное ребро $e$, но не все: $f$ не пересекает $a_{i} a_{i+1}$. Поэтому, число пересечений в изображении $G^{\prime}$ строго меньше, чем в $G$. Так как $e\left(G^{\prime}\right)=e(G)$, мы

получили контрпример с меньшим числом точек пересечения, что противоречит выбору $G$.
1. Нет полуребра грани d, удовлетворяющего условию $1^{\circ}$ или условию $2^{\circ}$.
Назовём ребро цикла $Z$ пустым, если оно не пересекает полурёбер грани $d$ и непустым в противном случае. Каждое полуребро грани $d$ пересекает одно из $s$ рёбер цикла $Z$. Поэтому, если хотя бы два из $s$ ребер цикла $Z$ - пустые, то $h(d) \leq(s-2) k<(s-2)(k+1)-1$. Значит, не более чем одно из рёбер цикла $Z$ - пустое. Следовательно, существуют $s-1 \geq 3$ непустых ребра цикла $Z$ подряд.

Пусть $a_{i} a_{i+1}$ - непустое ребро. Тогда ближайшая к $a_{i}$ точка пересечения - с полуребром $e_{i-1}^{+}$, выходящим из вершины $a_{i-1}$, а ближайшая к $a_{i+1}$ точка пересечения - с полуребром $e_{i+2}^{-}$, выходящим из вершины $a_{i+2}$. Так как рёбра с общим концом по следствию 6.7 не пересекаются, из четырех вершин $a_{i-1}, a_{i}, a_{i+1}$ и $a_{i+2}$ могут совпадать только $a_{i-1}$ и $a_{i+2}$.

Предположим, что вершина $a_{i-1}$ совпадает с $a_{i+2}$. Тогда внутри грани $d$ можно провести ребро-петлю в вершине $a_{i-1}=a_{i+2}$, не пересекающее других рёбер и отделяющее $\left\{a_{i}, a_{i+1}\right\}$ от остальных вершин цикла $Z$ (эта петля - "диагональ" $a_{i-1} a_{i+2}$ цикла $Z$ ). Следовательно, вершина $a_{i}$ не совпадает с $a_{i+3}$. Эта же петля отделяет ребро $a_{i+1} a_{i+2}$ от ребра $a_{i-2} a_{i-1}$, а значит, эти рёбра различны.

Пусть $a_{i-1} a_{i}, a_{i} a_{i+1}$ и $a_{i+1} a_{i+2}$ - три последовательных непустых ребра грани $d$. Нам хочется, чтобы вершины $a_{i-1}$ и $a_{i+2}$ не совпадали. Предположим, противное, пусть вершины $a_{i-1}$ и $a_{i+2}$ совпадают. Так как соседние вершины грани совпадать не могут, легко понять, что $s \geq 5$, а ребра $a_{i-2} a_{i-1}$ и $a_{i+1} a_{i+2}$ различны. Понятно, что хотя бы одно из них непустое. Пусть это ребро $a_{i+1} a_{i+2}$. Как сказано выше, тогда вершины $a_{i}$ и $a_{i+3}$ не совпадают.

Итак, теперь можно считать, что рёбра $a_{1} a_{2}, a_{2} a_{3}$ и $a_{3} a_{4}$ - непустые, а все вершины $a_{1}, a_{2}, a_{3}, a_{4}$ - различны, см. рисунок 6.28 . Тогда полуребро $e_{3}^{+}$пересекает $a_{3} a_{4}, e_{1}^{+}, e_{3}^{+}$и $e_{4}^{-}$(это 4 различных ребра, так как вершины $a_{1}, a_{2}, a_{3}, a_{4}$ различны), а полуребро $e_{5}^{-}$пересекает $a_{3} a_{4}$, $e_{6}^{-}, e_{4}^{-}$и $e_{3}^{+}$(опять же, это 4 различных ребра). Такое возможно лишь при $k=4$ и в этом случае рёбра $f_{2}$ и $f_{5}$ графа $G$, содержащие полурёбра $e_{2}^{+}$и $e_{5}^{-}$соответственно, не пересекают рёбер графа $G$ вне грани $d$ и друг друга. Тогда $M^{\prime}=\left(M-a_{3} a_{4}\right)+f_{2}+f_{5}-$ плоский подграф графа $G$ и $e\left(M^{\prime}\right)>e(M)$, что невозможно.

Лемма 6.17. Пусть $d-$ грань графа $M$, причём $t(d) \geq 1$. Тогда $h(d) \leq(k+1) \cdot t(d)-1$.



Рис. 6.28: Рёбра $e_{2}^{+}$и $e_{5}^{-}$.

Доказательство. Если граница грани несвязна, то $t(d) \geq b(d)$ по лемме 6.7. Так как каждое ребро границы пересекает не более чем $k$ полурёбер грани $d$, мы имеем

$$
h(d) \leq k \cdot b(d) \leq k \cdot t(d) \leq(k+1) \cdot t(d)-1
$$

Пусть $B(d)$ - связный граф. Тогда $t(d)=b(d)-2$ по лемме 6.7 и по лемме 6.16 мы имеем

$$
h(d) \leq(b(d)-2)(k+1)-1=(k+1) t(d)-1
$$

Теперь вернемся к доказательству теоремы. Пусть $d_{1}, \ldots, d_{n}$ - все грани $M$. По построению, в границе каждой грани хотя бы три вершины, следовательно $t\left(d_{i}\right) \geq 1$ для всех $i \in[1 . . n]$. Триангулируем граф $M$, в результате получится триангуляция $T$ с $e(T)=3 v(M)-6=3 v(G)-6$. Грань $d_{i}$ в результате разбивается на $t\left(d_{i}\right)$ треугольников, для чего нужно провести не менее, чем $t\left(d_{i}\right)-1$ рёбер (на самом деле, $t\left(d_{i}\right)-2$ плюс количество компонент связности графа $B\left(d_{i}\right)$.) Отметим, что в силу формулы Эйлера общее количество граней триангуляции, очевидно, равно $2 v(G)-4$ :

$$
\sum_{i=1}^{n} t\left(d_{i}\right)=2 v(G)-4
$$

В силу леммы 6.7 мы имеем

$$
e(M) \leq 3 v(G)-6-\sum_{i=1}^{n}\left(t\left(d_{i}\right)-1\right)
$$

Каждое ребро из $E(G) \backslash E(M)$ содержит два полуребра, поэтому по лемме 6.17

$$
e(G)-e(M)=\frac{1}{2} \sum_{i=1}^{n} h\left(d_{i}\right) \leq \frac{1}{2} \sum_{i=1}^{n}\left((k+1) \cdot t\left(d_{i}\right)-1\right)
$$

Так как $t\left(d_{i}\right) \geq 1$, из формул (6.4)-(6.6) следует

$$
\begin{aligned}
& e(G) \leq 3 v(G)-6+\frac{1}{2} \sum_{i=1}^{n}\left((k-1) \cdot t\left(d_{i}\right)+1\right)) \leq \\
& \leq 3(v(G)-2)+\frac{k}{2} \sum_{i=1}^{n} t\left(d_{i}\right)=(k+3)(v(G)-2)
\end{aligned}
$$

что и требовалось доказать.
Что интересно, оценка из теоремы 6.17 для $k=1$ и $k=2$ точна. Более того, серии примеров графов, подтверждающие её точность, имеют много общего с триангуляциями, на которых достигается максимум количества рёбер в планарных графах без петель и кратных рёбер.

Для $k=1$ пусть $G_{n}^{\prime}$ - плоский граф на $n$ вершинах, все грани которого - четырёхугольники. Несложно построить такие графы для всех достаточно больших $n$. Количество рёбер $e\left(G_{n}^{\prime}\right)$ такого графа равно удвоенному количеству граней $f\left(G_{n}^{\prime}\right)$, откуда по формуле Эйлера получаем $f\left(G_{n}^{\prime}\right)=n-2, e\left(G_{n}^{\prime}\right)=2 n-4$. Проведём в каждой грани графа $G_{n}^{\prime}$ две диагонали и получим серию 1-планарных графов $G_{n}$ с $e\left(G_{n}\right)=2 n-4+2(n-2)=4(n-2)$, подтвердив тем самым точность оценки.

Для $k=2$ мы построим серию плоских графов $H_{n}^{\prime}$ на $n$ вершинах, все грани которых - пятиугольники (такие графы существуют при всех достаточно больших $n=3 m+2$ ). Тогда

$$
f\left(H_{n}^{\prime}\right)=\frac{2(n-2)}{3}=2 m, \quad e\left(H_{n}^{\prime}\right)=\frac{5(n-2)}{3}=5 m
$$

Получим 2-планарный граф $H_{n}$, проведя в $H_{n}^{\prime}$ все 5 диагоналей каждой грани. Таким образом, $e\left(H_{n}\right)=e\left(H_{n}^{\prime}\right)+5 f\left(H_{n}^{\prime}\right)=5(n-2)$ и точность оценки из теоремы 6.17 доказана.

Для больших $k$ максимальное возможное число рёбер в $k$-планарном графе $G$ на $n$ вершинах имеет порядок $c \cdot \sqrt{k} \cdot n$.

# 6.11 Комментарии 

В этой главе рассматриваются задачи так или иначе связанные с изображением графов на плоскости (или, что то же самое, на сфере). Сразу подчеркну, что меньше всего автора интересуют топологические и прочие технические подробности, все это подразумевается верным. На мой взгляд, избыток топологических подробностей лишь отвекает внимание от главного - графского и комбинаторного - содержания. Более топологический взгляд на планарные графы можно найти, например, в книге Дистеля [8], где есть много интересного материала по планарности в несколько другом изложении.

Начинается глава с формулы Эйлера и ее очевидных следствий, а затем продолжается весьма неочевидным утверждением - теоремой Куратовского. Данное в книге доказательство основано на идеях Ю. Макарычева, отмечу большой вклад в это доказательство А. Б. Скопенкова. Приведенное доказательство совсем нетривиально, но его все-таки может постараться понять не только специалист в теории графов.

Все результаты начала этой главы - классические, доказаны в 30 -е годы XX века или даже раньше. Несложным следствием теоремы Куратовского и теории разбиения двусвязного графа является изложенная в нашей терминологии теорема Маклейна - еще один критерий планарности. Оригинальную версию теоремы можно найти в [24].

Глава продолжается еще одной классической теоремой - теоремой Уитни о том, что любые два изображения трёхсвязного планарного графа изоморфны. В качестве леммы к теореме Уитни доказывается важное свойство трёхсвязных планарных графов - множество граней изображения такого графа есть в точности множество всех неразделяющих инжуцированных циклов. Это важное свойство понадобится и дальше, в главе Циклическое пространство.

Отмечу, что мы придерживаемся не совсем классического определения двойственного графа для несвяного графа в разделе 6.5 - объединяем двойственные графы его компонент, считая множества их вершин непересекающимися. Такое определение удобнее применять при работе с циклическим пространством, потоковым и хроматическим многочленом.

В разделе 6.6 определяются плоские триангуляции и доказывается классическое утверждение о планарных графах - теорема о 3 красках, говорящая что триангуляция имеет правильную раскраску в 3 цвета, если и только если все степени ее вершин четны. С 1898 года, когда Хивуд впервые высказал соответствующую гипотезу, долгие годы этот факт оставался недоказанным. Удивительно, что, похоже, первое доказательство этой теоремы было опубликовано в книге Головиной и Яглома [49]

из замечательной серии "Популярные лекции по математики". С тех пор стало известно много различных доказательств теоремы. В частности, теорема о 3 красках может быть легко доказана с помощью двойственности потоков и раскрасок (задача ??). Тцай и Вест [37] доказали обобщение теоремы 6.5 на почти триангуляиии - графы, у которых все грани, кроме одной - треугольники (см. задачу ??).

Нельзя избежать разговора о самом знаменитом утверждении в теории графов - гипотезе 4 красок (4СС). Как верно написал Харари в своей замечательной книге [63], ее можно называть болезнью 4 красок это весьма заразное заболевание, нередко передающееся от одного математика другому, особенно от научного руководителя ученику. Я также не избежал (как теперь кажется, чрезмерного) интереса к этой проблеме, и так и не придумал ее нормального доказательства (то есть такого, которое не будет, ну или почти не будет использовать компьютер). Возможно, когда-нибудь появится доказательство, которое можно будет записать в книге по теории графов. А пока мы можем лишь обсудить подход к ее решению. Начинается рассказ с постановки задачи и теоремы об эквивалентности Тэйта. В свое время Тэйт решил теорему ошибочно - он предполагал очевидным, что любой трёхсвязный кубический планарный граф имеет гамильтонов цикл. Вскоре математики поняли, что это не очевидно, но лишь в 1946 году Татт построил контрпример. Красивый метод Гринберга построения негамильтоновых кубических планарных графов также обсуждается в этой главе.

Итак, Тэйт не доказал 4CC, но придумал метод, который используют современные доказательства - он доказал, что 4СС эквивалентна существованию Тэйтовой раскраске у любой плоской триангуляции (то есть, такой раскраски рёбер в 3 цвета, где рёбра каждой грани-треугольника покрашены в разные цвета). В доказательствах теоремы 4 красок приводится список "неизбежных конфигураций", которые непременно есть в каждой триангуляции, и показывается, что для каждой из этих конфигураций вопрос о Тэйтовой раскраске триангуляций содержащих такую конфигурацию, можно свести к меньшим триангуляциям ("редуцируемость конфигураций"). Самые простая конфигурация, редуцироемость которой очевидна - вершина степени 3. Не слишком сложен и случай вершины степени 4 , однако же тут есть что доказывать, и доказательство редуцируемости вершины степени 4 приведено в книге. Разговор о Тэйтовых раскрасках будет продолжен в разделе 13.4.1, где с помощью дискриминанта графа будет предложен способ считать количество таких раскрасок.

Далее мы делаем поворот в сторону современной теории планарных графов и говорим о списочных раскрасках. Это значит - о теоремах То-

массена. Одна из них, о 5-списочной раскрашиваемости, имеет простое и элегантное доказательство и ее можно найти во многих книгах - например, в [8]. А вот вторая - о списочной 3-раскрашиваемости планарного графа обхвата не менее 5 , весьма сложна. Само утверждение - простое и понятное, а вот доказательство содержит весьма длинный разбор случаев, к тому же основанный на непростых идеях. Оригинал теоремы в статье [35], которая называется "A short list color proof of Grötzsch's theorem" действительно достаточно коротко доказан, но и нашу версию с дополнительными подробностями понять не так просто. И все же, это утверждение сильнее теоремы Грёцша и имеет более простое доказательство.

Следующие весьма непростые теоремы о планарных графах, включенные в эту главу - это теоремы Татта и Томассена о путях и циклах в планарном графе, в частности, знаменитая теорема Татта 6.15 о том, что 4-связный планарный граф имеет гамильтонов цикл. Основной теоремой в нашем изложении является теорема Томассена 6.12 о пути в двусвязном планарном графе с заданными концами, из которой следуют и обе теоремы Татта, и гипотеза Пламмера. Отмечу, что доказательство Томассена [36] гораздо короче доказательства Татта [39] и, опять же, дает более сильный результат. Однако, я не смог понять один из переходов в статье Томассена (точнее, на ошибку в моем понимании обратил внимание мой студент А. Глазман, когда я это доказательство рассказывал). На мой взгляд, в доказательстве из [36] действительно содержится (нефатальная) ошибка. Однако, исправить это место с помощью идей Томассена мне не удалось, на помощь пришли идеи Татта из доказательства его теоремы [39]. Надеюсь, интересующимся теорией графов сильным читателям будет интересно прочитать полученное в итоге такого синтеза доказательство теоремы 6.12. А условия теорем Томассена и Татта может понять любой.

Завершает главу современная теорема Паха и Тота [28] об оценке числа рёбер в $k$-планарных графах (графах, которые можно изобразить не более чем с $k$ пересечениями на ребре). Отмечу, что случай $k=1$ может быть доказан намного проще, см. подсказку к пункту $a$ задачи ??.



# Глава 7 

## Циклическое пространство графа

В этой главе нам понадобится знание о том, что такое линейное пространство. Мы будем использовать линейные пространства над полем $\mathbb{F}_{2}=\{0,1\}$. Пусть $G$-граф, $n=v(G), m=e(G), E(G)=\left\{e_{1}, \ldots, e_{m}\right\}$.

Определение 7.1. Рёберное пространство $\mathcal{E}(G)$ графа $G$ - это линейное пространство над полем $\mathbb{F}_{2}$. Элементами $\mathcal{E}(G)$ будут подмножества $E(G)$, а сложение элементов $E_{1}, E_{2} \in \mathcal{E}(G)$ - их симметрическая разность $E_{1} \triangle E_{2}$.

Легко понять, что $\mathcal{E}(G)$ - линейное пространство над $\mathbb{F}_{2}$ с базисом $\left\{e_{1}\right\}, \ldots,\left\{e_{m}\right\}$. Следовательно, $\operatorname{dim} \mathcal{E}(G)=m$.

Определение 7.2. 1) Определим скалярное произведение $\left\langle E, E^{\prime}\right\rangle$ элементов $E, E^{\prime} \in \mathcal{E}(G)$, как остаток от деления $\left|E \cap E^{\prime}\right|$ на 2.
1) Определим ортоганальное дополнение подпространства $\mathcal{F}$ рёберного пространства $\mathcal{E}(G)$ стандартным образом:

$$
\mathcal{F}^{\perp}=\{E \in \mathcal{E}(G) \mid\langle E, F\rangle=0 \text { для всех } F \in \mathcal{F}\}
$$

Замечание 7.1. 1) Можно считать, что элемент $F \in E(G)$ представляется в виде $F=\sum_{i=1}^{m} \lambda_{i} e_{i}$, где коэффициент $\lambda_{i} \in \mathbb{F}_{2}$ равен 1 тогда и только тогда, когда $e_{i} \in F$.
1) Тогда если $E=\sum_{i=1}^{m} \lambda_{i} e_{i}$, а $E^{\prime}=\sum_{i=1}^{m} \lambda_{i}^{\prime} e_{i}$, то $\left\langle E, E^{\prime}\right\rangle=\sum_{i=1}^{m} \lambda_{i} \lambda_{i}^{\prime}$, то есть, определённое выше скалярное произведение есть скалярное произведение в общепринятом смысле этого термина.
2) В нашем случае для любого четного множества рёбер $F$ мы имеем $\langle F, F\rangle=0$. Поэтому мы не можем пользоваться свойствами вещественного скалярного произведения, доказательство которых использует невы-

рожденность. В частности, для подпространства $\mathcal{F}$ рёберного пространства $\mathcal{E}(G)$ нельзя считать верными привычные нам свойства $\mathcal{F}^{\perp \perp}=\mathcal{F}$ и $\mathcal{F}^{\perp} \oplus \mathcal{F}=\mathcal{E}(G)$.

Определение 7.3. Циклическое пространство $\mathcal{C}(G)$ графа $G$ - это подпространство $\mathcal{E}(G)$, порожденное рёберными множествами простых циклов.

В циклическом пространстве и его свойствах заключено много информации о графе.

Лемма 7.1. Для множества $F \in \mathcal{E}(G)$ следующие три утверждения равносильны.
$1^{\circ} F \in \mathcal{C}(G)$.
$2^{\circ}$ В графе $G[F]$ степени всех вершин четны.
$3^{\circ} F$ является объединением рёберных множеств нескольких простых циклов, не имеющих общих рёбер.

Доказательство. Для пустого множества рёбер все три условия выполняются. Далее пусть $F \neq \varnothing$.
$1^{\circ} \Rightarrow 2^{\circ}$. Вспомним, что $\mathcal{C}(G)$ порождено реберными множествами циклов, а у каждого цикла степени всех вершин равны 2. Взятие симметрической разности рёберных множеств, очевидно, сохраняет четность степеней.
$2^{\circ} \Rightarrow 3^{\circ}$. Если степени всех вершин графа $G(F)$ четны, то он содержит простой цикл. Удалим рёбра этого цикла и продолжим аналогичные рассуждения до тех пор, пока не останется пустое множество рёбер.
$3^{\circ} \Rightarrow 1^{\circ}$. Очевидно.
Лемма 7.2. Рёберные множества индуцированных циклов графа $G$ порождают циклическое пространство $\mathcal{C}(G)$.

Доказательство. Так как пространство $\mathcal{C}(G)$ порождено множествами рёбер простых циклов, достаточно доказать, что множество рёбер простого цикла $C$ порождено множествами рёбер индуцированных циклов. Это несложно сделать индукцией по количеству рёбер.

Пусть $C$ - не индуцированный цикл. Тогда $C$ имеет диагональ $x y$, которая разбивает его на два меньших цикла $C_{1}$ и $C_{2}$. Следовательно, $E(C)=E\left(C_{1}\right) \triangle E\left(C_{2}\right)$, а для $C_{1}$ и $C_{2}$ утверждение уже доказано.

# 7.1 Пространство разрезов 

Напомним определение (рёберного) разреза.

Определение 7.4. 1) Разрезом называется множество рёбер $E\left(V_{1}, V_{2}\right)$ (все рёбра между $V_{1}$ и $V_{2}$ ) для произвольного разбиения $V(G)$ на два непересекающихся множества вершин $V_{1}$ и $V_{2}$.
1) Пространство разрезов $\mathcal{C}^{*}(G)$ - это подпространство $\mathcal{E}(G)$, порожденное всеми разрезами.
2) Для каждой вершины $v \in V(G)$ определим $E(v)=E(v, V(G-v))-$ разрез из всех рёбер, инцидентных $v$.

Замечание 7.2. Отметим, что в главе 5 используется другое определение разреза - там это разделяющее множество, содержащее хотя бы одно ребро. Здесь же разрез состоит из всех рёбер графа, соединяющих две части множества его вершин, то есть, разрез - это разделяющее множество графа, состоящее только из рёбер.

Лемма 7.3. 1) Если $D_{1}$ и $D_{2}$ - два разреза, то $D_{1} \triangle D_{2}$ - тоже разрез.
1) $\mathcal{C}^{*}(G)$ состоит из всех разрезов графа $G$ и пустого множества.
2) Разрезы вида $E(v)$ порождают $\mathcal{C}^{*}(G)$.

Доказательство. 1)

1) Пусть $D_{1}=E\left(V_{1}, V_{2}\right), D_{2}=E\left(W_{1}, W_{2}\right)$. Тогда $D_{1} \triangle D_{2}$ есть множество всех рёбер, пересекающих ровно один из двух разрезов (то есть, концы этих рёбер находятся в разных частях ровно одного из двух разбиений $V(G)$ ). Таким образом,

$$
D_{1} \triangle D_{2}=E\left(\left(V_{1} \cap W_{1}\right) \cup\left(V_{2} \cap W_{2}\right),\left(V_{1} \cap W_{2}\right) \cup\left(W_{1} \cap V_{2}\right)\right)
$$

является разрезом.
1) Из пункта 1 следует, что что множество всех разрезов замкнуто относительно взятия симметрической разности.
2) Пусть $D=E\left(V_{1}, V_{2}\right)$ - произвольный разрез. Тогда $D$ есть сумма всех разрезов вида $E(w)$ для $w \in V_{1}$ (напомним, что сумма у нас - это симметрическая разность, поэтому при сложении указанных разрезов все рёбра между вершинами $V_{1}$ сократятся и останутся в точности рёбра разреза $D$ ).

Определение 7.5. Пусть $G$ - связный граф, а $T$ - его остовное дерево.

1) Для каждого ребра $e \in E(T)$ граф $T-e$ имеет ровно две компоненты связности - пусть это $W_{e}$ и $U_{e}$. Назовём $T$-разрезами все разрезы вида $D_{e}=E\left(W_{e}, U_{e}\right)$.
2) Для каждого ребра $f \in E(G) \backslash E(T)$ граф $T+f$ содержит ровно один цикл $C_{f}$. Назовём $T$-циклами все циклы вида $C_{f}$.

Теорема 7.1. Пусть $G$ - связный граф, $T$ - его остовное дерево. Тогда выполняются следующие утверждения.

1) $T$-циклы образуют базис ииклического пространства $\mathcal{C}(G)$,

$$
\operatorname{dim} \mathcal{C}(G)=e(G)-v(G)+1
$$

1) $T$-разрезы образуют базис пространства разрезов $\mathcal{C}^{*}(G)$,

$$
\operatorname{dim} \mathcal{C}^{*}(G)=v(G)-1
$$

1) $\mathcal{C}(G)=\mathcal{C}^{*}(G)^{\perp}$.
2) $\mathcal{C}^{*}(G)=\mathcal{C}(G)^{\perp}$.

Доказательство. 1) Каждое ребро $f \in E(G) \backslash E(T)$ входит ровно в один $T$-цикл $C_{f}$. Поэтому, все $T$-циклы линейно независимы в $\mathcal{C}(G)$. Рассмотрим любой элемент $C \in \mathcal{C}(G)$. Пусть $f_{1}, \ldots, f_{s} \in C-$ все рёбра из $C \backslash E(T)$. Тогда $C \triangle \sum_{i=1}^{s} C_{f_{i}}-$ элемент $\mathcal{C}(G)$, все ребра которого принадлежат дереву $T$. Нетрудно понять, что такой элемент - это $\varnothing$, а следовательно, $C=\sum_{i=1}^{s} C_{f_{i}}$. Значит, $T$-циклы образуют базис $\mathcal{C}(G)$, откуда $\operatorname{dim} \mathcal{C}(G)=e(G)-v(G)+1$.
1) Каждое ребро $e \in E(T)$ входит ровно в один $T$-разрез $D_{e}$. Поэтому, все $T$-разрезы линейно независимы в $\mathcal{C}^{*}(G)$. Рассмотрим любой элемент $D \in \mathcal{C}^{*}(G)$. Пусть $e_{1}, \ldots, e_{t} \in D-$ все рёбра из $D \cap E(T)$. Тогда $F=D \triangle \sum_{i=1}^{t} D_{e_{i}}-$ элемент $\mathcal{C}^{*}(G)$, ни одно из рёбер которого не принадлежит дереву $T$. Если $F \neq \varnothing$, то, как мы знаем по лемме 7.3, $F=E(A, B)-$ разрез графа $G$. Из связности графа $G$ следует, что хотя бы одно ребро остовного дерева $T$ соединяет $A$ с $B$, пртиворечие. Следовательно, $F=\varnothing$, а тогда $D=\sum_{i=1}^{t} D_{e_{i}}$. Значит, $T$-разрезы образуют базис $\mathcal{C}^{*}(G)$, откуда $\operatorname{dim} \mathcal{C}^{*}(G)=v(G)-1$.
2) Пусть $E \in \mathcal{E}(G)$. Из пункта 3 леммы 7.3 следует, что $E \in \mathcal{C}^{*}(G)^{\perp}$ тогда и только тогда, когда $\langle E, E(w)\rangle=0$ для любой вершины $w$, то есть, степень любой вершины графа $G[E]$ четна. А это по лемме 7.1 означает, что $E \in \mathcal{C}(G)$.
3) Очевидно каждый цикл $C$ пересекает разрез $E\left(V_{1}, V_{2}\right)$ четное число раз (выйдя из $V_{i}$, цикл должен вернуться обратно). Следовательно, $\mathcal{C}^{*}(G) \subset \mathcal{C}(G)^{\perp}$.

Пусть $D \in \mathcal{C}(G)^{\perp}$, причем $D \cap E(T)=\left\{e_{1}, \ldots, e_{t}\right\}$. Выше доказано, что все $T$-разрезы $D_{e_{1}}, \ldots, D_{e_{t}} \in \mathcal{C}(G)^{\perp}$. Тогда и $F=D \triangle \sum_{i=1}^{t} D_{e_{i}} \in \mathcal{C}(G)^{\perp}$. По построению, $F \subset E(G) \backslash E(T)$. Если $F \neq \varnothing$, то рассмотрим ребро $f \in F$ и $T$-цикл $C_{f}$. Тогда $\left\langle C_{f}, F\right\rangle=\left|C_{f} \cap F\right|=1$, противоречие. Значит, $F=\varnothing$, откуда следует, что $D \in \mathcal{C}^{*}(G)$.

# 7.2 Бонды 

Простые циклы являются минимальными (по включению) непустыми элементами циклического пространства. Как мы видим, циклическое пространство и пространство разрезов двойственны друг другу. Определим элементы пространства разрезов, двойственные простым циклам.

Определение 7.6. Бонд - это минимальный (по включению) непустой разрез графа $G$.

Начнем с очевидного.
Лемма 7.4. Разрез $E\left(V_{1}, V_{2}\right)$ связного графа $G$ является бондом, если и только если оба графа $G\left(V_{1}\right)$ и $G\left(V_{2}\right)$ связны.

Доказательство. Пусть $E=E\left(V_{1}, V_{2}\right)$.
$\Rightarrow$. Пусть $E-$ бонд. Докажем, что для любого ребра $e \in E$ граф $G-E+e$ связен. Действительно, пусть этот граф несвязен и имеет, скажем, компоненты связности $U_{1}$ и $U_{2}$. Тогда $E \supseteq E\left(U_{1}, U_{2}\right)$, а из связности графа $G$ следует, что $E\left(U_{1}, U_{2}\right) \neq \varnothing$. Противоречие с минимальностью $E$.

Так как для любого ребра $e \in E=E\left(V_{1}, V_{2}\right)$ граф $G-E+e$ связен, оба графа $G\left(V_{1}\right)$ и $G\left(V_{2}\right)$ связны.
$\Leftarrow$. Если оба графа $G\left(V_{1}\right)$ и $G\left(V_{2}\right)$ - связны, то добавление любого ребра из $E$ даст нам связный подграф графа $G$. Значит, в этом случае разрез $E$ минимален по включению. В силу связности $G$ этот разрез непуст, то есть, является бондом.

Нам понадобится немного более сложная лемма.
Лемма 7.5. Пусть $G$ - связный граф, непересекающиеся множества $X_{1}, X_{2} \subset V(G)$ связны, а $E \subset E(G)$ - минимальное по включению среди рёберных разделяющих множеств графа $G$, отделяющих $X_{1}$ от $X_{2}$. Тогда $E$ является бондом графа $G$.

Доказательство. Докажем, что каждое из множеств $X_{1}$ и $X_{2}$ содержится в одной компоненте связности графа $G-E$. Пусть это не так и, скажем, $X_{1}$ - несвязное множество в $G-E$. Так как $X_{1}$ связно в $G$, существует ребро $f \in E\left(G\left(X_{1}\right)\right) \cap E$. Однако, если $E$ отделяет $X_{1}$ от $X_{2}$ в графе $G$, то и множество $E \backslash\{f\}$ также отделяет, что противоречит минимальности $E$.

Итак, в $G-E$ есть две компоненты связности $U_{1} \supset X_{1}$ и $U_{2} \supset X_{2}$. Если у $G-E$ есть другие компоненты связности, то есть и ребро $e$, соединяющее одну из них с $U_{1}$ или $U_{2}$. Тогда $E \backslash\{e\}$ - разделяющее множество,

отделяющее $X_{1}$ от $X_{2}$, противоречие с минимальностью $E$. Таким образом, $G-E$ имеет две компоненты связности $U_{1}$ и $U_{2}$, следовательно, $E \supset E\left(U_{1}, U_{2}\right)$. Из минимальности $E$ следует, что $E=E\left(U_{1}, U_{2}\right)$ - разрез графа $G$, непустой в силу связности $G$. Так как граф $G-E$ имеет ровно две компоненты связности, $E$ по лемме 7.4 является бондом.

Легко понять, что бонды несвязного графа - это бонды его компонент.

Следствие 7.1. Каждый разрез графа $G$ является объединением попарно непересекающихся бондов.

Доказательство. Индукция по размеру разреза, база для бонда очевидна. Предположим, что разрез $E\left(V_{1}, V_{2}\right)$ - не бонд. Тогда существует бонд $E\left(U_{1}, U_{2}\right) \subsetneq E\left(V_{1}, V_{2}\right)$. По пункту 1 леммы 7.3 , множество рёбер $E\left(V_{1}, V_{2}\right) \backslash E\left(U_{1}, U_{2}\right)=E\left(V_{1}, V_{2}\right) \triangle E\left(U_{1}, U_{2}\right)$ - разрез, меньший чем $E\left(V_{1}, V_{2}\right)$, который по индукционному предположению является объединением попарно непересекающихся бондов.

Следствие 7.1 показывает, что бонды играют ту же роль в пространстве разрезов, что простые циклы - в цикическом пространстве графа: для циклического пространства и простых циклов аналогичное утверждение доказано в пункте 3 леммы 7.1.

Как мы знаем, каждый цикл графа лежит в одном из его блоков, а любые два ребра одного блока по следствию 5.2 лежат на простом цикле. Аналогичное свойство верно и для бондов. Для его доказательства нам потребуется еще одно несложное свойство блоков.
Лемма 7.6. Пусть $B$ - блок связного графа $G$, а $F \subset E(B)$. Тогда $c(G-F)=c(B-F)$.
Доказательство. Пусть $U_{1}, \ldots, U_{n}$ - все компоненты связности графа $B-F$. Построим разбиение множества $V(G)$ на компоненты связности $V_{1}, \ldots, V_{n}$. Изначально положим $U_{i} \subset V_{i}$ для всех $i \in[1 . . n]$. Вершины любого другого блока $B^{\prime}$ графа $G$ отделены от $B$ точкой сочленения $a \in V(B)$. Очевидно, существует единственное $i \in[1 . . n]$, для которого $a \in U_{i}$. Тогда поместим $V\left(B^{\prime}\right)$ в $V_{i}$. Легко видеть, что в результате получатся связные множества вершин $V_{1}, \ldots, V_{n}$.
Теорема 7.2. 1) Любой бонд графа $G$ лежит в одном из блоков графа $G$ и является бондом этого блока.
1) Бонды графа $G$ - это в точности бонды его блоков, то есть, минимальные по включению рёберные разделяющие множества блоков графа.
2) Любые два ребра блока В графа $G$ лежат в одном бонде графа $G$.

Доказательство. Во всей теореме можно считать граф связным, иначе проведем рассуждения отдельно для его компонент.

1) Пусть $E=E\left(V_{1}, V_{2}\right)$ - бонд, а $x y \in E$. Каждое ребро графа лежит ровно в одном его блоке - пусть $x y \in E(B)$. Можно считать, что $x \in V_{1}$ и $y \in V_{2}$. Рассмотрим любой $x y$-путь $P$ в графе $G$. Вместе с ребром $x y$ путь $P$ образует цикл, а значит, все вершины и рёбра $P$ лежат в блоке $B$. Бонд $E$ должен отделять $x$ от $y$, а значит, содержать хотя бы по одному ребру каждого $x y$-пути. Пусть множество $E^{\prime}$ состоит из ребра $x y$ и всех принадлежащих $E$ рёбер $x y$-путей. Тогда $E^{\prime} \subset E \cap E(B)$ отделяет $x$ от $y$ в графе $G$.

Рассмотрим минимальное по включению подмножество $E^{*} \subset E^{\prime}$, отделяющее $x$ от $y$. Тогда множество $E^{*} \subset E(B) \cap E$ по лемме 7.5 является бондом графа $G$. В силу минимальности бонда $E \supset E^{*}$ мы имеем $E^{*}=E$. По леммам 7.4 и 7.6 мы имеем $c(B-E)=c(G-E)=2$, а значит, $E-$ бонд блока $B$.
1) После пункта 1 остается лишь доказать, что любой бонд $E$ блока $B$ графа $G$ является бондом графа $G$. По леммам 7.4 и 7.6 мы имеем $c(G-E)=c(B-E)=2$, а значит, $E-$ бонд блока $G$.
2) В силу пункта 2 достаточно доказать, что два ребра $e, f \in E(B)$ лежат в одном бонде блока $B$. Как мы знаем, эти два ребра лежат на одном цикле $C$ блока $B$. Рёбра $e$ и $f$ делят цикл на две дуги $C_{1}$ и $C_{2}$. Пусть $E$ - множество всех рёбер блока $B$, кроме рёбер этих двух дуг. Тогда граф $B-E$ несвязен, а связные множества $V\left(C_{1}\right)$ и $V\left(C_{2}\right)$ лежат в разных компонентах связности этого графа. Следовательно, существует минимальное по включению разделяющее множество $E^{\prime}$ графа $B$, отделяющее $V\left(C_{1}\right)$ от $V\left(C_{2}\right)$ и по лемме 7.5 множество $E^{\prime}-$ бонд блока $B$. Так как каждое из рёбер $e$ и $f$ соединяет $C_{1}$ с $C_{2}$, мы имеем $e, f \in E^{\prime}$.

Закончим раздел полезным фактом.
Следствие 7.2. 1) Циклическое пространство графа $G$ является прямой суммой циклических пространств его блоков.
1) Пространство разрезов графа $G$ является прямой суммой пространств разрезов его блоков.

Доказательство. 1) Циклическое пространство порождено простыми циклами, а каждый простой цикл лежит ровно в одном из блоков.
1) Пространство разрезов порождено бондами, а каждый бонд является бондом ровно в одном из блоков.

В разделе 7.5 мы увидим еще одну иллюстрацию двойственности циклов и бондов, рассмотрев двойственные друг другу плоские графы.

# 7.3 Пространство трёхсвязного графа 

Теорема 7.3. (W. T. Tutte, 1963.) Циклическое пространство трёхсвязного графа порождено множествами рёбер его неразделяющих индуцированных циклов.

Доказательство. Индукция по размеру графа. База для $K_{4}$ очевидна: множества рёбер четырёх треугольных циклов этого графа, очевидно, порождают $\mathcal{C}\left(K_{4}\right)$. Вместе с тем, эти треугольники являются неразделяющими индуцированными циклами.

Пусть $v(G) \geq 5$ и для любого меньшего чем $G$ трёхсвязного графа утверждение доказано. По теореме 5.16 существует ребро $e=x y \in E(G)$ такое, что граф $G^{\prime}=G \cdot e$ трёхсвязен. Пусть $w=x \cdot y \in V\left(G^{\prime}\right)$.

Назовем фундаментальным треугольник вида $u x y$ в графе $G$. Очевидно, фундаментальный треугольник - неразделяющий цикл. (Граф $G-\{x, y, u\}=G^{\prime}-\{w, u\}$ связен ввиду трёхсвязности $G^{\prime}$.) Любой треугольник является индуцированным циклом. Таким образом, мы можем использовать фундаметальные треугольники в порождении $\mathcal{C}(G)$.

Мы будем считать множества рёбер $E_{1}, E_{2} \subset E(G)$ похожими, если $E_{1} \triangle E_{2}$ представляется в виде суммы множеств рёбер нескольких фундаментальных треугольников и, возможно, ребра $e$. Очевидно, отношение похожести является отношением эквивалентности.

Ввиду леммы 7.2 нам достаточно доказать, что множество рёбер любого индуцированного цикла $C$ графа $G$ есть сумма рёберных множеств нескольких индуцированных неразделяющих циклов графа $G$.

Определим цикл $C^{\prime}$ графа $G^{\prime}$ следующим образом. Если $e \in E(C)$, то $C^{\prime}=C \cdot e$. Пусть $e \notin E(C)$. Так как цикл $C$ - индуцированный, он не содержит хорд, а значит, $V(C)$ содержит не более чем одну из вершин $x$ и $y$. Если цикл $C$ содержит одну из этих вершин (например, $x$ ), то $C^{\prime}$ получается из $C$ заменой $x$ на $w$. Наконец, если $x, y \notin V(C)$, то положим $C^{\prime}=C$.

Наоборот, для каждого цикла $Z^{\prime}$ графа $G^{\prime}$ мы построим множество рёбер $E^{*}\left(Z^{\prime}\right) \subset E(G)$ так: все неинцидентные $w$ рёбра $Z^{\prime}$ есть и в $E^{*}\left(Z^{\prime}\right)$, а вместо каждого из рёбер вида $w u$ в $E^{*}\left(Z^{\prime}\right)$ есть ровно одно из рёбер $x u$ и $y u$ (не имеет значения, какое именно). Отметим, что хотя бы одно из этих рёбер обязательно есть в $E(G)$.

Мы воспользуемся индукционным предположением, то есть, результатом теоремы для графа $G^{\prime}$. Получим, что

$$
E\left(C^{\prime}\right)=E\left(C_{1}^{\prime}\right) \triangle E\left(C_{2}^{\prime}\right) \triangle \ldots \triangle E\left(C_{k}^{\prime}\right)
$$

где все циклы из правой части - индуцированные и неразделяющие в

графе $G^{\prime}$. Для каждого цикла $C_{i}^{\prime}$ мы построим такой индуцированный неразделяющий цикл $C_{i}$ в графе $G$, что $E\left(C_{i}\right)$ похоже на $E^{*}\left(C_{i}^{\prime}\right)$.

Если $w \notin V\left(C_{i}^{\prime}\right)$, то, очевидно, нам подойдёт $C_{i}=C_{i}^{\prime}$. Пусть $w \in V\left(C_{i}^{\prime}\right)$, причем $C_{i}^{\prime}=$ Ришv, где $P$ - некоторый путь. Рассмотрим два случая.

1. $E(G)$ содержит все четыре ребра $x u, x v, y u, y v$.

Рассмотрим в графе $G$ циклы $C_{i}^{x}=$ Рихv и $C_{i}^{y}=$ Риy $v$ (см. рисунок 7.1a). Очевидно, оба цикла являются индуцированными. Предположим, что $V\left(C_{i}^{x}\right)$ - разделяющее множество в графе $G$. Так как $V\left(C_{i}^{\prime}\right)$ не разделяющее множество в графе $G^{\prime}$, то $V\left(C_{i}^{x}\right)$ отделяет $y$ от остальных вершин графа $G$. Аналогично, если $V\left(C_{i}^{y}\right)$ - разделяющее множество в графе $G$, то оно отделяет $x$ от остальных вершин графа $G$.

Таким образом, если оба множества $V\left(C_{i}^{x}\right)$ и $V\left(C_{i}^{y}\right)$ - разделяющие в графе $G$, то вершины $x$ и $y$ могут быть смежны в графе $G$ только с $u, v$, вершинами пути $P$ и друг с другом. Но ввиду отсутствия хорд у циклов $C_{x}$ и $C_{y}$, очевидно, $x$ и $y$ не смежны с вершинами пути $P$, то есть, $\mathrm{N}_{G}(\{x, y\})=\{x, y, u, v\}$. Таким образом, $\{u, v\}$ отделяет $\{x, y\}$ от остальных вершин графа $G$, что противоречит трёхсвязности этого графа.

Значит, хотя бы один из циклов $C_{i}^{x}$ и $C_{i}^{y}$ является неразделяющим пусть, например, это $C_{i}^{x}$. Очевидно, $E\left(C_{i}^{x}\right)$ похоже на $E^{*}\left(C_{i}^{\prime}\right)$ и мы можем положить $C_{i}=C_{i}^{x}$.


Рис. 7.1: Построение цикла $C_{i}$.
1. $E(G)$ содержит не все четыре ребра $x u, x v, y u, y v$.

Не умаляя общности будем считать, что $x u \notin E(G)$. Тогда $y u \in E(G)$. Если $y v \in E(G)$, то положим $C_{i}=$ Риуч (см. рисунок 7.1 b ). Как и в первом пункте, $C_{i}=$ Риуч - индуцированный цикл графа $G$ и если $V\left(C_{i}\right)$ разделяющее множество в $G$, то оно отделяет $x$ от остальных вершин графа. Но тогда $\mathrm{N}_{G}(x)=\{y, v\}$, что невозможно в трёхсвязном графе.

Пусть $y v \notin E(G)$. Тогда $x v \in E(G)$ и мы положим $C_{i}=$ Риухv (см. рисунок 7.1 c ). Так как $x u, y v \notin E(G)$, цикл $C_{i}$ - индуцированный. На этот раз очевидно, что цикл $C_{i}$ - неразделяющий.

Остается лишь добавить, что в любом случае, как нетрудно заметить, $E\left(C_{i}\right)$ похоже на $E^{*}\left(C_{i}^{\prime}\right)$.

Так как для каждого $i$ мы знаем, что $E\left(C_{i}\right)$ похоже на $E^{*}\left(C_{i}^{\prime}\right)$, то $E\left(C_{1}\right) \triangle \ldots \triangle E\left(C_{k}\right)$ похоже на $E^{*}\left(C_{1}^{\prime}\right) \triangle \ldots \triangle E^{*}\left(C_{k}^{\prime}\right)$, а значит, и на $E^{*}\left(C^{\prime}\right)$, которое, в свою очередь, похоже на $E(C)$. Следовательно, $E(C)$ представляется в $\mathcal{C}(G)$ в виде суммы $E\left(C_{1}\right), \ldots, E\left(C_{k}\right)$, множеств рёбер нескольких фундаментальных треугольников и, возможно, ребра $e$. Для завершения доказательства теоремы остается заметить, что ребра $e$ в этой сумме быть не может: если бы оно там было, то $e \in \mathcal{C}(G)$, что не так.

# 7.4 Циклическое пространство и планарность 

Определение 7.7. Множество $\mathcal{F} \subset \mathcal{E}(G)$ называется простым, если каждое ребро $e \in E(G)$ принадлежит не более чем двум подмножествам из $\mathcal{F}$.

Замечание 7.3. Самый естественный пример простого множества - это $\{E(v)\}_{v \in V(G)}$ - базис пространства разрезов $\mathcal{C}^{*}(G)$ (см. лемму 7.3). Таким образом, пространство разрезов графа всегда имеет простой базис.

А вот простой базис циклического пространства существует далеко не у каждого графа.

Лемма 7.7. Пусть $e \in E(G)$ и циклическое пространство $\mathcal{C}(G)$ имеет простой базис. Тогда циклическое пространство $\mathcal{C}(G-e)$ также имеет простой базис.

Доказательство. Так как циклическое пространство графа является прямой суммой циклических пространств его компонент, можно считать граф $G$ связным. Если граф $G-e$ несвязен, то ребро $e-$ мост, то есть, не принадлежит ни одному простому циклу. Тогда по лемме 7.1 ребро $e$ не принадлежит ни одному из элементов $\mathcal{C}(G)$, а значит, $\mathcal{C}(G)=\mathcal{C}(G-e)$.

Пусть граф $G-e$ связен, а $C_{1}, \ldots, C_{k}$ - простой базис $\mathcal{C}(G)$. Из теоремы 7.1 следует, что

$$
\operatorname{dim} \mathcal{C}(G-e)=\operatorname{dim} \mathcal{C}(G)-1
$$

1. Пусть е принадлежит одному из множеств $C_{1}, \ldots, C_{k}$. Например, пусть $e \in C_{k}$. Тогда множества $C_{1}, \ldots, C_{k-1} \in \mathcal{C}(G-e)$ линейно независимы и в виду (7.1) образуют простой базис $\mathcal{C}(G-e)$.

2. Пусть е принадлежит двум из множеств $C_{1}, \ldots, C_{k}$.

Например, пусть $e \in C_{k-1}$ и $e \in C_{k}$. Тогда множества $C_{1}, \ldots, C_{k-2}$, $C_{k-1} \triangle C_{k} \in \mathcal{C}(G-e)$ линейно независимы и ввиду (7.1) образуют простой базис $\mathcal{C}(G-e)$.

Теорема 7.4. (S. MacLane, 1937.) Граф $G$ планарен, если и только если его ииклическое пространство $\mathcal{C}(G)$ имеет простой базис.

Доказательство. Мы будем считать, что $v(G) \geq 3$, иначе утверждение очевидно. Также будем считать, что утверждение доказано для любого графа с меньшим числом вершин. Рассмотрим два случая.

1. Пусть $G$ недвусвязен.

Тогда существует два таких графа $G_{1}$ и $G_{2}$, что $V\left(G_{1}\right) \cap V\left(G_{2}\right)=\{a\}$ и $G=G_{1} \cup G_{2}$.
$\Rightarrow$. Если $G$ планарен, то оба графа $G_{1}$ и $G_{2}$ - планарны, а значит, их циклические пространства имеют простые базисы. По следствию 7.2 мы имеем $\mathcal{C}(G)=\mathcal{C}\left(G_{1}\right) \oplus \mathcal{C}\left(G_{2}\right)$, а значит, и $\mathcal{C}(G)$ имеет простой базис.
$\Leftarrow$. Если $\mathcal{C}(G)$ имеет простой базис, то по лемме 7.7 циклические пространства $\mathcal{C}\left(G_{1}\right)$ и $\mathcal{C}\left(G_{2}\right)$ имеют простые базисы, а значит, оба графа $G_{1}$ и $G_{2}$ - планарны. Следовательно, и граф $G$ планарен.
1. Пусть $G$ двусвязен.
$\Rightarrow$. В этом случае в графе нет точек сочленения и мостов, поэтому граница любой грани графа $G$ - простой цикл. Каждое ребро принадлежит границе ровно двух граней, поэтому, множество границ всех граней простое.

Докажем, что множества рёбер границ граней порождают $\mathcal{C}(G)$. Для этого достаточно доказать, что они порождают любой цикл $C$. Цикл $C$ делит плоскость на две области - внутреннюю и внешнюю. Пусть $D_{1}, \ldots$, $D_{k}$ - границы всех граней внутренней области цикла $C$. Нетрудно понять, что $E(C)=E\left(D_{1}\right) \triangle \ldots \triangle E\left(D_{k}\right)$ (любое ребро, проведенное внутри $C$, входит в границы ровно двух внутренних граней и потому сократится, останутся в точности рёбра цикла $C$ ).

Для завершения доказательства остается заметить, что из полученной простой порождающей системы можно выбрать простой базис $\mathcal{C}(G)$.
$\Leftarrow$. Докажем, что $G$ не может содержать подразбиения $K_{5}$ или $K_{3,3}$. Предположим противное, пусть подграф $H$ графа $G$ является подразбиением $K_{5}$ или $K_{3,3}$. Из леммы 7.7 следует, что $\mathcal{C}(H)$ имеет простой базис. Очевидно, если $H$ - подразбиение графа $K$, то $\mathcal{C}(H) \simeq \mathcal{C}(K)$.

Остается доказать, что графы $K_{5}$ и $K_{3,3}$ не имеют простых базисов.

По теореме 7.1 мы имеем $\operatorname{dim} \mathcal{C}\left(K_{5}\right)=e\left(K_{5}\right)-v\left(K_{5}\right)+1=6$. Предположим, что $\mathcal{C}\left(K_{5}\right)$ имеет простой базис $C_{1}, \ldots, C_{6}$. Пусть

$$
C_{0}=C_{1} \triangle C_{2} \triangle \ldots \triangle C_{6}
$$

Отметим, что каждое ребро $e \in E\left(K_{5}\right)$ входит ровно в два из множеств $C_{0}, C_{1}, \ldots, C_{6}$. (Ребро $e$ входит не более чем в два из множеств $C_{1}, \ldots, C_{6}$. Если такое множество одно, то $e \in C_{0}$, а если два, то $e \notin C_{0}$ ).

Так как в графе $K_{5}$ нет кратных рёбер, а степень каждой вершины в графе $G\left(C_{i}\right)$ четна, $e\left(C_{i}\right) \geq 3$ (для всех $i \in[0 . .6]$ ). Таким образом, $21 \leq\left|C_{0}\right|+\cdots+\left|C_{6}\right|=2 e\left(K_{5}\right)=20$, что невозможно. Значит, $K_{5}$ не имеет простого базиса.

По теореме 7.1 мы имеем $\operatorname{dim} \mathcal{C}\left(K_{3,3}\right)=e\left(K_{3,3}\right)-v\left(K_{3,3}\right)+1=4$. Предположим, что $\mathcal{C}\left(K_{3,3}\right)$ имеет простой базис $C_{1}, \ldots, C_{4}$. Пусть $C_{0}=C_{1} \triangle C_{2} \triangle C_{3} \triangle C_{4}$. Как и выше, каждое ребро $e \in E\left(K_{3,3}\right)$ входит ровно в два из множеств $C_{0}, C_{1}, \ldots, C_{4}$.

Так как в графе $K_{3,3}$ нет кратных рёбер и нечетных циклов, а степень каждой вершины в графе $G\left(C_{i}\right)$ четна, $e\left(C_{i}\right) \geq 4$ (для всех $i \in[0 . .4]$ ). Таким образом, $20 \leq\left|C_{0}\right|+\cdots+\left|C_{4}\right|=2 e\left(K_{3,3}\right)=18$, что невозможно. Значит, $K_{3,3}$ не имеет простого базиса.

Из доказанного следует, что граф $G$ не содержит ни подразбиения $K_{5}$, ни подразбиения $K_{3,3}$ и потому ввиду теоремы Куратовского 6.2 граф $G$ планарен.

Теорема 7.5. (A. Kelmans, 1978.) Трёхсвязный граф $G$ является планарным тогда и только тогда, когда каждое его ребро лежит не более, чем на двух неразделяющих индуцированных циклах.

Доказательство. $\Rightarrow$. Пусть $G$ - трёхсвязный планарный граф. Тогда каждое его ребро принадлежит границам ровно двух граней, а границы граней графа $G$ в точности есть все его неразделяющие индуцированные циклы по лемме 6.5.
$\Leftarrow$. Пусть $G$ - трёхсвязный граф, у которого каждое ребро принадлежит не более чем двум неразделяющим индуцированным циклам. По теореме 7.3 у циклического пространства $\mathcal{C}(G)$ существует базис из рёберных множеств неразделяющих индуцированных циклов, и такой базис, очевидно, является простым. Тогда по теореме 7.4 граф $G$ планарен.

Непосредственно из доказательства теоремы 7.5 следует еще одно утверждение.

Следствие 7.3. Пусть $G$ - трёхсвязный граф, причем каждое его ребро принадлежит не более, чем доум неразделяющим индуцированным ииклам. Тогда каждое ребро графа $G$ принадлежит ровно доум неразделяющим индуцированным ииклам.

# 7.5 Циклическое пространство и двойственность 

Пусть $G$ и $G^{*}$ - двойственные друг другу плоские графы. Напомним, что для любого множества $A$ рёбер, вершин или граней графа $G$ через $A^{*}$ обозначается двойственное множество рёбер, граней или вершин графа $G^{*}$. Наоборот, для множества $A^{*}$ рёбер, вершин или граней графа $G^{*}$ через $A$ обозначается двойственное множество рёбер, граней или вершин графа $G$ (см. определения в разделе 6.5). Начнем с теоремы, показывающей связь циклов графа и бондов двойственного ему.

Теорема 7.6. Пусть $G$ и $G^{*}$ - двойственные друг другу плоские графы, а $E \subset E(G)$ и $E^{*} \subset E\left(G^{*}\right)$ - двойственные множества рёбер. Тогда выполнены следующие утверждения.

1) $E$ - множество рёбер простого иикла графа $G$, если и только если $E^{*}$ - бонд графа $G^{*}$.
2) $E$ - бонд графа $G$, если и только если $E^{*}$ - множество рёбер простого иикла графа $G^{*}$.

Доказательство. Так как $\left(G^{*}\right)^{*}=G$, достаточно доказать пункт 1. Достаточно разобрать лишь случай связных графов так как бонды и циклы несвязного графа - это бонды и циклы его компонент. Далее пусть графы $G$ и $G^{*}$ связны.
$\Rightarrow$. Пусть $E=E(C)$, где $C-$ простой цикл графа $G$. Этот цикл делит плоскость на две части, а каждая грань лежит в одной из частей. Пусть $V_{1}^{*}$ - множество вершин графа $G^{*}$, двойственных граням, лежащим внутри $C$, а $V_{2}^{*}$ - множество вершин $G^{*}$, двойственных граням, лежащим вне $C$. Докажем, что $E_{G^{*}}\left(V_{1}^{*}, V_{2}^{*}\right)=E^{*}$. Действительно, $E_{G^{*}}\left(V_{1}^{*}, V_{2}^{*}\right)$ - множество всех рёбер графа $G^{*}$, соединяющих внутреннюю и внешнюю относительно $C$ части плоскости. Это как раз все рёбра графа $G^{*}$, пересекающие цикл $C$, а значит, это множество $E^{*}$ всех рёбер, двойственных рёбрам цикла $C$. Таким образом, $E^{*}$ - разрез графа $G^{*}$. Очевидно, $V_{1}^{*}$ и $V_{2}^{*}$ - компоненты связности графа $G^{*}-E^{*}$ (между любыми двумя гранями связного графа $G$, лежащими внутри (вне) цикла $C$ существует путь, не пересекающий цикл $C$, по этому пути строится

и путь в двойственном графе $G^{*}$ между двойственными этим граням вершинами). Значит, по лемме 7.4 разрез $E^{*}$ - бонд графа $G^{*}$.
$\Leftarrow$. Пусть $E^{*}=E_{G^{*}}\left(V_{1}^{*}, V_{2}^{*}\right)$ - бонд графа $G^{*}$. Тогда по лемме 7.5 граф $G^{*}-E^{*}$ имеет ровно две компоненты связности, а именно, $V_{1}^{*}$ и $V_{2}^{*}$. Пусть $V_{1}=\left\{d_{1}, \ldots, d_{k}\right\}$, а $F_{i}$ - множество всех граничных рёбер $d_{i}$ (то есть, рёбер из границы грани $d_{i}$, не являющихся мостами). Тогда $F_{i}$ является объединением нескольких простых циклов и по лемме 7.1 мы имеем $F_{i} \in \mathcal{C}(G)$. Положим $M=F_{1} \Delta \ldots \Delta F_{k}$.

Докажем, что $M^{*} \subset E^{*}$. Любое ребро $f \in M$ принадлежит нечетному числу множеств из $F_{1}, \ldots, F_{k}$, а значит, ровно одному из них (напомним, что каждое ребро принадлежит границам не более чем двух граней). Пусть $f \in F_{i}$. Тогда $f$ принадлежит границе грани $d_{i}$. Так как $f-$ не мост, по ребру $e$ граничат две разные грани графа $G$ - это $d_{i}$ и, скажем, $a$. Из доказанного слеует, что $a \notin V_{1}$, а значит, $a^{*} \in V_{2}^{*}$, то есть $f^{*}=d_{i}^{*} a^{*} \in E^{*}$.

По лемме 7.1 мы знаем, что $M \in \mathcal{C}(G)$ содержит множество рёбер простого цикла $C$. Пусть $F=E(C)$. Отметим, что $F^{*} \subset M^{*} \subset E^{*}$. В силу доказанной выше импликации $F^{*}$ - бонд графа $G^{*}$. Следовательно, $F^{*}=E^{*}$, а значит, $E=F=E(C)$, что и требовалось доказать.

Двойственные графы к разным плоским изображениям одного планарного графа могут быть неизоморфными, но, как мы увидим, у них должны быть одни и те же блоки.

Следствие 7.4. Пусть $G$ и $G^{*}$ - двойственные друг другу плоские графы, а $E \subset E(G)$ и $E^{*} \subset E\left(G^{*}\right)$ - двойственные множества рёбер. Тогда $E$ - множество рёбер блока графа $G$, если и только если $E^{*}$ множество рёбер блока графа $G^{*}$.

Доказательство. Два ребра $e, f \in E(G)$ лежат в одном блоке графа $G$ если и только если $e$ и $f$ лежат на одном цикле. Это условие по теореме 7.6 равносильно тому, что $e^{*}$ и $f^{*}$ лежат в одном бонде графа $G^{*}$. А это условие по теореме 7.2 выполнено, если и только если $e^{*}$ и $f^{*}$ лежат в одном блоке графа $G^{*}$.

Вот такая связь получилась между двумя двойственностями - плоских графов, а также бондов и циклов. Интересно, что доказанное в теореме 7.6 свойство является, по сути, определяющим двойственный граф. Взяв его за основу, мы определим абстрактный двойственный граф для произвольного (не обязательно плоского!) графа, а в результате окажется, что такой объект существует в точности для планарных графов.

Определение 7.8. Пусть $G$ и $G^{*}$ - два графа, для которых существует такая биекция $\varphi: E(G) \rightarrow E\left(G^{*}\right)$, что $E \subset E(G)$ - множество рёбер простого цикла графа $G$, если и только если $\varphi(E)$ - бонд графа $G^{*}$. Тогда будем говорить, что $G^{*}$ - абстрактный двойственный граф к $G$.

Если возникает вопрос, а существуют ли вообще такие пары графов, нужно вспомнить теорему 7.6 и понять, что один тип примеров мы знаем - это двойственные друг другу плоские графы. Отметим, что графы $G$ и $G^{*}$ в определении 7.8 не должны быть плоскими. Разумеется, абстрактные двойственные к одному и тому же графу не обязательно будут изоморфными. Однако, все эти графы имеют одинаковые циклические пространства и пространства разрезов.
Следствие 7.5. 1) Пусть $G$ - плоский граф, а $G^{*}$ - двойственный ему граф. Тогда $\mathcal{C}(G)=\mathcal{C}^{*}\left(G^{*}\right)$ и $\mathcal{C}\left(G^{*}\right)=\mathcal{C}^{*}(G)$.
1) Пусть $G^{*}$ - абстрактный двойственный граф для G. Тогда $\mathcal{C}(G)=\mathcal{C}^{*}\left(G^{*}\right)$ и $\mathcal{C}\left(G^{*}\right)=\mathcal{C}^{*}(G)$.
Доказательство. 1) Напрямую следует из теоремы 7.6.
1) По определению 7.8 мы имеем $\mathcal{C}(G)=\mathcal{C}^{*}\left(G^{*}\right)$. По теореме 7.1 отсюда следует, что $\mathcal{C}\left(G^{*}\right)=\mathcal{C}^{*}(G)$.

А для каких графов в принципе существуют абстрактные двойственные? Может показаться, что должны быть примеры пар абстрактных двойственных графов, существенно отличные от плоского графа и его двойственного. Однако, следующая теорема покажет, что это не так.
Теорема 7.7. (H. Whitney, 1932.) Граф $G$ имеет абстрактный двойственный, если и только если $G$ планарен.
Доказательство. $\Leftarrow$. Рассмотрим плоское изображение графа $G$ и его двойственный граф $G^{*}$. Из теоремы 7.6 следует, что множества рёбер циклов графа $G$ при естественной биекции множеств рёбер двойственных графов соответствуют бондам графа $G^{*}$.
$\Rightarrow$. По замечанию 7.3 пространство разрезов любого графа имеет простой базис. Следовательно, $\mathcal{C}(G)=\mathcal{C}^{*}\left(G^{*}\right)$ - а это циклическое пространство графа $G$ - имеет простой базис. Тогда по теореме 7.4 граф $G^{*}$ планарен.

# 7.6 Комментарии 

Это одна из двух "алгебраических" глав книги, достаточно простая и короткая. Главная идея главы в том, чтобы показать с помощью алгебраических инструментов двойственность различных объектов, в основном

комбинаторных. Так, начиная с двойственности циклического пространства и пространства разрезов, мы подходим к поиску объекта, двойственного порождающим циклическое пространство простым циклам, и таким объектом оказывается бонд - минимальный нетривиальный разрез.

Все результаты главы - классические, их можно найти, например, в книге Дистеля [8], правда, там они не объединены в одну главу и изложение несколько отличается от нашего. Отмечу, что в [8] можно найти принципиально другое, весьма элегантное доказательство теоремы Татта о циклическом пространстве трёхсвязного графа (теоремы 7.3).

В последнем разделе главы речь идет о планарных графах и, как обычно, топологические подробности остались за бортом книги, более топологический взгляд на эти теоремы можно найти в [8].

В следующей главе мы рассмотрим цилическое пространство ориентированного графа и обсудим ориентированный циклический базис.

# Глава 8 

## Ориентированные графы

Основным предметом нашего изучения будет ориентированный граф $G$.

## 8.1 Сильная связность

Определение 8.1. Вершины $a$ и $b$ ориентированного графа $G$ назовем связанными, если в графе $G$ существуют пути из $a$ в $b$ и из $b$ в $a$.

Ориентированный граф $G$ называется сильно связным, если любые две его вершины связаны.

Легко видеть, что отношение связанности вершин ориентированного графа $G$ является отношением эквивалентности. Таким образом, множество вершин $V(G)$ оказывается разбито на классы попарно связанных вершин, которые мы будем называть компонентами сильной связности. Очевидна аналогия с определением компонент связности неориентированных графов. Термин получился весьма длинным, поэтому мы вместо "компонента сильной связности" иногда будем просто говорить "компонента", не вкладывая в этот термин отдельного смысла, как для неориентированных графов.

Построим для орграфа $G$ орграф компонент сильной связности $C(G)$, вершины которого - компоненты сильной связности $G$. Проведем в графе $C(G)$ стрелку $V_{i} \rightarrow V_{j}$ тогда и только тогда, когда в графе $G$ есть хотя бы одна стрелка, направленная от компоненты $V_{i}$ к $V_{j}$.

Определение 8.2. Орграф называется ациклическим, если он не имеет ориентированных циклов.

Лемма 8.1. Для любого ориентированного графа $G$ выполняются следующие утверждения.

1) $C(G)$ - аиклический орграф.
2) Для любой компоненты сильной связности $V_{i}$ индуцированный подграф $G\left(V_{i}\right)$ сильно связен.

Доказательство. 1) Предположим противное, пусть в $C(G)$ есть цикл $V_{1} V_{2} \ldots V_{k}$. Тогда в графе $G$ все вершины из $\cup_{i=1}^{k} V_{i}$ попарно связаны и, следовательно, входят в одну компоненту сильной связности. Противоречие.
1) Пусть $w_{1}, w_{2} \in V_{i}$. Тогда существует $w_{1} w_{2}$-путь $S$ и $w_{2} w_{1}$-путь $T$ в орграфе $G$. Понятно, что все вершины из $V(S) \cup V(T) \ni w_{1}, w_{2}$ связаны в орграфе $G$, следовательно, $V(S) \cup V(T) \subset V_{i}$, то есть, вершины $w_{1}$ и $w_{2}$ связаны в $G\left(V_{i}\right)$. Таким образом, граф $G\left(V_{i}\right)$ сильно связен.

Определение 8.3. Пусть $V_{i}$ - компонента сильной связности ориентированного графа $G$. Назовем эту компоненту промежуточной, если в графе $C(G)$ существует стрелка, входящая в $V_{i}$, и существует стрелка, выходящая из $V_{i}$. В противном случае назовем компоненту $V_{i}$ крайней.

Так как в $C(G)$ нет циклов, то любой путь в этом графе начинается в вершине, из которой все ребра выходят, и заканчивается в вершине, в которую все ребра входят. Такие вершины соответствуют крайним компонентам сильной связности. Таким образом, любая промежуточная компонента сильной связности орграфа $G$ лежит в $C(G)$ на пути между какими-то двумя крайними компонентами.

Итак, мы описали структуру компонент сильной связности ориентированного графа.

Сформулируем простой, но полезный критерий сильной связности орграфа.

Лемма 8.2. Орграф D сильно связен, если и только если для любого множества $W \subset V(D)$ существует стрелка из $W$ в $V(D) \backslash W$.

Доказательство. Докажем обе импликации от противного.
$\Rightarrow$. Если из некоторого множества $W \subset V(D)$ нет стрелки в $V(D) \backslash W$, то невозможно попасть из $W$ в $V(D) \backslash W$, что противоречит сильной связности $D$.
$\Leftarrow$. Если орграф не является сильно связным, то он имеет крайнюю компоненту сильной связности $W$, из которой не выходит ни одной стрелки в $V(D) \backslash W$, что противоречит условию.

Следующая лемма также очевидна, и при этом очень полезна.

Лемма 8.3. Орграф D является ациклическим, если и только если его вершины можно занумеровать так, что любая стрелка ведет из вершины с меньшим номером к вершине с большим номером.

Доказательство. Если такая нумерация существует, отсутствие циклов очевидно: ни из какой вершины нельзя попасть в вершину с меньшим номером.

Существование нумерации для орграфа, не являющегося сильно связным, докажем по индукции. База для одновершинного графа очевидна. Также понятно, что в ациклическом орграфе есть вершина $a$, из которой не выходит ни одной стрелки. По индукционному предположению построим нумерацию для (очевидно, ациклического) орграфа $D-a$, после чего присвоим вершине $a$ последний, самый большой номер.

# 8.2 Входящее и исходящее дерево 

Как мы знаем, из любого связного графа $G$ можно выделить остовное дерево. Определим два "ориентированных аналога" дерева.

Определение 8.4. Пусть $D$ - такой орграф, что неориентированный граф $\underline{D}$ - дерево, $a \in V(D)$.

1) Если из каждой вершины орграфа $D$, кроме $a$, выходит ровно одно ребро, то $D$ называется входящим деревом вершины $a$.
2) Если в каждую вершину орграфа $D$, кроме $a$, входит ровно одно ребро, то $D$ называется исходящим деревом вершины $a$.

Изучим свойства исходящего и входящего деревьев. Очевидно, входящие и исходящие деревья - ациклические орграфы. Оказывается, в некотором смысле верно и обратное.

Лемма 8.4. 1) Пусть $D$ - ациклический орграф, в котором из каждой вершины, кроме а, выходит ровно одна стрелка, а из а не выходит ни одной стрелки. Тогда $D$ - входящее дерево вершины а.
1) Пусть $D$ - ациклический орграф, в котором в каждую вершину, кроме а, входит ровно одна стрелка, а в а не входит ни одной стрелки. Тогда $D$ - исходящее дерево вершины а.

Доказательство. 1) Очевидно, в $D$ ровно $n-1$ стрелка, то есть, в $\underline{D}$ ровно $n-1$ ребро. Предположим, что орграф $\underline{D}$ имеет цикл $Z$. Так как орграф $D$ - ациклический, соответствующие циклу $Z$ стрелки не образуют ориентированного цикла, а значит, в $V(Z)$ есть вершина, из которой

обе стрелки орграфа $D$ выходят, что противоречит условию. Таким образом, в $\underline{D}$ нет циклов, значит, это дерево. Тогда по определению $D-$ входящее дерево вершины $a$.
1) Аналогично.

Лемма 8.5. 1) Если $D$ - входящее дерево вершины а, то из каждой вершины $D$ существует путь до а.
1) Если $D$ - исходящее дерево вершины а, то из а существует путь до каждой вершины $D$.

Доказательство. 1) Пусть $x \in V(D)$. Построим максимальный путь $P$ с началом в $x$. Так как $D$ - ациклический орграф, из конца пути $P$ не выходит ни одной стрелки, значит, этот конец - вершина $a$.
1) Аналогично.

Теорема 8.1. Пусть $G-$ орграф, $a \in V(G), V_{a}^{-}-$множество всех вершин $G$, из которых можно дойти до $a$, а $V_{a}^{+}$- множество всех вершин $G$, до которых можно дойти из а (мы считаем, что $a \in V_{a}^{-}$и $a \in V_{a}^{+}$). Тогда существует входящее дерево вершины а с множеством вершин $V_{a}^{-}$и исходящее дерево вершины а с множеством вершин $V_{a}^{+}$.

Доказательство. Построим входящее дерево, исходящее строится аналогично. Положим $L_{0}=\{a\}$, пусть $L_{k}=\left\{x: \operatorname{dist}_{G}(x, a)=k\right\}$. Если $m-$ наибольшее расстояние от вершины множества $V_{a}^{-}$до $a$, то $\cup_{k=0}^{m} L_{k}=V_{a}^{-}$. Для всех $k>0$ проведем от каждой вершины $x \in L_{k}$ ровно одну стрелку, выходящую из $x$ к вершине уровня $L_{k-1}$ (такая стрелка, очевидно, есть). Обозначим через $D$ орграф с построенным множеством стрелок. В $D$ из каждой вершины, кроме $a$, выходит ровно одна стрелка. Понятно, что в этом орграфе нет циклов (каждая стрелка выходит к вершине меньшего уровня), а значит, по лемме 8.4 орграф $D$ - входящее дерево вершины $a$.

Следствие 8.1. В сильно связном орграфе $G$ для любой вершины а существует исходящее и входящее деревъя вершины а с множеством вершин $V(G)$.

Доказательство. Так как орграф $D$ сильно связен, $V_{a}^{-}=V_{a}^{+}=V(G)$.

Любой связный граф имеет остовное дерево. Так как в дереве на $n$ вершинах ровно $n-1$ ребро, то для "обеспечения связности" $n$-вершинного связного графа $G$ достаточно оставить $n-1$ ребро, а вот $n-2$ ребер, понятное дело, не хватит.

А как обстоит дело с аналогичным вопросом для сильно связного ориентированного графа? Решить его нам помогут исходящее и входящее деревья.

Теорема 8.2. Для сильно связного орграфа $G$ на п вершинах выполняются следующие утверждения.

1) Существует сильно связный остовный подграф орграфа $G$, в котором не более $2 n-2$ стрелок.
2) Если в орграфе $G$ между любыми двумя вершинами проведено не более одной стрелки, то существует сильно связный остовный подграф орграфа $G$, в котором не более $2 n-3$ стрелок.

Доказательство. 1) Пусть $v \in V(G)$, а $T_{v}^{+}$и $T_{v}^{-}$- это исходящее и входящее деревья вершины $v$, соответственно (они сущестувуют по следствию 8.1). Понятно, что остовный подграф орграфа $G$, полученный объединением этих двух деревьев, будет сильно связным и содержит не более $2 n-2$ стрелок.
1) Очевидно, в сильно связном орграфе есть цикл $Z$. Пусть в нем $k$ вершин. Из условия следует, что $k>2$. Построим новый орграф $G^{\prime}$, объединив все вершины цикла $Z$ в одну вершину $z$. (Все стрелки, соединяющие остальные вершины орграфа $G$ с вершинами цикла $Z$, в новом графе будут соединять эти же вершины с $z$. Возможно, в орграфе $G^{\prime}$ появятся кратные стрелки.) Легко видеть, что орграф $G^{\prime}$ на $n-k+1$ вершинах также будет сильно связным, следовательно, по пункту 1 в нем можно оставить не более $2(n-k)$ стрелок, обеспечивающих его связность. В орграфе $G$ к этим стрелкам мы добавим $k$ стрелок цикла $Z$ и получим сильно связный остов, в котором не более $2(n-k)+k \leq 2 n-3$ стрелок.

Задача 8.1. Для всех $v \geq 3$ постройте примеры орграфов, для которых оценки из теоремы 8.2 являются точными.

# 8.3 Сильная $k$-связность 

Мы определим разделяющие множества в ориентированном графе, как в обычном.

Определение 8.5. Пусть $D-$ орграф, $X, Y \subset V(D), R \subset V(D) \cup A(D)$.

1) Назовем множество $R$ разделяющим, если орграф $D-R$ не является сильно связным.

2) Орграф $D$ называется сильно $k$-связным, если $v(D) \geq k+1$ и $D$ не имеет разделяющего множества, состоящего из менее чем $k$ вершин.
3) Пусть $X \not \subset R, Y \not \subset R$. Будем говорить, что $R$ отделяет множество $X$ от множества $Y$, если в орграфе $D-R$ ни для каких вершин $v_{x} \in X$ и $v_{y} \in Y$ нет $v_{x} v_{y}$-пути.

Замечание 8.1. 1) Главное отличие разделяющих множеств в ориентированном графе от неориентированного случая в том, что множество $R$ может отделять $X$ от $Y$, но не отделять $Y$ от $X$.
1) D сильно $k$-связном графе $D$ для любой вершины $x \in V(D)$ выполнено $d_{D}^{*}(x) \geq k$ и $d_{D}^{-}(x) \geq k$. (Иначе, если, например, $d_{D}^{*}(x)<k$, то множество $\mathrm{N}_{D}^{*}(x)$ состоит из менее чем $k$ вершин и отделяет $x$ от остальных вершин графа.)

Для сильно $k$-связного графа выполняются аналог теоремы Менгера (см. раздел 5.1). Более того, у следующих теорем доказательства похожи на доказательства их неориентированных аналогов.

Теорема 8.3. Пусть $D-$ орграф, $X, Y \subset V(D),|X| \geq k,|Y| \geq k$ и любое множество $R \subset V(D)$, отделяющее $X$ от $Y$, содержит хотя бы $k$ вершин. Тогда в орграфе $D$ существуют $k$ непересекающихся $X Y$-путей.

Доказательство. Доказательство аналогично теореме 5.1. Индукция по количеству вершин в орграфе. Доказывая утверждение для орграфа $D$ и пары множеств $X, Y$ мы будем считать утверждение уже доказанным для всех меньших графов. Рассмотрим два случая.

1. Существует множество $R$ из $k$ вершин, отделяющее $X$ от $Y$. Тогда $X \backslash R \neq \varnothing$ и $Y \backslash R \neq \varnothing$. Отметим, что никакой $X R$-путь не содержит вершины из $Y \backslash R$ (иначе существовал бы $X Y$-путь, не содержащий ни одной вершины множества $R$ ). Следовательно, любое множество $S$, отделяющее $X$ от $R$ в орграфе $D_{x}=D-(Y \backslash R)$, отделяет $X$ от $R$ и в $D$. Но тогда $S$ отделяет $X$ от $Y$ в орграфе $D$, следовательно, $|S| \geq k$.

Таким образом, по индукционному предположению, существует $k$ непересекающихся $X R$-путей в графе $D_{x}$, а следовательно, и в орграфе $D$. Аналогично, существует $k$ непересекающихся $R Y$-путей в орграфе $D$. Отметим, что никакой $X R$-путь не пересекает никакой $R Y$-путь во внутреннейи вершине (иначе существовал бы $X Y$-путь, не содержащий ни одной вершины множества $R$ ). Так как $|R|=k$, мы можем состыковать $X R$-пути и $R Y$-пути по вершинам множества $R$, получив $k$ непересекающихся $X Y$-путей в $D$.

1. Нет множества из $k$ вершин, отделяющего $X$ от $Y$.

Случай, когда в $D$ нет стрелок, очевиден. Пусть $A(D) \neq \varnothing$. Тогда удалим из графа произвольную стрелку $x y$. Если условие теоремы выполняется в меньшем орграфе $D-x y$, то по индукционному предположению выполняется утверждение теоремы для $D-x y$, а следовательно, и для орграфа $D$.

Остается рассмотреть случай, когда существует множество $T \subset V(D)$, $|T| \leq k-1$, отделяющее $X$ от $Y$ в $D-x y$. Пусть $X^{\prime}=X \backslash T, Y^{\prime}=Y \backslash T$, эти множества, очевидно, непусты и не пересекаются. Пусть $T_{x}=T \cup\{x\}$, $T_{y}=T \cup\{y\}$.

Любой путь из $X^{\prime}$ в $Y^{\prime}$ в орграфе $D$ проходит по ребру $x y$ или по вершине множества $T$. Если $X^{\prime} \neq\{x\}$ и $Y^{\prime} \neq\{x\}$, то любой путь из $X^{\prime} \backslash\{x\}$ в $Y^{\prime} \backslash\{x\}$ проходит через одну из вершин множества $T_{x}$, следовательно, $T_{x}$ отделяет $X$ от $Y$ в $D$. Но $\left|T_{x}\right| \leq k$, а такого множества в рассматриваемом случае нет - противоречие. Значит, $X^{\prime}=\{x\}$ или $Y^{\prime}=\{x\}$. Аналогично, $X^{\prime}=\{y\}$ или $Y^{\prime}=\{y\}$.

Предположим, что $X^{\prime}=\{x\}$ и $Y^{\prime}=\{y\}$. Тогда $T \supset X \backslash\{x\}$ и $T \supset Y \backslash\{y\}$. Учитывая $|T| \leq k-1,|X| \geq k$ и $|Y| \geq k$, мы получаем

$$
X \backslash\{x\}=Y \backslash\{y\}=T \quad \text { и } \quad|T|=k-1
$$

В этом случае легко увидеть искомые пути - это стрелка $x y$ и $k-1$ общая вершина из $T=X \cap Y$.

Остается случай, когда $X^{\prime}=\{y\}$ и $Y^{\prime}=\{x\}$. В этом случае $X \ni y$ и $Y \ni x$, а значит, ни один $X Y$-путь не проходит по стрелке $x y$. Тогда $T$ отделяет $X$ от $Y$, что ввиду $|T| \leq k-1$ невозможно.
Следствие 8.2. Для орграфа $D$ выполнены следующие утверждения.

1) Пусть $x, y \in V(D), x y \notin A(D)$ и любое множество $R \subset V(D)$, отделяющее $x$ от $y$, содержит не менее чем $k$ вершин. Тогда в $D$ существует $k$ независимых ху-путей.
2) Пусть $x \in V(D), Y \subset V(D),|Y| \geq k$ и любое множество $R \subset V(D)$, отделяющее $x$ от $Y$, содержит не менее чем $k$ вершин. Toгда существуют $k$ не пересекающихся по внутренним вершинам путей от $x$ до различных вершин множества $Y$.
3) Пусть $X \subset V(D), y \in V(D),|X| \geq k$ и любое множество $R \subset V(D)$, отделяющее $X$ от $y$, содержит не менее чем $k$ вершин. Toгда существуют $k$ не пересекающихся по внутренним вершинам путей от различных вершин множества $X$ до $y$.

Доказательство. 1) Любой простой $x y$-путь в $D$ идёт из $x$ в $x_{1} \in \mathrm{~N}_{D}^{+}(x)$, далее в $y_{1} \in \mathrm{~N}_{D}^{-}(y)$ и затем в $y$ (возможно, вершины $x_{1}$ и $y_{1}$ совпадают). Тогда любое множество вершин $R$, отделяющее $\mathrm{N}_{D}^{+}(x)$ от $\mathrm{N}_{D}^{-}(y)$,

отделяет вершину $x$ от вершины $y$. Следовательно, $|R| \geq k$. Понятно, что $\left|\mathrm{N}_{D}^{+}(x)\right| \geq k$ и $\left|\mathrm{N}_{D}^{-}(y)\right| \geq k$. Тогда по теореме 8.3 существует $k$ непересекающихся $\mathrm{N}_{D}^{+}(x) \mathrm{N}_{D}^{-}(y)$-путей. Теперь легко найти и $k$ независимых $x y$-путей.
1) Очевидно, $\left|\mathrm{N}_{D}^{+}(x)\right| \geq k$. Так как $x \notin Y$, любое множество $R \subset V(G)$, отделяющее $\mathrm{N}_{D}^{+}(x)$ от $Y$, отделяет вершину $x$ от множества $Y$. Следовательно, $|R| \geq k$. Тогда по теореме 8.3 существует $k$ непересекающихся $\mathrm{N}_{D}^{+}(x) Y$-путей в орграфе $D$, а следовательно, и $k$ непересекающихся путей от $x$ до различных вершин множества $Y$.
2) Доказательство аналогично пункту 2.

Следствие 8.3. Пусть $D$ - сильно $k$-связный орграф. Тогда для любых двух вершин $x, y \in V(D)$ существует $k$ независимых ху-путей.

Доказательство. Индукция по $k$, база для $k=1$ очевидна. Докажем утверждения для сильно $k$-связного орграфа, считая, что оно доказано для орграфов меньшей связности.

Если $x y \notin A(D)$, то утверждение следует из следствия 8.2. Предположим, что $x y \in A(D)$. Если в $D-x y$ нельзя отделить $x$ от $y$ множеством из $k-2$ вершин, то по индукционному предположению существует $k-1$ независимых $x y$-путей в $D-x y$, а еще один путь - это стрелка $x y$.

Пусть $T \subset V(D)$ отделяет $x$ от $y$ в $D-x y$ и $|T| \leq k-2$. Но $T$ не является разделяющим множеством в $D$. Следовательно, орграф компонент сильной связности $D-T-x y$ - это простой путь с крайними компонентами $U_{x} \ni x$ (из нее нет исходящих стрелок) и $U_{y} \ni y$ (в нее нет исходящих стрелок). Если $U_{x} \neq\{x\}$, то множество $T \cup\{x\}$ является разделяющим в орграфе $D$ (отделяет $U_{x} \backslash\{x\}$ от $U_{y}$ ). Но это множество состоит из менее чем $k$ вершин, противоречие. Следовательно, $U_{x}=\{x\}$. Но тогда $d_{D}^{+}(x) \leq k-1$ (стрелки из $x$ могут выходить только в $T \cup\{y\}$ ), противоречие.

# 8.4 Гамильтоновы циклы в орграфе 

Гамильтонов цикл в орграфе определяется аналогично обычному графу - это простой ориентированный цикл, проходящий по всем вершинам. Можно обобщить на орграфы и один из классических критериев гамильтоновости - критерий Дирака (следствие 3.1), вот только доказательство будет идейно другим. С критерием Оре (теорема 3.1) это сделать не получается.

Начнем с леммы, которая также имеет аналог для неориентированных графов (лемма 1.3). На этот раз и доказательство аналогично.

Лемма 8.6. Пусть орераф $G$ таков, что $\max \left(\delta^{+}(G), \delta^{-}(G)\right) \geq k \geq 2$. Тогда $G$ имеет путь длины хотя бы $k$ и цикл длины хотя бы $k+1$.
Доказательство. Не умаляя общности предположим, что $\delta^{+}(G) \geq k$. Рассмотрим путь максимальной длины $P=a_{1} a_{2} \ldots a_{n}$ в орграфе $G$. Из его последней вершины $a_{n}$ выходит хотя бы $\delta(G)$ стрелок. Так как путь $P$ нельзя продлить, все эти стрелки выходят в $a_{1}, \ldots, a_{n-1}$. Пусть $a_{m}-$ вершина наименьшего номера, для которой $a_{n} a_{m} \in A(G)$. Тогда в множестве $\left\{a_{m}, \ldots, a_{n-1}\right\}$ лежат не менее $k$ концов выходящих из $a_{n}$ стрелок, следовательно, в этом множестве хотя бы $k$ вершин. Значит, путь и цикл $a_{m} \ldots a_{n-1} a_{n}$ нам подходят.
Теорема 8.4. (A. Ghouila-Houri, 1960.) Пусть орераф $G$ таков, что $\min \left(\delta^{+}(G), \delta^{-}(G)\right) \geq \frac{v(G)}{2}$. Тогда $G$ имеет гамильтонов цикл.
Доказательство. Рассмотрим максимальный цикл $C=v_{1} \ldots v_{m}$. Тогда $m \geq \frac{v(G)}{2}+1$ по лемме 8.6. Нумерацию вершин считаем циклической по модулю $m$.

Предположим, что цикл $C$ не является гамильтоновым и рассмотрим орграф $H=G-V(C)$. Пусть $P=u_{1} \ldots u_{k}$ - максимальный путь в $H$. Тогда

$$
m+k \leq v(G) \quad \text { и } \quad k \leq \frac{v(G)}{2}-1
$$

Положим

$$
S=\left\{i: v_{i} u_{1} \in A(G)\right\} \quad \text { и } \quad T=\left\{i: u_{k} v_{i+1} \in A(G)\right\}
$$

Если $S \cap T \ni i$, то мы увеличим цикл $C$, заменив стрелку $v_{i} v_{i+1}$ на путь $v_{i} u_{1} P u_{n} v_{i+1}$ (см. рисунок 8.1a), что противоречит максимальности цикла $C$. Следовательно, $S \cap T=\varnothing$.


Рис. 8.1: Гамильтонов цикл в орграфе.
В силу максимальности пути $P$ мы имеем $\mathrm{N}_{G}^{+}\left(u_{k}\right) \subset V(C) \cup V(P)$ и $\mathrm{N}_{G}^{-}\left(u_{1}\right) \subset V(C) \cup V(P)$, откуда следует

$$
\frac{v(G)}{2} \leq d_{G}^{+}\left(u_{k}\right) \leq k-1+|T|, \quad \frac{v(G)}{2} \leq d_{G}^{-}\left(u_{1}\right) \leq k-1+|S|
$$

Принимая во внимание $S \cap T=\varnothing$ и (8.1), получим

$$
|S| \geq 1, \quad|T| \geq 1 \quad \text { и } \quad|S \cup T|=|S|+|T| \geq v(G)-2 k+2 \geq m-k+2
$$

Существуют такие индексы $i$ и $j$, что $i \in S, i+1, \ldots, i+j-1 \notin S \cup T$ и $i+j \in T$ (в силу (8.2) мы имеем $j-1 \leq k-2$ ). Тогда $v_{i} u_{1}, u_{n} v_{i+j+1} \in$ $A(G)$ и мы получаем цикл $v_{i+j+1} C v_{i} u_{1} P u_{k}$ (см. рисунок 8.1 b ), в котором хотя бы на одну вершину больше чем в $C$. Противоречие.

# 8.5 Турниры 

Определение 8.6. Турниром, называется орграф, в котором любые две вершины соединены ровно одной стрелкой.

Такие орграфы называют турнирами, так как с их помощью удобно изображать однокруговые турниры без ничьих.

Лемма 8.7. 1) В турнире существует гамильтонов путь.
1) (P. Camion, 1959.) В сильно связном турнире существует гамильтонов иикл.

Доказательство. 1) Существование гамильтонова пути в любом турнире несложно доказать индукцией по количеству вершин.
1) В сильно связном турнире есть циклы. Рассмотрим в нашем турнире $T$ максимальный простой цикл $C=a_{1} a_{2} \ldots a_{k}$. Предположим, что в него вошли не все вершины графа, пусть вершина $b$ не вошла в этот цикл. Пусть не все стрелки между $b$ и циклом $C$ ориентированы одинаково. Тогда существуют последовательные вершины цикла $a_{i}$ и $a_{i+1}$ такие, что стрелки ориентированы следующим образом: $a_{i} b$ и $b a_{i+1}$ (см. рисунок 8.2 a ). В этом случае несложно удлинить максимальный цикл $C$, вставив вершину $b$ между $a_{i}$ и $a_{i+1}$, противоречие.

a

b

Рис. 8.2: Гамильтонов цикл в турнире.
Пусть из всех вершин цикла $C$ стрелки входят в $b$. Ввиду сильной связности турнира $T$ существует путь $S$ от $b$ до цикла $C$. Пусть $S$ впервые

пересекает цикл $C$ в вершине $a_{i+1}$ (см. рисунок 8.2 b ). Тогда, опять же, несложно удлинить наш максимальный цикл, заменив стрелку $a_{i} a_{i+1}$ на путь $a_{i} b S a_{i+1}$. Противоречие. Случай, когда из $b$ выходят ребра ко всем вершинам цикла $C$, аналогичен.

Как мы знаем, в любом связном графе $G$ существует вершина, удаление которой не нарушает связности этого графа (в качестве такой вершины подойдет любая висячая вершина произвольного остовного дерева графа $G$ ). Аналогичный факт для произвольного орграфа неверен (см. задачу ??), мы докажем его для турниров.

Теорема 8.5. В сильно связном турнире $G$ с четырьмя и более вершинами существуют две такие вершины $a, b \in V(G)$, что турниры $G-a$ и $G-b$ - сильно связные.

Доказательство. По лемме 8.7 в турнире $G$ есть гамильтонов цикл $a_{1} a_{2} \ldots a_{k}$ (нумерация вершин - циклическая). Если $a_{i} a_{i+2} \in A(D)$, то нетрудно понять, что турнир $G-a_{i+1}$ сильно связен. Если таких $i$ хотя бы два, то теорема доказана.

Рассмотрим случай, когда в $A(G)$ существует не более чем одна стрелка вида $a_{i} a_{i+2}$. Тогда можно предположить, что $a_{i+2} a_{i} \in A(G)$ при $i \neq k$, а ориентация ребра $a_{k} a_{k+2}=a_{k} a_{2}$ может быть произвольной.

a

b

Рис. 8.3: Удаление вершины $a_{k}$ с сохранением сильной связности.

Докажем, что в таком случае орграф $G-a_{k}$ сильно связен. Для этого достаточно показать, что существует путь из $a_{k-1}$ в $a_{1}$. Это несложно: по стрелкам-диагоналям гамильтонова цикла существует путь $a_{k-1} a_{k-3} \ldots$, приходящий, в зависимости от четности $k-1$, в $a_{1}$ (см. рисунок 8.3 a ) или в $a_{2}$ (см. рисунок 8.3 b ). Во втором случае дополним этот путь участком $a_{2} a_{3} a_{1}$. Таким образом, существует путь из $a_{k-1}$ в $a_{1}$, то есть, турнир $G-a_{k}$ сильно связен. Отметим, что мы не пользовались при этом рёбрами $a_{k} a_{2}$ и $a_{k} a_{k-2}$, их ориентация не имеет для нас значения. Поэтому аналогично доказывается, что турнир $G-a_{k-2}$ сильно связен.

Задача 8.2. а) Пусть $G$ - турнир с $n$ вершинами $(n \neq 3, n \neq 5)$. Тогда в нем существует такой гамильтонов путь $a_{1} a_{2} \ldots a_{n}$, что $a_{1} a_{n} \in A(G)$.
б) Найдите все турниры на 3 и 5 вершинах, для которых такого гамильтонова пути не существует.

Отметим, что на основании леммы 8.1 и того, что любые две вершины турнира соединены стрелкой, можно сделать вывод, что структура компонент сильной связности турнирного графа представляет собой простой путь $V_{1} V_{2} \ldots V_{m}$, в котором для любых двух различных компонент $V_{i}$ и $V_{j}$, где $i<j$, все ребра графа ориентированы от $V_{i}$ к $V_{j}$.

# 8.5.1 Циклы в сильно связных турнирах 

Теорема 8.6. (J. W. Moon, 1966.) Пусть $G$ - сильно связный mypнир, а $k \in \mathbb{N}, 3 \leq k \leq v(G)$. Тогда выполнены следующие утверждения.

1) Для любой вершины $v \in V(G)$ существует простой иикл длины $k$, проходящий через $v$.
2) $B$ орграфе $G$ существует хотя бы $v(G)+1-k$ простых циклов длины $k$.

Доказательство. Зафиксируем $k$ и будем доказывать оба утверждения индукцией по количеству вершин турнира $G$. При $v(G)=k$ оба утверждения следуют из пункта 2 леммы 8.7: в сильно связном турнире $G$ есть гамильтонов цикл.

1) Пусть $v(G)>k$. Тогда по теореме 8.5 существует такая вершина $w \neq v$, что турнир $G-w$ сильно связен. Так как

$$
3 \leq k \leq v(G)-1=v(G-w)
$$

по индукционному предположению в турнире $G-w$ есть простой цикл длины $k$, проходящий через $v$. Этот же цикл есть и в турнире $G$.
1) Пусть $v(G)>k$. Тогда по теореме 8.5 существует такая вершина $w$, что турнир $G-w$ сильно связен. В турнире $G-w$ существует не менее $v(G-w)+1-k=v(G)-k$ простых циклов длины $k$. По пункту 1 в турнире $G$ существует простой цикл длины $k$, проходящий через вершину $w$, следовательно, в турнире $G$ не менее чем $v(G)-k+1$ простых циклов длины $k$.

Что интересно, оценка из пункта 2 теоремы 8.6 точна и, более того, для каждого $n$ существует сильно связный турнир с $n$ вершинами, на котором достигается минимум количества простых циклов длины $k$ для каждого $k \in[3 . . n]$, а значит, и минимум суммарного количества циклов.

Этот турнир $G_{n}$ таков: пусть $V\left(G_{n}\right)=\left\{v_{1}, \ldots, v_{n}\right\}$, в $G_{n}$ есть гамильтонов путь $P=a_{1} a_{2} \ldots a_{n}$, а для любой пары индексов $i, j$, где $j \geq i+2$, выполнено $a_{j} a_{i} \in A(G)$ (то есть, все остальные стрелки ориентированы против направления пути $P$ ). Нетрудно убедиться, что для этого турнира неравенства из теоремы 8.6 для всех возможных $k$ обращаются в равенства.

Отметим, что вопрос о максимуме количества простых циклов длины $k>3$ в сильно связном турнире с числом вершин более $k$ остается открытым.

# 8.5.2 Гамильтоновы пути в турнирном графе 

Определение 8.7. 1) Количество гамильтоновых путей в орграфе $G$ будем обозначать через $h(G)$.
1) Назовём турнир $T$ на $n$ вершинах транзитивным, если его вершины можно пронумеровать $v_{1}, \ldots, v_{n}$ так, что $v_{i} v_{j} \in A(T)$ при $i<j$.

Понятно, что в транзитивном турнире ровно один гамильтонов путь. А сколько их может быть в других турнирах?

Теорема 8.7. (L. Redei, 1934.) Количество гамильтоновых путей в турнире нечетно.

Доказательство. Индукция по количеству вершин турнира. База для турнира на двух вершинах очевидна, докажем индукционный переход.

Введем следующие обозначения для количеств гамильтоновых путей в турнире $G$ :
$h(G, a b)$ - это количество гамильтоновых путей, проходящих стрелку $a b$ или $b a$ (в том направлении, в котором она есть в турнире $G$ );
$h(G, a b c)$ - это количество гамильтоновых путей, проходящих участок $a b c$;
$h(G, \mid a)$ и $h(G, a \mid)$ - это количество гамильтоновых путей графа $G$, начинающихся и кончающихся в $a$ соответственно;
$h(G, \mid a b)$ - количество гамильтоновых путей, начинающихся в $a$ и проходящих по стрелке $a b$;
$h(G, a b \mid)$ - количество гамильтоновых путей, проходящих по стрелке $a b$ и кончающихся в $b$.

Докажем следующее утверждение. Четность количества гамильтоновых путей в турнире не изменится, если поменять направление одной стрелки.

Доказательство. Пусть турниры $G$ и $G^{\prime}$ отличаются одной стрелкой: $a b \in A(G)$ и $b a \in A\left(G^{\prime}\right)$ (см. рисунок 8.4 a ). Отметим, что

$$
h(G)-h\left(G^{\prime}\right)=h(G, a b)-h\left(G^{\prime}, a b\right)
$$

и потому нам достаточно доказать четность $h(G, a b)-h\left(G^{\prime}, a b\right)$.


Рис. 8.4: Графы $G, G^{\prime}, H_{x}, H_{x}^{\prime}$.
Рассмотрим произвольную вершину $x \in V(G) \backslash\{a, b\}$. Введем обозначения (см. рисунок 8.4 b$)$
$H_{x}$ - это турнир $G-b$, в котором, возможно, изменено направление стрелки между $a$ и $x: a x \in A\left(H_{x}\right)$;
$H_{x}^{\prime}$ - это турнир $G-b$, в котором, возможно, изменено направление стрелки между $a$ и $x: x a \in A\left(H_{x}\right)$.

Турниры $H_{x}$ и $H_{x}^{\prime}$ отличаются ориентацией одной стрелки, а турнир $G-b=G^{\prime}-b$ совпадает с одним из $H_{x}$ и $H_{x}^{\prime}$. Следовательно, из индукционного предположения следует

$$
h\left(H_{x}\right) \equiv h\left(H_{x}^{\prime}\right) \equiv h(G-b) \quad(\bmod 2)
$$

Отметим, что

$$
\begin{aligned}
h(G-b)-h\left(H_{x}\right)=h(G-b, a x)-h\left(H_{x}, a x\right) \quad \text { и } \\
h(G-b)-h\left(H_{x}^{\prime}\right)=h(G-b, a x)-h\left(H_{x}^{\prime}, a x\right)
\end{aligned}
$$

откуда

$$
h(G-b, a x) \equiv h\left(H_{x}, a x\right) \equiv h\left(H_{x}^{\prime}, a x\right) \quad(\bmod 2)
$$

Теперь можно сделать вывод

$$
\begin{aligned}
h(G, a b)=h(G, a b \mid) & +\sum_{x \in \mathrm{~N}_{G}^{x}(b)} h(G, a b x)=h(G-b, a \mid)+\sum_{x \in \mathrm{~N}_{G}^{x}(b)} h\left(H_{x}, a x\right) \\
& \equiv h(G-b, a \mid)+\sum_{x \in \mathrm{~N}_{G}^{x}(b)} h(G-b, a x) \quad(\bmod 2)
\end{aligned}
$$

Аналогично получаем

$$
\begin{aligned}
h\left(G^{\prime}, a b\right)=h\left(G^{\prime},|b a)\right. & \left.+\sum_{y \in \mathrm{~N}_{G^{\prime}}^{*}(b)} h\left(G^{\prime}, y b a\right)=h(G-b,|a)+\sum_{y \in \mathrm{~N}_{G^{\prime}}^{*}(b)} h\left(H_{y}^{\prime}, y a\right)\right) \\
& \equiv h(G-b,|a)+\sum_{y \in \mathrm{~N}_{G^{\prime}}^{*}(b)} h(G-b, a y) \quad(\bmod 2)
\end{aligned}
$$

Сложив сравнения (8.4) и (8.5) и принимая во внимание, что

$$
N_{G}^{+}(b) \cup N_{G^{\prime}}^{-}(b)=V(G) \backslash\{a, b\}
$$

(см. рисунок 8.4a), получим

$$
\begin{aligned}
& h(G, a b)+h\left(G^{\prime}, a b\right) \\
& \quad \equiv h(G-b, a|)+h(G-b,|a)+\sum_{y \in V(G) \backslash\{a, b\}} h(G-b, a y) \quad(\bmod 2)
\end{aligned}
$$

Заметим, что каждый гамильтонов путь турнира $G-b$ либо проходит через вершину $a$ и в этом случае содержит две инцидентных вершине $a$ стрелки, либо начинается или кончается в вершине $a$ и в этом случае содержит одну инцидентную вершине $a$ стрелку. Следовательно, правая часть сравнения (8.6) равна $2 \cdot h(G-b)$, и потому четна. Ввиду равенства (8.3) утверждение доказано.

Теперь поменяем направление стрелок так, чтобы турнир стал транзитивным. В таком турнире, очевидно, ровно один гамильтонов путь. Следовательно, в исходном турнире количество гамильтоновых путей было нечетным.

Определение 8.8. Назовём турнир $T$ на $n \geq 3$ вершинах почти транзитивным, если его вершины можно пронумеровать $v_{1}, \ldots, v_{n}$ так, что $v_{n} v_{1} \in A(T)$ и $v_{i} v_{j} \in A(T)$ при $i<j,(i, j) \neq(1, n)$.

Замечание 8.2. Отметим, что сильно связный турнир, который можно сделать транзитивным, поменяв направление ровно одной стрелки - это почти транзитивный турнир.

Итак, в любом турнире есть гамильтонов путь. В транзитивном турнире гамильтонов путь единственен. Казалось бы, вот он, минимум числа гамильтоновых путей в турнирах!

Но посмотрим глубже: пусть турнир $T$ не является сильно связным, $V_{1} \ldots V_{k}$ - его орграф компонет сильной связности (напомним, что этот

орграф - простой путь), а $T_{i}=T\left(V_{i}\right)$. Тогда, очевидно, любой гамильтонов путь турнира $T$ должен проходить сначала все вершины из $V_{1}$, затем - вершины из $V_{2}$, и так далее, заканчиваться путь будет вершинами компоненты $V_{k}$. Поэтому, $h(T)=h\left(T_{1}\right) \ldots h\left(T_{k}\right)$. Тем самым, интересна следующая задача: найти минимум количества гамильтоновых путей в сильно связных турнирах на $n$ вершинах (естественно, при $n \geq 3$ ). Обозначим этот минимум через $h(n)$. Эта задача имеет достаточно изящное решение, которое было получено лишь в 2005 году Бушем. Отметим, что начал эти исследования Мун в 1972 году, построив серию примеров, на которых достигается оценка из теоремы 8.8.

Теорема 8.8. (А. Н. Busch, 2005.) Пусть $n \geq 3, \beta=\sqrt[3]{5}$. Тогда

$$
h(n)= \begin{cases}\beta^{n-1} & \text { npu } n \equiv 1 \quad(\bmod 3) \\ 3 \cdot \beta^{n-3} \approx 1.026 \cdot \beta^{n-1} & \text { npu } n \equiv 0 \quad(\bmod 3) \\ 9 \cdot \beta^{n-5} \approx 1.053 \cdot \beta^{n-1} & \text { npu } n \equiv 2(\bmod 3)\end{cases}
$$

Для начала докажем несколько лемм. Первая из них очевидна.
Лемма 8.8. В нетранзитивном турнире $T$ есть треугольник.
Доказательство. В нетранзитивном турнире есть хотя бы один цикл, пусть $C$ - минимальный цикл турнира $T$. Тогда этот цикл является треугольником, иначе, рассмотрев любую его диагональ, можно найти меньший цикл.

Лемма 8.9. Пусть $T$ - сильно связный турнир. Тогда либо $T$ - почти транзитивный, либо существуют такие множества $A, B \subset V(T)$, что $|A|,|B| \geq 3, A \cup B=V(T), A \cap B=\{w\}$, а турниры $T(A)$ и $T(B)$ сильно связные.

Доказательство. По лемме 8.7 в турнире $T$ есть гамильтонов цикл $Z=a_{1} a_{2} \ldots a_{n}$. Нумерация вершин - циклическая, то есть $a_{i+n}=a_{i}$. Пусть длина диагонали $a_{i} a_{j}$ цикла $Z$ - это остаток от деления на $n$ числа $j-i$. Рассмотрим два случая.

1. Для каждого $i$ выполняется $a_{i} a_{i+2} \in A(T)$.

Тогда пусть $A$ состоит из всех вершин с нечётными номерами, $B$ - из $a_{1}$ и всех вершин с чётными номерами. Нетрудно видеть, что $A \cap B=\left\{a_{1}\right\}$, а индуцированные турниры $T(A)$ и $T(B)$ - сильно связные.
1. Существует диагональ $a_{i+2} a_{i} \in A(T)$.

Не умаляя общности будем считать, что $a_{1} a_{n-1} \in A(T)$. Докажем, что при $1 \leq i<j \leq n-1$ диагональ $a_{i} a_{j} \in A(T)$. Пусть это не так, тогда выберем диагональ $a_{x} a_{y} \in A(T)$, где $x, y \in[1 . . n-1], x>y$

и $x-y$ - максимально. Понятно, что выполняется хотя бы одно из условий $x \neq n-1$ и $y \neq 1$. Пусть $x \neq n-1$ (второй случай аналогичен). Тогда $a_{y} a_{x+1} \in A(T)$, следовательно, для множеств $A=\left\{a_{y}, a_{y+1}, \ldots, a_{x}\right\}$ и $B=\left\{a_{x+1}, \ldots, a_{n}, a_{1}, \ldots, a_{y}\right\}$ индуцированные турниры $T(A)$ и $T(B)$ сильно связны, $A \cap B=\left\{a_{y}\right\}$ (см. рисунок 8.5 a ). В этом случае лемма доказана.


Рис. 8.5: Множества вершин $A$ и $B$.
Итак, при $i, j \in[1 . . n-1]$ и $i<j$ мы имеем $a_{i} a_{j} \in A(T)$. Осталось разобраться, как направлены стрелки, инцидентные $a_{n}$. Если существует такое $i \in[2 . . n-2]$, что $a_{i} a_{n}, a_{n} a_{i+1} \in A(T)$, то множества

$$
A=\left\{a_{n}, a_{1}, \ldots, a_{i}\right\}, \quad \text { и } \quad B=\left\{a_{i+1}, a_{i+2}, \ldots, a_{n}\right\}
$$

таковы, что турниры $T(A)$ и $T(B)$ сильно связны и $A \cap B=\left\{a_{n}\right\}$ (см. рисунок 8.5 b ). В этом случае лемма доказана.

Остаётся случай, когда для некоторого $k \in[1 . . n-2]$ стрелки в нашем графе стрелки ориентированы таким образом:

$$
a_{n} a_{1}, \ldots, a_{n} a_{k} \in A(T), \quad a_{k+1} a_{n}, \ldots, a_{n-1} a_{n} \in A(T)
$$

При $k=n-2$ турнир $T$ почти транзитивен (с порядком $a_{n}, a_{1}, \ldots, a_{n-1}$ ). При $k=1$ турнир $T$ почти транзитивен (с порядком $a_{1}, \ldots, a_{n-1}, a_{n}$ ). Если же $k \in[2 . . n-3]$, то $a_{k-1} a_{k+2} \in A(T)$. Следовательно, множества $A=\left\{a_{k}, a_{k+1}, a_{n}\right\}$ и $B=V(T) \backslash\left\{a_{k}, a_{k+1}\right\}$ таковы, что $T(A)$ и $T(B)$ сильно связны и $A \cap B=\left\{a_{n}\right\}$ (см. рисунок 8.5 c ).

Лемма 8.10. Пусть $T_{n}$ - почти транзитивный турнир на $n$ вершинах. Тогда $h\left(T_{n}\right)=2^{n-2}+1$.

Доказательство. Пусть $V\left(T_{n}\right)=\left\{v_{1}, \ldots, v_{n}\right\}$, причём $v_{n} v_{1} \in A(T)$ и $v_{i} v_{j} \in A(T)$ при $i<j,(i, j) \neq(1, n)$. Очевидно, существует ровно один гамильтонов путь в графе $T_{n}$, не проходящий по ребру $v_{n} v_{1}$.

Рассмотрим гамильтонов путь $P$, проходящий по $v_{n} v_{1}$. Тогда множество вершин $U=\left\{v_{2}, \ldots, v_{n-1}\right\}$ можно разбить на два подмножества $U_{P}$ и $U_{P}^{\prime}$ так, что сначала путь $P$ обходит вершины из $U_{P}$ в порядке возрастания номеров, затем идёт в вершину $v_{n}$, потом в $v_{1}$ и, наконец, обходит вершины из $U_{P}^{\prime}$ в порядке возрастания номеров. Таким образом, существует биекция $P \rightarrow U_{P}$ между гамильтоновыми путями турнира $T_{n}$, проходящими по ребру $v_{n} v_{1}$ и подмножествами $U$, а значит, количество таких путей равно $2^{n-2}$.

Лемма 8.11. Пусть $P$ и $Q$-два непересекащихся пути в турнире $T$. Тогда существует путь $R$ на вершинах $V(P) \cup V(Q)$, в котором все вершины из $V(P)$ следуют в порядке пути $P$, а все вершины из $V(Q)$ следуют в порядке пути $Q$.

Доказательство. Пусть $P=u_{1} \ldots u_{n}, Q=v_{1} \ldots v_{m}$. Докажем лемму индукцией по $m$ - длине пути $Q$. В случае, когда $m=0$, утверждение очевидно. В случае $m=1$ тоже несложно: если из $u_{1}$ выходят стрелки во все вершины пути $P$, то добавим $v_{1}$ в начало пути. Иначе найдём такое наибольшее число $k$, что $u_{k} v_{1} \in A(G)$ и вставим вершину $v_{1}$ после $u_{k}$.

Пусть утверждение доказано для пути меньшей длины, воспользуемся им для путей $P$ и $Q^{\prime}=v_{1} \ldots v_{m-1}$ и построим путь $R^{\prime}$. Если вершина $v_{m-1}$ - конец пути $R^{\prime}$, то поставим $v_{m}$ после $v_{m-1}$. Пусть вершина $v_{m-1}$ вставлена в путь $R^{\prime}$ перед вершиной $u_{t}$. Тогда воспользуемся утверждением базы для путей $P^{\prime}=u_{t} \ldots u_{n}$ и вершины $v_{m}$ и поставим полученный путь $S$ после вершины $v_{m-1}$ (очевидно, это возможно). В результате вершина $v_{m}$ будет вставлена в объединённый путь после вершины $v_{m-1}$.

Лемма 8.12. Пусть $T-$ турнир, а множества $A, B \subset V(T)$ таковы, что $A \cup B=V(T), A \cap B=\{w\},|A|=k \geq 3,|B|=m \geq 3$. Тогда $h(T) \geq h(T(A)) \cdot h(T(B))$.

Доказательство. Рассмотрим произвольные гамильтоновы пути $P$ турнира $T(A)$ и $Q$ турнира $T(B)$. Эти пути, очевидно, имеют вид $P=P_{1} w P_{2}$ и $Q=Q_{1} w Q_{2}$. (Возможно, какие-то из участков $P_{1}, P_{2}, Q_{1}$ и $Q_{2}-$ пустые. Вершина $w$ в них не входит.) По лемме 8.11 существует путь $R_{1}$ на вершинах $V\left(P_{1}\right) \cup V\left(Q_{1}\right)$, в котором все вершины из $V\left(P_{1}\right)$ следуют в порядке пути $P_{1}$, а все вершины из $V\left(Q_{1}\right)$ следуют в порядке пути $Q_{1}$. Отметим, что если $V\left(R_{1}\right) \neq \varnothing$, то путь $R_{1}$ кончается либо последней вершиной пути $P_{1}$, либо последней вершиной пути $Q_{1}$. Таким образом, либо $V\left(R_{1}\right)=\varnothing$, либо из последней вершины пути $R_{1}$ выходит стрелка в $w$.

Аналогично, существует путь $R_{2}$ на вершинах $V\left(P_{2}\right) \cup V\left(Q_{2}\right)$, в котором все вершины из $V\left(P_{2}\right)$ следуют в порядке пути $P_{2}$, а все вершины



Рис. 8.6: Пути $P_{1}, P_{2}, Q_{1}$ и $Q_{2}$.

из $V\left(Q_{2}\right)$ следуют в порядке пути $Q_{2}$. Если $V\left(R_{2}\right) \neq \varnothing$, то этот путь начинается либо первой вершиной пути $P_{2}$, либо первой вершиной пути $Q_{2}$. Таким образом, либо $V\left(R_{2}\right)=\varnothing$, либо из $w$ выходит стрелка в первую вершину пути $R_{2}$.

Тогда $R=R_{1} w R_{2}$ - гамильтонов путь в турнире $T$, в котором вершины турнира $T(A)$ следуют в порядке пути $P$, а вершины турнира $T(B)$ следуют в порядке пути $Q$. Каждой паре гамильтоновых путей $(P, Q)$ очевидно, соответствует свой путь $R$.

Доказательство теоремы 8.8. Пусть

$$
c_{n}=\left\{\begin{array}{lll}
1 & \text { при } n \equiv 1 & (\bmod 3) \\
\frac{3}{\beta^{4}} \approx 1.026 & \text { при } n \equiv 0 & (\bmod 3) \\
\frac{9}{\beta^{4}} \approx 1.053 & \text { при } n \equiv 2 & (\bmod 3)
\end{array}\right.
$$

где, напомним, $\beta=\sqrt[3]{5}$. Нам нужно доказать, что $h(n)=c_{n} \beta^{n-1}$.
$\geq$. Докажем, что $h(n) \geq c_{n} \beta^{n-1}$ индукцией по количеству вершин. Базу составит случаи $n=3, n=4$ и $n=5$. Нетрудно проверить, что в этих случаях $h(n)=h\left(T_{n}\right)=2^{n-2}+1$, то есть, $h(3)=3, h(4)=5$ и $h(5)=9$, как того требует теорема.

Пусть $n \geq 6$ и $T$ - сильно связный турнир на $n$ вершинах, для которого $h(T)=h(n)$. Если $T=T_{n}-$ почти транзитивный турнир то $h\left(T_{n}\right)=2^{n-2}+1$, что, как несложно прверить, больше указанных в теореме значений. Поэтому, турнир $T$ не является почти транзитивным.

Тогда по лемме 8.9 существуют такие множества $A, B \subset V(G)$, что $A \cup B=V(T), A \cap B=\{w\},|A|=k \geq 3,|B|=n+1-k \geq 3$, а турниры $T(A)$ и $T(B)$ - сильно связные. По лемме 8.12 мы имеем

$$
h(T) \geq h(T(A)) \cdot h(T(B)) \geq h(k) \cdot h(n+1-k) \geq c_{k} c_{n+1-k} \beta^{n-1} \geq c_{n} \beta^{n-1}
$$

В неравенстве $c_{k} \cdot c_{n+1-k} \geq c_{n}$ несложно убедиться, перебирая различные остатки от деления на 3 числа $k$.
$\leq$. Пусть $T_{1}, T_{2}, \ldots, T_{m}$ - почти транзитивные турниры на (пока что) непересекающихся множествах вершин. Для каждого $i \in[1 . . m-1]$ мы

отождествим последнюю вершину турнира $T_{i}$ и первую вершину турнира $T_{i+1}$ (вершины почти транзитивного турнира нумеруются, как в определении 8.8), назовём эту вершину $w_{i}$. Пусть $w_{0}$ - это первая вершина турнира $T_{1}$, а $w_{n}$ - последняя вершина турнира $T_{n}$. Все стрелки, не являющиеся рёбрами склеенных турниров мы ориентируем от турнира с меньшим номером к турниру с большим номером. Обозначим полученный граф за $T$, будем называть его цепочкой почти транзитивных турниров $T_{1}, \ldots, T_{m}$. Вершину $w_{0}$ назовём началом, а вершину $w_{n}-$ концом цепочки $T$.


Рис. 8.7: Цепочка почти транзитивных турниров.

Лемма 8.13. Пусть $T$ - турнир на $n$ вершинах, $A, B \subset V(G)$, $A \cup B=V(T), A \cap B=\{w\}$. Пусть $T(A), T(B)$ и $T$ - цепочки почти транзитивных турниров. Тогда $h(T)=h(T(A)) \cdot h(T(B))$.

Доказательство. Понятно, что $w$ - конец цепочки $T(A)$ и начало цепочки $T(B)$. Обозначим через $T_{A}$ почти транзитивный турнир - последнее звено цепочки $T(A)$. Понятно, что последняя вершина $T_{A}$ - это $w$, обозначим первую вершину $T_{A}$ за $a$. Аналогично, пусть почти транзитивный турнир $T_{B}$ - первое звено цепочки $T(B)$, пусть $b$ - последняя вершина $T_{B}$ (первой вершиной, очевидно, является $w$ ). Тогда $a$ - единственная вершина множества $A$, в которую выходит стрелка из $w$, а $b$ - единственная вершина множества $B$, из которой выходит стрелка в $w$ (см. рисунок 8.8 ).


Рис. 8.8: Вершины $w, a$ и $b$.

Пусть $R=R_{1} w R_{2}$ - гамильтонов путь в турнире $T$. Рассмотрим путь $R_{1}$. Он не проходит по вершине $w$, поэтому сначала в этом пути идут вершины множества $A$ (обозначим этот участок пути за $P_{1}$ ), а потом - вершины множества $B$ (обозначим этот участок пути за $Q_{1}$ ). Аналогично, в пути $R_{2}$ сначала в этом пути идут вершины множества $A$ (обозначим этот участок пути за $P_{2}$ ), а потом - вершины множества $B$ (обозначим этот участок пути за $Q_{2}$ ). Возможно, какие-то из путей $P_{1}$, $P_{2}, Q_{1}, Q_{2}$ - пустые. Отметим, что

$$
V\left(P_{1}\right) \cup V\left(P_{2}\right)=A \backslash\{w\}, \quad V\left(Q_{1}\right) \cup V\left(Q_{2}\right)=B \backslash\{w\}
$$

Итак, $R=P_{1} Q_{1} w P_{2} Q_{2}$. Тогда либо $V\left(P_{2}\right)=\varnothing$, либо первая вершина пути $P_{2}$ - эта единственная вершина множества $A$, в которую выходит стрелка из $w$ - вершина $a$. Мы хотим доказать, что $P_{1} w P_{2}$ - путь, тогда он будет гамильтоновым путём в $T(A)$. Для этого остаётся доказать, что путь $P_{1}$ кончается вершиной, из которой выходит стрелка в $w$, то есть, что $P_{1}$ не кончается в $a$. Предположим, что это не так и последняя вершина пути $P_{1}$ - это $a$. Тогда из доказанного выше следует, что $V\left(P_{2}\right)=\varnothing$, следовательно, $P_{1}$ - гамильтонов путь в $T(A) \backslash\{w\}$, заканчивающийся в $a$. Но $T_{A}-w$ - транзитивный турнир, поэтому из вершин непустого множества $V\left(T_{A}\right) \backslash\{a, w\}$, куда гамильтонов путь $P_{1}$ обязательно должен зайти, он не сможет попасть в свой конец $a$. Полученное противоречие показывает, что $P=P_{1} w P_{2}$ - гамильтонов путь в $T(A)$. Аналогично, $Q=Q_{1} w Q_{2}$ - гамильтонов путь в $T(B)$.

Таким образом, каждому гамильтонову пути $R$ турнира $T$ соответствует пара гамильтоновых путей $(P, Q)$ турниров $T(A)$ и $T(B)$, соответственно. Нетрудно понять, что это соответствие - биекция: описанная в лемме 8.12 операция, наоборот, поставит в соответствие паре путей $(P, Q)$ путь $R$. Тем самым, лемма доказана.

Вернёмся к цепочке $T$ почти транзитивных турниров $T_{1}, \ldots, T_{m}$. Применив последовательно к склейкам турниров-звеньев цепочки в вершинах $w_{1}, \ldots, w_{m-1}$ лемму 8.13 , мы получим, что $h(T)=h\left(T_{1}\right) \cdots \cdots h\left(T_{m}\right)$.

Теперь осталось использовать полученную формулу для построения турнира на $n$ вершинах $T$, на котором достигается равенство $h(T)=h(n)$.

Для $n=3 k+1$ пусть $T$ - цепочка из $k$ почти транзитивных турниров на 4 вершинах. Понятно, что $v(T)=3 k+1=n, h(T)=h(4)^{k}=\beta^{n-1}$.

Для $n=3 k$ пусть $T$ - цепочка из $k-1$ почти транзитивных турниров на 4 вершинах и одного турнира на 3 вершинах. Тогда $v(T)=3 k=n$, $h(T)=h(3) \cdot h(4)^{k-1}=c_{n} \beta^{n-1}$.

Для $n=3 k+2$ пусть $T$ - цепочка из $k-1$ почти транзитивных турниров на 4 вершинах и одного турнира на 5 вершинах. В этом случае

$v(T)=3 k+2=n, h(T)=h(5) \cdot h(4)^{k-1}=c_{n} \beta^{n-1}$.

# 8.6 Независимые множества вершин в орграфе 

Пусть $G$ - орграф. Как и в неориентированном случае, $\alpha(G)$ - количество вершин в максимальном независимом множестве вершин графа $G$ (то есть, максимальном множестве вершин, никакие две из которых не соединены стрелкой). В этом разделе мы докажем две теоремы, связанные с независимыми множествами в орграфе.

### 8.6.1 Теорема Хватала-Ловаса

Теорема 8.9. (V. Chvatal, L. Lovasz, 1974.) B любом орграфе $G$ существует такое независимое множество $S \subset V(G)$, что для любой вершины $v \in V(G) \backslash S$ существует путь длины не более 2 с началом в $S$ и кониом $v$.

Доказательство. Доказательство будет индукцией по количеству вершин в орграфе. База при $v(G)=1$ очевидна, докажем индукционный переход. Рассмотрим любую вершину $v \in V(G)$. Если $V(G)=\{v\} \cup \mathrm{N}_{G}^{+}(v)$, то утверждение теоремы очевидно, нам подходит $S=\{v\}$.


Рис. 8.9: Множества $S^{\prime}$ и $S$.
В противном случае для орграфа $G^{\prime}=G-\left(\{v\} \cup \mathrm{N}_{G}^{+}(v)\right)$ утверждение доказано, возьмем соответствующее этому графу независимое множество $S^{\prime}$. Если существует такая вершина $w \in S^{\prime}$, что $v \in N_{G}^{+}(w)$, то множество $S^{\prime}$ подходит и для графа $G$ (см. рисунок 8.9a). В противном случае положим $S=S^{\prime} \cup\{v\}$. Так как $S^{\prime} \cap \mathrm{N}_{G}^{+}(v)=\varnothing$, в рассматриваемом случае множество $S$ независимо, и, очевидно, любая вершина $x \in V(G) \backslash S$ достижима из $S$ по пути длины не более 2 (см. рисунок 8.9 b).

В разделе 8.7.2 мы докажем, что для орграфа $G$ без нечетных циклов можно выбрать множество $S$ так, чтобы из каждой вершины $v \in V(G) \backslash S$ выходила стрелка в $S$. Такое множество называется ядром орграфа и имеет множество применений для построения списочных раскрасок.

Следствие 8.4. В любом турнире $G$ существует такая вершина $v$, что для любой вершины $w \in V(G)$ существует $v w$-путь длины не более 2 .

Утверждение является прямым следствием теоремы 8.9 ввиду того, что в полном графе не может быть независимого множества более чем из одной вершины.

# 8.6.2 Покрытие вершин путями 

Теорема 8.10. (T. Gallai, A. Milgram, 1960.) Вершины орграфа $G$ можно покрыть не более, чем $\alpha(G)$ попарно непересекающимися простыми путями.

Доказательство. Для каждого простого пути $P$ обозначим его конеи, через $t(P)$.

Будем называть покрытием орграфа $G$ множество из нескольких попарно непересекающихся простых путей $G$, покрывающих все его вершины. Для каждого покрытия $\mathcal{P}$ обозначим через $T(\mathcal{P})$ множество концов всех путей из $\mathcal{P}$.

На множестве покрытий орграфа $G$ мы введём отношение порядка: будем считать, что $\mathcal{P}_{1}<\mathcal{P}_{2}$, если $\left|\mathcal{P}_{1}\right|<\left|\mathcal{P}_{2}\right|$ и $T\left(\mathcal{P}_{1}\right) \subset T\left(\mathcal{P}_{2}\right)$.

Докажем вспомогательное утверждение.
Пусть $\mathcal{P}$ - минимальное по введённому отношению порядка покрытие орграфа $G$. Тогда на каждом пути из $\mathcal{P}$ можно выбрать по вершине так, чтобы множество выбранных вершин было независимым.

Доказательство. Будем доказывать утверждение индукцией по $v(G)$. Пусть $\mathcal{P}=\left\{P_{1}, \ldots, P_{n}\right\}, u_{i}=t\left(P_{i}\right)$. Если множество $\left\{u_{1}, \ldots, u_{n}\right\}$ - независимое, то утверждение доказано. Предположим, что $u_{i} u_{j} \in A(G)$. Пусть путь $Q_{i}$ получен из $P_{i}$ добавлением ребра $u_{i} u_{j}$. Если $V\left(P_{j}\right)=\left\{u_{j}\right\}$, то заменой $P_{i}$ и $P_{j}$ на $Q_{i}$ получаем строго меньшее в нашем порядке чем $\mathcal{P}$, покрытие, что невозможно.

Значит, $V\left(P_{j}\right) \neq\left\{u_{j}\right\}$. Тогда рассмотрим граф $G^{\prime}=G-u_{j}$ и его покрытие $\mathcal{P}^{\prime}$, полученное заменой пути $P_{j}$ на $P_{j}^{\prime}=P_{j}-u_{j}$. Докажем, что $\mathcal{P}^{\prime}$ - минимальное покрытие графа $G^{\prime}$. Если это не так, рассмотрим строго меньшее в нашем порядке покрытие $\mathcal{Q}^{\prime}$ графа $G^{\prime}$. Пусть $u_{j}^{\prime}=t\left(P_{j}^{\prime}\right)$,

ясно, что $u_{j}^{\prime} u_{j} \in A(G)$. Отметим, что единственная вершина, которая может входить в $T\left(\mathcal{Q}^{\prime}\right)$ и не входит в $T(\mathcal{P})$ - это $u_{j}^{\prime}$. Рассмотрим три случая.

1. Существует путь $Q^{\prime} \in \mathcal{Q}^{\prime}$ с $t\left(Q^{\prime}\right)=u_{j}^{\prime}$.

Пусть путь $Q$ получен из $Q^{\prime}$ добавлением ребра $u_{j}^{\prime} u_{j}$, тогда $t(Q)=u_{j}$. Рассмотрим покрытие $\mathcal{Q}$ графа $G$, полученное из $\mathcal{Q}^{\prime}$ заменой пути $Q^{\prime}$ на $Q$. Очевидно $\mathcal{Q}<\mathcal{P}$ : мы имеем $T(\mathcal{Q}) \subset T(\mathcal{P})$ и $|\mathcal{Q}|=\left|\mathcal{Q}^{\prime}\right|<\left|\mathcal{P}^{\prime}\right|=|\mathcal{P}|$. Противоречие с выбором $\mathcal{P}$.
1. $B \mathcal{Q}^{\prime}$ нет пути с концом в $u_{j}^{\prime}$, но существует путь $Q^{\prime} \in \mathcal{Q}^{\prime}$ с $t\left(Q^{\prime}\right)=u_{i}$.
Пусть путь $Q$ получен из $Q^{\prime}$ добавлением ребра $u_{i} u_{j}$, тогда $t(Q)=u_{j}$. Рассмотрим покрытие $\mathcal{Q}$ графа $G$, полученное из $\mathcal{Q}^{\prime}$ заменой пути $Q^{\prime}$ на $Q$. Очевидно $\mathcal{Q}<\mathcal{P}$ : мы имеем $T(\mathcal{Q}) \subset T(\mathcal{P})$ и $|\mathcal{Q}|=\left|\mathcal{Q}^{\prime}\right|<\left|\mathcal{P}^{\prime}\right|=|\mathcal{P}|$. Противоречие с выбором $\mathcal{P}$.
1. $B$ покрытии $\mathcal{Q}^{\prime}$ нет ни пути с концом в $u_{j}^{\prime}$, ни пути с концом в $u_{i}$.
Тогда $\left|T(\mathcal{Q})^{\prime}\right| \leq|T(\mathcal{P})|-2$, следовательно, $\left|\mathcal{Q}^{\prime}\right| \leq|\mathcal{P}|-2$. Дополним $\mathcal{Q}^{\prime}$ до покрытия $\mathcal{Q}$ графа $G$, добавив путь $\left\{u_{j}\right\}$. И на этот раз оказывается, что $\mathcal{Q}<\mathcal{P}$, противоречие.

Таким образом, $\mathcal{P}^{\prime}$ оказывается минимальным покрытием графа $G^{\prime}$. Так как $v\left(G^{\prime}\right)<v(G)$, по индукционному предположению на путях покрытия $\mathcal{P}^{\prime}$ можно выбрать по вершине так, чтобы множество выбранных вершин было независимым. По построению покрытия $\mathcal{P}^{\prime}$, выбранные вершины подходят и для покрытия $\mathcal{P}$ графа $G$.

Теперь легко доказать теорему. Рассмотрим любое минимальное покрытие $\mathcal{P}$ графа $G$. На путях покрытия $\mathcal{P}$ можно выбрать по вершине так, чтобы эти вершины образовывали независимое множество, следовательно, $|\mathcal{P}| \leq \alpha(G)$.

В качестве следствия из теоремы 8.10 мы представим классическую теорему Дилворса.

Определение 8.9. Пусть $V$ - частично упорядоченное множество с порядком $<$. Подмножество $U \subset V$ - цепь, если любые два его элемента сравнимы и антицепь, если никакие два его элемента несравнимы.

Следствие 8.5. (R. P. Dilworth, 1950.) Пусть $V$ - конечное частично упорядоченное множество. Тогда минимальное количество цепей, покрывающих $V$, равно количеству вершин в максимальной антицепи множества $V$.

Доказательство. Построим орграф $G$ на элементах множества $V$, как на вершинах: для любых $x, y \in V$ мы положим $x y \in A(G)$ тогда и только тогда, когда $x<y$. Очевидно, $\alpha(G)$ равно количеству вершин в максимальной антицепи множества $V$, а путь в орграфе $G$ проходит по вершинам цепи множества $V$. По теореме 8.10 вершины орграфа $G$ можно покрыть не более, чем $\alpha(G)$ путями, то есть, множество $V$ можно покрыть не более, чем $\alpha(G)$ цепями. Остаётся лишь добавить, что две вершины антицепи не могут оказаться в одной цепи, поэтому покрывающих множество $V$ цепей будет ровно $\alpha(G)$.

# 8.7 Ориентации графа и его раскраски 

### 8.7.1 Теорема Роя-Галлаи

Теорема 8.11. (B. Roy, 1967; T. Gallai, 1968) Пусть $G$ - неориентированный граф, $\vec{G}$ - его ориентация. Тогда граф $\vec{G}$ содержит путь длины не менее $\chi(G)-1$.

Доказательство. Пусть $A \subset A(\vec{G})$ - минимальное по включению такое множество стрелок, что орграф $G^{\prime}=\vec{G}-A$ - ациклический. Для любой вершины $v \in V(G)$ положим $\rho(v)$ равным длине наибольшего простого пути в графе $G^{\prime}$ с началом в $v$. Покажем, что $\rho$ - правильная раскраска вершин графа $G$.

Пусть вершины $a, b \in V(G)$ соединены простым путём $P$ в орграфе $G^{\prime}$. Рассмотрим путь $P_{b}$ длины $\rho(b)$ в орграфе $G^{\prime}$. Так как $G^{\prime}$ - ациклический, то любой путь в графе $G^{\prime}$ - простой, в частности, равный объединению $P$ и $P_{b}$ путь $P_{a}$ с началом в $a$. Так как $\left|P_{a}\right|>\left|P_{b}\right|$, то $\rho(a)>\rho(b)$.

Таким образом, мы доказали, что для концов а и $b$ любого простого пути в орграфе $G^{\prime}$ выполняется условие $\rho(a) \neq \rho(b)$. Пусть $x, y \in V(G)$ и $x y \in E(G)$. Не умаляя общности, можем положить $x y \in A(G)$. Если $x y \in A\left(G^{\prime}\right)$, то, как доказано выше, $\rho(x) \neq \rho(y)$.

Если $x y \notin A\left(G^{\prime}\right)$, то $x y \in A$. Из минимальности $A$ следует, что в орграфе $G^{\prime}+x y$ есть цикл, но тогда в орграфе $G^{\prime}$ есть $y x$-путь, а следовательно, $\rho(x) \neq \rho(y)$.

Мы доказали правильность раскраски $\rho$. Пусть $k$ - номер наибольшего цвета в $\rho$. Тогда в орграфе $G^{\prime}$ (а значит, и в $\vec{G}$ ) есть простой путь длины $k$. Поскольку раскраска $\rho$ красит вершины в цвета $0,1, \ldots, k$, то $\chi(G) \leq k+1$, что и требовалось доказать.

Оценка из теоремы 8.11 , очевидно, оптимальна: можно взять правильную раскраску графа $G$ в $\chi(G)$ цветов и ориентировать любое реб-

ро графа от вершины с меньшим цветом к вершине с большим цветом. Очевидно, длина максимального пути в полученной ориентации $\vec{G}$ будет равна $\chi(G)-1$, так как номера цветов вершин на любом пути строго возрастают.

Забавный факт: из теоремы Роя-Галлаи следует наличие гамильтонова пути в любом турнирном графе, так как хроматическое число полного графа равно количеству его вершин.

# 8.7.2 Ядро орграфа и списочные раскраски рёбер 

В этом разделе мы определим ядро орграфа и докажем с помощью ориентаций графа двудольный случай гипотезы о списочных раскрасках (см. раздел 4.8). Также будет доказана теорема о существовании ядра в орграфах без нечетных циклов, с помощью которой мы оценим списочное хроматическое число двудольных планарных графов.

Определение 8.10. Пусть $H$ - орграф. Независимое множество вершин $U \subset V(H)$ называется ядром, если для любой вершины $v \in V(H) \backslash U$ существует хотя бы одна стрелка $v u \in A(H)$, где $u \in U$.

Лемма 8.14. Пусть $H$ - орграф, каждой вершине $v \in V(H)$ соответствует список иветов $L(v)$, причём $d_{H}^{+}(v)<\ell(v)$. Предположим, что каждый индуцированный подграф орграфа $H$ имеет ядро. Тогда существует правильная раскраска вершин $H$ в соответствии с данными списками.

Доказательство. Индукция по $v(H)$, база для пустого орграфа очевидна. Пусть $i$ - цвет, присутствующий в списках, $V_{i} \subset V(H)$ - множество из всех вершин, чьи списки содержат цвет $i, H_{i}=H\left(V_{i}\right)$. По условию, opграф $H_{i}$ имеет ядро $U_{i}$. Покрасим все вершины из $U_{i}$ в цвет $i$ (это не нарушит правильности раскраски, так как ядро является независимым множеством), после чего исключим цвет $i$ из списков всех вершин $v \in V_{i} \backslash U_{i}$ и получим новые списки $L^{\prime}(v)$.


Рис. 8.10: Ядро графа $H_{i}$

Пусть $H^{\prime}=H-U_{i}$. Поскольку $U_{i}$ - ядро орграфа $H_{i}=H\left(V_{i}\right)$, то для любой вершины $v \in V_{i} \backslash U_{i}$ выполняется

$$
d_{H^{\prime}}^{+}(v) \leq d_{H}^{+}(v)-1<\ell(v)-1=\ell^{\prime}(v)
$$

Следовательно, к орграфу $H^{\prime}$ можно применить индукционное предположение и покрасить его вершины правильным образом по спискам, в которых нет цвета $i$. В результате получится правильная раскраска всех вершин орграфа $H$ по спискам.

Теорема 8.12. (F. Galvin, 1995.) Для любого двудольного графа $G$ выполняется $\operatorname{ch}^{\prime}(G)=\chi^{\prime}(G)=\Delta(G)$.

Доказательство. Пусть $G=\left(V_{1}, V_{2}, E\right), k=\Delta(G)$. По теореме 4.9 мы имеем $\chi^{\prime}(G)=k$, то есть, существует правильная раскраска $\rho$ рёбер графа $G$ в $k$ цветов (пусть это цвета $1, \ldots, k$ ). Обозначим через $G^{\prime}$ рёберный граф двудольного графа $G$. Пусть каждому ребру $e$ графа $G$ (а значит, и каждой вершине графа $G^{\prime}$ ) соответствует список $L(e)$ из $k$ цветов. Наша цель - построить правильную раскраску вершин графа $G^{\prime}$ по данным спискам. Для этого мы хотим применить к рёберному графу $G^{\prime}$ лемму 8.14 .

Введём множество предпочтений (см. определения в разделе 2.4) для вершин исходного графа $G$. Для вершины $a \in V_{1}$ предпочтение $<_{a}$ строго упорядочивает инцидентные $a$ рёбра по возрастанию их цветов в раскраске $\rho$, а для вершины $b \in V_{2}$, предпочтение $<_{b}$ строго упорядочивает инцидентные $b$ рёбра по убыванию их цветов в раскраске $\rho$. Мы ориентируем каждое ребро ef рёберного графа $G^{\prime}$ от $e$ к $f$, если для их общей вершины $v$ имеет место $e<_{v} f$. Тем самымб, мы получим ориентацию $\vec{G}^{\prime}$ графа $G^{\prime}$. По построению множества предпочтений мы имеем $d_{\vec{G}^{\prime}}^{+}(e) \leq k-1<|L(e)|$. (Если $e=a b, a \in V_{1}, b \in V_{2}$ и $\rho(e)=i$, то из $e$ могут выходить стрелки к инцидентным $a$ рёбрам цветов $i+1, \ldots, k$ и к инцидентным $b$ рёбрам цветов $1, \ldots, i-1$, всего не более $k-1$ стрелки.)

Остаётся доказать, что у любого индуцированного подграфа $\vec{H}^{\prime}$ орграфа $\vec{G}^{\prime}$ есть ядро. Для этого мы воспользуемся теоремой 2.5. Пусть $F$ множество всех рёбер орграфа $G$, соответствующих вершинам из $\vec{H}^{\prime}$, а $H=G(F)$. Для введённого выше множества предпочтений существует стабильное паросочетание $M$ графа $H$. Рёбра из $M$ образуют независимое множество вершин орграфа $\vec{H}^{\prime}$. По определению стабильного паросочетания и по построению ориентации $\vec{H}^{\prime}$, для любого ребра $f \in F \backslash M$ существует такое ребро $e \in M$ и общая вершина $v$ рёбер $e$ и $f$, что $f<_{v} e$, то есть, $f e \in A\left(\vec{H}^{\prime}\right)$. Таким образом, $M-$ ядро $\vec{H}^{\prime}$.

Теперь воспользуемся леммой 8.14 и получим, что существует правильная раскраска вершин графа $G^{\prime}$ (и, соответственно, рёбер графа $G$ ) по заданным спискам. Таким образом, $\operatorname{ch}^{\prime}(G)=k$.

В теореме 8.9 доказано, что в любом орграфе есть "почти ядро" такое независимое множество $S$, что для любой вершины $v \in V(G) \backslash S$ есть путь длины не более 2 от $v$ до $S$. Для орграфа без нечетных циклов верно более сильное утверждение.

Теорема 8.13. В орграфе без нечетных циклов есть ядро.
Доказательство. Пусть $D$ - орграф без нечетных циклов. Доказательство будет индукцией по количеству вершин в орграфе.

База: $D$ сильно связен.
Зафиксируем вершину $a \in V(D)$ и построим входящее дерево $T$ вершины $a$. Разобьем вершины дерева $T$ на уровни: $L_{0}=\{a\}, L_{1}, L_{2}, \ldots$ (расстояние от вершин уровня $L_{k}$ до $a$ по дереву $T$ равно $k$ ). Предположим, что существует стрелка $b c \in A(D)$, где вершины $b$ и $c$ принадлежат уровням одинаковой четности (см. рисунок 8.11a). Тогда в дереве $T$ пути $T_{b}$ и $T_{c}$ до $a$ от $b$ и $c$, соответственно, имеют одинаковую четность. Значит, в $D$ существуют два $b a$-пути разной четности: это $T_{b}$ и $T_{c}^{\prime}=b c+T_{c}$. В сильно связном орграфе $D$ существует $a c$-путь $P$, который вместе с одним из путей $T_{c}^{\prime}$ и $T_{b}$ образует нечетный цикл, противоречие.

Таким образом, множество $U$, равное объединению всех вершин четных уровней, независимо. Из любой вершины нечетного уровня есть стрелка в вершину предыдущего четного уровня, поэтому, $U-$ ядро.


Рис. 8.11: Построение ядра: входящее дерево $T$, множества $W, U^{\prime}$ и $W^{\prime}$.
Переход: $D$ не сильно связен
Рассмотрим крайнюю компоненту сильной связности $W$, из которой нет исходящих стрелок в другие компоненты. В меньшем орграфе $D(W)$ есть ядро $U^{\prime}$ по индукционному предположению. Пусть $W^{\prime}$ - объединение $U^{\prime}$

и множества всех вершин орграфа $D$, из которых выходят стрелки в $U^{\prime}$. Тогда $W^{\prime} \supset W$, так как $U^{\prime}$ - ядро $D(W)$ (см. рисунок 8.11 b ).

Если $W^{\prime}=V(D)$, то $U^{\prime}-$ ядро орграфа $D$, в этом случае теорема доказана. Пусть $W^{\prime} \neq V(D)$. Рассмотрим орграф $D^{\prime}=D-W^{\prime}$. По индукционному предположению, меньший чем $D$ орграф $D^{\prime}$ имеет ядро $U^{*}$. Отметим, что $U=U^{\prime} \cup U^{*}$ - независимое множество. Действительно, стрелок из $U^{*}$ в $U^{\prime}$ нет по построению орграфа $D^{\prime}$, а стрелок из $U^{\prime}$ в $U^{*}$ нет, так как $W \cap U^{*}=\varnothing$, а из крайней компоненты $W \supset U^{\prime}$ нет стрелок в другие компоненты сильной связности. Теперь понятно, что $U$ - ядро орграфа $D$.

В качестве примера применения разработанной техники мы докажем еще один результат о списочных раскрасках планарных графов. По теореме 6.9 нам известно, что любой планарный граф $G$ обхвата $g(G) \geq 5$ имеет $\operatorname{ch}(G) \leq 3$. Докажем аналогичный результат для двудольных планарных графов. Интересно, что списочное хроматическое число непланарного двудольного графа может быть сколь угодно большим (задача ??).

Теорема 8.14. Если $G$ - двудольный планарный граф, то $\operatorname{ch}(G) \leq 3$.
Доказательство. В любой ориентации двудольного графа $G$ нет нечетных циклов, а потому в силу теоремы 8.13 есть ядро. Для применения леммы 8.14 остается доказать существование ориентации, в которой максимальная исходящая степень вершины не превосходит 2.

Для ориентации $\vec{G}$ графа $G$ положим

$$
s(\vec{G})=\sum_{x \in V(G), d_{\vec{G}}^{+}(x) \geq 3}\left(d_{\vec{G}}^{+}(x)-2\right)
$$

Рассмотрим ориентацию $\vec{G}$, для которой $s(\vec{G})$ минимально и предположим, что в ней есть вершина $a$ с $d_{\vec{G}}^{+}(a) \geq 3$. Пусть $U$ - множество вершин, достижимых из $a$ в $\vec{G}$, а $D=\vec{G}(U)$. Для каждой вершины $x \in U$ мы имеем $\mathrm{N}_{\vec{G}}^{+}(x) \subset U$, поэтому, $d_{\vec{G}}^{+}(x)=d_{D}^{+}(x)$. Предположим, что $\delta^{+}(D) \geq 2$. Так как количество стрелок орграфа равняется сумме исходящих степеней его вершин, мы имеем $e(G(U))=e(\underline{D}) \geq 2|U|>2|U|-4$, что для двудольного планарного графа $G(U)$ невозможно ввиду следствия 6.1.

Следовательно, существует вершина $b \in U$ с $d_{\vec{G}}^{+}(b)=d_{D}^{+}(b) \leq 1$. По построению множества $U$, существует простой $a b$-путь $P$ в орграфе $\vec{G}$. Поменяем ориентации всех стрелок на пути $P$ : в результате исходящая

степень $a$ уменьшится на 1 , исходящая степень $b$ увеличится на 1 , а степени остальных вершин не изменятся. В новой ориентации $\vec{G}^{\prime}$ мы имеем $d_{\vec{G}^{\prime}}^{*}(b) \leq 2$, поэтому, $s\left(\vec{G}^{\prime}\right)=s(\vec{G})-1$, что противоречит выбору ориентации $\vec{G}$.

# 8.8 Орграфы исходящей степени не менее 2 

В этом разделе орграфы могут иметь две стрелки, образующие цикл длины 2 .

Лемма 8.15. Пусть $G$ - сильно связный орграф с $\delta^{+}(G) \geq 2$. Тогда существует такая вершина $v \in V(G)$, что орграф $G-v$ сильно связен.

Доказательство. Очевидно, $G$ имеет сильно связный подграф, содержащий не все вершины (например, кратчайший цикл орграфа $G$ не может быть гамильтоновым ввиду $\delta^{+}(G) \geq 2$ ). Пусть $H$ - максимальный по включению сильно связный подграф орграфа $G$, содержащий не все вершины $G, U=V(H), W=V(G) \backslash U$.


Рис. 8.12: Орграф $H$ и путь $P$.
Так как орграф $G$ сильно связен, существует такой путь $P=x_{1} \ldots x_{k}$ с вершинами из $W$, что есть стрелка из $U$ в $x_{1}$ и из $x_{n}$ в $U$ (возможно, $n=1$ ). Тогда индуцированный подграф $G(U \cup V(P))$ сильно связен и больше, чем $H$, поэтому $G(U \cup V(P))=G$. Если $n>1$, то вспомним, что существует стрелка $x_{1} y$, где $y \neq x_{2}$. Если $y \in U$, то орграф $G\left(U \cup\left\{x_{1}\right\}\right)-$ сильно связен (см. рисунок 8.12a), больше чем $H$ и не равен $G$, противоречие с выбором $H$. Значит, $y=x_{\ell}, \ell>2$ (см. рисунок 8.12 b ). Тогда орграф $G-\left\{x_{2}, \ldots x_{\ell-1}\right\}$ сильно связен, больше чем $H$ и не равен $G$, противоречие. Значит, $n=1$ и $H=G-x_{1}$ сильно связен.

Теорема 8.15. (C. Thomassen, 1985.) Пусть $G-$ орграф с $\delta^{+}(G) \geq 2$. Тогда $G$ содержит два цикла, имеюших ровно одну общую вершину.

Доказательство. Индукция по $v(G)$. Очевидно, $v(G) \geq 3$, база для $v(G)=3$ очевидна (в графе должны быть проведены все 6 возможных стрелок между тремя вершинами, а значит, есть два цикла длины 2 с одной общей вершиной). Далее мы докажем переход: при доказательстве утверждения для $G$ считаем, что для всех меньших орграфов оно уже доказано.

Предположим, что орграф $G$ не сильно связен и рассмотрим его крайнюю компоненту сильной связности $U$, из которой не выходят стрелки в другие компоненты. Очевидно, в сильно связном орграфе $G(U)$ исходящая степень каждой вершины хотя бы 2 и для этого орграфа утверждение уже доказано. Далее считаем, что орграф $G$ сильно связен.

По лемме 8.15 существует такая вершина $x \in V(G)$, что орграф $G-x$ сильно связен. Пусть $Y=\mathrm{N}_{G}^{-}(x)$ - множество всех вершин, из которых выходят стрелки в $x$. Очевидно, $Y \neq \varnothing$. Рассмотрим два случая.

1. В орграфе $G(Y)$ есть иикл $C$.

Тогда рассмотрим кратчайший путь от $x$ до $C$, пусть он кончается в точке $z \in V(C)$. Этот путь мы замкнем в цикл стрелкой $z x$ и получим два цикла, имеющие ровно одну общую вершину $z$ (см. рисунок 8.13a).

a

b

c

Рис. 8.13: Два цикла с одной общей вершиной.
1. Орграф $G(Y)$ ацикличен.

Тогда существует вершина $y \in Y$, для которой $N_{G}^{-}(y) \cap Y=\varnothing$. Рассмотрим два случая.
2.1. $x y \in A(G)$.

Тогда стрелки $x y$ и $y x$ образуют цикл $C$. В сильно связном орграфе $G-x$ существует цикл $C^{\prime}$, проходящий по вершине $y$. Эти два цикла нам подходят.
2.2. $x y \notin A(G)$.

Построим орграф $H$ следующим образом: к орграфу $G-y$ добавим отсутствующие в нем стрелки множества $\left\{v x: v \in \mathrm{~N}_{G}^{-}(y)\right\}$. Так как $N_{G}^{-}(y) \cap \mathrm{N}_{G}^{-}(x)=\varnothing$, исходящая степень каждой вершины $v \neq x$ в орграфах $G$ и $H$ одинакова, то есть, хотя бы два. В рассматриваемом случае

$\mathrm{N}_{G}^{+}(x)=\mathrm{N}_{H}^{+}(x)$. Таким образом, исходящая степень каждой вершины орграфа $H$ не менее 2 и по индукционному предположению в нем есть два искомых цикла $C_{1}^{\prime}$ и $C_{2}^{\prime}$, имеющие единственную общую вершину $a$.

Построим два цикла $C_{1}$ и $C_{2}$, соответствующие $C_{1}^{\prime}$ и $C_{2}^{\prime}$ в орграфе $G$ : если нам нужна стрелка $v x \notin A(G)$, то возьмем вместо неё стрелки $v y \in A(G)$ и $y x$. Если циклы $C_{1}$ и $C_{2}$ имеют более одной общей вершины, то $a=x$ и циклы имеют две общие вершины $x$ и $y$ (см. рисунок 8.13 b ). Отметим, что стрелки обоих циклов входят в вершину $y$.

Орграф $G-x$ сильно связен, поэтому он содержит цикл $C_{3}$, проходящий по $y$. Пусть $W=V\left(C_{1}\right) \cup V\left(C_{2}\right)$. Отметим, что стрелка, выходящая в цикле $C_{3}$ из $y$, не принадлежит ни одному из циклов $C_{1}$ и $C_{2}$. Тогда пусть $P$ - это дуга цикла $C_{3}$ от $y$ до следующего попадания в множество $W$ - скажем, в вершину $w$ (см. рисунок 8.13 c ). Не умаляя общности будем считать, что $w \notin V\left(C_{2}\right) \backslash\{y\}$. Тогда $P$ вместе с дугой $w C_{2} y$ образует цикл, имеющий ровно одну общую вершину с $C_{1}-$ вершину $y$.

Следствие 8.6. Пусть $G$ - орграф, исходящие степени всех вершин которого не менее 2. Тогда $G$ имеет цикл длины не более $\frac{v(G)+1}{2}$.

Определим две операции на орграфах.
Определение 8.11. Пусть $G$ - орграф.

1) Подразбиение стрелки - операция замены стрелки $a b \in A(G)$ на путь $a x b$, где $x \notin V(G)$ - новая вершина (см. рисунки 8.14 a и b).


Рис. 8.14: Подразбиение стрелки и расщепление вершины.
1) Расщепление вершины $a \in V(G)$ - это операция замены вершины $a$ на пару новых вершин $a_{1}, a_{2}$. В граф добавляется стрелка $a_{1} a_{2}$, все стрелки вида $x a_{1}$, где $x \in \mathrm{~N}_{G}^{-}(a)$, и все стрелки вида $a_{2} y$, где $y \in \mathrm{~N}_{G}^{+}(a)$ (см. рисунок 8.14 с и d).

Теперь определим несколько странный на первый взгляд объект, который в дальнейшим окажется очень важным.

Определение 8.12. 1) Двойной иикл длины $k$ - это орграф на вершинах $a_{1}, \ldots, a_{k}$ с рёбрами вида $a_{i} a_{i+1}$ и $a_{i+1} a_{i}$ для всех $i \in[1 . . k]$ (нумерация - циклическая по модулю $k$, см. рисунок 8.15 a).



Рис. 8.15: Двойной цикл и слабый двойной цикл длины 5.
1) Слабый двойной цикл длины $k$ - это орграф, полученный из двойного цикла длины $k$ несколькими операциями подразбиения рёбер и расщепления вершин (см. рисунок 8.15 b ).
2) Двойной цикл и слабый двойной цикл называется нечетным (четным), если его длина $k$ нечетна (четна).

Теорема 8.16. Пусть $G-$ орграф с $\delta^{+}(G) \geq 2$. Тогда $G$ имеет два цикла без общих вершин или слабый двойной треугольник.

Доказательство. 1. По теореме 8.15 существуют циклы $C_{1}=x y_{1} \ldots y_{n}$ и $C_{2}=x z_{1} \ldots z_{n}$ с единственной общей вершиной $x$. Назовём $y_{k} y_{i}$-трансверсаль $Q$ цикла $C_{1}$ правильной, если $k<i$ и неправильной в противном случае. Аналогично для цикла $C_{2}$. Предположим, что цикл $C_{1}$ имеет неправильную $y_{k} y_{i}$-трансверсаль (см. рисунок 8.16a). Тогда эта трансверсаль вместе с дугой $y_{i} C_{1} y_{k}$ образует цикл, не пересекающийся с $C_{2}$ и утверждение теоремы выполнено. Следовательно, все трансверсали цикла $C_{1}$ - правильные, аналогично для цикла $C_{2}$.


Рис. 8.16: Циклы $C_{1}, C_{2}$ и $C_{3}$.
1. В графе $G-x$, очевидно, существует цикл $C_{3}$. Если $C_{3}$ не пересекает хотя бы один из циклов $C_{1}$ и $C_{2}$, то существует два непересекающихся цикла. Значит, $C_{3}$ пересекает оба цикла $C_{1}$ и $C_{2}$. Тогда цикл $C_{3}$ содержит дугу $P_{1}=z_{i} C_{3} y_{j}$, являющуюся $C_{2} C_{1}$-путём (см. рисунок 8.17a). Воз-

можно, такая дуга неединственна, тогда мы выберем $P_{1}$ таким образом, чтобы номер $i$ был наибольшим возможным среди всех таких дуг.

От точки $y_{j}$ цикл $C_{3}$ должен вернуться в $V\left(C_{2}\right)$. Пусть $\operatorname{Int}\left(y_{j} C_{3} y_{k}\right)$ не содержит вершин цикла $C_{2}$ (возможно, $j=k$ ), а дуга $P_{2}=y_{k} C_{3} z_{r}$ является $C_{2} C_{1}$-путём (см. рисунок 8.17 a ). Тогда дуга $y_{j} C_{3} y_{k}$ состоит из нескольких трансверсалей и стрелок цикла $C_{1}$. По доказанному выше все трансверсали цикла $C_{1}$ - правильные, поэтому $k>j$.


Рис. 8.17: Графы $H$ и $D$.
1. Предположим, что $r<i$ (см. рисунок 8.17a).

Обозначим через $H$ орграф, состоящий из вершин и стрелок циклов $C_{1}$ и $C_{2}$, а также путей $P_{1}$ и $P_{2}$. Докажем, что $H$ - слабый двойной треугольник. Заменим дугу $y_{j} C_{1} y_{k}$ на вершину $y$, в которую входят и выходят стрелки цикла $C_{1}$ и путей $P_{1}$ и $P_{2}$. Аналогично, заменим дугу $z_{r} C_{2} z_{i}$ на вершину $z$ (см. рисунок 8.17 b ). Назовем полученный орграф $D$. Отметим, что стрелки $D$, входящие в $y$, соответствуют стрелкам $H$, входящим в $y_{j}$, а стрелки $D$, исходящие из $y$, соответствуют стрелкам $H$, исходящим из $y_{k}$. Поэтому, дуга $y_{j} C_{1} y_{k}$ в графе $H$ может быть получена расщеплением вершины $y$ и подразбиением полученного при этом ребра. Аналогично, дугу $z_{r} C_{2} z_{i}$ в графе $H$ может быть получена расщеплением вершины $z$ и подразбиением полученного при этом ребра. Таким образом, $H$ получается из $D$ расщеплениями вершин и подразбиениями стрелок. Очевидно, орграф $D$ является подразбиением двойного треугольника. Следовательно, $H$ - слабый двойной треугольник.
1. Остается случай, когда $r>i$ (см. рисунок 8.16 b ).

Докажем, что цикл $C_{3}$ имеет отличную от $P_{1}$ дугу, которая является $C_{2} C_{1}$-путём. Пусть это не так. Тогда дуга $Q=z_{r} C_{3} z_{i}$ не пересекает цикл $C_{1}$. Поскольку $x \notin V\left(C_{3}\right)$, то $Q$ не может быть дугой цикла $C_{2}$. Так как $r>i$, тогда $Q$ содержит хотя бы одну неправильную трансверсаль цикла $C_{2}$. Противоречие с доказанным выше.

Итак, пусть дуга $P_{3}=z_{s} C_{3} y_{q}$, отличная от $P_{1}-$ это $C_{2} C_{1}$-путь, причём $z_{s}$ - ближайшее по циклу $C_{3}$ после $z_{r}$ начало такой дуги. Тогда,

аналогично пункту 2 (так как все трансверсали цикла $C_{2}$ - правильные) можно доказать, что $s>r$. Следовательно, $s>i$, что противоречит выбору дуги $P_{1}$.

Следствие 8.7. Для сильно двусвязного орграфа $G$ выполняются следующие утверждения.

1) Орграф $G$ содержит два цикла, имеющие ровно одну обиую вершину.
2) Орграф $G$ имеет цикл длины не более $\frac{v(G)+1}{2}$.
3) Орграф $G$ имеет два цикла без общих вершин или слабый двойной треугольник.

Доказательство. Очевидно, исходящая степень любой вершины двусвязного орграфа не менее 2 . Теперь утверждения напрямую следуют из доказанных выше.

# 8.9 Циклический базис орграфа 

Определение 8.13. 1) Циклическим пространством орграфа $D$ (обозначение: $\mathcal{C}(D)$ ) называется циклическое пространство $\mathcal{C}(\underline{D})$ соответствующего неориентированного графа.
1) Ориентированный циклический базис орграфа $D$ - это базис циклического пространства $\mathcal{C}(D)$, все элементы которого - множества (неориентированных) рёбер (ориентированных) циклов орграфа $D$.

Теорема 8.17. Для сильно связного орграфа $D$ выполняются следующие утверждения.

1) $D$ имеет ориентированный циклический базис.
2) Если множество стрелок $A \subset A(D)$ таково, что орграф $D-A$ сильно связен, то существует такой ориентированный циклический базис орграфа $D$, что каждая стрелка из $A$ входит ровно в один из циклов, составляющих этот базис.

Доказательство. 1) Построим последовательность сильно связных opграфов $H_{0}, H_{1}, \ldots, H_{n}=D$, где $H_{0}$ - ориентированный цикл, а $H_{j+1}$ получается из $H_{j}$ добавлением рёбер и внутренних вершин пути $P_{j+1}$, соединяющего две (возможно, совпадающие) вершины графа $H_{j}$, но проходящего каждую внутреннюю вершину ровно один раз.

Очевидно, в орграфе $D$ есть цикл, любой такой цикл и будет графом $H_{0}$. Пусть мы уже построили граф $H_{k} \neq D$, построим путь $P_{k+1}$. Если существует стрелка не из $A\left(H_{k}\right)$, соединяющая две вершины из $V\left(H_{k}\right)$,

то она и образует путь $P_{k+1}$. Если такой стрелки нет, то есть стрелка $a b \in E(D)$, где $a \in V\left(H_{k}\right), b \notin V\left(H_{k}\right)$. Тогда $a b$ вместе с кратчайшим путем от $b$ до $V\left(H_{k}\right)$ (кратчайший путь не может иметь самопересечений) образуют искомый путь $P_{k+1}$. Понятно, что граф $H_{k+1}$, полученный присоединением к $H_{k}$ пути $P_{k+1}$, сильно связен.

Так как граф $H_{k}$ сильно связен, путь $P_{k+1}$ можно замкнуть стрелками из $A\left(H_{k}\right)$ в цикл $C_{k}$. Мы докажем, что $H_{0}, C_{1}, \ldots, C_{k}$ образуют ориентированный циклический базис $H_{k}$. Для $k=n$ мы получим утверждение пункта 1 теоремы.

База $k=0$ очевидна, докажем переход $k \rightarrow k+1$. По теореме 7.1 мы знаем, что $\operatorname{dim}(\mathcal{C}(H))=e(H)-v(H)+1$ для любого связного графа $H$. При переходе от $H_{k}$ к $H_{k+1}$ мы добавили все внутренние вершины и все рёбра простого пути $P_{k+1}$, а значит, рёбер было добавлено на одно больше, чем вершин. Таким образом, $\operatorname{dim}\left(\mathcal{C}\left(H_{k+1}\right)\right)=\operatorname{dim}\left(\mathcal{C}\left(H_{k}\right)\right)+1$. Значит, достаточно доказать, что добавленное множество ребер $E\left(C_{k+1}\right)$ не есть линейная комбинация $E\left(H_{0}\right), E\left(C_{1}\right), \ldots, E\left(C_{k}\right)$. Но это очевидно, так как $C_{k+1}$ содержит хотя бы одно ребро пути $P_{k+1}$, а этого ребра нет в $E\left(H_{k}\right)$.
1) Построим ориентированный циклический базис для сильно связного орграфа $D-A$. В этом орграфе уже есть все вершины из $V(G)$, поэтому, на следующих шагах построения мы будем каждый раз добавлять путь, состоящий из одной стрелки. Пусть на $i$-м шаге мы добавляем стрелку $x y \in A$. Так как граф $D-A$ сильно связен, можно замкнуть эту стрелку в цикл $C_{i}$ путём в $D-A$. Тогда $C_{i}$ содержит ровно одну стрелку из $A$. Аналогично для остальных шагов.

# 8.10 Четные орграфы 

В 1975 году Ловас сформулировал два вопроса о четных циклах в орграфах.

Вопрос 1. Существует ли такое $k$, что любой орграф $D$ с $\delta^{+}(D) \geq k$ содержит четный иикл?

Вопрос 2. Существует ли такое $k$, что любой сильно $k$-связный орграф содержит четный иикл?

Отрицательный ответ на первый вопрос Томассен дал в 1985 году (см. задачу ??). Однако, в теореме 8.20 доказывается, что в сильно связном орграфе, у которого и входящая, и исходящая степень каждой вершины не менее 3 , четный цикл обязательно есть.

Теория, изложенная в следующем разделе, в частности, отвечает на второй вопрос: как видно из следствия 8.9 , подходит $k=3$. Несложно построить примеры, показывающие, что сильной двусвязности для наличия четного цикла недостаточно.

Как это часто бывает, оказалось, что нужно изучать более сложный, на первый взгляд вопрос.

Определение 8.14. Мы будем называть взвешенным орграф, стрелкам которого присвоены целочисленные веса. Цикл в таком орграфе называется четным, если сумма весов его стрелок четна, и нечетным, если сумма весов его стрелок нечетна.

Определение 8.15. Орграф $D$ называется четным, если при любом присваивании целочисленных весов его рёбрам в нем найдется четный цикл (то есть, ориентированный цикл четного суммарного веса).

Сразу же сформулируем эквивалентное определение.
Определение 8.16. Орграф $D$ называется четным, если любое подразбиение орграфа $D$ содержит цикл четной длины.

Главная цель этого раздела - доказательство теоремы о том, что четный орграф содержит слабый нечетный двойной цикл. Мы начнем с доказательства нескольких вспомогательных утверждений.

Определение 8.17. Граф $G$ называется минимальным рёберно двусвязным, если он не имеет мостов, но для любого ребра $e \in E(G)$ граф $G-e$ имеет мост.

Нам понадобятся некоторые факты о таких графах. Через $v_{2}(G)$ обозначим количество вершин степени 2 в графе $G$.

Лемма 8.16. Пусть $G$ - минимальный рёберно двусвязный граф (возможно, с кратными рёбрами). Тогда выполняются следующие утверждения.

1) Каждый блок графа $G$ - минимальный рёберно двусвязный граф.
2) Если $G$ имеет кратные рёбра между вершинами $x$ и $y$, то таких рёбер ровно два и вершины $x$, у вместе с рёбрами между ними образуюют блок.
3) Если $v(G) \geq 3$, граф $G$ (вершинно) двусвязен и не имеет вершин степени 3 , то $v_{2}(G) \geq \max \left(3, \frac{v(G)}{2}+1\right)$.

Доказательство. 1) Пусть $B$ - блок графа $G$. Если $B$ состоит из двух вершин и ребра $e$ между ними, то граф $G-e$ несвязен, противоречие. Следовательно, $B$ двусвязен, а значит, и рёберно двусвязен.

Пусть $e \in E(B)$. Тогда существует такое $f \in E(G)$, что граф $G-\{e, f\}$ несвязен. Пусть $f \in E\left(B^{\prime}\right), B^{\prime} \neq B$. Мы показали, что каждый блок графа $G$ двусвязен, поэтому $B-e$ и $B^{\prime}-f$ связны, а следовательно, связен и граф $G-\{e, f\}$, противоречие. Значит, $f \in E(B)$, то есть, блок $B-$ минимальный рёберно двусвязный граф.
1) Пусть между вершинами $x$ и $y$ хотя бы три кратных ребра, одно из них $e$. Все эти рёбра принадлежат некоторому блоку $B$. По пункту 1 тогда существует такое ребро $f \in E(B)$, что $B-\{e, f\}$ несвязен. Так как граф $B-f$ связен, вершины $x$ и $y$ лежат в разных компонентах связности графа $B-\{e, f\}$, что, очевидно, не так. Противоречие.

Итак, $E_{G}(x, y)=\{e, f\}$. Предположим, что $V(B) \neq\{x, y\}$. Тогда $B-$ двусвязный граф, в котором есть $x y$-путь, отличный от ребра. Следовательно, граф $B-e$ двусвязен, что противоречит пункту 1.
1) В графе $G$ не менее трёх вершин. Если их три, то $G$ - цикл, и все три его вершины имеют степень два. Если $v(G) \geq 4$, то $\frac{v(G)}{2}+1 \geq$ 3. Поэтому нам достаточно доказать, что вершин степени 2 не менее чем $\frac{v(G)}{2}+1$.

Назовем большой вершину степени не менее 4 , пусть в графе $G$ ровно $n$ больших вершин и $k$ вершин степени 2 . Нам нужно доказать, что $k \geq n+2$. Предположим, что это не так, тогда $k \leq n+1$. Назовём большим ребро, соединяющее две большие вершины, пусть в графе $m$ больших рёбер. Назовём малым ребро, соединяющее две вершины степени 2 , пусть в графе $s$ малых рёбер. Посчитаем количество $q$ рёбер, соединяющих большие вершины с вершинами степени 2. С одной стороны, $q=2 k-2 s$. С другой стороны, $q \geq 4 n-2 m$. Следовательно, $2 k-2 s \geq 4 n-2 m$, откуда следует, что $n+1 \geq k \geq 2 n-m+s$ и $m-s \geq n-1$.

Докажем, что существует цикл $Z$, в котором не более одной вершины степени 2. Пусть $W$ - множество всех больших вершин. В графе $G(W)$ проведено $m \geq n-1$ рёбер на $n$ вершинах, а значит, либо в $G(W)$ существует цикл (он нам подходит), либо $G(W)$ - дерево. Рассмотрим второй случай. Тогда $m=n-1$, а следовательно, $s=0$, то есть, каждая вершина степени 2 смежна с двумя большими. Добавим к $G(W)$ вершину $a$ степени 2 и два инцидентных ей ребра и получим искомый цикл $Z$ (проходящий по $a$ и большим вершинам).

Итак, цикл $Z$ найден, отметим в нем вершину $a$ : это вершина степени 2 , если такая есть и любая вершина, если все они большие. Для каждого ребра $e \in E(Z)$ есть такое ребро $e^{\prime}$, что граф $G-\left\{e, e^{\prime}\right\}$ - несвязен.



Рис. 8.18: Циклы $Z$ и $C$.

Понятно, что $e^{\prime} \in E(Z)$ (иначе вершины ребра $e$ связаны в $G-\left\{e, e^{\prime}\right\}$, что невозможно). Выберем разделяющую граф $G$ пару рёбер $e, e^{\prime}$ цикла $Z$ так, чтобы между ними на дуге $L$ цикла $Z$, не содержащей $a$, было минимальное число рёбер (см. рисунок 8.18). Пусть $x$ - конец ребра $e$, лежащий на $L$. Тогда $D_{G}(x) \geq 4$, а значит, из $x$ выходит ребро, не лежащее на цикле $Z$. Если это ребро - не хорда цикла, то из его конца $w \notin V(Z)$ существует путь до $V(Z) \backslash\{x\}$, не проходящий через $x$ (напомним, что граф $G$ двусвязен). Следовательно, цикл $Z$ имеет хорду или трансверсаль от $x \in L$ до неккоторой вершины $y$. Так как граф $G-\left\{e, e^{\prime}\right\}$ несвязен, мы имеем $y \in L$. Таким образом, мы построили цикл $C$, имеющий с $Z$ общую дугу $L^{\prime}=x L y$.

Рассмотрим ребро $f$ дуги $L^{\prime}$ и такое ребро $f^{\prime}$, что граф $G-\left\{f, f^{\prime}\right\}$ несвязен. Так как $f$ лежит на циклах $Z$ и $C$, ребро $f^{\prime}$ также лежит на обоих этих циклах, то есть лежит на их общей дуге $L^{\prime}$. Но количество рёбер между $f$ и $f^{\prime}$ на дуге между ними, не содержащей $a$ меньше, чем это количество для $e$ и $e^{\prime}$, противоречие.

Лемма 8.17. Если граф $G$ имеет эйлерову ориентацию $\vec{G}$, то для каждого блока $B$ графа $G$ орграф $\vec{G}(B)$ - эйлеров.

Доказательство. Будем доказывать утверждение индукцией по $v(G)$. База для двусвязного графа $G$ очевидна.

Пусть $G$ имеет точку сочленения $a$. Тогда существует такое разбиение $V(G)=U_{1} \cup U_{2}$, что $U_{1} \cup U_{2}=\{a\}$. Пусть $G_{i}=G\left(U_{i}\right)$. Тогда в ориентации $\vec{G}_{i}$ (все стрелки из $A\left(G_{i}\right)$ ориентированы как в $\vec{G}$ ) в каждой вершине, кроме $a$, поровну входящих и исходящих стрелок. Следовательно, и в вершине $a$ поровну входящих и исходящих стрелок, то есть ориентация $\vec{G}_{i}$ - эйлерова. Несложно понять (см. раздел 5.5.1), что блок $B$ графа $G$ является блоком одного из графов $G_{1}$ и $G_{2}$ - пусть, скажем, графа $G_{1}$. Тогда по индукционному предположению для графа $G_{1}$, орграф $\vec{G}(B)$ - эйлеров.

Следствие 8.8. Пусть $D$ - эйлеров граф, причем неориентированный граф $\underline{D}$ связен. Тогда выполняются следующие утверждения.

1) Орграф $D$ сильно связен.
2) Для каждого блока $B$ графа $\underline{D}$ орграф $D(V(B))$ - эйлеров и, следовательно, сильно связен.

Доказательство. 1) По следствию 1.4 граф $D$ имеет эйлеров цикл, а следовательно, является сильно связным.
1) Прямое следствие леммы 8.17 и пункта 1.

# 8.10.1 Циклический базис орграфа и четные циклы 

Лемма 8.18. Пусть $\mathcal{F}$ - такое конечное семейство непустых подмножеств конечного множества $A$, что симметрическая разность любого нечетного числа подмножеств из $\mathcal{F}$ непуста и лежит в $\mathcal{F}$. Пусть $T \subset A$ - минимальное подмножество, пересекающее все подмножества из $\mathcal{F}$. Тогда $T$ пересекает каждое подмножество из $\mathcal{F}$ по нечетному числу элементов.

Доказательство. Пусть $S_{0} \in \mathcal{F}$ таково, что $S_{0} \cap T=\left\{x_{1}, \ldots, x_{2 k}\right\}$ содержит четное число элементов. Из минимальности $T$ следует, что для каждого элемента $x_{i}$ существует такое подмножество $S_{i} \in \mathcal{F}$, что $T \cap S_{i}=\left\{x_{i}\right\}$. По условию, множество $S=S_{0} \triangle S_{1} \triangle \ldots \triangle S_{2 k} \in \mathcal{F}$, однако, $S \cap T=\varnothing$, противоречие.

Лемма 8.19. Пусть $\mathcal{M}$ - конечное семейство непустых подмножеств конечного множества $A$. Тогда выполняется ровно одно из следующих двух утверждений.
$1^{\circ}$ Существует $T \subset A$ такое, что $T$ пересекает каждое подмножество из $\mathcal{M}$ по нечетному числу элементов.
$2^{\circ}$ Существуют такие $S_{1}, \ldots, S_{2 k+1} \in \mathcal{M}$, что $S_{1} \triangle \ldots \triangle S_{2 k+1}=\varnothing$.
Доказательство. Пусть семейство $\mathcal{F}$ получено из $\mathcal{M}$ добавлением симметрических разностей любого нечетного числа элементов $\mathcal{M}$. Если $\varnothing \in \mathcal{F}$, то выполняется условие $2^{\circ}$. А если $\varnothing \notin \mathcal{F}$, то по лемме 8.18 выполнено условие $1^{\circ}$.

Если выполнено условие $1^{\circ}$, то заметим, что $S_{1} \triangle \ldots \triangle S_{2 k+1}$ имеет нечетное пересечение с $T$ и, следовательно, непусто, то есть, условие $2^{\circ}$ не выполняется.

Напомним, что сумма элементов циклического пространства орграфа по определению - их симметрическая разность (то есть, сумма по модулю 2).

Лемма 8.20. Пусть $D$ - сильно связный орграф, а $\mathcal{F}$ - его ориентированный ииклический базис. Тогда можно присвоить дугам из $A(D)$ такие веса, чтобы каждый иикл из $\mathcal{F}$ имел нечетный суммарный вес.

Доказательство. Применим лемму 8.19 для $A=E(D)$ (множество неориентированных рёбер орграфа $D$ ) и семейства его подмножеств $\mathcal{F}$. Так как $\mathcal{F}$ - базис циклического пространства, входящие в него подмножества линейно независимы, поэтому условие $2^{\circ}$ не может быть выполнено. Следовательно, выполнено условие $1^{\circ}$ и существует множество $T$, пересекающее любой цикл из $\mathcal{F}$ по нечетному числу рёбер. Положим веса всех рёбер из $T$ равными 1 , а остальных рёбер -0 и получим искомые веса.

Лемма 8.21. Пусть $D$ - взвешенный сильно связный орграф, а $\mathcal{F}$ - его ориентированный ииклический базис из нечетных ииклов. Тогда следующие четыре утверждения эквивалентны.
$1^{\circ}$ Орграф $D$ четен.
$2^{\circ}$ Орграф $D$ имеет четный иикл (то есть, иикл четного веса).
$3^{\circ}$ Орграф $D$ имеет такой иикл $C$, что $E(C)$ представляется в виде суммы четного числа слагаемых из $\mathcal{F}$.
$4^{\circ}$ Орграф $D$ имеет такие ииклы $C_{1}, \ldots, C_{m}$, что $m$ нечетно и

$$
E\left(C_{1}\right) \triangle E\left(C_{2}\right) \triangle \ldots \triangle E\left(C_{m}\right)=\varnothing
$$

Доказательство. Импликация $1^{\circ} \Rightarrow 2^{\circ}$ очевидна.
$2^{\circ} \Rightarrow 3^{\circ}$. Пусть $C$ - четный цикл в орграфе $D$. Тогда $E(C)$ представляется в виде суммы нескольких (скажем, $m$ ) слагаемых из ориентированного циклического базиса $\mathcal{F}$. Так как все эти слагаемые нечетны, $m$ четно.
$3^{\circ} \Rightarrow 4^{\circ}$. Пусть $n$ - четно, а $E(C)=E\left(S_{1}\right) \triangle \ldots \triangle E\left(S_{n}\right)$ - представление из условия $3^{\circ}$. Тогда $C, S_{1} \ldots, S_{n}$ - искомые циклы.
$4^{\circ} \Rightarrow 1^{\circ}$. Для любого присвоения весов стрелкам из $A(D)$ один из циклов $C_{1}, \ldots, C_{m}$ должен иметь четный вес, так как количество циклов нечетно, а сумма их весов четна.

# 8.10.2 Редукция 

Определение 8.18. Пусть $D$ - сильно связный орграф, а вершина $z \in V(D)$ такова, что $V(D-z)$ есть объединение непересекающихся множеств $U_{1}$ и $U_{2}$, причем $A_{D}\left(U_{2}, U_{1}\right)=\varnothing$. Пусть

$$
U_{1}^{+}=\left\{x \in U_{1}: A_{D}\left(x, U_{2}\right) \neq \varnothing\right\} \quad \text { и } \quad U_{2}^{-}=\left\{y \in U_{2}: A_{D}\left(U_{1}, y\right) \neq \varnothing\right\}
$$

Назовем $\left(z, U_{1}\right)$-редукиией орграфа $D$ орграф, полученный из $D-U_{2}$ добавлением всех отсутствующих в этом орграфе стрелок множества $\left\{x z: x \in U_{1}^{+}\right\}$. Аналогично, назовем $\left(z, U_{2}\right)$-редукиией орграфа $D$ opграф, полученный из $D-U_{1}$ добавлением всех отсутствующих в этом орграфе стрелок множества $\left\{z y: y \in U_{2}^{-}\right\}$.
Замечание 8.3. Пусть $D$ - сильно связный орграф, а вершина $z \in V(D)$ такова, что $D-z$ - не сильно связный орграф. Тогда можно построить $(z, U)$-редукцию $D$ для любой крайней компоненты сильной связности $U$ орграфа $D-z$.
Лемма 8.22. Пусть $D$ - сильно связный орграф, а вершина $z \in V(D)$ такова, что $V(D-z)$ есть объединение непересекающихся множеств $U_{1}$ и $U_{2}$, причем $A_{D}\left(U_{2}, U_{1}\right)=\varnothing$. Предположим, что $\left(z, U_{i}\right)$-редукиия $D_{i}$ орграфа $D$ (для некоторого $i \in\{1,2\}$ ) содержит слабый двойной нечетный цикл $H$. Тогда $D$ также содержит слабый двойной нечетный цикл.
Доказательство. Будем считать, что $i=1$ (случай $i=2$ аналогичен). Пусть $H$ не является подграфом $D$, иначе лемма доказана. Тогда $H$ содержит стрелки вида $x z$, отсутствующие в $D$ (таких стрелок одна или две, так как в слабом двойном нечетном цикле в каждую вершину входит не более двух стрелок). Если $x z \in A\left(D_{1}\right) \backslash A(D)$, то существует такая вершина $y \in U_{2}$, что $x y \in A(D)$. В сильно связном орграфе $D$ есть $y z$ путь $P$, который, очевидно, не проходит по $U_{1}$. Тогда стрелка $x y$ вместе с путём $P$ образует $x z$-путь $P_{x}$, внутренние вершины которого лежат в $U_{2}$. Если есть еще одна стрелка $x^{\prime} z \in A\left(D_{1}\right) \backslash A(D)$, мы аналогично построим $x^{\prime} z$ - путь $P_{x^{\prime}}$ в $D$, внутренние вершины которого лежат в $U_{2}$.


Рис. 8.19: Слабые двойные нечетные циклы $H$ и $H^{\prime}$.
Если $A\left(D_{1}\right) \backslash A(D)=\{x z\}$, то заменим в $H$ стрелку $x z$ на $x z$-путь $P_{x}$ и получим орграф $H^{\prime}$ - подграф $D$ - который можно получить из $H$ несколькими подразбиениями стрелок, а следовательно, $H^{\prime}$ является слабым двойным нечетным циклом в $D$. В этом случае лемма доказана.

Остается случай, когда $A\left(D_{1}\right) \backslash A(D)=\left\{x z, x^{\prime} z\right\}$. Заменим в $H$ стрелку $x z$ на $x z$-путь $P_{x}$. Теперь определим вершину $t$ как первое (по пути $P_{x^{\prime}}$ ) пересечение путей $P_{x^{\prime}}$ и $P_{x}$. Пусть $Q_{x^{\prime}}=x^{\prime} P_{x^{\prime}} t$. Тогда $Q_{x^{\prime}}$ не имеет

общих внутренних вершин с $P_{x}$. Заменим стрелку $x^{\prime} z$ на путь $Q_{x^{\prime}}$ (см. рисунок 8.19). Полученный орграф $H^{\prime}$ является подграфом $D$ и может быть получен из $H$ расщеплением вершины $z$ на $t \rightarrow z$ с последующим подразбиением нескольких стрелок. Следовательно, $H^{\prime}$ является слабым двойным нечетным циклом в $D$.

# 8.10.3 Основная теорема 

Теорема 8.18. (C. Thomassen, 1985.) Орграф D четен тогда и только тогда, когда он содержит слабый двойной нечетный иикл.

Доказательство. «. Достаточно доказать, что слабый двойной нечетный цикл четен. Сначала рассмотрим двойной нечетный цикл (см. рисунок 8.15 a ). Всего циклов нечетное число: для двойного цикла длины $k$ их ровно $k+2$. Отметим, что каждая его вершина входит в 4 цикла, а каждая стрелка - в два цикла.

Операции подразбиения стрелки и расщепления вершины (см. рисунок 8.14) не изменяют количество циклов. Мы докажем, что после любого количества операций подразбиения и расщепления каждая стрелка и каждая вершина входят в четное число циклов. Две стрелки и вершина, возникающие после подразбиения, входят во столько же циклов, во сколько входила исходная стрелка, то есть, в четное число.

При расщеплении вершины $a$ на $a_{1} \rightarrow a_{2}$ (см. рисунок 8.14 b ) количество циклов, в которые входят все стрелки, кроме $a_{1} a_{2}$, и все вершины, кроме $a_{1}$ и $a_{2}$ - такое же, как было у соответствующих стрелок и вершин исходного графа, то есть, четное. Стрелка $a_{1} \rightarrow a_{2}$ и вершины $a_{1}$ и $a_{2}$ входят во столько же циклов, во сколько входила вершина $a$, то есть, в четное число.

Итак, в слабом двойном нечетном цикле длины $k$ нечетное число циклов (их $k+2$ ), а каждая стрелка входит в четное число циклов. Следовательно, есть цикл четной длины.
$\Rightarrow$. Пусть $D$ - минимальный контрпример (четный орграф с наименьшим числом вершин и рёбер, не содержащий слабого двойного нечетного цикла). Мы будем последовательно выяснять свойства орграфа $D$ пока, наконец, не придем к противоречию.

Сразу же заметим очевидное: орграф $D$ содержит хотя бы четыре вершины. Действительно, четных орграфов менее чем на 3 вершинах нет, а единственный четный орграф на 3 вершинах - это двойной нечетный цикл. Орграф $D$ является сильно связным (так как любой цикл лежит в одной компоненте сильной связности, одна из компонент сильной связности четного орграфа должна быть четным орграфом).

# 1. Орграф D сильно двусвязен. 

Доказательство. Предположим противное. Тогда существует такая вершина $z \in V(D)$, что $V(D-z)$ есть объединение непересекающихся таких множеств $U_{1}$ и $U_{2}$, что $A_{D}\left(U_{2}, U_{1}\right)=\varnothing$. Пусть $D_{i}-$ это $\left(z, U_{i}\right)$ редукция орграфа $D$ (где $i \in\{1,2\}$ ).

Предположим, что орграф $D_{i}$ четен. Из минимальности $D$ следует, что $D_{i}$ имеет слабый двойной нечетный цикл. Но тогда по лемме 8.22 и орграф $D$ имеет слабый двойной нечетный цикл, противоречие.

Следовательно, ни один из орграфов $D_{1}$ и $D_{2}$ не является четным. Тогда присвоим стрелкам орграфов $D_{1}$ и $D_{2}$ такие веса, что в этих двух орграфах не будет четных циклов.

Для любой стрелки $x y \in A_{D}\left(U_{1}, U_{2}\right)$ существует цикл в орграфе $D$, проходящий по $x y$. Обозначим через $C_{x y}$ один из таких циклов. Понятно, что $z \in V\left(C_{x y}\right)$. Присвоим стрелке $x y$ такой вес, чтобы цикл $C_{x y}$ был нечетен. Теперь все стрелки орграфа $D$ имеют вес.

В полученном взвешенном орграфе $D$ есть четный цикл $C$. Понятно, что $C$ не является циклом ни в одном из орграфов $D_{1}$ и $D_{2}$, а значит, должен проходить по какой-то стрелке $x y \in A_{D}\left(U_{1}, U_{2}\right)$, а также по вершине $z$.


Рис. 8.20: Циклы в $D$ и $D_{1}$.

Оба цикла $C$ и $C_{x y}$ проходят по стрелке $x y$ и по вершине $z$, а значит, содержат $z x$-пути (пусть $P$ и $P^{\prime}$ в циклах $C$ и $C_{x y}$ соответственно) и $y z$-пути (пусть $Q$ и $Q^{\prime}$ в циклах $C$ и $C_{x y}$ соответственно). Циклы $C$ и $C_{x y}$ имеют разную четность, следовательно, либо пути $P$ и $P^{\prime}$, либо пути $Q$ и $Q^{\prime}$ имеют разную четность. Пусть $P$ и $P^{\prime}$ имеют разную четность, второй случай аналогичен. Тогда стрелка $x z \in A\left(D_{1}\right)$ замыкает $P$ и $P^{\prime}$ в циклы разной четности (см. рисунок 8.20 ), один из этих циклов четен. Противоречие с отсутствием четных циклов в $D_{1}$ показывает, что орграф $D$ - сильно двусвязный.
1. Если $A \subset A(D)$ таково, что $D-A$ - сильно связный орграф, то $D$ содержит простой цикл, проходящий по всем стрелкам из $A$.

Доказательство. По теореме 8.17 орграф $D$ имеет такой ориентированный циклический базис $\mathcal{F}$, что каждая стрелка из $A$ принадлежит ровно одному циклу из $\mathcal{F}$. По лемме 8.20 можно присвоить стрелкам орграфа $D$ такие веса, что все циклы из $\mathcal{F}$ будут нечетны. Так как орграф $D$ четен, лемма 8.21 показывает, что существует четный цикл $S_{0}$ и циклы $S_{1}, \ldots, S_{k} \in \mathcal{F}$ такие, что

$$
E\left(S_{0}\right)=E\left(S_{1}\right) \triangle \ldots \triangle E\left(S_{k}\right), \quad \text { где } k \text { чётно. }
$$

Пусть $D^{\prime}=\cup_{i=1}^{k} S_{i}$. Так как $S_{0}$ - цикл в $D^{\prime}$, ввиду (8.7) и по лемме 8.21 орграф $D^{\prime}$ четен. Разумеется, $D^{\prime}$, также как и $D$, не может содержать слабый двойной нечетный цикл. Значит, из минимальности $D$ следует, что $D=D^{\prime}$. Это означает, что $\cup_{i=1}^{k} A\left(S_{i}\right)=A(D)$, следовательно, циклы $S_{1}, \ldots, S_{k}$ содержат все стрелки из $A$. Тогда $A\left(S_{0}\right) \supset A$, что и требовалось доказать.
1. Все вершины орграфа $D$ имеют входящую и исходящую степени ровно 2 .

Доказательство. Из пункта 1 следует, что входящие и исходящие степени всех вершин $D$ не менее 2 . Пусть вершина $z$ такова, что $d_{D}^{+}(z) \geq 3$, а $e$ и $e^{\prime}$ - две исходящие из $z$ стрелки. Из двусвязности $D$ следует, что орграф $D-z$ сильно связен, а значит, и $D-\left\{e, e^{\prime}\right\}$ сильно связен. Тогда по пункту 3 существует простой цикл, проходящий по обеим стрелкам $e$ и $e^{\prime}$. Очевидно, это невозможно: $e$ и $e^{\prime}$ выходят из одной вершины $z$. Аналогично разбирается случай, когда $d_{D}^{-}(z) \geq 3$.
1. Пусть $C$ - такой иикл в $D$, что $D-A(C)$ - сильно связный орграф. Тогда неориентированный граф $D-A(C)$ и каждый его блок минимальные рёберно двусвязные графы.

Доказательство. Пусть $G=\underline{D}-A(C)$. Рассмотрим произвольное ребро $e \in A(D) \backslash A(C)$. Если орграф $\overline{D-A}(C)-e$ сильно связен, то по пункту 2 существует простой цикл орграфа $D$, содержащий $A(C) \cup\{e\}$, что, очевидно, невозможно. Значит, орграф $D-A(C)-e-$ не сильно связный, то есть $V(D)$ есть объединение непересекающихся множеств $U_{1}$ и $U_{2}$ таких, что все стрелки из $A_{D}\left(U_{2}, U_{1}\right) \subset A(C) \cup\{e\}$.

В силу пункта 3 орграф $D$ эйлеров. Цикл $C$ также эйлеров. Следовательно, $a_{D-A(C)}\left(U_{1}, U_{2}\right)=a_{D-A(C)}\left(U_{2}, U_{1}\right)$. Так как орграф $D-A(C)$ сильно связен, $A_{D-A(C)}\left(U_{2}, U_{1}\right) \neq \varnothing$. Тогда из сказанного выше следует, что $A_{D-A(C)}\left(U_{2}, U_{1}\right)=\{e\}$. Следовательно, множество $A_{D-A(C)}\left(U_{1}, U_{2}\right)$ состоит из одной стрелки - назовем ее $e^{\prime}$.

Обозначим неориентированные рёбра, соответствующие стрелкам $e$ и $e^{\prime}$ через $\tilde{e}$ и $\tilde{e}^{\prime}$ соответственно. Для произвольно выбранного ребра $\tilde{e}$ графа $G$ мы доказали, что граф $G-\tilde{e}$ связен, а граф $G-\left\{\tilde{e}, \tilde{e}^{\prime}\right\}$ несвязен. Это означает, что граф $G$ - минимальный реберно двусвязный.

По лемме 8.16 тогда и каждый блок графа $G$ - минимальный реберно двусвязный граф.
1. Пусть $D$ не имеет цикла длины 2. Тогда $D$ имеет такой простой цикл $C$ длины не более $\frac{v(D)+1}{2}$, что неориентированный граф $D-A(C)$ двусвязен.

Доказательство. Так как орграф $D$ двусвязен и не содержит слабого двойного треугольника, по следствию 8.7 орграф $D$ имеет цикл длины не более $k=\frac{v(D)+1}{2}$. Тогда рассмотрим множество $\mathcal{C}$ всех циклов длины не более $k$ в $D$ и выберем из них цикл $Z$ так, чтобы выполнялись следующие два условия.
$1^{\circ}$ Один из блоков $B$ неориентированного графа $D-A(Z)$ имеет максимальное количество вериин (среди всех блоков для всех циклов $\left.Z^{\prime} \in \mathcal{C}\right)$.
$2^{\circ}$ Компонента связности $U \supset V(B)$ графа $D-A(Z)$ максимальна (среди таких компонент для всех циклов $Z^{\prime} \in \mathcal{C}$ ).

Докажем несколько утверждений.
5.1. Граф $G=\underline{D-A(Z)}$ связен, а орграф $D-A(Z)$ сильно связен.


Рис. 8.21: Случай несвязного графа $\underline{D-A(Z)}$.

Доказательство. Пусть это не так и $G$ имеет компоненту связности $W \neq U$ (см. рисунок 8.21). Из пункта 3 мы знаем, что в графе $D(W)$ исходящая и входящая степень каждой вершины орграфа $D(W)$ не менее 1 , поэтому, орграф $D(W)$ имеет цикл $Z^{\prime}$. Ввиду максимальности $U$ мы имеем $v\left(Z^{\prime}\right) \leq|W| \leq \frac{v(D)+1}{2}$. Цикл $Z$ имеет вершину и в $U$, и в $W$, поэтому в графе $D-A\left(Z^{\prime}\right)$ все вершины множества $V(Z) \cup U \supseteq U$ лежат в одной компоненте связности $U^{\prime}$. Так как $B-$ подграф $\underline{D-A\left(Z^{\prime}\right)}$,

вершины которого лежат как раз в компоненте связности $U^{\prime}$, то $U^{\prime}$ содержит блок не меньший, чем $B$. Это противоречит выбору цикла $Z$. Таким образом, граф $G$ связен.

Тогда по следствию 8.8 орграф $D-A(Z)$ сильно связен.
5.2. Блок $B$ имеет хотя бы три вершины степени 2.

Доказательство. Очевидно, граф $D-A(Z)$ эйлеров. Из пункта 4 следует, что блок $B$ графа $D-A(Z)$ - минимальный реберно двусвязный граф. По условию пункта 5 , блок $B$ имеет более двух вершин. Значит, по следствию 8.8 все вершины $B$ имеют четную степень. По лемме 8.16 блок $B$ имеет хотя бы три вершины степени 2.

Мы хотим доказать, что $G=B$, откуда следует двусвязность $G$. Предположим, что это не так и рассмотрим крайний блок $B^{\prime} \neq B$ графа $G$. Ввиду следствия 8.8 в орграфе $D\left(V\left(B^{\prime}\right)\right)$ есть цикл $Z^{\prime}$. Пусть $G^{\prime}=\underline{G-A\left(Z^{\prime}\right)}$. Отметим, что в силу двусвязности орграфа $D$ цикл $Z$ содержит по внутренней вершине каждого крайнего блока графа $G$. Мы докажем, что в графе $G^{\prime}$ есть блок, больший чем $B$, и получим противоречие с выбором цикла $Z$.

Отметим важное свойство: в силу пункта 3 ,

в графе $G$ степень 2 могут иметь только вершины цикла $Z$.
Рассмотрим три случая.
а. Цикл $Z$ содержит хотя бы две вершины блока $B$.

Ни одно ребро из $E(B) \cup E(Z)$ не принадлежит циклу $Z^{\prime}$. Поэтому вершины из $V(B) \cup V(Z)$ нельзя разделить точкой сочленения в $G^{\prime}$ (см. рисунок 8.22 a ), а значит, есть блок $K$ содержащий все эти вершины. В графе $G$ есть крайний блок $B_{1} \neq B$, а цикл $Z$ содержит хотя бы одну вершину $B_{1}$. Поэтому, $v(B)<v(K)$, что противоречит выбору цикла $Z$.
b. Цикл $Z$ содержит одну вершину блока $B$.

Пусть это вершина $x$ (см. рисунок 8.22 b ). Блок $B$ имеет хотя бы три вершины степени 2 , в нашем случае хотя бы две из них отличны от $x$ и ввиду (8.8) являются точками сочленения графа $G$. Одна из этих точек сочленения - назовем ее $y$ - лежит в дереве блоков и точек сочленения графа $G$ на пути от $B$ до крайнего блока $B_{1} \neq B^{\prime}$. Пусть $x_{1}$ - внутренняя вершина блока $B_{1}$, лежащая в $V(Z)$. Тогда существует $x x_{1}$-путь $P$, проходящий через $y$. Пусть $v$ - первая точка пути $P$ (по направлению от $x$ ), принадлежащая циклу $Z$. Понятно, что $v \notin V(B)$. Пусть $P^{\prime}=x P v$. Тогда ни одно из рёбер пути $P^{\prime}$, цикла $Z$ и блока $B$ не принадлежит циклу $Z^{\prime}$, следовательно, $V\left(P^{\prime}\right) \cup V(B) \cup V(Z)$ невозможно разделить точкой

сочленения в $G^{\prime}$ (то есть, существует блок $K$ графа $G^{\prime}$, содержащий все эти вершины). Блок $K$ содержит $V(B)$ и вершину $v \notin V(B)$, а значит, $v(K)>v(B)$, что противоречит выбору цикла $Z$.


Рис. 8.22: Случай связного графа $\underline{D}-A(Z)$.
c. Цикл $Z$ не содержит вершин блока $B$.

Тогда все хотя бы три вершины степени 2 блока $B$ - это точки сочленения графа $G$. Хотя бы две из них - пусть это $y_{1}$ и $y_{2}$ - лежат в дереве блоков и точек сочленения на путях от $B$ до отличных от $B^{\prime}$ крайних блоков $B_{1}$ и $B_{2}$, соответственно (см. рисунок 8.22 c ). Пусть $x_{1}$ и $x_{2}-$ внутренние вершины блоков $B_{1}$ и $B_{2}$ соответственно, принадлежащие циклу $Z$. Тогда в графе $G$ существует путь $Q$ от $x_{1}$ до $x_{2}$, проходящий через блок $B$ и содержащий точки сочленения $y_{1}$ и $y_{2}$. Пусть $w_{1}-$ первая точка на пути $Q$ при проходе от $y_{1}$ к $x_{1}$, принадлежащая циклу $Z$, а $w_{2}$ - первая точка на пути $Q$ при проходе от $y_{2}$ к $x_{2}$, принадлежащая циклу $Z$. Понятно, что $w_{1}, w_{2} \notin V(B)$. Пусть $Q^{\prime}=w_{1} Q w_{2}$. Тогда ни одно из рёбер пути $Q^{\prime}$, цикла $Z$ и блока $B$ не принадлежит циклу $Z^{\prime}$, а значит, $V\left(Q^{\prime}\right) \cup V(B) \cup V(Z)$ невозможно разделить точкой сочленения в $G^{\prime}$ (то есть, существует блок $K$ графа $G^{\prime}$, содержащий все эти вершины). Блок $K$ содержит $V(B)$ и вершину $w_{1} \notin B$, а значит, $v(K)>v(B)$, что противоречит выбору цикла $Z$.

Таким образом, все случаи разобраны. Полученные противоречия показывают, что граф $\underline{D-A(Z)}$ двусвязен, то есть, цикл $Z=C$ нам подходит.
1. $D$ имеет цикл длины 2 .

Доказательство. Если это не так, то пункту 5 в орграфе $D$ есть такой цикл $C$, что $v(C) \leq \frac{v(D)+1}{2}$ и граф $\underline{D-A(C)}$ двусвязен. Тогда по следствию 8.8 орграф $\underline{D}-\bar{A}(C)$ сильно связен (так как этот граф эйлеров). По пункту 4 граф $\underline{D-A(C)}$ - минимальный рёберно двусвязный. По лемме 8.16 граф $\underline{D-A(C)}$ имеет не менее $\frac{v(D)+2}{2}$ вершин степени 2. В

силу пункта 3 все эти вершины должны принадлежать циклу $C$ длины не более $\frac{e(D)+1}{2}$, что невозможно. Противоречие.
1. $D$ - двойной иикл.

Доказательство. В силу пункта 6 орграф $D$ имеет цикл $C$ длины 2 , состоящий из двух стрелок между вершинами $a$ и $b$. Из двусвязности орграфа $D$ следует сильная связность орграфа $D-a$. Так как $d_{D}^{+}(a)=d_{D}^{-}(a)$ по пункту 3 , после добавления к $D-a$ вершины $a$ и инцидентных ей стрелок, кроме стрелок цикла $C$, получится сильно связный орграф. Таким образом, орграф $D-A(C)$ сильно связен. Так как граф $\underline{D}$ двусвязен, граф $G=\underline{D}-A(C)$ связен и становится двусвязным при добавлении двух рёбер между $a$ и $b$. Это означает, что дерево блоков и точек сочленения графа $G$ имеет не более двух крайних блоков, то есть, является простым путем.

Рассмотрим некрайний блок $B$ графа $G$. Он содержит две точки сочленения. Но все вершины степени 2 блока $B$ - точки сочленения $G$, значит, их ровно две. Рассмотрим крайний блок $B^{\prime}$ графа $G$. Он содержит одну точку сочленения и одну из вершин $a$ и $b$, поэтому тоже имеет не более двух вершин степени 2 .

Таким образом, любой блок $B$ графа $G$ имеет не более двух вершин степени 2 . Но из пункта 4 следует, что блок $B$ - минимальный реберно двусвязный граф. Если $v(B)>2$, то $B$ двусвязен и по лемме 8.16 имеет не менее трёх вершин степени 2 , противоречие. Значит, каждый блок графа $G$ состоит из двух кратных рёбер. Так как дерево блоков и точек сочленения графа $G$ - простой путь, сам этот граф - двойной путь. Значит, $\underline{D}$ - двойной (неориентированный) цикл. Из двусвязности $G$ следует, что каждая пара кратных рёбер $\underline{D}$ соответствует противоположно направленным стрелкам орграфа $D$, то есть, $D$ - двойной цикл.

Закончим доказательство теоремы. Предположив, что $D$ - минимальный четный орграф, не содержащий слабого двойного нечетного цикла, мы сделали вывод, что $D$ - двойной цикл. Следовательно, $D$ четный двойной цикл. Тогда несложно расставить веса на его стрелках так, чтобы не было четного цикла. Следовательно, $D$ не является четным графом. Противоречие завершает доказательство теоремы.

# 8.10.4 Условия существования слабого двойного треугольника 

Лемма 8.23. Пусть орграф $D$ сильно двусвязен, а $v \in V(D)$ и иикл $C$ в орграфе $D-v$ таковы, что выполняется одно из двух условий:

$1^{\circ}$ Из каждой вершины цикла $C$ выходит стрелка в $v$;
$2^{\circ}$ Из вершины $v$ выходят стрелки во все вершины цикла $C$.
Тогда $D$ содержит слабый двойной треугольник.
Доказательство. Пусть выполняется условие $1^{\circ}$ (для условия $2^{\circ}$ аналогично). По следствию 8.3 существует два пути $P_{1}$ и $P_{2}$ из $v$ в $V(c)$, не имеющие общих вершин, кроме $v$. Пусть эти пути кончаются в вершинах $x_{1}, x_{2} \in V(C)$. Тогда пути $P_{1}, P_{2}$, стрелки $x_{1} v$ и $x_{2} v$, а также две дуги $x_{1} C x_{2}$ и $x_{2} C x_{1}$ цикла $C$ образуют слабый двойной треугольник (см. рисунок 8.23a).


Рис. 8.23: Слабые двойные треугольники.

Лемма 8.24. Пусть орграф $D$ сильно двусвязен, $v_{1}, v_{2}, v_{3}, v_{4} \in V(D)$ и выполняется одно из условий:
$1^{\circ} v_{1} v_{3}, v_{1} v_{4}, v_{2} v_{3}, v_{2} v_{4}, v_{3} v_{4} \in A(D)$;
$2^{\circ} v_{3} v_{1}, v_{4} v_{1}, v_{3} v_{2}, v_{4} v_{2}, v_{4} v_{3} \in A(D)$.
Тогда в $D$ есть слабый двойной треугольник.
Доказательство. Пусть выполнено условие $1^{\circ}$ (для условия $2^{\circ}$ доказательство аналогично). По следствию 8.3 существуеют $v_{4} v_{1}$-путь $P_{1}$ и $v_{4} v_{2}$-путь $P_{2}$, не имеющие общих вершин, кроме $v_{4}$. Рассмотрим два случая.

1. $V\left(P_{1}\right) \cup V\left(P_{2}\right) \nRightarrow v_{3}$.

В орграфе $D-v_{4}$ существует путь $P_{3}$ от $v_{3}$ до $V\left(P_{1}\right) \cup V\left(P_{2}\right)$, пусть конец этого пути - вершина $z \in V\left(P_{1}\right)$. Тогда мы имеем слабый двойной треугольник, изображенный на рисунке 8.23 b (путь из $z$ в $v_{1}$ нужно стянуть в вершину $v$, после чего получится двойной треугольник на вершинах $v, v_{3}$ и $v_{4}$, рёбра которого подразбиты).
1. $V\left(P_{1}\right) \cup V\left(P_{2}\right) \ni v_{3}$.

Пусть $V\left(P_{1}\right) \ni v_{3}$ (случай $V\left(P_{1}\right) \ni v_{3}$ аналогичен). Положим $R_{1}=v_{4} P_{1} v_{3}$ и $R_{2}=v_{3} P_{1} v_{1}$. В графе $D-v_{3}$ существует путь $P_{3}$ от $V\left(R_{1}\right) \cup V\left(P_{2}\right)$

до $V\left(R_{2}\right)$, пусть конец этого пути - вершина $z \in V\left(R_{1}\right)$, а начало вершина $t$. Рассмотрим два случая.
2.1. $t \in V\left(P_{2}\right)$.

Тогда мы имеем слабый двойной треугольник, изображенный на рисунке 8.23 с (путь из $z$ в $v_{1}$ нужно стянуть в вершину $v$, после чего получится двойной треугольник на вершинах $v, v_{3}$ и $v_{4}$, рёбра которого подразбиты).
2.2. $t \in V\left(R_{1}\right)$.

Тогда мы имеем слабый двойной треугольник, изображенный на рисунке 8.23 d (путь из $z$ в $v_{1}$ нужно стянуть в вершину $v$, путь из $v_{4}$ в $t$ нужно стянуть в вершину $v^{\prime}$, после чего получится двойной треугольник на вершинах $v, v^{\prime}$ и $v_{3}$, рёбра которого подразбиты).

Лемма 8.25. Пусть орграф $D$ имеет вершину $v$ исходящей степени 1 , $v и \in A(D), D_{1}=D \cdot v и$. Тогда $D$ содержит слабый двойной треугольник, если и только если $D_{1}$ содержит слабый двойной треугольник.

Доказательство. Очевидно, ввиду того, что как стягивание стрелки $v и$ с $d_{D}^{+}(v)=1$ в вершину $w=v \cdot u$, так и обратная операция расщепления вершины $w$ на $v \rightarrow u$ переводят слабый двойной треугольник в слабый двойной треугольник.

Следующая теорема - основной результат раздела.
Теорема 8.19. (C. Thomassen, 1992.) Пусть $D$ - сильно связный орграф с $\delta^{+}(D) \geq 2$, удовлетворяющий следующим условиям.
$1^{\circ}$ Вершиныь $v_{1}, v_{2}, v_{3}$ таковы, что все остальные вершины орграфа $D$ имеют исходящую степень хотя бы 3.
$2^{\circ}$ Для любых различных вершин $x, y \in V(G)$, где $x \neq v_{1}$, в орграфе $D-x$ существует путь от $v_{1}$ до $y$.

Тогда орграф $D$ содержит слабый двойной треугольник. $B$ частности, орграф $D$ четен.

Доказательство. Предположим, что утверждение неверно и рассмотрим минимальный контрпример $D$ (сначала минимизируем число вершин, потом число стрелок.) Мы будем выяснять свойства орграфа $D$ до тех пор, пока не придем к противоречию.

1. $D$ сильно двусвязен.

Доказательство. Предположим, что это не так и рассмотрим такую вершину $z \in V(D)$, что орграф $D-z$ не является сильно связным.

Пусть $U$ - крайняя компонента сильной связности орграфа $D-z$, из которой не выходит стрелок. Из условия $2^{\circ}$ следует, что $v_{1} \notin U$. Пусть $D^{\prime}-$ это $(z, U)$-редукция орграфа $D$.

Для любой вершины $x \in U$ мы имеем $d_{D^{\prime}}^{+}(x)=d_{D}^{+}(x) \geq 2$. В частности это означает, что $|U| \geq 2$ и в графе $D^{\prime}$ не более трех вершин исходящей степени менее 3 - это могут быть $v_{2}$ и $v_{3}$ (если они лежат в $U$ ) и $z$.

Для любых вершин $x, y \in U$ в орграфе $D-x$ есть путь из $V(D) \backslash U \ni v_{1}$ в $y$. Значит, по построению $(z, U)$-редукции в орграфе $D^{\prime}-x$ есть путь из $z$ в $y$. Отсюда следует, что $d_{D^{\prime}}^{+}(z) \geq 2$ и орграф $D^{\prime}$ удовлетворяет условию теоремы с $v_{1}=z$.

Из минимальности орграфа $D$ следует, что $D^{\prime}$ содержит слабый двойной треугольник. Так как орграф $D$ сильно связен, по лемме 8.22 и орграф $D$ содержит слабый двойной треугольник, противоречие.

Теперь мы знаем, что орграф $D$ сильно двусвязен. Поэтому условие $2^{\circ}$ выполняется для любой вершины вместо $v_{1}$. Значит, разницы между $v_{1}, v_{2}$ и $v_{3}$ нет. Мы будем считать, что исходящая степень вершины $v_{1}$ - минимальная в орграфе $D$.
1. $d_{D}^{+}\left(v_{1}\right)=2$.

Доказательство. Если это не так, то $\delta^{+}(D) \geq 3$. Для любой вершины $z \in \mathrm{~N}_{D}^{-}\left(v_{1}\right)$ орграф $D-z v_{1}$ удовлетворяет условиям $1^{\circ}$ (в качестве одной из вершин $v_{2}$ и $v_{3}$ нужно будет взять $z$ ) и $2^{\circ}$ (это условие наследуется из орграфа $D$ : никакой простой $v_{1} y$-путь не проходит по ребру $z v_{1}$ ). Так как $D$ - минимальный контрпример, орграф $D-z v_{1}$ содержит слабый двойной треугольник, что, очевидно, невозможно.

Пусть $\mathrm{N}_{D}^{+}\left(v_{1}\right)=\left\{u_{1}, u_{2}\right\}$. Введем обозначения
$D_{1}=\left(D-v_{1} u_{2}\right) \cdot v_{1} u_{1}, \quad u_{1}^{\prime}=v_{1} \cdot u_{1}, \quad D_{2}=\left(D-v_{1} u_{1}\right) \cdot v_{1} u_{2}, \quad u_{2}^{\prime}=v_{1} \cdot u_{2}$.
1. Можно выбрать обозначения так, что $\delta^{+}\left(D_{1}\right) \geq 2$.

Доказательство. Предположим, что утверждение для $D_{1}$ в исходных обозначениях не выполнено. Если $d_{D_{1}}^{+}\left(u_{1}^{\prime}\right) \leq 1$, то выполнено условие:

$$
d_{D}^{+}\left(u_{1}\right)=2 \quad \text { и } \quad u_{1} v_{1} \in A(D)
$$

Если же $d_{D_{1}}^{+}\left(x_{1}\right) \leq 1$ для некоторой вершины $x_{1} \neq u_{1}^{\prime}$, то выполнено условие:

$$
\text { существует такая вершина } x_{1} \in V(D) \text {, что } \mathrm{N}_{D}^{+}\left(x_{1}\right)=\left\{u_{1}, v_{1}\right\}
$$

Вершинами исходящей степени 2 в орграфе $D$ могут быть только $v_{1}, v_{2}$ и $v_{3}$. Рассмотрим несколько случаев в зависимости от соединения стрелками этих трех вершин. Напомним, что $v_{1}, v_{2}, v_{3}$ почти что равноправны: единственное отличие вершины $v_{1}$ в том, что ее исходящая степень минимальна и равна 2 . Если это же верно и для какой-то из вершин $v_{2}$ и $v_{3}$, то ее можно поменять местами с $v_{1}$.
a. $v_{2} v_{1}, v_{3} v_{1} \notin A(D)$.

Рассмотрим орграф $D_{1}$ (в исходной нумерации). В нашем случае в вершину $v_{1}$ не входит стрелки ни из одной вершины исходящей степени 2 в орграфе $D$, а значит, ни условие (8.9), ни условие (8.10) не может быть выполнено. Следовательно $\delta^{+}\left(D_{1}\right) \geq 2$.

a

b

c

Рис. 8.24: Конфигурации пункта 3.
b. $v_{1} v_{2}, v_{1} v_{3} \in A(D)$.

Рассмотрим орграф $D^{\prime}=\left(D-v_{1} v_{3}\right) \cdot v_{1} v_{2}$. Пусть этот орграф нам не подходит. Предположим, что выполняется условие (8.10). Так как единственной отличной от $v_{1}$ и $v_{2}$ вершиной исходящей степени 2 может быть только $v_{3}$, тогда $v_{3} v_{2}, v_{3} v_{1} \in A(D)$ (см. рисунок 8.24 a ). В этом случае существует цикл из двух вершин $v_{1} v_{3}$, причем $v_{1} v_{2}, v_{3} v_{2} \in A(D)$. Тогда по лемме 8.23 орграф $D$ содержит слабый двойной треугольник, противоречие. Значит, выполнено условие (8.9), то есть, $v_{2} v_{1} \in A(D)$ и $d_{D}^{+}\left(v_{2}\right)=2$. Аналогично, $v_{3} v_{1} \in A(D)$ и $d_{D}^{+}\left(v_{3}\right)=2$ (см. рисунок 8.24 b ).

Если $v_{2} v_{3} \in A(D)$, то применим лемму 8.23 к циклу $v_{1} v_{2}$ и вершине $v_{3}$ и получим, что орграф $D$ содержит слабый двойной треугольник, противоречие. Значит, $v_{2} v_{3} \notin A(D)$ и, аналогично, $v_{3} v_{2} \notin A(D)$.

Тогда существует такая вершина $y \in V(D) \backslash\left\{v_{1}, v_{3}\right\}$, что $v_{2} y \in A(D)$. Отметим, что $d_{D}^{+}(y) \geq 3$. Пусть

$$
D^{*}=\left(D-v_{2} v_{1}\right) \cdot v_{2} y, \quad w=v_{2} \cdot y
$$

Из $d_{D}^{+}(y) \geq 3$ следует, что $d_{D^{*}}^{+}(w) \geq 2$. Пусть $d_{D^{*}}^{+}(t) \leq 1$, где $t \neq w$. Тогда $\mathrm{N}_{D}^{+}(t)=\left\{v_{2}, y\right\}$. Это означает, что $t \notin\left\{v_{1}, v_{2}, v_{3}\right\}-$ четвертая вершина исходящей степени 2 в орграфе $D$, противоречие с условием $1^{\circ}$. Значит, $\delta^{+}\left(D^{*}\right) \geq 2$ и $D_{1}=D^{*}$ нам подходит.

с. Ни одно из предыдущих условий не выполнено.

Рассмотрим орграф $H=D\left(\left\{v_{1}, v_{2}, v_{3}\right\}\right)$. Тогда $\delta^{-}(H) \geq 1$, иначе выполнено условие а. Следовательно, в этом графе хотя бы три стрелки. Но из любой вершины выходит не более чем одна стрелка, иначе выполнено условие b. Значит, исходящая и входящая степень каждой вершины $H$ равна 1 , откуда понятно, что этот граф - треугольник. Можно считать, что $A(H)=\left\{v_{1} v_{2}, v_{2} v_{3}, v_{3} v_{1}\right\}$.

Пусть $\mathrm{N}_{D}^{+}\left(v_{1}\right)=\left\{v_{2}, x\right\}$. Рассмотрим орграф $D^{\prime}=\left(D-v_{1} x\right) \cdot v_{1} v_{2}$. Поскольку $v_{2} v_{1} \notin A(D)$ и нет вершины $t$ с $\mathrm{N}_{D}^{+}(t)=\left\{v_{1}, v_{2}\right\}$, то условия (8.9) и (8.10) не выполнены, а значит, $\delta^{+}\left(D^{\prime}\right) \geq 2$ и этот орграф нам подходит.

Итак, пусть обозначения таковы, что $\delta^{+}\left(D_{1}\right) \geq 2$. Далее мы исследуем граф $D_{1}$. Если и $\delta^{+}\left(D_{2}\right) \geq 2$, то все доказанное далее для $D_{1}$ верно и для $D_{2}$.
1. $D_{1}$ имеет не более трех вершин исходящей степени 2. Если их ровно три, то выполнено одно из условий (8.11) и (8.12).

Доказательство. В орграфе $D$ было не более трёх вершин исходящей степени 2: это $v_{1}, v_{2}$ и $v_{3}$. Вершина $v_{1}$ исчезла. Вершины $v_{2}$ и $v_{3}$ сохранили исходящую степень (если $u_{1}=v_{i}$ и $d^{+}\left(v_{i}\right)=2$, то $d_{D_{1}}^{+}\left(u_{1}^{\prime}\right)=2$, эта вершина будет вместо $v_{i}$ ). Новой вершиной исходящей степени 2 в $D_{1}$ могла стать $u_{1}^{\prime}$, если и только если

$$
d_{D}^{+}\left(u_{1}\right)=3 \quad \text { и } \quad u_{1} v_{1} \in A(D)
$$

Новая вершина $w \neq u_{1}^{\prime}$ исходящей степени $d_{D_{1}}^{+}(w)=2$ могла появиться, если и только если

существует такая вершина $w \in V(D)$, что $d_{D}^{+}(w)=3$ и $w u_{1}, w v_{1} \in A(D)$.

a

b

Рис. 8.25: Конфигурации пункта 4.
Если есть две вершины $w_{1}, w_{2}$, удовлетворяющие условию (8.12), то по лемме 8.24 (ее можно применить для вершин $w_{1}, w_{2}, v_{1}, u_{1}$, см. рисунок 8.25 a ) в орграфе $D$ есть слабый двойной треугольник, противоречие.

Если выполнены оба условия (8.11) и (8.12), то в $D$ есть цикл $u_{1} v_{1}$ и $w u_{1}, w v_{1} \in A(D)$ (см. рисунок 8.25 b ). Тогда по лемме 8.23 в орграфе $D$ есть слабый двойной треугольник, противоречие.

Следовательно, в $D_{1}$ добавилось не более одной вершины исходящей степени 2 , а значит, их не более трёх. Если таких вершин три, то выполнено ровно одно из условий (8.11) и (8.12).
1. Орграф $D_{1}$ не содержит слабого двойного треугольника.

Доказательство. Если орграф $D_{1}$ содержит слабый двойной треугольник, то по лемме 8.25 и орграф $D$ содержит слабый двойной треугольник, что не так.

Если орграф $D_{1}$ сильно двусвязен, то для него выполняется утверждение теоремы (он меньше чем $D$ ), то есть, $D_{1}$ содержит слабый двойной треугольник, что противоречит пункту 5 . Значит, орграф $D_{1}$ не является сильно двусвязным. Рассмотрим все способы удалить вершину из $D_{1}$ так, чтобы получился не сильно связный орграф, и у каждого такого орграфа рассмотрим все крайние компоненты, из которых не выходит стрелок. Среди всех таких компонент найдем минимальную компоненту $U_{1}$, пусть это крайняя компонента сильной связности орграфа $D_{1}-z_{1}$, а $W_{1}=V\left(D_{1}-z_{1}\right) \backslash U_{1}$.

Если $U_{1} \ni u_{1}^{\prime}$, то положим $U_{1}^{*}=\left(U_{1} \backslash\left\{u_{1}^{\prime}\right\}\right) \cup\left\{u_{1}\right\}$. Иначе положим $U_{1}^{*}=U_{1}$. Если $W_{1} \ni u_{1}^{\prime}$, то положим $W_{1}^{*}=\left(W_{1} \backslash\left\{u_{1}^{\prime}\right\}\right) \cup\left\{u_{1}, v_{1}\right\}$. Иначе положим $W_{1}^{*}=W_{1}$.
1. $A_{D}\left(U_{1}^{*}, W_{1}^{*}\right)=\varnothing$, а $A_{D}\left(U_{1}^{*}, V(D) \backslash U_{1}^{*}\right)=A_{D}\left(U_{1}^{*},\left\{z_{1}^{*}, v_{1}\right\}\right)$, где $z_{1}^{*}=z_{1}$ при $z_{1} \neq u_{1}^{\prime}$ и $z_{1}^{*}=u_{1}$ при $z_{1}=u_{1}^{\prime}$.

Доказательство. По выбору компоненты сильной связности $U_{1}$ мы имеем $A_{D_{1}}\left(U_{1}, W_{1}\right)=\varnothing$. По построению орграфа $D_{1}$ нам известно, что

$$
\begin{aligned}
& u_{1}^{\prime}=v_{1} \cdot u_{1}, \quad \mathrm{~N}_{D_{1}}^{+}\left(u_{1}^{\prime}\right)=\mathrm{N}_{D}^{+}\left(u_{1}\right) \backslash\left\{v_{1}\right\} \quad \text { и } \\
& \mathrm{N}_{D_{1}}^{-}\left(u_{1}^{\prime}\right)=\left(\mathrm{N}_{D}^{-}\left(u_{1}\right) \cup \mathrm{N}_{D}^{-}\left(v_{1}\right)\right) \backslash\left\{u_{1}, v_{1}\right\} .
\end{aligned}
$$

Таким образом, доказываемое утверждение следует из построения $U_{1}^{*}$ и $W_{1}^{*}$.
1. $u_{1}^{\prime} \in U_{1} \cup\left\{z_{1}\right\}, \quad u_{2} \in W_{1}, \quad W_{1}^{*}=W_{1}$.

Доказательство. Если $u_{1}^{\prime} \in W_{1}$, то по пункту 6 в орграфе $D-z_{1}$ нет стрелок, выходящих из $U_{1}^{*}$, то есть, этот граф не является сильно связным. Противоречие с пунктом 1 . Значит, $u_{1}^{\prime} \in U_{1} \cup\left\{z_{1}\right\}$, откуда $u_{1} \in U_{1}^{*} \cup\left\{z_{1}\right\}$.

Если $u_{2} \in U_{1} \cup\left\{z_{1}\right\}$, то $u_{2} \in U_{1}^{*} \cup\left\{z_{1}\right\}$. В этом случае в орграфе $D-z_{1}$ нет стрелок, выходящих из $U_{1}^{*} \cup\left\{v_{1}\right\}$, то есть, этот граф не является сильно связным. Противоречие с пунктом 1.

Из доказанного следует, что $W_{1}=W_{1}^{*} \subset V(D)$.
Отметим, что из $\delta^{+}\left(D_{1}\right) \geq 2$ и сильной связности орграфа $D-z_{1}$ несложно следует, что $\left|U_{1}\right| \geq 3$.
1. Пусть $H_{1}$ - это $\left(z_{1}, U_{1}\right)$-редукиия орграфа $D_{1}$. Тогда орграф $H_{1}$ сильно двусвязен.

Доказательство. Очевидно, орграф $H_{1}-z_{1}=D_{1}\left(U_{1}\right)$ сильно связен. Пусть $t \in U_{1}$. Докажем, что орграф $H_{1}-t$ сильно связен. Рассмотрим произвольную вершину $x \in U_{1}, x \neq t$.

Если орграф $H_{1}-t$ не сильно связен, то из $x$ можно попасть в компоненту сильной связности $U$ орграфа $H_{1}-t$, из которой не выходит стрелок. Из минимальности $U_{1}$ следует, что $U$ не является компонентой сильной связности орграфа $D_{1}-t$, а значит, $z_{1} \in U$. Таким образом, из любой вершины $x$ в орграфе $H_{1}-t$ можно попасть в $z_{1}$.


Рис. 8.26: Пути в $D-t$ и $D_{1}-t$.
Остается доказать, что в $H_{1}-t$ существует и $z_{1} x$-путь. Рассмотрим несколько случаев.
a. $u_{1}^{\prime} \notin\left\{t, z_{1}\right\}$.

Рассмотрим простой путь $P$ в орграфе $D-t$ от $z_{1}$ до $x$ (при $x \neq u_{1}^{\prime}$ ) или до $v_{1}$ (при $x=u_{1}^{\prime}$ ). Такой путь есть по сильной двусвязности орграфа $D$. Если $V(P) \subset U_{1}^{*} \cup\left\{v_{1}, z_{1}\right\}$, то искомый $z_{1} x$-путь в орграфе $H_{1}$ есть. Остается случай, когда $P$ пересекает $W_{1}$. Пусть $y_{1} y_{2} \in A(P), y_{1} \in W_{1}$, $y_{2} \in U_{1}^{*} \cup\left\{v_{1}\right\}$, причем это последнее такое ребро при проходе от $z_{1}$ (см. рисунок 8.26a). Тогда по построению редукции при $y_{2} \notin\left\{u_{1}, v_{1}\right\}$ мы имеем $z_{1} y_{2} \in A\left(H_{1}\right)$, а при $y_{2} \in\left\{u_{1}, v_{1}\right\}$ мы имеем $z_{1} u_{1}^{\prime} \in A\left(H_{1}\right)$. Следовательно, существует $z_{1} x$-путь в $H_{1}-t$ (см. рисунок 8.26 b ).
b. $z_{1}=u_{1}^{\prime}$.

Строим в орграфе $D-t$ путь $P$ от $u_{1}$ до $x$ (см. рисунок 8.26 c ) и действуем аналогично случаю а.
c. $t=u_{1}^{\prime}$.

Строим $z_{1} x$-путь $P$ в орграфе $D-u_{1}$ (см. рисунок 8.26 a ) и действуем аналогично. Нужно лишь добавить, что на этот раз путь $y_{2} P x$ не содержит $v_{1}$ (это необходимо ввиду $t=u_{1}^{\prime}=v_{1} \cdot u_{1}$ ). Действительно, если на этом участке есть $v_{1}$, то далее путь может следовать только по стрелке $v_{1} u_{2}$ (напомним, что $\mathrm{N}_{D}^{+}\left(v_{1}\right)=\left\{u_{1}, u_{2}\right\}$ ). Так как $u_{2} \in W_{1}$ по пункту 7 , в результате путь снова попадет в $W_{1}$, противоречие с выбором стрелки $y_{1} y_{2}$. В остальном рассуждения аналогичны случаю а.
1. Орграф $H_{1}$ имеет хотя бы четыре вершины исходящей степени 2.

Доказательство. Предположим, что $H_{1}$ имеет не более трёх вершин исходящей степени 2. Так как $H_{1}$ меньше чем $D$, этот граф не может быть контрпримером к утверждению теоремы. Следовательно, $H_{1}$ имеет слабый двойной треугольник. Тогда по лемме 8.22 и орграф $D_{1}$ содержит слабый двойной треугольник, что противоречит пункту 5.
1. $d_{H_{1}}^{+}\left(z_{1}\right)=2$. В $D_{1}$ ровно три вершины исходящей степени 2 и все они лежат в $U_{1}$. В частности, при $v_{2} \neq u_{1}$ выполнено $v_{2} \in U_{1}^{*}$, а при $v_{3} \neq u_{1}$ выполнено $v_{3} \in U_{1}^{*}$. Для любой вершины $x \in W_{1}$ выполнено $d_{D}^{+}(x) \geq 3$. Если $z_{1} \neq u_{1}^{\prime}$, то $d_{D}^{+}\left(z_{1}\right) \geq 3$.

Доказательство. Орграф $H_{1}$ имеет хотя бы четыре вершины исходящей степени 2. Какие вершины в $H_{1}$ могут иметь исходящую степень 2 ? По пункту 4 , в орграфе $D_{1}$ таких вершин не более трех, а у любой вершины $t \in V\left(H_{1}\right)$, отличной от $z_{1}$, очевидно, $d_{H_{1}}^{+}(t)=d_{D_{1}}^{+}(t)$. Поэтому, $z_{1}$ должна оказаться "дополнительной" вершиной исходящей степени 2 в $H_{1}$, а значит, $d_{H_{1}}^{+}\left(z_{1}\right)=2$ и $d_{D_{1}}^{+}\left(z_{1}\right) \geq 3$. Если $z_{1} \neq u_{1}^{\prime}$, то, очевидно, и $d_{D}^{+}\left(z_{1}\right) \geq 3$.

Все вершины, имеющие в $D_{1}$ исходящую степень 2 , должны лежать в $U_{1}$ и их ровно три. В частности, те из вершин $v_{2}$ и $v_{3}$, что отличны от $u_{1}^{\prime}$, лежат в $U_{1}$, а значит, и в $U_{1}^{*}$.

Из сказанного выше следует, что для любой вершины $x \in W_{1}$ выполнено $d_{D_{1}}^{+}(x) \geq 3$, а значит, и $d_{D}^{+}(x) \geq 3$.

По пункту 7 нам известно, что $u_{2} \in W_{1}$. Тогда $d_{D}^{+}\left(u_{2}\right) \geq 3$ в силу пункта 10 , а значит, условие (8.9) для $u_{2}$ вместо $u_{1}$ не может быть выполнено. Проверим, что условие (8.10) не выполнено для $u_{2}$ вместо $u_{1}$. Предположим противное, тогда существует такая вершина $x \in V(D)$,

что $\mathrm{N}_{D}^{+}(x)=\left\{u_{2}, v_{1}\right\}$. Тогда $x \in\left\{v_{2}, v_{3}\right\} \subset U_{1}$ по пункту 10 . Но по пункту 7 мы имеем $u_{2} \in W_{1}$, а значит, $x u_{2} \notin A(D)$, противоречие. Теперь аналогично ввиду пункта 3 можно сделать вывод $\delta^{+}\left(D_{2}\right) \geq 2$.

Напомним, что $u_{2}^{\prime}=v_{1} \cdot u_{2}$. Для орграфа $D_{2}$ аналогично определим компоненту сильной связности $U_{2}$, вершину $z_{2}$, множества $W_{2}, W_{2}^{*}$ и $U_{2}^{*}$, а также $\left(z_{2}, U_{2}\right)$-редукцию орграфа $D_{2}-$ орграф $H_{2}$.

Все доказанное в пунктах $4-10$ про орграф $D_{1}$ верно и для орграфа $D_{2}$. Сформулируем три из этих утверждений.

4а. В орграфе $D_{1}$ ровно три вершин исходящей степени 2. Выполнено одно из условий (8.13) и (8.14):

$$
d_{D}\left(u_{2}\right)=3 \text { и } u_{2} v_{1} \in A(D)
$$

существует такая вершина $w \in V(D)$, что $d_{D}^{+}(w)=3$ и $w u_{2}, w v_{1} \in A(D)$.

Доказательство. Мы склеили результаты пунктов 4 и 10 для графа $D_{2}$ : так как в $H_{2}$ четыре вершины исходящей степени 2 , в $D_{2}$ должно быть ровно три таких вершины, а значит, аналогично пункту 4 , выполнено одно из условий (8.13) и (8.14).

6a. $A_{D}\left(U_{2}^{*}, W_{2}^{*}\right)=\varnothing$, a $A_{D}\left(U_{2}^{*}, V(D) \backslash U_{2}^{*}\right)=A_{D}\left(U_{2}^{*},\left\{z_{2}^{*}, v_{1}\right\}\right)$, где $z_{2}^{*}=$ $z_{2} n p u z_{2} \neq u_{2}^{\prime}$ и $z_{2}^{*}=u_{2} n p u z_{2}=u_{2}^{\prime}$.

7a. $u_{2}^{\prime} \in U_{2} \cup\left\{z_{2}\right\}, \quad u_{1} \in W_{2}, \quad W_{2}^{*}=W_{2}$.
1. $v_{2}, v_{3} \in U_{2}^{*} \cap U_{1}^{*}$.

Доказательство. По пунктам 7а и 7 мы имеем $u_{1} \in W_{2}$ и $u_{2} \in W_{1}$. По пункту 10 мы имеем $v_{2}, v_{3} \subset U_{1}^{*} \cup\left\{u_{1}\right\}$. Так как $u_{2} \in W_{1}$ и $u_{2} \neq u_{1}$, получаем $u_{2} \notin\left\{v_{2}, v_{3}\right\}$. По аналогу пункта 10 для орграфа $D_{2}$ мы имеем $v_{2}, v_{3} \subset U_{2}^{*} \cup\left\{u_{2}\right\}$, откуда аналогично получаем, что $u_{1} \notin\left\{v_{2}, v_{3}\right\}$. Таким образом, $v_{2}, v_{3} \in U_{2}^{*} \cap U_{1}^{*}$.
1. Существует такая вершина $x \in W_{1} \cup\left\{z_{1}\right\}$, что $x v_{1} \in A(D)$.

Доказательство. По пункту 4а, выполняется одно из условий (8.13) и (8.14). Если выполнено условие (8.13), то $x=u_{2}$ нам подходит (напомним, что $u_{2} \in W_{1}$ по пункту 7). Если выполнено условие (8.14), то из $u_{2} \in W_{1}$ следует, что $w \in W_{1} \cup\left\{z_{1}\right\}$. Тогда вершина $x=w$ нам подходит.
1. $z_{1} \neq u_{1}^{\prime}$ или $z_{2} \neq u_{2}^{\prime}$.

Доказательство. Предположим противное: $z_{1}=u_{1}^{\prime}$ и $z_{2}=u_{2}^{\prime}$. В пунктах 7 и 10 доказано, что $u_{2} \in W_{1}$ и $v_{2} \in U_{1}^{*}$. По пункту 6 , любой $v_{2} u_{2^{-}}$ путь в орграфе $D-v_{1}$ содержит $u_{1}$. Аналогично, любой $v_{2} u_{1}$-путь в орграфе $D-v_{1}$ содержит $u_{2}$. Но ввиду сильной двусвязности $D$ в орграфе $D-v_{1}$ существует простой путь из $v_{2}$ до $\left\{u_{1}, u_{2}\right\}$, что противоречит доказанному выше.

Выберем нумерацию так, чтобы $z_{1} \neq u_{1}^{\prime}$. Тогда $z_{1} \in V(D)$. Однако, возможно, что $z_{2}=u_{2}^{\prime}$. Поэтому далее менять нумерацию мы не сможем.
1. $A_{D}\left(v_{1}, W_{1}\right)=\left\{v_{1} u_{2}\right\}$.

Доказательство. По пункту 7 и из $u_{1}^{\prime} \neq z_{1}$ мы имеем $u_{1}^{\prime}=v_{1} \cdot u_{1} \in U_{1}$. Отсюда немедленно следует доказываемое утверждение.


Рис. 8.27: $v_{2} z_{1}$-путь $P$.
1. Если $z_{2}=u_{2}^{\prime}$ или $z_{2} \in W_{1} \backslash\left\{u_{2}\right\}$, mo $z_{1} \in U_{2}^{*}$.

Доказательство. Так как орграф $D$ сильно двусвязен, в $D-v_{1}$ есть $v_{2} z_{1}$-путь $P$. Поскольку $v_{2} \in U_{1}^{*}$, из пункта 6 следует, что путь $P$ не может проходить по $W_{1}$ (см. рисунок 8.27a). В частности, это означает, что $P$ не содержит вершину $z_{2}$. По пункту 11 мы имеем $v_{2} \in U_{2}^{*}$, а из пункта 6а следует $A_{D}\left(U_{2}^{*}, W_{2}\right)=0$. Следовательно, $V(P) \subset U_{2}^{*}$. В частности, конец пути $P$ вершина $z_{1} \in U_{2}^{*}$ (см. рисунок 8.27 b ).
1. Если $z_{2}=u_{2}^{\prime}$ или $z_{2} \in U_{1}^{*} \cup\left\{z_{1}\right\}$, mo $W_{1} \backslash\left\{u_{2}\right\} \subset U_{2}$.


Рис. 8.28: $z_{1} x$-путь $P$.

Доказательство. Рассмотрим случай, когда $z_{2}=u_{2}^{\prime}$. Пусть $P-$ это простой путь из $z_{1}$ в произвольную вершину $x \in W_{1} \backslash\left\{u_{2}\right\}$ в орграфе $D-u_{2}$ (такой путь есть так как орграф $D$ сильно двусвязен, см. рисунок 8.28 a ). Путь $P$ не может проходить по $U_{1}^{*} \cup\left\{v_{1}\right\}$ : по пункту 6 мы имеем $A_{D}\left(U_{1}^{*}, W_{1}\right)=\varnothing$, а по пункту 14 нам известно, что $A_{D}\left(v_{1}, W_{1}\right)=\left\{v_{1} u_{2}\right\}$. Путь $P$ стартует в $z_{1} \in U_{2}^{*}$ (напомним, что $z_{1} \in U_{2}^{*}$ по пункту 15) и не проходит ни через $u_{2}$, ни через $v_{1}$. Значит, $V(P) \subset U_{2}^{*}$, в частности, $x \in U_{2}^{*}$ (см. рисунок 8.28 b ).

Пусть $z_{2} \in U_{1}^{*} \cup\left\{z_{1}\right\}$. Тогда в силу пункта 7 a мы имеем $u_{2}^{\prime} \in U_{2}$, а значит, $u_{2} \in U_{2}^{*}$. Из сильной двусвязности $D$ следует, что для любой вершины $x \in W_{1} \backslash\left\{u_{2}\right\}$ в $D-z_{1}$ существует простой $u_{2} x$-путь $P$ (см. рисунок 8.29 a ). Предположим, что путь $P$ проходит по $v_{1}$, тогда далее он идет по стрелке $v_{1} u_{1}$ и попадает в $U_{1}^{*}$, откуда не сможет попасть в $x \in W_{1}$, так как не проходит по $z_{1}$ и больше не попадает в $v_{1}$. Если $P$ проходит по $z_{2} \in U_{1}^{*}$, он также может попасть в $W_{2}$ лишь пройдя через $v_{1}$ или $z_{1}$, что невозможно. Значит, $z_{2}, v_{1} \notin V(P)$.


Рис. 8.29: $u_{2} x$-путь $P$.
Путь $P$ начинается в вершине $u_{2} \in U_{2}^{*}$ и не проходит ни по $z_{2}$, ни по $z_{1}$, а значит, по пункту ба мы имеем $x \in U_{2}^{*}$ (см. рисунок 8.29 b ).

В обоих случаях мы получили, что $W_{1} \backslash\left\{u_{2}\right\} \subset U_{2}^{*}$, то есть, утверждение доказано.
1. Если $z_{2} \in W_{1} \backslash\left\{u_{2}\right\}$, то $\left(W_{1} \backslash\left\{z_{2}\right\}\right) \cup\left\{z_{1}\right\} \subset U_{2}^{*}$.

Доказательство. По пункту 15 в этом случае $z_{1} \in U_{2}$. По пункту ба мы имеем $u_{2}^{\prime} \in U_{2}$. Из сильной двусвязности $D$ следует, что для любой вершины $x \in W_{1} \backslash\left\{u_{2}\right\}$ в $D-z_{2}$ существует кратчайший путь $P$ от $\left\{z_{1}, u_{2}\right\}$ до $x$ (см. рисунок 8.30a). Предположим, что $P$ проходит через $v_{1}$. Так как этот путь - простой, он не может идти по стрелке $v_{1} u_{2}$, а значит, идет по стрелке $v_{1} u_{1}$ и попадает в $U_{1}^{*}$, откуда не сможет вернуться в $x \in W_{1}$ : по пункту 6 это можно сделать только через вершины $v_{1}$ и $z_{1}$, что невозможно.

Путь $P$ начинается в вершине из $U_{2}^{*}$ и не проходит ни по $z_{2}$, ни по $v_{1}$, а значит, по пункту 6 а его конец $x \in U_{2}^{*}$ (см. рисунок 8.30 b ).



Рис. 8.30: Путь $P$ из $\left\{z_{1}, u_{2}\right\}$ в $x$.
1. Существует не более одной такой вершины $w \in W_{1} \cup\left\{z_{1}\right\}$, что $w u_{1} \in A(D)$. Если вершина $w$ существует, то $w \in\left\{z_{1}, z_{2}, u_{2}\right\}$.

Доказательство. Вспомним, что $u_{1} \in W_{2}$, а $A_{D}\left(U_{2}^{*}, W_{2}\right)=\varnothing$ по пункту 6а. Рассмотрим четыре случая расположения вершины $z_{2}$.
a. $z_{2}=u_{2}^{\prime}$.

Тогда $\left(W_{1} \cup\left\{z_{1}\right\}\right) \backslash\left\{u_{2}\right\} \subset U_{2}^{*}$ по пунктам 15 и 16. Значит, в этом случае возможно только $w=u_{2}$.
b. $z_{2} \in W_{1} \backslash\left\{u_{2}\right\}$.

Тогда $\left(W_{1} \backslash\left\{z_{2}\right\}\right) \cup\left\{z_{1}\right\} \subset U_{2}^{*}$ по пункту 17. Значит, в этом случае возможно только $w=z_{2}$.
c. $z_{2}=z_{1}$.

По пункту 16 мы имеем $W_{1} \backslash\left\{u_{2}\right\} \subset U_{2}^{*}$. Вспомним, что $u_{2}^{\prime} \in U_{2} \cup\left\{z_{2}\right\}$ по пункту 7а. Однако, $u_{2}^{\prime} \neq z_{1}=z_{2}$ (вершина $z_{1}$ выбиралась в графе $D_{1}$, в котором нет $u_{2}^{\prime}$ ). Значит, $u_{2} \in U_{2}^{*}$, откуда $u_{2} u_{1} \notin A(D)$ по пункту 6а. В этом случае возможно только $w=z_{2}=z_{1}$.
d. $z_{2} \in U_{1}^{*}$.

По пункту 16 мы имеем $W_{1} \backslash\left\{u_{2}\right\} \subset U_{2}^{*}$, а по пункту 6а и сказанному выше $A_{D}\left(U_{2}^{*}, u_{1}\right) \subset A_{D}\left(U_{2}^{*}, W_{2}\right)=\varnothing$. Остаются только два варианта: $w=u_{2}$ и $w=z_{1}$. По пункту 7а и по построению $u_{2} \in\left\{z_{2}\right\} \cup U_{2}^{*}$. Выше доказано, что $w \notin U_{2}^{*}$. Так как $w \in W_{1} \cup\left\{z_{1}\right\}$, вариант $w=z_{2}$ на этот раз нам тоже не подходит. Следовательно, $w \neq u_{2}$. Таким образом, мы доказали, что $w \notin W_{1}$. Остается возможным лишь вариант $w=z_{1}$.

По пункту 12 существует такая вершина $x \in W_{1} \cup\left\{z_{1}\right\}$, что $x v_{1} \in A(D)$. Если $x=z_{1}$, то $z_{1} u_{1}^{\prime} \in A\left(H_{1}\right)$. Если $x \in W_{1}$, то по построению графа $D_{1}$ и его $\left(z_{1}, U_{1}\right)$-редукции мы имеем $z_{1} u_{1}^{\prime} \in A\left(H_{1}\right)$. Так как $d_{H_{1}}^{+}\left(z_{1}\right)=2$ по пункту 10 , мы имеем $\mathrm{N}_{H_{1}}^{+}\left(z_{1}\right)=\left\{u_{1}^{\prime}, r\right\}$. Вершина $r$ будет нужна нам в последующих рассуждениях.

Положим $G=D\left(W_{1} \cup\left\{r, v_{1}, z_{1}\right\}\right)+r v_{1}+r z_{1}$ (стрелки $r v_{1}$ и $r z_{1}$ добавляются, если их нет, см. рисунок 8.31a). Отметим, что из $z_{1} \neq u_{1}^{\prime}$ следует $z_{1} \in V(D) \backslash\left\{v_{1}\right\}$.

Из $u_{1} \notin V(G)$ следует, что $\mathrm{N}_{G}^{+}\left(v_{1}\right)=\left\{u_{2}\right\}$. Пусть $G^{\prime}=G \cdot v_{1} u_{2}$ и $u_{2}^{\prime}=v_{1} \cdot u_{2}$ (см. рисунок 8.31 b ).


Рис. 8.31: Графы $G$ и $G^{\prime}$.
1. Орграф $G^{\prime}$ не содержит слабого двойного треугольника.

Доказательство. Так как орграф $D$ сильно двусвязен, по следствию 8.3 он содержит $r z_{1}$-путь $P_{z}$ и $r v_{1}$-путь $P_{v}$, не имеющие общих вершин, кроме $r$ (см. рисунок 8.31 c ). Поскольку $r \in U_{1}^{*}$, пути $P_{z}$ и $P_{v}$ не содержат вершин из $W_{1}$ (по пункту 6 чтобы попасть в $W_{1}$ путь в орграфе $D$ с началом в $r$ должен пройти через $z_{1}$ или $v_{1}$ ).

Тогда орграф $G_{1}$, полученный из $G$ заменой стрелок $r v_{1}$ и $r z_{1}$ на пути $P_{v}$ и $P_{z}$, соответственно, является подразбиением орграфа $G$ и, одновременно, подграфом $D$.

Предположим, что $G^{\prime}$ содержит слабый двойной треугольник. Тогда по лемме 8.22 и граф $G$ содержит слабый двойной треугольник, а значит, и его подразбиение $G_{1}$ - подграф орграфа $D$ - тоже содержит слабый двойной треугольник, противоречие.

Мы докажем, что $G^{\prime}$ удовлетворяет условиям теоремы с вершиной $r$ в качестве $v_{1}$.
1. $\delta^{+}\left(G^{\prime}\right) \geq 2$. Более того, $G^{\prime}$ имеет не более трёх вершин исходящей степени 2.

Доказательство. Пусть вершина $w \in V(G) \backslash\left\{v_{1}, r\right\}=W_{1} \cup\left\{z_{1}\right\}$ такова, что $d_{G}^{+}(w)<d_{D}^{+}(w)$. Тогда существует стрелка $w y \in A(D)$, где $y \in U_{1}^{*} \backslash\left\{v_{1}, r\right\}$. Если $y \neq u_{1}$, то по построению $\left(z_{1}, U_{1}\right)$-редукции мы имеем $y \in \mathrm{~N}_{\dot{H}_{1}}^{+}\left(z_{1}\right)=\left\{u_{1}^{\prime}, r\right\}$, противоречие. Следовательно, возможен только вариант $y=u_{1}$, то есть, $w u_{1} \in A(D)$ и $d_{G}^{+}(w)=d_{D}^{+}(w)-1$. По пункту 18 такая вершина $w$ не более чем одна, причем $w \in\left\{z_{1}, z_{2}, u_{2}\right\}$. Следовательно, $d_{D}^{+}(w) \geq 3$ по пункту 10. Таким образом,

$$
d_{G}^{+}(w)=d_{D}^{+}(w)-1 \geq 2 \quad \text { и } \quad d_{G}^{+}(x)=d_{D}^{+}(x) \geq 3 \text { при } x \in V(G) \backslash\left\{v_{1}, r, w\right\}
$$

Перейдем к исходящим степеням вершин орграфа $G^{\prime}$. Сначала рассмотрим вершины $r, u_{2}^{\prime}, w$. Очевидно, $d_{G^{\prime}}^{+}(r)=2$. Для вершины $u_{2}^{\prime}$ мы имеем

$$
\begin{aligned}
& d_{G^{\prime}}^{+}\left(u_{2}^{\prime}\right)=d_{G}^{+}\left(u_{2}\right)-1 \text { при } u_{2} v_{1} \in A(D) \quad \text { и } \\
& \quad \mathrm{d}_{G^{\prime}}^{+}\left(u_{2}^{\prime}\right)=d_{G}^{+}\left(u_{2}\right) \text { при } u_{2} v_{1} \notin A(D) \text {. }
\end{aligned}
$$

Напомним, что $u_{2} \in W_{1}$ по пункту 7 , а значит, $d_{D}^{+}\left(u_{2}\right) \geq 3$ по пункту 10. Таким образом, $d_{G^{\prime}}^{+}\left(u_{2}^{\prime}\right) \leq 1$ ввиду (8.15) и (8.16) возможно только при $u_{2} v_{1} \in A(D)$ и $u_{2}=w$, то есть, $u_{2} u_{1} \in A(D)$. Но в этом случае в орграфе $D$ есть цикл $v_{1} u_{2}$ и стрелки $v_{1} u_{1}, u_{2} u_{1} \in A(D)$, а значит, по лемме 8.23 в $D$ есть слабый двойной треугольник, противоречие. Следовательно, $d_{G^{\prime}}^{+}\left(u_{2}\right) \geq 2$.

Отметим, что для любой вершины $x \in V(G) \backslash\left\{v_{1}, u_{2}\right\}$ выполнено

$$
\begin{aligned}
d_{G^{\prime}}^{+}(x)= & d_{G}^{+}(x)-1, \quad \text { при } \quad x v_{1}, x u_{2} \in A(D) \quad \text { и } \\
& \mathrm{d}_{G^{\prime}}^{+}\left(u_{2}^{\prime}\right)=d_{G}^{+}\left(u_{2}\right) \quad \text { при } \quad x v_{1} \notin A(D) \text { или } x u_{2} \notin A(D)
\end{aligned}
$$

Теперь предположим, что вершина $w$ существует и $w \neq u_{2}$. Тогда $d_{G}^{+}(w) \geq 2$ в силу (8.15), а значит, $d_{G^{\prime}}^{+}(w) \leq 1$ ввиду (8.17) возможно только в случае, когда $w v_{1}, w u_{2} \in A(D)$. Учитывая стрелки $w u_{1}, v_{1} u_{1}$ и $v_{1} u_{2}$, мы видим, что для вершин $u_{1}, u_{2}, v_{1}, w$ выполнено условие $2^{\circ}$ леммы 8.24 , следовательно, в орграфе $D$ есть слабый двойной треугольник, противоречие.

Пусть $x \in V\left(G^{\prime}\right) \backslash\left\{u_{2}^{\prime}, r, w\right\}$. Тогда $d_{G^{\prime}}^{+}(x) \geq d_{G}^{+}(x)-1=d_{D}^{+}(x)-1 \geq 2$ в силу (8.15) и (8.17). Таким образом, $\delta^{+}\left(G^{\prime}\right) \geq 2$.

Теперь посчитаем потенциальные вершины исходящей степени 2 в $G^{\prime}$. Очевидно, $d_{G^{\prime}}^{+}(r)=2$. Из сказанного выше ясно, что кроме $r$ возможны только следующие варианты:
(1) вершина $w$ при $w \neq u_{2}$ или вершина $u_{2}^{\prime}$ при $w=u_{2}$;
(2) вершина $u_{2}^{\prime}$, если $u_{2} v_{1} \in A(D)$;
(3) вершина $y$, для которой $y v_{1}, y u_{2} \in A(D)$

Вариант (1) дает нам не более одной вершины исходящей степени 2 в $G^{\prime}$. Если условию (3) удовлетворяют две вершины $y_{1}, y_{2}$, то по лемме 8.24 для вершин $y_{1}, y_{2}, u_{2}, v_{1}$ в орграфе $D$ есть слабый двойной треугольник, что не так. Пусть одновременно выполнены условия (2) и (3). Тогда $u_{2} v_{1} \in A(D)$ и существует вершина $y$ с $y v_{1}, y u_{2} \in A(D)$. В этом случае к циклу $u_{2} v_{1}$ и вершине $y$ можно применить лемму 8.23 и опять получить слабый двойной треугольник в $D$, которого нет. Значит, варианты (2) и (3) вместе дают не более одной вершины исходящей степени 2 в $G^{\prime}$, а всего таких вершин не более трёх.

1. Для любых двух отличных от $r$ вершин $z, z^{\prime} \in V\left(G^{\prime}\right)$ в орера$\phi e G^{\prime}-z^{\prime}$ есть $r z$-путь.

Доказательство. Так как $r z_{1}, r u_{2}^{\prime} \in A\left(G^{\prime}\right)$, достаточно рассмотреть случай $z \notin\left\{z_{1}, u_{2}^{\prime}\right\}$ (то есть, $z \in W_{1}$ ).


Рис. 8.32: Построение $r z$-пути в графе $G^{\prime}-z^{\prime}$.
Пусть

$$
M= \begin{cases}\left\{z_{1}, u_{2}\right\}, & \text { если } \quad z^{\prime} \notin\left\{z_{1}, u_{2}^{\prime}\right\} \\ \left\{z_{1}\right\}, & \text { если } \quad z^{\prime}=u_{2}^{\prime} \\ \left\{u_{2}\right\}, & \text { если } \quad z^{\prime}=z_{1}\end{cases}
$$

а $P$ - кратчайший путь в орграфе $D-z^{\prime}$ от $M$ до $z$ (см. рисунок 8.32a). Такой путь есть по сильной двусвязности $D$. Докажем, что $V(P) \subset W_{1}$. Сразу же отметим, что ни одна вершина пути $P$, кроме его начала, не входит в множество $\left\{z_{1}, u_{2}\right\}$ (так как $\left\{z_{1}, u_{2}\right\} \subset M \cup\left\{z^{\prime}\right\}$ ).

Пусть $P$ проходит по $v_{1}$. Тогда далее он идет по стрелке $v_{1} u_{1}$ и оказывается в $U_{1}^{*}$. В силу пункта 6 из $U_{1}^{*}$ путь $P$ может пройти в $W_{1}$ только через $\left\{z_{1}, v_{1}\right\}$, но он не может попасть ни в $z_{1}$, ни второй раз в $v_{1}$, противоречие. Значит, $v_{1} \notin V(P)$. Если же $P$ содержит вершину из $U_{1}^{*}$, то вернуться из $U_{1}^{*}$ в $W_{1}$ он сможет только пройдя через $\left\{v_{1}, z_{1}\right\}$, что, как показано выше, невозможно.

Значит, $V(P) \subset W_{1}$ и одно из ребер $r u_{2}^{\prime}$ и $r z_{1}$ вместе с $P$ образует искомый $r z$-путь в $G^{\prime}$ (см. рисунок 8.32 b$)$.
1. $G^{\prime}$ сильно связен.

Доказательство. Так как из $r$ можно попасть в любую вершину орграфа $G^{\prime}$ и $z_{1} r \in A\left(G^{\prime}\right)$, осталось показать, что из любой вершины $x^{\prime} \in\left(W_{1} \backslash\left\{u_{2}\right\}\right) \cup\left\{u_{2}^{\prime}\right\}$ можно попасть в $r$.

Пусть $x=x^{\prime}$, если $x^{\prime} \neq u_{2}^{\prime}$ и $x=u_{2}$, если $x^{\prime}=u_{2}^{\prime}$. Из сильной двусвязности орграфа $D$ следует, что в $D-u_{1}$ существует $x r$-путь $P$ (см. рисунок 8.33a). Так как $x \in W_{1}$, а $r \in U_{1}^{*}$, на этом пути есть стрелка $y y^{\prime}$, где $y \in W_{1} \cup\left\{v_{1}\right\}, y^{\prime} \in U_{1}^{*} \cup\left\{z_{1}\right\}$. Поскольку $u_{1} \notin V(P)$ и $\mathrm{N}_{D}^{+}\left(v_{1}\right)=\left\{u_{1}, u_{2}\right\}$, можно сделать вывод $y \neq v_{1}$. Более того, если $v_{1} \in V(P)$, то из $v_{1}$ путь $P$ идет в вершину $u_{2}$.



Рис. 8.33: Построение $x r$-пути в графе $G^{\prime}$.

Тогда можно построить в орграфе $G^{\prime}$ путь $P^{\prime}$ от $x^{\prime}$ до $y$, заменив вхождение вершины $u_{2}$ или последовательное вхождение вершин $v_{1} u_{2}$ на вершину $u_{2}^{\prime}$ (см. рисунок 8.33 b ). Если $y^{\prime}=z_{1}$, то мы дополним путь $P^{\prime}$ участком $y z_{1} r$ до искомого пути в $G^{\prime}$.

Пусть $y^{\prime} \neq z_{1}$. Тогда по построению орграфа $D_{1}$ и его $\left(z_{1}, U_{1}\right)$-редукции $H_{1}$ можно сделать вывод $z_{1} y^{\prime} \in A\left(H_{1}\right)$, следовательно, $y^{\prime}=r$ и мы дополним путь $P^{\prime}$ ребром $y r$ до искомого пути в $G^{\prime}$.

В пунктах $20-22$ показано, что орграф $G^{\prime}$ удовлетворяет условию теоремы, он меньше $D$ и, поэтому, должен содержать слабый двойной треугольник. Но в пункте 19 показано, что это невозможно. Противоречие завершает доказательство теоремы.

# 8.10.5 Критерии четности орграфа 

Начнем с прямого следствия теоремы 8.19.
Следствие 8.9. Пусть $D$ - сильно двусвязный орграф, у которого все вершины, кроме, может быть, трёх, имеют исходящую степень не менее 3. Тогда $D$ четен.

Томассен отметил, что условия сильной двусвязности и ровно трех вершин исходящей степени менее 3 не могут быть улучшены. Сформулируем эти результаты в виде задачи.
Задача 8.3. 1) Докажите, что существует сильно двусвязный орграф с 4 вершинами исходящей степени 2 , не являющийся четным.
1) Докажите, что существует сильно связный орграф $D$ с $\delta^{+}(D) \geq 3$, не являющийся четным.

Однако, при ограничениях на входящую и исходящую степени одновременно получается следующая теорема.

Теорема 8.20. (C. Thomassen, 1992.) Пусть сильно связный орграф $D$ таков, что $\delta^{+}(D) \geq 3$ и $\delta^{-}(D) \geq 3$. Тогда $D$ четен.

Доказательство. Если $D$ сильно двусвязен, воспользуемся следствием 8.9. Далее пусть $D$ не сильно двусвязен. Рассмотрим все способы удалить вершину из $D$ так, чтобы получился не сильно связный орграф, и у каждого такого орграфа рассмотрим все крайние компоненты сильной связности (как те, из которых не выходит стрелок, так и те, в которые не входит стрелок). Среди всех таких компонент найдем минимальную компоненту $U$, пусть это крайняя компонента сильной связности орграфа $D-z, W=V(D-z) \backslash U$, а орграф $H-$ это $(z, U)$-редукция $D$.

Пусть из $U$ не выходит стрелок в орграфе $D-z$. Докажем, что орграф $H$ сильно двусвязен. Очевидно, орграф $H-z=D(U)$ сильно связен. Пусть $t \in U$. Предположим, что орграф $H-t$ не сильно связен и рассмотрим его крайнюю компоненту сильной связности $U^{\prime}$, не содержащую $z$ (у орграфа $H-t$ хотя бы две крайних компоненты сильной связности, и хотя бы одна из них не содержит $z$.) Если из $U^{\prime}$ не выходит стрелок в $H-t$, то очевидно, не выходит стрелок и в $D-t$ (так как в орграфе $D$ нет стрелок из $U$ в $W$ ). Тогда $U^{\prime}$ - крайняя компонента сильной связности орграфа $D-t$, причем $U^{\prime} \subsetneq U$, противоречие с минимальностью $U$.

Пусть в $U^{\prime}$ не входит стрелок в орграфе $H-t$, но входит стрелка $x y$ в орграфе $D-t$. Тогда $x \in W, y \in U^{\prime}$ и по построению $(z, U)$-редукции в $H$ есть стрелка $z y$. Но $z \in U \backslash U^{\prime}$, противоречие. Значит, и в этом случае $U^{\prime} \subsetneq U$ - крайняя компонента сильной связности, что невозможно.

Итак, $H$ - сильно двусвязный орграф, все его вершины, кроме, может быть, $z$, имеют исходящую степень не менее 3 . По следствию 8.9 орграф $H$, а следовательно, и орграф $D$ - четен.

В случае, когда в $U$ не входит стрелок в $D-z$, заменим в орграфе $D$ все стрелки на противоположно направленные и воспользуемся преыдущими рассуждениями.

# 8.11 Снова о раскрасках гиперграфа в два цвета 

Мы продолжим разговор о правильных раскрасках гиперграфа в два цвета, начатый в разделе 4.9.2.

Определение 8.19. Пусть $D$ - орграф. Для каждой вершины $x \in V(D)$ положим $e_{x}=\{x\} \cup \mathrm{N}_{D}^{x}(x)$. Определим гиперграф $\mathcal{G}_{D}$ :

$$
V\left(\mathcal{G}_{D}\right)=V(D) \quad \text { и } \quad E\left(\mathcal{G}_{D}\right)=\left\{e_{x}: x \in V(D)\right\}
$$

Теорема 8.21. (Р. D. Seymour, 1974.) Минимальные недвудольные гиперграфы, имеющие поровну вершин и гиперрёбер - это гиперграфы вида $\mathcal{G}_{D}$, где $D$ - сильно связный орграф без четных ииклов, и только они.

Доказательство. 1. Пусть $\mathcal{H}$ - минимальный недвудольный гиперграф с $e(\mathcal{H})=v(\mathcal{H})$. По пункту 2 леммы 4.17 существует такая биекция $\varphi: V(\mathcal{H}) \rightarrow E(\mathcal{H})$, что $x \in \varphi(x)$ для любой вершины $x$. Построим орграф $D$ на множестве вершин $V(\mathcal{H})$ с $A(D)=\{x y: y \in \varphi(x)\}$. Тогда нетрудно понять, что $e_{x}=\{x\} \cup \varphi(x)$ и $\mathcal{H}=\mathcal{G}_{\mathcal{D}}$. Из теоремы 4.16 следует, что орграф $D$ не имеет четных циклов (иначе $\mathcal{H}$ не удовлетворяет условию $2^{\circ}$ этой теоремы).

Остается показать, что $D$ сильно связен. Предположим противное, тогда по лемме 8.2 существует разбиение $V(D)=V(\mathcal{H})$ на два таких непустых множества $W$ и $U$, что $A_{D}(U, W)=\varnothing$. Следовательно, для любой вершины $x \in U$ мы имеем $\varphi(x) \cap W=\varnothing$. Таким образом, подмножество $W \subsetneq V(\mathcal{H})$ может пересекать только гиперрёбра $\varphi(y)$ для $y \in W$, а их не более $|W|$. Противоречие с теоремой 4.15 .
1. Пусть $D$ - сильно связный орграф без четных циклов. Рассмотрим гиперграф $\mathcal{G}_{D}$. Если для некоторых двух вершин $x, y \in D$ мы имеем $e_{x}=e_{y}$, то $x y, y x \in A(D)$, а эти два ребра образуют четный цикл, которых нет в $D$, противоречие. Следовательно, $e\left(\mathcal{G}_{D}\right)=v\left(\mathcal{G}_{D}\right)$.

Предположим, что гиперграф $\mathcal{G}_{D}$ двудолен. Пусть $x_{1} \in V(D)$ - произвольная вершина. Построим последовательность вершин: для каждой вершины $x_{i}$ выберем следующую вершину $x_{i+1} \in e_{x_{i}}$ так, чтобы цвета вершин $x_{i}$ и $x_{i+1}$ различались. Из конечности гиперграфа следует, что вершины в этой последовательности в некоторый момент повторятся, пусть $x_{m+1}=x_{k}$. Тогда получится цикл $C=x_{k} \ldots x_{m}$ в орграфе $D$ (так как $x_{i} x_{i+1} \in A(D)$.) Из чередования цветов понятно, что этот цикл четен, противоречие. Таким образом, гиперграф $\mathcal{G}_{D}$ недвудолен.

Предположим, что множество $U \subsetneq V(D)$ пересекает не более $|U|$ гиперребер $\mathcal{G}_{D}$ - тогда это гиперребра $e_{x}$ для $x \in U$. Следовательно, для любого $x \in V(D) \backslash U$ мы имеем $e_{x} \cap U=\varnothing$, то есть, $A_{D}(V(D) \backslash U, U)=\varnothing$, что противоречит сильной связности орграфа $D$. Следовательно, любое непустое множество $U \subsetneq V(D)$ пересекает более $|U|$ гиперребер $\mathcal{G}_{D}$ и по лемме 4.18 гиперграф $\mathcal{G}_{D}$ - минимальный недвудольный.

Из первой части доказательства теоремы 8.21 непосредственно следует интересный факт.

Следствие 8.10. Пусть $\mathcal{H}$ - минимальный недвудольный гиперграф, а $\varphi: V(\mathcal{H}) \rightarrow E(\mathcal{H})-$ такая биекция, что $x \in \varphi(x)$ для любой верии-

ны $x$. Построим орграф $D$ на вершинах $V(\mathcal{H})$ с $A(D)=\{x y: y \in \varphi(x)\}$. Тогда $D$ - сильно связный гиперграф без четных циклов.

Теорема 8.22. (C. Thomassen, 1992.) Пусть $\mathcal{H}$ - минимальный недвудолъный гиперграф с $e(\mathcal{H})=v(\mathcal{H})$. Тогда $\mathcal{H}$ имеет вершину степени не более 3 или гиперребро, содержащее не более трех вершин.

Доказательство. В теореме 8.21 доказано, что $\mathcal{H}=\mathcal{G}_{\mathcal{D}}$ для некоторого сильно связного орграфа $D$ без нечетных циклов. Предположим, что $\delta(\mathcal{H}) \geq 4$ и каждое гиперребро имеет хотя бы 4 вершины. Рассмотрим произвольную вершину $v \in V(D)$. Из $\left|e_{v}\right| \geq 4$ следует, что $\delta_{D}^{+}(v) \geq 3$. Из $d_{\mathcal{H}}(v) \geq 4$ следует, что $v$ содержится хотя бы в трёх отличных от $e_{v}$ гиперребрах $e_{x}, e_{y}, e_{z} \in E(\mathcal{H})$. Но это означает, что $x v, y v, z v \in A(D)$, то есть, $\delta_{D}^{-}(v) \geq 3$.

Таким образом, $\delta^{+}(D) \geq 3$ и $\delta^{-}(D) \geq 3$, что по теореме 8.20 означает наличие в орграфе $D$ четного цикла. Противоречие завершает доказательство теоремы.

# 8.12 Комментарии 

Это одна из самых длинных глав книги, которая начинается с очень простых разделов, а заканчивается весьма сложными результатами. Я постарался изложить разные аспекты теории ориентированных графов а также ряд теорем из других разделов теории графов, доказательства которых используют орграфы и специфическую технику работы с ними. В книге Дистеля [8] нет главы про орграфы, в книгах [3] и [63] содержится совсем немного результатов, так что и сравнивать эту главу в общем-то, не с чем.

Начинается глава с раздела о структуре компонент сильной связности орграфа: это очень простые, но повсеместно используемые утверждения, не просто классические, а даже фольклорные: непонятно, кто их впервые придумал. Видимо, в каждой статье, где это нужно, просто пишется, что все это очевидно - кстати, чистая правда. Но аккуратно изложить эти факты нужно, что и сделано в разделе 8.1. Все доказательства совершенно элементарны и доступны любому читателю.

В следующем разделе 8.3 обсуждается сильная $k$-связность орграфов и главное утверждение - аналог теоремы Менгера для орграфов и ее следствия. Доказательство в целом аналогично обычной теореме Менгеpa 5.1 , но имеет некоторую специфику. Во всех ссылках на это утверждения просто пишут - теорема Менгера для орграфов, и все же, мне показалось, что его доказателство в книге необходимо.

Далее в разделе 8.4 вниманию чистателя предлагается критерий гамильтоновости орграфа. Не все критерии для обычных графов удается обобщить: только самый простой критерий Дирака (следствие 3.1).

В разделе 8.5 обсуждаются турниры - полные ориентированные графы - и их свойства. Это один из самых популярных объектов в теории орграфов. В первой, элементарной части раздела одно из главных утверждений - теорема Муна о циклах в турнирах, которая изложена в этой книге не так, как в статье Муна [27] и книге Бонди и Мурти [3]. В нашем изложении доказательство проходит через важнейшую с моей точки зрения теорему о существовании в сильно связном турнире двух вершин, удаление каждой из которых не нарушает связность, что в свою очередь, доказывается через существование гамильтонова цикла в сильно связном турнире.

Далее изучаются гамильтоновы пути в турнирах, начиная с классической теоремы Редеи о нечетности их количества до гораздо более современной теоремы Буша [5] о минимальном количестве гамильтоновых путей в сильно связном турнире. Этот результат был предположен на много лет раньше Муном еще в 1960-е, но доказан лишь спустя пояти 40 лет. Доказательства кажутся мне достаточно интересными и, в принципе, их несложно понять.

После не совсем элементарной теоремы Буша мы снова возвращаемя к классическим результатам в разделе 8.6: теоремы Хватала-Ловаса, Галлаи-Мильграма и следствие последней - теорема Дилворса.

В разделе 8.7 обсуждаются ориентации обычных графов. После классической теоремы Роя-Галлаи о существовании пути длины $\chi(G)-1$ в ориентации графа $G$ мы переходим к более современному понятию ядра орграфа и его применению для доказательства двух результатов о списочных раскрасках: теоремы Гэльвина о списочной раскраске рёбер двудольного графа и теореме о существовании списочной раскраски двудольного планарного графа в 3 цвета. Эти теоремы вполне доступны любому читателю.

Дальнейшая часть главы достаточно сложна и вряд ли покорится неподготовленному читателю. Лишь в самом последнем разделе можно увидеть красивые результаты о раскрасках гиперграфов, имеющие простые формулировки, но для их доказательства Карстен Томассен разработал целую теорию, связанную с орграфами, попутно ответив на ряд открытых вопросов.

Раздел 8.8 содержит структурные результаты о циклах в орграфах исходящей степени не менее 2 , принадлежащие Томассену [32]. В дальнейшем, эти результаты помогут решить различные задачи, в частности, о раскрасках гиперграфов в два цвета (см. раздел 4.9.2). Фундаменталь-

ным понятием этого раздела является странный на первый взгляд слабый двойной иикл, который неоднократно пригодится в дальнейшем.

Далее следует небольшое алгебраическое отступление - раздел об ориентированном циклическом базисе, а затем мы вновь погружаемся в увлекательный мир работ Томассена в самом сложном разделе 8.10 о четных орграфах - таких, которые при любых целых весах своих рёбер имеют четный ориентированный цикл. Само по себе необходимое и достаточное условие четности - ниличие слабого двойного нечетного цикла - уже достаточно технически и идейно сложная теорема, но затем следует еще теорема о наличии в графе слабого двойного треугольника с еще более длинным и сложным доказательством... Все это очень непросто прочитать, но в результате получается доказать, что орграф, у которого входящая и исходящая степени всех вершин не менее 3 четен (и, в частности, имеет четный цикл). А также закончить разговор о раскрасках гиперграфов в два цвета. Красивых результатов, следующих из разработанной теории, приходится ждать долго, и эти разделы, конечно, предназначены для сильных и подготовленных читателей.

# Глава 9 

## Остовные деревья

В этой главе всегда подразумевается, что граф $G$ - связный. Мы обсудим вопросы о количестве остовных деревьев в графе $G$, о наличии остовных деревьев с достаточно большим количеством висячих вершин и о выделении в графе нескольких непересекающихся остовных деревьев.

## 9.1 Количество остовных деревьев

Начнём с классического вопроса, исследованного еще в конце 19 века.
Определение 9.1. Обозначим через $s t(G)$ количество остовных деревьев связного графа $G$.

Следующий результат иногда называют формулой Кэли.
Теорема 9.1. (A. Cayley, 1889.) Пусть $G$ - граф, в котором возможны петли и кратные рёбра, а ребро $e \in E(G)$ - не петля. Тогда $s t(G)=s t(G-e)+s t(G * e)$.

Доказательство. Количество остовных деревьев графа $G$, не содержащих ребра $e$, очевидно, равно $s t(G-e)$. Между остовными деревьями, содержащими ребро $e$ и остовными деревьями графа $G * e$ существует взаимно однозначное соответствие $T \rightarrow T * e$ (где $T$ - остовное дерево графа $G, e \in E(T))$.

С помощью формулы Кэли можно вычислить количество остовных деревьев произвольного графа, однако, этот процесс весьма небыстрый. Для ряда графов можно напрямую вычислить количество остовных деревьев. Наверное, наиболее известный результат в этом направлении -

подсчёт количества остовных деревьев полного графа, который был получен Артуром Кэли также в 1889 году. Вместо первоначального доказательства со сложными рекуррентными соотношениями мы приведём ставшее даже более классическим доказательство Прюфера, опубликованное в 1918 году. Каждому дереву будет поставлен в соответствие так называемый код Прюфера.

Теорема 9.2. (A. Cayley, 1889.) $s t\left(K_{n}\right)=n^{n-2}$.
Доказательство. (H. Prüfer, 1918.) Пусть $V\left(K_{n}\right)=[1 . . n]$. Мы построим взаимно однозначное соответствие между остовными деревьями $K_{n}$ (то есть, всеми деревьями на наших $n$ вершинах) и последовательностями длины $n-2$, в которых каждый член принимает натуральное значение от 1 до $n$. Этого достаточно для доказательства теоремы.

Пусть $T$ - дерево на вершинах [1..n]. Построим соответствующую ему последовательность $t_{1}, \ldots, t_{n-2}$. Пусть $\ell_{1}$ - висячая вершина наименьшего номера в дереве $T$, тогда $t_{1}$ - единственная смежная с $\ell_{1}$ вершина дерева $T, T_{1}=T-\ell_{1}$. Затем найдём в $T_{1}$ висячую вершину наименьшего номера $\ell_{2}$, пусть $t_{2}$ - единственная смежная с $\ell_{1}$ вершина дерева $T_{1}$, $T_{2}=T_{1}-\ell_{2}$, и так далее, будем повторять процесс, пока не получим последовательность длины $n-2$ (при этом, останется дерево $T_{n-2}$ на двух вершинах).


Рис. 9.1: Дерево и его код Прюфера.
Построим обратное соответствие. Пусть дана последовательность $t_{1}, \ldots, t_{n-2}$ с элементами из [1..n]. Отметим, что по построению каждая вершина $x$ встречается в последовательности дерева $T$ ровно $d_{T}(x)-1$ раз, поэтому вершины, которые в этой последовательности не встречаются, и есть висячие вершины дерева. Выберем такую вершину $\ell_{1}$ с наименьшим номером и соединим её с $t_{1}$, после чего удалим $\ell_{1}$ из списка номеров: $V_{1}=V \backslash\left\{\ell_{1}\right\}$. Теперь выберем вершину $\ell_{2} \in V_{1}$ с наименьшим номером, которая не встречается в последовательности $t_{2}, \ldots, t_{n-2}$, соединим $\ell_{2}$ с $t_{2}$ и положим $V_{2}=V_{1} \backslash\left\{\ell_{2}\right\}$. И так далее, повторим такую операцию $n-2$ раза. В результате будет использована вся последовательность и проведено $n-2$ ребра, останется множество $V_{n-2}$ из двух вершин и одно непроведённое ребро дерева $T$. Именно две вершины из $V_{n-2}$ и

нужно соединить ребром: их степени в имеющемся графе равны количеству вхождений этих вершин в последовательность $t_{1}, \ldots, t_{n-2}$, то есть, на 1 меньше, чем их степени в дереве $T$.

# 9.2 Матричная теорема о деревьях 

Этот раздел требует некоторого знания алгебры - а именно, того, что такое группа подстановок и определитель матрицы. В графах допускаются кратные рёбра, но не петли (которые все равно не могут входить в остовные деревья).

Определение 9.2. Пусть $G$ - граф на множестве вершин [1..n]. Лапласиан графа $G$ - это квадратная матрица $L=\left(l_{i, j}\right)_{i, j \in[1 . . n]}$, заданная следующим образом: $l_{i, i}=d_{G}(i)$, и $l_{i, j}=-e_{G}(i, j)$ при $i \neq j$.

Замечание 9.1. 1) Из определения и отсутствия петель следует, что сумма элементов в любой строке и в любом столбце матрицы $L$ равна 0 . Таким образом, матрица $L$ вырождена и ее определитель равен 0 .
1) Матрица $L$ симметрична относительно главной диагонали.

Мы докажем теорему Кирхгофа о вычислении количества остовных деревьев графа как минора его лапласиана. У этой классической теоремы есть разные доказательства, из которых мы выбрали, разумеется, комбинаторное. Но все же некоторые простейшие сведения о группе подстановок и определителе матрицы нам понадобится. Для полноты изложения приведем их здесь. Следующая часть текста до формулировки теоремы содержит мини ликбез по группе подстановок, которую знающий читатель может пропустить.

Через $S_{n}$ обозначается группа подстановок, то есть, биекций из [1..n] в $[1 . . n]$. Через id обозначим тождественную подстановку, оставляющую каждый элемент $[1 . . n]$ на месте - это единичный элемент группы $S_{n}$. Групповой операцией будет композиция подстановок.

Для подстановки $\sigma$ через $I(\sigma)$ обозначается количество инверсий в подстановке $\sigma$, а именно, таких упорядоченных пар $(i, j)$, что $i<j$, но $\sigma(i)>\sigma(j)$. Подстановка называется четной, если $I(\sigma)$ четно и нечетной в противном случае.

Знак подстановки $\sigma-$ это $\operatorname{sign}(\sigma)=(-1)^{I(\sigma)}$. Таким образом, знак четной подстановки равен +1 , а знак нечетной подстановки равен -1 .

Определим циклическое разложение подстановки $\sigma$. Рассмотрим любой элемент $i$, он входит в ориентированный цикл вида $i \sigma(i) \sigma^{2}(i) \ldots i$.

Следовательно, все элементы [1..n] разбиты на несколько непересекающихся циклов такого вида. Циклы длины 1 в этом разложении соответствуют всем таким $i$, что $\sigma(i)=i$. В циклическом разложении подстановки id все циклы имеют длину 1 . В циклическом разложении любой другой подстановки есть хотя бы один неединичный цикл.

Цикл длины 2 (то есть, подстановка, меняющая местами некоторые два числа $i$ и $j$ ) называется транспозииией. Несложно представить любую подстановку в виде композиции нескольких транспозиций (с помощью транспозиций можно последовательно поставить на нужные места все элементы). Легко проверить, что каждая транспозиция меняет четность числа инверсий (то есть, композиция подстановки $\sigma$ и транспозиции имеет четность отличную от четности $\sigma$ ). Поэтому, четная подстановка представляется в виде композиции четного числа транспозиций, а нечетная - в виде композиции нечетного числа транспозиций.

Цикл длины $m$ можно представить как композицию $m-1$ транспозиции. Поэтому, четный цикл является нечетной подстановкой, а нечетный цикл - четной подстановкой. Более того, подстановка является четной если и только если в циклическом разложении четное число четных циклов.

Определитель квадратной матрицы $A=\left(a_{i j}\right)_{i, j \in[1 . . n]}$ размера $n \times n-$ это

$$
\operatorname{det}(A)=\sum_{\sigma \in S_{n}} \operatorname{sign}(\sigma) \cdot a_{1, \sigma(1)} \cdot \ldots \cdots a_{n, \sigma(n)}
$$

Хорошо известно, что определитель меняет знак при перестановке местами двух столбцов или строк (это следует из того, что транспозиция меняет четность числа инверсий в подстановке).
Теорема 9.3. (G. Kirhhoff, 1847.) Пусть $G$ - граф без петель (возможно, с кратными ребрами) на $n \geq 2$ вершинах, а $L$ - его лапласиан. Тогда $s t(G)$ равно минору любого диагонального элемента матрицы $L$ (то есть, определителю матрицы, полученной из $L$ вычеркиванием $i$ строчки и $i$ столбиа для любого $i \in[1 . . n]$ ).
Доказательство. При одновременной перестановке $i$ строки на $n$ место и $i$ столбца на $n$ место знак определителя не меняется. Поэтому, достаточно доказать, что $s t(G)=\operatorname{det}(M)$, где матрица $M$ получена из $L$ вычеркиванием $n$ строки и $n$ столбца. Для каждой пары индексов $i, j \in[1 . . n-1], i \neq j$ с $m_{i, j} \neq 0$ представим $m_{i, j}$ как сумму $\left|m_{i, j}\right|$ чисел -1 . Для каждого $i \in[1 . . n-1]$ представим $m_{i, j}$ как сумму $d_{G}(i)$ чисел 1. Отметим, что $\sum_{j=1}^{n-1} m_{k, j}=e_{G}(k, n)$.

Каждому ребру из $e=x y \in E(G)$ соответствуют две стрелки: $x y$ и $y x$. Каждую стрелку in мы покрасим в белый цвет, а каждую стрелку ij

(где $i, j \neq n$ ) сделаем в двух экземплярах: черную и белую. Стрелок с началом в $n$ не будет. Пусть $A(k)$ - множество из всех стрелок с началом в $k$, а $A(k, i)$ - множество всех стрелок с началом в $k$ и концом в $i$.

Зафиксируем индекс $k \in[1 . . n-1]$ и рассмотрим $k$ строку матрицы $M$. В $A(k)$ ровно $d_{G}(k)=m_{k, k}$ белых стрелок, поставим в соответствие каждой из +1 элемента $m_{k, k}$ ровно одну белую стрелку из $A(k)$. Для каждого $i \in[1 . . n-1], i \neq k$, в $A(k, i)$ ровно $e_{G}(k, i)=\left|m_{k, i}\right|$ черных стрелок, поставим в соответствие каждой -1 элемента $m_{k, i}$ ровно одну черную стрелку из $A(k, i)$. Каждую $\pm 1$ пометим соответствующей ей стрелкой.

Таким образом, всем +1 из $k$ строки соответствуют белые стрелки из $A(k)$, а всем -1 соответствуют черные стрелки из $A(k)$. И наоборот, каждой стрелке из $A(k)$ соответствует ровно одна $\pm 1$ из $k$ строки.

Напишем формулу для $\operatorname{det}(M)$ :

$$
\operatorname{det}(M)=\sum_{\sigma \in S_{n-1}} S(\sigma), \quad \text { где } \quad S(\sigma)=\operatorname{sign}(\sigma) m_{1, \sigma(1)} \cdot \ldots \cdots m_{n-1, \sigma(n-1)}
$$

Каждый элемент $m_{i, \sigma(i)}$ из $S(\sigma)$ распишем как определенную выше сумму из нескольких +1 (при $\sigma(i)=i$ ) или -1 (при $\sigma(i) \neq i$ ). После этого раскроем скобки, и в результате получим некоторое количество произведений из $\pm 1$ (по $n-1$ штук в каждом), все эти произведения нужно домножить на $\operatorname{sign}(\sigma)$.

Рассмотрим одно такое произведение (напомним, что все +1 из этого произведения помечены белыми стрелками, а все -1 - черными). Поставим в соответствие этому произведению орграф с $n-1$ стрелками: для каждой +1 проведем соответствующую белую стрелку, а для каждой -1 проведем соответствующую черную стрелку. Полученному орграфу $D$ соответствует знак $\operatorname{sign}(D)$, полученный произведением знака $\operatorname{sign}(\sigma)$ на $(-1)$ в степени количества черных стрелок $D$. Все орграфы, полученные из $S(\sigma)$, образуют множество $\mathcal{D}(\sigma)$.

Пусть $\mathcal{D}=\cup_{\sigma \in S_{n}} \mathcal{D}(\sigma)$ - множество всех полученных орграфов. Тогда $\operatorname{det}(M)=\sum_{D \in \mathcal{D}} \operatorname{sign}(D)$. Отметим ряд свойств орграфов из $\mathcal{D}$. Из построения следует, что $\mathcal{D}(\sigma) \cap \mathcal{D}(\tau)=\varnothing$ при $\sigma \neq \tau$ (по орграфу $D \in \mathcal{D}$ однозначно восстанавливается такое $\sigma \in S_{n}$, что $D \in \mathcal{D}(\sigma)$, так как каждая черная и белая стрелка однозначно определяет матричный элемент $m_{i, j}$, из которого она получена).

Отметим еще очевидное свойство построенных графов: если $D \in \mathcal{D}$, то $\underline{D}-$ подграф $G$.
Лемма 9.1. Для $D \in \mathcal{D}(\sigma)$ выполнены следующие свойства.

1) В $D$ ровно $n-1$ стрелка - по одной исходящей стрелке из каждой вершины множества $[1 . . n-1]$.

2) Никакие два цикла орграфа $D$ не имеют общих вершин.
3) Черные стрелки в $D$ образуют несколько циклов без общих вершин, соответствующих неединичным циклам из циклического разложения подстановки $\sigma$.
4) Цикл из белых стрелок в $D$ может проходить только по вершинам, которые $\sigma$ оставляет на месте.
5) Если в $D$ нет циклов, то все стрелки - белые и $D$ является входящим деревом вершины $n$. В этом случае $\sigma=\mathrm{id} u \operatorname{sign}(D)=+1$.
6) Пусть $T$ - остовное дерево графа $G$, а $\vec{T}$ - такая его ориентация, в которой каждое ребро ориентировано по направлению к $n$ (определение корректно ввиду того, что между любыми двумя вершинами дерева существует единственный путь). Тогда $\vec{T} \in \mathcal{D}(\mathrm{id})$ - входящее дерево вершины $n$.

Доказательство. Свойство 1 очевидно по построению. Свойство 2 напрямую следует из пункта 1.
1) В $D$ есть черная стрелка из $A\left(i_{1}, i_{2}\right)$, если и только если $i_{1} \neq i_{2}$ и в $S(\sigma)$ есть сомножитель $m_{i_{1}, i_{2}}$, то есть $\sigma\left(i_{1}\right)=i_{2}$, а значит, стрелка $i_{1} i_{2}$ входит в неединичный цикл подстановки $\sigma$. Тогда $\sigma\left(i_{2}\right)=i_{3} \neq i_{2}$, а значит, в $S(\sigma)$ есть сомножитель $m_{i_{2}, i_{3}}$, то есть, в $D$ есть черная стрелка из $A\left(i_{2}, i_{3}\right)$, и так далее. В результате получится цикл в орграфе $D$, соответствующий неединичному циклу подстановки $\sigma$. Наоборот, по каждому неединичному циклу из циклического разложения $\sigma$ так же строится цикл из черных стрелок в $D$.
2) Очевидно по определению белых стрелок.
3) Из пункта 3 следует, что $D \in \mathcal{D}(\mathrm{id})$ (так как id - единственная подстановка, все циклы которой - единичные). Значит, все стрелки орграфа $D$ - белые, а $\operatorname{sign} D=+1$.

Ациклический орграф $D$ на $n$ вершинах [1..n] таков, что из каждой вершины $1, \ldots, n-1$ выходит ровно одна стрелка. По лемме 8.4 мы знаем, что $D$ - входящее дерево вершины $n$.
1) Очевидно, для каждой вершины $i \in[1 . . n-1]$ в $\vec{T}$ проведена ровно одна исходящая стрелка, а значит, $\vec{T}$ - входящее дерево вершины $n$. Для каждого $i \in[1 . . n-1]$ можно выбрать в $A(i)$ белую стрелку $i j \in A(\vec{T})$. Таким образом, $\vec{T} \in \mathcal{D}(\mathrm{id})$.

Вернемся к доказательству теоремы. Все ациклические орграфы из $\mathcal{D}$, как доказано выше - входящие деревья вершины $n$, их знаки положительны и по пункту 6 их количество равно $s t(G)$. Следовательно, сумма знаков ациклических орграфов из $\mathcal{D}$ равна $s t(G)$.

Остается доказать, что знаки всех орграфов из $\mathcal{D}$, имеющих цикл, сокращаются. Достаточно доказать, что все подграфы множества

$$
\mathcal{D}(H)=\{D \in \mathcal{D}: \underline{D}=H\}
$$

сокращаются, если $H$ имеет цикл. Понятно, что $\mathcal{D}(H) \neq \varnothing$, если и только если $H$ - подграф $G$ с $n-1$ ребром, который можно ориентировать так, чтобы из всех вершин множества $[1 . . n-1]$ выходило ровно одна стрелка.

Пусть $Z$ - цикл в $H$. Так как в орграфах из $\mathcal{D}(H)$ не может быть двух стрелок, выходящих из одной вершины, цикл $Z$ во всех этих орграфах ориентирован транзитивно. Рассмотрим орграфы, где он ориентирован $\vec{Z}=i_{1} i_{2} \ldots i_{s}$. Пусть $D \in D(\sigma)$ (где $\sigma \in S_{n-1}$ ) - такой орграф. Тогда не входящие в $\vec{Z}$ стрелки из $D$ начинаются в вершинах множества $N=[1 . . n-1] \backslash\left\{i_{1}, \ldots, i_{s}\right\}$ и однозначно задают, как $\sigma$ переставляет числа из $N$. Для чисел $i_{1}, \ldots, i_{s}$ возможны два варианта: если цикл $\vec{Z}$ состоит из черных стрелок, то $\sigma$ имеет в циклическом разложении цикл $i_{1} \ldots i_{s}$ (назовем такую подстановку $\sigma_{1}$ ), а если цикл $\vec{Z}$ состоит из белых стрелок, то $\sigma$ оставляет числа $i_{1}, \ldots, i_{s}$ на своих местах (назовем такую подстановку $\sigma_{2}$ ). Оба варианта возможны и дают нам два орграфа $D_{1} \in \mathcal{D}\left(\sigma_{1}\right)$ и $D_{2} \in \mathcal{D}\left(\sigma_{2}\right)$. Их знаки отличаются: $\operatorname{sign}\left(\sigma_{1}\right)=(-1)^{s-1} \operatorname{sign}\left(\sigma_{2}\right)$, но в $D_{1}$ на $s$ черных стрелок больше, чем в $D_{2}$. Таким образом, знаки этой пары орграфов сокращаются. Следовательно, и знаки всех имеющих циклы орграфов из $\mathcal{D}$ в сумме дают 0.

Несложно доказать, что алгебраические дополнения всех элементов лапласиана $L$ связного графа $G$ равны между собой, а значит, равны $s t(G)$. Увы, на этот раз в доказательстве нет ничего кроме элементарной линейной алгебры. Мы приводим это утверждение для полноты картины.

Следствие 9.1. Пусть $L$ - лапласиан связного графа $G$, а $L_{i, j}$ - матрица, полученная из $L$ вычеркиванием $i$ строки и $j$ столбиа. Тогда $s t(G)=(-1)^{i+j} \operatorname{det}\left(L_{i, j}\right)$.

Доказательство. Так как сумма элементов любой строки матрицы $L$ равна 0 , система уравнений

$$
L X=0
$$

имеет ненулевое решение - столбец $X=(1, \ldots, 1)^{T}$ из $n$ единиц. Значит, матрица $L$ вырождена, то есть, $\operatorname{rk}(L) \leq n-1$.

По теореме 9.3 мы знаем, что $\operatorname{det}\left(L_{i, i}\right)=s t(G) \neq 0$ (так как граф $G$ связен). Таким образом, матрица $L$ имеет ненулевой минор порядка $n-1$, а значит, $\operatorname{rk}(L)=n-1$.

Известно, что размерность пространства решений системы (9.2) равна $n-\operatorname{rk}(L)=1$. Значит, все решения пропорциональны вектору из $n$ единиц, то есть, все $n$ их координат равны.

Алгебраическое дополнение элемента $l_{i, j}$ - это $A_{i, j}=(-1)^{i+j} \operatorname{det}\left(L_{i, j}\right)$. Из линейной алгебры известно, что столбец из алгебраических дополнений любой строки $X=\left(A_{k, 1}, \ldots, A_{k, n}\right)^{T}$ является решением системы $(9.2):$

$$
\sum_{j=1}^{n} l_{k, j} \cdot A_{k, j}=\operatorname{det}(L)=0 ; \quad \sum_{j=1}^{n} l_{i, j} \cdot A_{k, j}=0 \quad \text { при } \quad i \neq k
$$

Поэтому, $(-1)^{i+k} \operatorname{det}\left(L_{k, i}\right)=A_{k, i}=A_{k, k}=\operatorname{det}\left(L_{k, k}\right)=s t(G)$ по теореме 9.3.

# 9.3 Количество висячих вершин 

В этом разделе мы обсудим гораздо более современные результаты.
Определение 9.3. Пусть $G$ - связный граф. Мы обозначим через $u(G)$ наибольшее возможное количество висячих вершин в остовном дереве графа $G$.

Нетрудно понять, что если $T$ - дерево, то $u(T)$ - количество его висячих вершин.

### 9.3.1 Теорема о промежуточных значениях

Именно так называется следующий результат. Мы докажем, что на самом деле все количества висячих вершин в остовных деревьях связного графа $G$ от минимума до максимума достижимы.

Теорема 9.4. (S. Schuster, 1983.) Пусть связный граф $G$ имеет остовные деревья с $m$ и $n$ висячими вершинами, $m<n$. Тогда для любого натурального $k \in[m . . n]$ существует остовное дерево графа $G$ ровно с $k$ висячими вершинами.

Доказательство. Пусть $T_{1}$ и $T^{*}$ - остовные деревья с $u\left(T_{1}\right)=m$ и $u\left(T^{*}\right)=n$. Начиная с дерева $T_{1}$ будем выполнять следующий шаг. Пусть уже построена последовательность остовных деревьев $T_{1}, \ldots, T_{i}$ графа $G$. Если $T_{i} \neq T^{*}$, то существует ребро $e_{i} \in E\left(T^{*}\right) \backslash E\left(T_{i}\right)$, пусть

$G_{i}=T_{i}+e_{i}$. В графе $G_{i}$ есть ровно один простой цикл $C_{i}$, проходящий по ребру $e_{i}$. Понятно, что $E\left(C_{i}\right) \not \subset E\left(T^{*}\right)$, поэтому существует ребро $f_{i} \in E\left(C_{i}\right) \backslash E\left(T^{*}\right)$. Положим $T_{i+1}=G_{i}-f_{i}=T_{i}+e_{i}-f_{i}$.

Поскольку в дереве $T_{i+1}$ больше рёбер из $E\left(T^{*}\right)$, чем в $T_{i}$, в некоторый момент мы получим $T_{\ell}=T^{*}$. Рассмотрим последовательность деревьев $T_{1}, T_{2}, \ldots, T_{\ell}=T^{*}$. Деревья $T_{i}$ и $T_{i+1}$ отличаются двумя рёбрами, поэтому, $\left|u\left(T_{i}\right)-u\left(T_{i+1}\right)\right| \leq 2$. Следовательно, количества висячих вершин деревьев нашей последовательности деревьев покрывают отрезок натурального ряда $[m . . n]$ с пробелами не более чем в одно число.

Пусть $t \in[m . . n]$ и в нашей последовательности нет дерева с $t$ вершинами. Тогда существует такое $j$, что $u\left(T_{j}\right)=t-1$ и $u\left(T_{j+1}\right)=t+1$. По построению, $T_{j+1}=G_{j}-f_{j}$ и $T_{j}=G_{j}-e_{j}$, пусть $f_{j}=a b, e_{j}=x y$. Тогда $d_{G_{j}}(a)=d_{G_{j}}(b)=2$ (обе вершины $a$ и $b$ становятся висячими после удаления ребра $e_{j}$ ), $d_{G_{j}}(x)>2$ и $d_{G_{j}}(y)>2$ (вершины $x$ и $y$ не становятся висячими после удаления ребра $f_{j}$ ). Таким образом, в цикле $C_{j}$ есть вершины степени 2 и есть вершины степени более 2 , тогда одно из рёбер $e^{\prime}=u w \in E\left(C_{i}\right)$ таково, что $d_{G_{j}}(u)>2$ и $d_{G_{j}}(w)=2$. Значит, в дереве $T^{\prime}=G_{i}-e^{\prime}$ ровно одна из вершин $V\left(C_{i}\right)$ - вершина $w$ - становится висячей, то есть, $u\left(T^{\prime}\right)=t$. Таким образом, утверждение теоремы доказано.

# 9.3.2 Минимальная степень и количество висячих вершин 

Опубликовано несколько работ, в которых доказываются оценки снизу на $u(G)$. В 1981 году Линиал предположил, что $u(G) \geq \frac{\delta(G)-2}{\delta(G)+1} v(G)+c$ при $\delta(G) \geq 3$, где константа $c>0$ зависит только от $\delta(G)$. Эта гипотеза появилась не на пустом месте: для любого $d \geq 3$ легко придумать бесконечную серию примеров графов с минимальной степенью $d$, для которых $\frac{u(G)}{v(G)}$ стремится к $\frac{d-2}{d+1}$, мы расскажем об этом далее. Таким образом, оценка из гипотезы Линиала асимптотически точна в тех случаях, когда она верна.

Для $d=3$ и $d=4$ утверждение гипотезы доказали Клейтман и Вест (1991), для $d=5-$ Григгс и Ву (1992). В обеих работах применялся метод мёртвых вершин. С развитием этого метода для $d \geq 6$ есть значительные проблемы, дальнейших результатов на настоящий момент нет. Из работ Алона и других математиков следует, что для достаточно больших $d$ гипотеза Линиала неверна. Однако, для малых значений $d>5$ вопрос остается открытым. Мы приведем доказательство гипотезы для случая $d=3$.

# Экстремальные примеры 

Заметим, что если в графе $G$ существует остовное дерево, в котором все вершины из множества $W \subset V(G)$ являются висячими, то удаление всех вершин любого подмножества $U \subset W$ не нарушает связности графа $G$.

Обозначим через $K_{d+1}^{-}$граф, полученный из полного графа $K_{d+1}$ в результате удаления одного ребра. Граф $G_{n}^{d}$ будет "цепочкой" из $n$ блоков, в которой два крайних блока изоморфны графу $K_{d+1}$, а остальные $n-2$ блока изоморфны $K_{d+1}^{-}$. В $k$-ом (некрайнем) блоке обозначим через $a_{k}$ и $b_{k}$ две несмежные вершины. В первом блоке одну из вершин обозначим через $a_{1}$, в $n$-ом блоке одну из вершин обозначим через $b_{n}$. Для всех $k \in[1 . . n-1]$ соединим вершины $a_{k}$ и $b_{k+1}$. Мы получили граф $G_{n}^{d}$, в котором $v\left(G_{n}^{d}\right)=n(d+1)$ и $\delta\left(G_{n}^{d}\right)=d$.

Все вершины $a_{k}$ (при $1 \leq k \leq n-1$ ) и $b_{k}$ (при $2 \leq k \leq n$ ) являются точками сочленения и поэтому не могут быть висячими вершинами в остовном дереве графа $G_{n}^{d}$. Рассмотрим $k$-й (некрайний) блок. Кроме двух точек сочленения $a_{k}$ и $b_{k}$ в этом блоке есть еще $d-1$ вершина. Однако, при удалении всех этих вершин нарушается связность графа $G_{n}^{d}$, значит, не более чем $d-2$ вершины из каждого некрайнего блока могут одновременно быть висячими вершинами в остовном дереве графа $G_{n}^{d}$. В каждом из двух крайних блоков точки сочленения не могут быть висячими вершинами. Таким образом,

$$
u\left(G_{n}^{d}\right) \leq n(d-2)+4=\frac{d-2}{d+1} \cdot v\left(G_{n}^{d}\right)+2
$$

Для некоторых значений $d$ существуют принципиально другие серии экстремальных примеров. Пусть $d=3 m+2$, графы $A_{1}, A_{2}, \ldots, A_{n}$ изоморфны графу $K_{m+1}$. Соединим эти графы в кольцо: все пары вершин графов $A_{i}$ и $A_{i+1}$ (нумерация циклическая) сделаем попарно смежными. Для полученного таким образом графа $H_{n}$, очевидно, $\delta\left(H_{n}\right)=3 m+2$ и $v\left(H_{n}\right)=n(m+1)$. Нетрудно доказать, что

$$
u\left(H_{n}\right)=n m+2=\frac{d-2}{d+1} \cdot v\left(H_{n}\right)+2
$$

Отметим, что все графы $H_{n}$ являются $(2 m+2)$-связными, что существенно отличает эту серию от серии графов $G_{n}^{d}$, в которых любые два соседних блока цепочки соединены мостом. Эти две серии показывают нам разнообразие локальной структуры экстремальных примеров.

# Алгоритм построения остовных деревьев 

Теорема 9.5. (D. J. Kleitman, D. B. West, 1991.) В связном графе $G$ с $\delta(G) \geq 3$ существует остовное дерево с не менее чем $v(G) \cdot \frac{1}{4}+2$ висячими вершинами.

Доказательство. Мы приведем алгоритм построения остовного дерева с соответствующим количеством висячих вершин. Алгоритм будет выделять в графе $G$ дерево, последовательно, по шагам добавляя к нему вершины.

Пусть в некоторый момент уже построено дерево $F$ - подграф графа $G$.
Определение 9.4. Висячую вершину $x$ дерева $F$ назовем мертвой, если все вершины графа $G$, смежные с $x$, входят в дерево $F$.

Количество мёртвых вершин дерева $F$ мы обозначим через $b(F)$.
Нетрудно заметить, что мертвые вершины останутся мертвыми висячими вершинами на всех последующих этапах построения.

Для дерева $F$ мы определим

$$
\alpha(F)=\frac{3}{4} u(F)+\frac{1}{4} b(F)-\frac{1}{4} v(F)
$$

Мы хотим построить такое остовное дерево $T$ графа $G$, что $\alpha(T) \geq 2$. Так как в остовном дереве все висячие вершины - мертвые, то $u(T)=$ $b(T)=\frac{1}{4} v(F)+\alpha(T)$ и дерево $T$ нас устраивает.

Мы будем строить дерево последовательно, на каждом шаге добавляя к нему новые вершины. Подробнее остановимся на шаге алгоритма. Пусть после нескольких шагов построения мы получили дерево $F$ (естественно $V(F) \subset V(G), E(F) \subset E(G)$ ). Пусть в результате шага добавилось $\Delta v$ вершин, количество висячих вершин увеличилось на $\Delta u$, а количество мертвых вершин - на $\Delta b$.
Определение 9.5. Назовем доходом шага $S$ величину

$$
P(S)=\frac{3}{4} \Delta u+\frac{1}{4} \Delta b-\frac{1}{4} \Delta v
$$

Мы будем выполнять только шаги с неотрицательным доходом. При вычислении дохода шага мы будем полагать, что все добавленные вершины, про которые не сказано, что они мертвые, не являются мёртвыми. Это предположение лишь уменьшит доход шага.
Замечание 9.2. Понятно, что для итогового остовного дерева $T$ число $\alpha(T)$ будет складываться из $\alpha\left(F^{\prime}\right)$ (где $F^{\prime}$ - базовое дерево, с которого мы начали построение) и суммы доходов всех шагов.

Мы опишем несколько вариантов шага алгоритма. К очередному варианту мы будем переходить только когда убедимся в невозможности всех предыдущих. Введём обозначение $W=V(G) \backslash V(F)$. Итак, вот какие шаги мы будем выполнять.

S1. В дереве $F$ есть невисячая вершина $x$, смежная с $y \in W$. Добавим в дерево вершину $y$, получим $\Delta v=\Delta u=1$ и

$$
p(S 1) \geq \frac{3}{4}-\frac{1}{4}=\frac{1}{2}
$$

S2. В дереве $F$ есть вершина $x$, смежная хотя бы с двумя вершинами из $W$.
Добавим в дерево эти две вершины, получим $\Delta v=2, \Delta u=1$ и

$$
p(S 2) \geq \frac{3}{4}-2 \cdot \frac{1}{4}=\frac{1}{4}
$$

S3. Существует вершина $y \in W$, смежная с деревом $F$ и хотя бы с двумя вершинами из $W$.
Добавим в дерево $y$ и две смежные с ней вершины из $W$. Получим $\Delta v=3$, $\Delta u=1$ и

$$
p(S 3) \geq \frac{3}{4}-3 \cdot \frac{1}{4}=0
$$

S4. Существуют не вошедшие в дерево $F$ вершины.
Тогда существует и смежная с деревом $F$ вершина $y \in W$. Так как невозможно выполнить $S 3$, то $y$ смежна не более, чем с одной вершиной из $W$. Однако, $d_{G}(y) \geq 3$, следовательно, вершина $y$ смежна с двумя вершинами $x, x^{\prime} \in V(F)$. Присоединим $y$ к $x$. Так как невозможно выполнить шаги $S 1$ и $S 2$, вершина $x^{\prime}$ - висячая в дереве $F$ и смежна ровно с одной вершиной из $W$ - с вершиной $y$. Поэтому, в новом дереве вершина $x^{\prime}$ мёртвая. Таким образом, $\Delta v=1, \Delta b \geq 1$ и $P(S 4) \geq 0$.

Замечание 9.3. Если невозможно выполнить ни один из вариантов шага, то, очевидно, уже построено остовное дерево графа $G$.

# Базовое дерево. 

Вернемся к началу нашего построения. Мы хотим начать с базового дерева $F^{\prime}$ с $\alpha\left(F^{\prime}\right) \geq \frac{3}{2}$. Потом мы объясним, почему в процессе построения добавится еще $\frac{1}{2}$ сверх посчитанных выше доходов шагов. Разберём два случая.

В1. В графе $G$ есть вершина а степени не менее 4.
Тогда базовое дерево $F^{\prime}$ - это дерево, в котором вершина $a$ соединена с $k \geq 4$ вершинами из ее окрестности. Мы имеем $v\left(F^{\prime}\right)=k+1, u\left(F^{\prime}\right)=k$ и

$$
\alpha\left(F^{\prime}\right) \geq \frac{3}{4} \cdot k-\frac{1}{4} \cdot(k+1)=\frac{2 k-1}{4}>\frac{3}{2}
$$

B2. В графе $G$ все вершины имеют степень 3.
Сначала рассмотрим дерево $F^{\prime}$, в котором вершина $a$ соединена с тремя вершинами $b_{1}, b_{2}, b_{3}$ из своей окрестности. Очевидно,

$$
\alpha\left(F^{\prime}\right) \geq \frac{3}{4} \cdot 3-\frac{1}{4} \cdot 4=\frac{5}{4}
$$

Нам не хватает $\frac{1}{4}$ и в случае, когда одна из трёх висячих вершин дерева $F^{\prime}$ - мёртвая, она обеспечивает нам дополнительную $\frac{1}{4}$ и $\alpha\left(F^{\prime}\right) \geq \frac{3}{2}$.

Остаётся случай, когда каждая из вершин $b_{1}, b_{2}, b_{3}$ смежна хотя бы с одной вершиной вне $V\left(F^{\prime}\right)$. В нашем случае все вершины графа $G$ имеют степень 3 , а сумма степеней вершин индуцированного подграфа $G\left(\left\{a, b_{1}, b_{2}, b_{3}\right\}\right)$ чётна, поэтому одна из вершин $b_{1}, b_{2}, b_{3}$ должна быть смежна хотя бы с двумя вершинами не из $V(F)$. Тогда мы выполним шаг $S 2$ и добавим доход в $\frac{1}{2}$, что нам более чем достаточно.

Для завершения доказательства теоремы остается доказать, что шаги построения принесут нам неучтённый выше доход не менее чем $\frac{1}{2}$. Для этого мы посмотрим на конец построения.

Если последним был шаг $S 1$, то его доход не менее $\frac{1}{2}$. Пусть это был шаг $S 2$ или $S 3$. Тогда мы добавили две новые вершины, которые должны оказаться мёртвыми, так как больше шагов не выполнялось. Это приносит дополнительный доход хотя бы $\frac{1}{2}$. Отметим, что даже если последним был шаг $S 1$, описанный в базе $B 2$, то доход за эти две мёртвые вершины мы в нём не учитывали.

Пусть последним был шаг $S 4$. Тогда добавленная вершина $y$ оказалась мёртвой (что добавляет нам $\frac{1}{4}$ ), а значит, $y$ была смежна только с вершинами дерева $F$. Но $d_{G}(y)=3$, то есть, таких вершин было три, а не две, как мы посчитали при описании шага $S 4$. Вот мы и нашли еще одну мёртвую вершину и еще одну $\frac{1}{4}$, завершив тем самым доказательство теоремы.

# 9.3.3 Остовные деревья в графах с вершинами степеней 1 и 2 

В описанном выше методе мертвых вершин существенно используется ограничение $\delta(G) \geq 3$. В этом разделе мы допускаем наличие в графе

вершин степеней 1 и 2 , причем висячие вершины внесут свой вклад в оценку на $u(G)$.

Итак, пусть $G$ - связный граф. Через $S(G)$ мы будем обозначать множество всех вершин степени не 2 в графе $G$, пусть $s(G)=|S(G)|$. Мы докажем, что $u(G) \geq \frac{1}{4}(s(G)-2)+2$ и построим бесконечную серию примеров графов, для которых эта оценка достигается.

Теорема 9.6. (А. Банкевич, Д. Карпов, 2011.) Пусть $G$ - связный граф, в котором $v(G) \geq 2$ и $s$ вершин имеют степень, отличную от 2. Тогда у графа $G$ существует остовное дерево, в котором не менее $\frac{1}{4}(s-2)+2$ висячих вершин.

В качестве очевидного следствия мы получаем оценку на количество висячих вершин в остовном дереве графа без вершин степени 2.

Следствие 9.2. Пусть $G$ - связный граф без вершин степени 2, причем $v(G) \geq 2$. Тогда у графа $G$ существует остовное дерево, в котором не менее, чем $\frac{1}{4}(v(G)-2)+2$ висячих вершин.

Доказательство теоремы 9.6. Мы будем считать, что в графе $G$ есть висячие вершины, иначе можно воспользоваться теоремой 9.5. Пусть $U-$ множество всех висячих вершин графа $G, W$ - множество всех вершин графа $G$, смежных с висячими, $X$ - множество всех не вошедших в $U \cup W$ вершин графа $G$, смежных с вершинами из $W$ и, наконец, $Y-$ множество всех остальных вершин. Пусть $H=G-U$. Очевидно, граф $H$ связен.

Доказательство теоремы 9.6 будем вести индукцией по размеру графа: приступая к доказательству для графа $G$ будем считать утверждение доказанным для графов с меньшим числом вершин и графов с таким же числом вершин, но меньшим числом рёбер.

Базу индукиии составит очевидный случай, когда в графе $H$ не более двух вершин. Все возможные в этом случае варианты нетрудно перебрать.

В индукиионном переходе мы разберём несколько случаев.

1. В графе $G$ есть вершина а степени 2.

Если $a$ - точка сочленения, то, стянув инцидентное ей ребро, мы получим меньший граф $G^{\prime}$ с $s\left(G^{\prime}\right)=s(G)$ и $u\left(G^{\prime}\right)=u(G)$. Если же $a-$ не точка сочленения, то рассмотрим инцидентное ей ребро $a b$. Это ребро не мост, а значит, граф $G^{\prime}=G-a b$ связен. Очевидно, $a \in S\left(G^{\prime}\right) \backslash S(G)$. Отметим, что $S(G) \backslash S\left(G^{\prime}\right) \subseteq\{b\}$, так как степени отличных от $a$ и $b$ вершин в графах $G$ и $G^{\prime}$ совпадают. Следовательно, $s\left(G^{\prime}\right) \geq s(G)$. Так

как любое остовное дерево графа $G^{\prime}$ является остовным деревом графа $G$, мы имеем $u\left(G^{\prime}\right) \leq u(G)$. В обоих случаях утверждение теоремы для графа $G$ следует из утверждения теоремы для меньшего графа $G^{\prime}$.

Далее мы будем считать, что все вершины графа $G$ имеют степень не 2 , то есть $s(G)=v(G)$.
1. Граф $H$ не двусвязен.

Пусть $a$ - точка сочленения графа $H$. Тогда $a$ - точка сочленения графа $G$, разбивающая $H$ хотя бы на две части. Это означает, что существуют такие связные графы $G_{1}$ и $G_{2}$, для которых

$$
V\left(G_{1}\right) \cup V\left(G_{2}\right)=V(G), \quad V\left(G_{1}\right) \cap V\left(G_{2}\right)=\{a\} \quad \text { и } \quad v\left(G_{1}\right), v\left(G_{2}\right)>2 .
$$

Для $i \in\{1,2\}$ рассмотрим граф $G_{i}^{\prime}$, полученный из $G_{i}$ присоединением новой висячей вершины $x_{i}$ к вершине $a$ (см. рисунок 9.2). Две копии вершины $a$ в графах $G_{1}^{\prime}$ и $G_{2}^{\prime}$ мы будем считать различными вершинами. Тогда граф $G$ получается из $G_{1}^{\prime}$ и $G_{2}^{\prime}$ склейкой вершин $x_{1}$ и $x_{2}$ в одну вершину $x$ и последующим стягиванием двух инцидентных $x$ мостов (при этом две копии вершины $a$ в графах $G_{1}^{\prime}$ и $G_{2}^{\prime}$ склеятся в вершину $a$ графа $G$ ).

Вершина $a$ - точка сочленения графа $G$, поэтому легко понять, что любое остовное дерево $T$ графа $G$ получается из остовных деревьев $T_{1}$ и $T_{2}$ графов $G_{1}^{\prime}$ и $G_{2}^{\prime}$ соответственно склеиванием по висячим вершинам $x_{1}$ и $x_{2}$ и стягиванием двух мостов, инцидентных $a$. Следовательно, $u(T)=u\left(T_{1}^{\prime}\right)+u\left(T_{2}^{\prime}\right)-2$. И, наоборот, склеивание остовного дерева графа $G_{1}^{\prime}$ и остовного дерева графа $G_{2}^{\prime}$ по висячим вершинам $x_{1}$ и $x_{2}$ с последующим стягиванием двух инцидентных $a$ мостов дает остовное дерево графа $G$. Поэтому, $u(G)=u\left(G_{1}^{\prime}\right)+u\left(G_{2}^{\prime}\right)-2$.

Нетрудно понять, что $v\left(G_{1}^{\prime}\right)<v(G)$ и $v\left(G_{2}^{\prime}\right)<v(G)$. Тогда по индукционному предположению $u\left(G_{1}^{\prime}\right) \geq \frac{s\left(G_{1}^{\prime}\right)-2}{4}+2$ и $u\left(G_{2}^{\prime}\right) \geq \frac{s\left(G_{2}^{\prime}\right)-2}{4}+2$.


Рис. 9.2: разрез графа по точке сочленения $a$.
Отметим, что $s(G)=v(G)$ и все вершины графов $G_{1}^{\prime}$ и $G_{2}^{\prime}$, кроме $a$, имеют степень не 2 . Поскольку $3 \leq d_{G}(a)=d_{G_{1}^{\prime}}(a)+d_{G_{2}^{\prime}}(a)-2$, то вершина $a$ имеет степень не 2 хотя бы в одном из графов $G_{1}^{\prime}$ и $G_{2}^{\prime}$. Поэтому

$$
s(G)=v(G)=v\left(G_{1}^{\prime}\right)+v\left(G_{2}^{\prime}\right)-3 \leq s\left(G_{1}^{\prime}\right)+s\left(G_{2}^{\prime}\right)-2
$$

Таким образом,

$$
u(G)=u\left(G_{1}^{\prime}\right)+u\left(G_{2}^{\prime}\right)-2 \geq \frac{s\left(G_{1}^{\prime}\right)-2}{4}+\frac{s\left(G_{2}^{\prime}\right)-2}{4}+2 \geq \frac{s(G)-2}{4}+2
$$

что и требовалось доказать.
Далее мы будем считать, что в графе $H$ нет точек сочленения. Это означает, что все точки сочленения графа $G$ - это вершины множества $W$ (вершина $w \in W$ отделяет смежные с ней висячие вершины от остальных вершин графа).

Для дальнейших продвижений нам потребуется лемма.
Лемма 9.2. Пусть $a, b \in V(G)$ - смежные вершины, а $G^{\prime}$ - компонента графа $G-a$, содержащая вершину b. Тогда, если $b$ - точка сочленения графа $G^{\prime}$, то $u(G) \geq u\left(G^{\prime}\right)+1$.

Доказательство. Рассмотрим такое остовное дерево $T^{\prime}$ графа $G^{\prime}$, что $u\left(T^{\prime}\right)=u\left(G^{\prime}\right)$. Построим остовное дерево $T$ графа $G$, присоединив вершину $a$ к $b$ и далее присоединив к вершине $a$ все отличные от $G^{\prime}$ компоненты графа $G-a$. Вершина $b$ - точка сочленения графа $G^{\prime}$, поэтому она не является висячей вершиной в дереве $T^{\prime}$. Следовательно, $u(G) \geq u(T) \geq u\left(T^{\prime}\right)+1=u\left(G^{\prime}\right)+1$.

Продолжим разбор случаев в доказательстве теоремы 9.6.
1. Существуют такие смежные вершины $a, b \in V(G)$, что $d_{G}(a) \leq 3$, а $b$ - точка сочленения графа $G-a$.
Пусть $G^{\prime}$ - компонента графа $G-a$, содержащая $b$. Из двусвязности $H$ понятно, что в $G^{\prime}$ не попала только вершина $a$ и смежные с ней висячие вершины. Таким образом,
$S(G) \backslash S\left(G^{\prime}\right) \subseteq\{a\} \cup \mathrm{N}_{G}(a), \quad$ поэтому $\quad s\left(G^{\prime}\right) \geq s(G)-d_{G}(a)-1 \geq s(G)-4$.
По индукционному предположению, лемме 9.2 и доказанному выше мы имеем

$$
u(G) \geq u\left(G^{\prime}\right)+1 \geq \frac{s\left(G^{\prime}\right)-2}{4}+3 \geq \frac{s(G)-2}{4}+2
$$

что и требовалось доказать.
1. Существуют такие смежные вершины $x, y \in V(H)$, что $d_{G}(x) \geq 4$, $d_{G}(y) \geq 4$.
Тогда рассмотрим граф $G^{\prime}=G-x y$. Поскольку граф $H$ двусвязен, то граф $G^{\prime}$ - связен и для него утверждение теоремы уже доказано. Понятно, что $s\left(G^{\prime}\right)=s(G)$, а остовное дерево графа $G^{\prime}$ является остовным деревом $G$, поэтому утверждение доказано и для $G$.

1. Подытожим разобранные случаи и выясним свойства, которыми теперь обладает граф $G$.

Лемма 9.3. Если граф $G$ не удовлетворяет условию ни одного из разобранных случаев, то он удовлетворяет следуюшим условиям.
$1^{\circ}$ Никакие две вершины множества $W$ не смежны.
$2^{\circ}$ Все вершины множества $W$ имеют степень 3.
$3^{\circ}$ Множество $X$ непусто и состоит из вершин степени более 3.
$4^{\circ}$ Каждая вершина множества $W$ смежна с одной висячей вершиной графа $G$ и двумя вершинами множества $X$.

Доказательство. Рассмотрим вершину $w \in W$ и смежную с ней висячую вершину $u \in U$. Вершина $w$ - точка сочленения, отделяющая $u$ от остальных вершин графа. Если вершина $w$ смежна с отличной от $u$ вершиной степени не более трёх, то граф был бы рассмотрен в пункте 3. Поэтому, все смежные с $w$ вершины, кроме ровно одной висячей, имеют степень более трёх. Таким образом, степени всех вершин множества $X$ больше 3 .

Докажем, что $W$ - независимое множество графа $G$. Пусть две вершины $w, w^{\prime} \in W$ смежны. Тогда хотя бы одна из них имеет степень не более 3 , пусть $d_{G}\left(w^{\prime}\right) \leq 3$. Но в этом случае вершина $w \in W$ смежна с невисячей вершиной степени не более 3 , что противоречит доказанному выше.

Итак, $W$ - независимое множество. Тогда каждая вершина $w \in W$ смежна хотя бы с $d_{G}(w)-1 \geq 2$ вершинами из $X$, следовательно, множество $X$ непусто. Так как степени вершин множества $X$ более 3 , то $d_{G}(w)=3$. Таким образом, все утверждения леммы доказаны.

Рассмотрим вершину $w \in W$ и смежные с ней вершины $x, x^{\prime} \in X$. Пусть $a \neq w$ - смежная с $x$ вершина. Так как вершины степени более 3 не смежны друг с другом и вершина $x \notin W$ не смежна с висячими вершинами, мы имеем либо $a \in W$, либо $a \in Y$ и в обоих случаях $d_{G}(a)=3$ (см. рисунок 9.3a).


Рис. 9.3: Вершины $w, x, x^{\prime}$ и $a$.

Пусть $G^{*}=G-x^{\prime} w$, а $G^{\prime}-$ компонента графа $G^{*}-a$, содержащая вершину $w$ (см. рисунок 9.3 b ). Очевидно, вершина $x$ - точка сочленения графа $G^{\prime}$ (отделяющая $w$ и смежную с ней висячую вершину от остальных вершин графа), поэтому, применив лемму 9.2 к графам $G^{*}$ и $G^{\prime}$, мы получим $u\left(G^{*}\right) \geq u\left(G^{\prime}\right)+1$.

Смежная с $a$ вершина $x$ не является точкой сочленения графа $G-a$ (иначе наш граф уже был бы рассмотрен в пункте 3), поэтому, ребро $x w$ - не мост графа $G-a$. Так как $w$ смежна с висячей вершиной и двумя вершинами $x, x^{\prime} \in X$, это означает, что $x^{\prime} w$ - также не мост графа $G-a$. Следовательно, в графе $G-a-x^{\prime} w=G^{*}-a$ все вершины, кроме $a$ и - в случае, когда $a \in W$ - смежной с ней висячей вершины, входят в $G^{\prime}$.

Все вершины из $V(G)$, кроме $a, x^{\prime}, w$ и вершин из $\mathrm{N}_{G}(a)$, входят в граф $G^{\prime}$ и имеют там такую же степень, как в графе $G$. Для вершины $x \in \mathrm{~N}_{G}(a)$ мы имеем $d_{G^{\prime}}(x)=d_{G}(x)-1 \geq 3$. Если $x^{\prime} \notin \mathrm{N}_{G}(a)$, то $d_{G^{\prime}}\left(x^{\prime}\right)=d_{G}\left(x^{\prime}\right)-1 \geq 3$. Следовательно, множество $S(G) \backslash S\left(G^{\prime}\right)$ состоит не более, чем из $d_{G}(a)+1 \leq 4$ вершин: это могут быть $w, a$ и отличные от $x$ вершины из $\mathrm{N}_{G}(a)$ (эти вершины выделены на рисунке 9.3 b ). Таким образом, $s\left(G^{\prime}\right) \geq s(G)-4$. По индукционному предположению, $u\left(G^{\prime}\right) \geq \frac{s\left(G^{\prime}\right)-2}{4}+2$. Учитывая, что $G^{*}$ - подграф $G$ и доказанные выше неравенства, мы имеем

$$
u(G) \geq u\left(G^{*}\right) \geq u\left(G^{\prime}\right)+1 \geq \frac{s\left(G^{\prime}\right)-2}{4}+3 \geq \frac{s(G)-2}{4}+2
$$

что и требовалось доказать.

# 9.3.4 Экстремальные примеры 



Рис. 9.4: Экстремальный пример к оценке из теоремы 9.6.
Рассмотрим дерево $T$, в котором есть только вершины степеней 1 и 3 , причём вершин степени 3 ровно $n$. Легко видеть, что количество вершин степени 1 тогда равно $n+2$, а $e(T)=2 n+1$. Заменим каждую вершину $x$ степени 3 дерева $T$ на треугольник, передав каждой из трёх вершин треугольника по одному из рёбер, инцидентных в дереве $T$

вершине $x$. Пример такого графа для $n=5$ на рисунке 9.4. В полученном графе $G$ будет $n+2$ вершины степени 1 и $n$ треугольников, итого $v(G)=n+2+3 n=4 n+2$. Все невисячие вершины графа $G$ являются точками сочленения и потому не могут быть висячими вершинами остовного дерева. Следовательно, $u(G)=n+2=\frac{v(G)-2}{4}+2$.

# 9.4 Непересекающиеся остовные деревья 

Основной вопрос этого раздела: при каком условии в графе можно выделить $k$ остовных деревьев, не имеющих общих рёбер? Мы докажем две теоремы Нэша-Уильямса: о необходимом и достаточном условии для выделения в графе $k$ рёберно-непересекающихся связных остовных подграфов и о необходимом и достаточном условии для разбиения графа на $k$ лесов. Эти две в некотором смысле двойственные теоремы будут доказаны одним и тем же методом, для которого мы изучим максимальные по количеству рёбер наборы из $k$ непересекающихся лесов.

В этом разделе в графах допускаются кратные рёбра.
Рассмотрим все упорядоченные наборы $F=\left(F_{1}, \ldots, F_{k}\right)$ из $k$ ребернонепересекающихся остовных лесов - подграфов $G$. Будем $i$-компонентой набора $F$ лес $F_{i}$.

Введем обозначение $E(F)=E\left(F_{1}\right) \cup \cdots \cup E\left(F_{k}\right)$. Обозначим через $\mathcal{D}$ множество всех таких наборов $F$ с максимальным количеством рёбер $e(F)=|E(F)|$. Начнём с изучения свойств наборов из множества $\mathcal{D}$. Для любого набора $F \in \mathcal{D}$ будем обозначать его $i$-компоненту через $F_{i}$.

Рассмотрим набор $F \in \mathcal{D}$ и ребро $e \notin E(F)$. Из максимальности количества рёбер в $F$ следует, что в графе $F_{i}+e$ есть цикл $Z$, причем ровно один. Пусть $e^{\prime} \in E\left(F_{i}\right)$ - ребро цикла $Z$, тогда $F_{i}^{\prime}=F_{i}+e-e^{\prime}-$ лес, причем с теми же компонентами связности, что и лес $F_{i}$. Очевидно, набор из $k$ лесов $F^{\prime}$, полученный из $F$ заменой ребра $e$ на $e^{\prime}$ также принадлежит $\mathcal{D}$. Будем говорить, что $F^{\prime}$ получен из $F$ заменой ребра. Очевидно, тогда $F$ также получается из $F^{\prime}$ заменой ребра.

Подытожим сказанное выше. Пусть наборы $F, F^{\prime} \in \mathcal{D}$ получаются друг из друга заменой ребра. Тогда для каждого $i \in[1 . . k]$ у лесов $F_{i}$ и $F_{i}^{\prime}$ одинаковые компоненты связности.

Лемма 9.4. Пусть $F^{*} \in \mathcal{D}, e_{0} \notin E\left(F^{*}\right)$. Тогда существует содержащее оба кониа ребра $e_{0}$ множество $U \subset V(G)$ такое, что для каждого $i \in[1 . . k]$ граф $F_{i}^{*}(U)$ является деревом.

Доказательство. Пусть $\mathcal{D}^{*}$ - множество всех наборов из $\mathcal{D}$, которые получаются из $F^{*}$ цепочками замен рёбер. Пусть $E^{-}$- это множество

всех ребер $e \in E(G)$, для которых существует такой $F \in \mathcal{D}^{*}$, что $e \notin E(F)$. Докажем вспомогательное утверждение.
Лемма 9.5. 1) Пусть $F \in \mathcal{D}^{*}, e \notin E(F)$, а $Z$ - единственный иикл в графе $F_{i}+e$. Тогда $E(Z) \subset E^{-}$.
1) Пусть $F^{1}, F^{2} \in \mathcal{D}^{*}, x, y \in V(G)$. Тогда лес $F_{i}^{1}$ содержит ху-путь по рёбрам из $E^{-}$если и только если такой путь содержит лес $F_{i}^{2}$.
Доказательство. 1) Рассмотрим любое ребро $e^{\prime} \in E(Z), e^{\prime} \neq e$. Тогда $e^{\prime} \in E(F)$. При замене в $F$ ребра $e^{\prime}$ на $e$ мы, очевидно, получим набор лесов $F^{\prime} \in \mathcal{D}^{*}$, не содержащий ребра $e^{\prime}$. Следовательно, $e^{\prime} \in E^{-}$. Очевидно, $e \in E^{-}$. Следовательно, $E(Z) \subset E^{-}$.
1) Пусть $P_{1}-x y$-путь по рёбрам из $E^{-}$в $F_{i}^{1}$. Понятно, что достаточно рассмотреть случай, когда $F^{2}$ получается из $F^{1}$ заменой ребра $e_{1}$ на ребро $e_{2}$. Если $e_{1} \notin E\left(F_{i}^{1}\right)$, то утверждение очевидно.

Пусть $e_{1} \in E\left(F_{i}^{1}\right)$, тогда в графе $G_{i}=E\left(F_{i}^{1}\right)+e_{2}=E\left(F_{i}^{2}\right)+e_{1}$ существует ровно один цикл $Z$, причем этот цикл содержит рёбра $e_{1}$ и $e_{2}$. По пункту 1 мы имеем $E(Z) \subset E^{-}$. Значит, концы замененного ребра $e_{1}$ связаны в $F_{i}^{2}$ путём по рёбрам из $E^{-}$. Таким образом, даже если ребро $e_{1}$ входит в путь $P_{1}$, в графе $G_{i}^{2}$ есть $x y$-путь $P_{2}$ по рёбрам из $E^{-}$

Вернёмся к доказательству леммы 9.4. Пусть $G^{-}$- граф на $V(G)$ с множеством ребер $E\left(G^{-}\right)=E^{-}$. Так как $e_{0}=v w \in E^{-}$, концы этого ребра $v$ и $w$ связаны в $G^{-}$. Пусть $U-$ компонента связности графа $G^{-}$, содержащая $v$ и $w$. Докажем, что множество $U$ нам подходит.

Пусть граф $H_{j}=F_{j}^{*}(U)$ несвязен. Тогда существуют компоненты связности $U_{1}, U_{2}$ графа $H_{j}$, соединённые ребром $e^{\prime}=a b \in E^{-}$в $G^{-}$. Предположим, что вершины $a$ и $b$ соединены в лесу $F_{j}$ путём $P$. Тогда в $F_{j}+e^{\prime}$ путь $P$ и ребро $e$ образуют цикл $Z$. По пункту 1 леммы 9.5 мы имеем $E(Z) \subset E^{-}$, а значит, $E(P) \subset E^{-}$. Но тогда $V(P) \subset U$, а значит, $P$ - путь в графе $H_{j}$, что невозможно.

Таким образом, вершины $a$ и $b$ не связаны в $F_{j}$. Рассмотрим такой набор лесов $F^{\prime} \in \mathcal{D}^{*}$, что $e^{\prime} \notin E\left(F^{\prime}\right)$. По лемме 9.5 вершины $a$ и $b$ не связаны в лесу $F_{j}^{\prime}$, а значит, заменив лес $F_{j}^{\prime}$ на лес $F_{j}^{\prime}+e^{\prime}$, мы получим набор лесов $F^{+}$с большим числом рёбер чем у $F^{*}$, что противоречит максимальности последнего.
Теорема 9.7. (C. St. J. A. Nash-Williams, 1961 и W. T. Tutte, 1961.) Граф содержит $k$ рёберно-непересекающихся остовных деревъев тогда и только тогда, когда для любого разбиения его вершин $P$ на несколько множеств существует хотя бы $k(|P|-1)$ рёбер между вершинами разных множеств разбиения. (Здесь через $|P|$ обозначается количество множеств в разбиении P.)

Доказательство. $\Rightarrow$. Пусть существуют рёберно-непересекающиеся остовные деревья $T_{1}, \ldots, T_{k}$. Рассмотрим разбиение $P=\left\{V_{1}, \ldots, V_{m}\right\}$ множества $V(G)$. Пусть графы $G^{P}, T_{1}^{P}, \ldots, T_{k}^{P}$, получены из $G, T_{1}, \ldots, T_{k}$ в результате стягивания каждого из множеств $V_{i}$ в одну вершину (между вершинами $V_{i}$ и $V_{j}$ нового графа проводится столько рёбер, сколько было между множествами $V_{i}$ и $V_{j}$ в старом графе). Так как $T_{1}^{P}, \ldots, T_{k}^{P}-$ связные остовные подграфы графа $G^{P}$, мы имеем

$$
s=e\left(T_{1}^{P}\right)+\cdots+e\left(T_{k}^{P}\right) \geq k(m-1)
$$

Остается лишь заметить, что между разными множествами разбиения $P$ в графе $G$ было проведено не менее $s$ рёбер.
$\Leftarrow$. Докажем обратную импликацию индукцией по количеству вершин в графе, база для $v(G)=2$ очевидна. Применив условие для разбиения графа на одиночные вершины, мы получим $e(G) \geq k(v(G)-1)$. Рассмотрим произвольный набор $F=\left(F_{1}, \ldots, F_{k}\right) \in \mathcal{D}$. Предположим, что не все остовные леса $F_{1}, \ldots, F_{k}$ являются деревьями. Тогда $e(F)<k(v(G)-1)$, следовательно, существует ребро $e \in E(G) \backslash E(F)$. Тогда по лемме 9.4 существует такое множество вершин $U \subset V(G)$, что графы $F_{i}(U)$ связны для всех $i \in[1 . . k]$. Понятно, что $F_{1}(U), \ldots, F_{k}(U)$ - рёберно-непересекающиеся деревья на вершинах множества $U$.

Рассмотрим граф $G^{\prime}=G * U$ (полученный из $G$ стягивание множества $U$ в одну вершину $u$, соединенную с каждой вершиной $x \in V(G) \backslash U$ ровно $e_{G}(x, U)$ рёбрами). Каждое разбиение $P^{\prime}$ вершин графа $G^{\prime}$ индуцирует разбиение $P$ вершин графа $G$ (вместо вершины $u$ в одно из множеств попадут все вершины множества $U$ ). Поэтому, для разбиения $P^{\prime}$ существует не менее $k\left(\left|P^{\prime}\right|-1\right)$ рёбер графа $G^{\prime}$ между различными множествами. Значит, по индукционному предположению существует $k$ рёберно-непересекающихся остовных деревьев $T_{1}^{\prime}, \ldots, T_{k}^{\prime}$ в графе $G^{\prime}$. Теперь пусть $T_{i}$ - остовное дерево графа $G$, полученное заменой в дереве $T_{i}^{\prime}$ вершины $u$ на дерево $F_{i}(U)$. Легко понять, что мы построили искомый набор рёберно-непересекающихся остовных деревьев.
Следствие 9.3. Рёберно $2 k$-связный граф содержит $k$ рёберно-непересекающихся остовных деревъев.

Доказательство. Проверим условие из теоремы 9.7. Рассмотрим разбиение вершин графа $P=\left\{V_{1}, \ldots, V_{r}\right\}$. Из рёберной связности графа $G$ следует, что для каждого множества $V_{i}$ существует хотя бы $2 k$ рёбер от $V_{i}$ к остальным множествам. Сложив неравенства для всех $i$, мы получим, что существует не менее $\frac{2 k \cdot r}{2}>(k-1) r$ рёбер между разными множествами. По теореме 9.7 получаем существование $k$ рёберно-непересекающихся остовных деревьев.

Что интересно, точно так же выводится теорема с похожим по форме, но двойственным по сути утверждением.

Теорема 9.8. (C. St. J. A. Nash-Williams, 1964.) Граф $G$ является объединением $k$ лесов, если и только если для любого множества $U \subset V(G)$ в графе $G(U)$ не более $k(|U|-1)$ рёбер.

Доказательство. $\Rightarrow$. Пусть $F=\left(F_{1}, \ldots, F_{k}\right)$ - разбиение графа $G$ на $k$ лесов, $U \subset V(G)$. Тогда все графы $F_{1}(U), \ldots, F_{k}(U)$ - ациклические, а их объединение есть $G(U)$. Следовательно, $e(G(U)) \leq k(|U|-1)$.
$\Leftarrow$. Рассмотрим, как и в доказательстве теоремы 9.7, множество $\mathcal{D}$ и произвольный набор лесов $F=\left(F_{1}, \ldots, F_{k}\right) \in \mathcal{D}$. Наша цель - доказать, что $E(G)=E(F)$. Предположим, что это не так и рассмотрим ребро $e \notin E(F)$. По лемме 9.4 существует такое множество $U \subset V(G)$, что все графы $F_{1}(U), \ldots F_{k}(U)$ - связны. Но тогда $e\left(F_{i}(U)\right) \geq|U|-1$ для каждого $i \in[1 . . k]$. Учитывая не входящее в $E(F)$ ребро $e$, получаем

$$
e(G(U)) \geq 1+\sum_{i=1}^{k} e\left(F_{i}(U)\right)>k(|U|-1)
$$

противоречие.

# 9.5 Комментарии 

Эта глава - смесь классических и новых результатов, касающихся общих объектов - остовных деревьев связного графа. Начинаем, как всегда, с классики - с формулы Кэли о числе остовных деревьев и алгоритма Прюфера для подсчета числа остовных деревьве полного графа. К количеству остовных деревьев мы еще вернемся, обсуждая многочлен Татта в разделе 13.3 .

Далее идут гораздо более новые результаты о количестве листьев в остовных деревьях данного графа. Сначала доказывается элегантная и простая теорема о промежуточных значениях (1983 г): количество листьев в остовном дереве принимает все возможные значения от минимального до максимального.

Затем доказывается теорема 9.5 Клейтмана и Веста [16] о том, что в связном графе минимальной степени 3 есть остовное дерево, в котором более $\frac{2}{5}$ всех вершин - листья. Эта теорема открывает для читателя исследования, связанные с гипотезой Линиала о том, что связный граф минимальной степени $d \geq 3$ имеет остовное дерево, в котором более $\frac{d-2}{d+1}$ всех вершин - листья. Известно, что для больших $d$ это утверждение

неверно, а доказано оно для $d=3,4,5$ с помощью метода мёртвых вершин. Случай $d=4$ доказан независимо в работах [16] и [12] этим методом, но с разной весовой функцией $\alpha(F)$ (см. формулу 9.3 , мёртвые вершины учитываются с разным весом). В задаче ?? читателю предлагается придумать это доказательство самостоятельно. Случай $d=5$ доказан в работе [12], там доказательство использует похожие идеи, но является значительно более трудоёмким. Аналогичное утверждение для $d=6$ остается открытым вопросом.

Все эти результаты оценивают количество листьев в остовном дереве графа, имеющего вершины степени не менее 3 . В теореме 9.6 доказывается оценка на количество листьев в остовном дереве связного графа, имеющего вершины любых степеней, причем в оценке учитываются вершины всех степеней, кроме 2. Эта теорема доказана А. Банкевичем и автором книги в 2011 году [44]. Доказательство использует метод редукции, с помощью которого можно доказать и другие оценки. Одну из них предлагается доказать читателю в задаче ??.

Заканчивается глава разделом 9.4 , в котором доказываются две классические теоремы Нэша-Уильямса: о выделении $k$ непересекающихся остовных деревьев и о разбиении рёбер графа на $k$ лесов. Эти двойственные теоремы доказываются с помощью одного и того же метода - рассмотрения максимальных семейств остовных лесов. В 2015 году была доказана теорема, объединяющая эти две (и доказанная примерно так же), ее можно найти в 5 издании книги Дистеля [8].

ГЛАВА 9. ОСТОВНЫЕ ДЕРЕВЬЯ

# Глава 10 

## Потоки

## 10.1 Поток в сети

Определение 10.1. Пусть задано множество вершин $V$, в котором выделены две вершины: $s$ (вход или исток) и $t$ (выход или сток). Пусть определена функция $c: V \times V \rightarrow \mathbb{R}$, удовлетворяющая соотношениям

$$
c(x, y) \geq 0, \quad c(x, s)=0, \quad c(t, y)=0
$$

для любых вершин $x, y \in V$. Тогда $G=(V, s, t, c)-c e т ъ$, функция $c$ называется пропускной способностью сети $G$.

Множество $A(G)=\{(x, y): c(x, y)>0\}$ называется множеством стрелок сети $G$.

Мы часто будем рассматривать сеть $G$ как орграф с множеством вершин $V$ и множеством стрелок $A(G)$. Например, говоря "путь в сети $G$ ", будем иметь в виду путь в орграфе $(V, A(G))$.

Определение 10.2. Пусть $G$ - сеть, а функция $f: V \times V \rightarrow \mathbb{R}$ удовлетворяет трем условиям:
$(F 1)$ для любых $x, y \in V \quad f(x, y) \leq c(x, y)$;
$(F 2)$ для любых $x, y \in V \quad f(x, y)=-f(y, x)$;
$(F 3)$ для любой вершины $v \in V, v \neq s, t$ выполняется условие

$$
\sum_{x \in V} f(v, x)=0
$$

Тогда $f-$ поток в сети $G$. Число $|f|=\sum_{x \in V} f(s, x)$ называется величиной потока. Поток сети $G$ с максимальной величиной называется максимальным.

Замечание 10.1. Вообще-то не очевидно, что максимальный поток существует.

Определение 10.3. Пусть $G$ - сеть, а множество ее вершин $V$ разбито на два непересекающихся множества $S \ni s$ и $T \ni t$. Тогда $(S, T)$ - разрез сети $G$.

Величина

$$
c(S, T)=\sum_{x \in S, y \in T} c(x, y)
$$

называется пропускной способностью разреза. Любой разрез сети $G$ с минимальной пропускной способностью называется минимальным.

Для любого потока $f$ в сети $G$ величина

$$
f(S, T)=\sum_{x \in S, y \in T} f(x, y)
$$

называется потоком через разрез $(S, T)$.
Замечание 10.2. Нетрудно понять, что минимальный разрез сети существует. Возможно, таких разрезов несколько.

Лемма 10.1. Для любого потока $f$ и разреза $(S, T)$ сети $G$ выполняется $|f|=f(S, T)$.

Доказательство. Отметим, что ввиду условия ( $F 3$ )

$$
|f|=\sum_{x \in V} f(s, x)=\sum_{y \in S}\left(\sum_{x \in V} f(y, x)\right)
$$

В правой части равенства (10.1) для любых двух вершин $y, z \in S$ присутствуют слагаемые $f(y, z)$ и $f(z, y)$, в силу $(F 2)$ в сумме дающие 0 . Поэтому,

$$
\sum_{y \in S}\left(\sum_{x \in V} f(y, x)\right)=\sum_{x \in S, y \in T} f(x, y)=f(S, T)
$$

что и требовалось доказать.
Определение 10.4. 1) Пусть $f$ - поток в сети $G$. Рассмотрим сеть $G_{f}$ с теми же $V, s, t$ и пропускной способностью

$$
c_{f}(x, y)= \begin{cases}0 & \text { при } y=s \text { или } x=t \\ c(x, y)-f(x, y) & \text { в остальных случаях. }\end{cases}
$$

Назовем $G_{f}$ остаточной сетью потока $f$.
1) Дополняющий путь потока $f$ - это любой путь $s t$-путь в остаточной сети $G_{f}$.

Лемма 10.2. Пусть $f-$ поток в сети $G, f^{\prime}-$ поток в остаточной сети $G_{f}$. Тогда $f+f^{\prime}-$ поток в сети $G$, причём $\left|f+f^{\prime}\right|=|f|+\left|f^{\prime}\right|$.

Доказательство. Нетрудно проверить для потока $f+f^{\prime}$ условия ( $F 1$ ), $(F 2)$ и $(F 3)$. Утверждение про величину потока очевидно.

Определение 10.5. Пусть $P-st$-путь в сети $G$, а $c$ - минимальная пропускная способность стрелки пути $P$. Определим поток $f_{P}$ вдоль пy$m u P:$

$$
\begin{gathered}
f_{P}(x, y)=c \text { при } x y \in A(P), \quad f_{P}(x, y)=-c \text { при } y x \in A(P) \\
f_{P}(x, y)=0 \text { при } x y, y x \notin A(P)
\end{gathered}
$$

Нетрудно понять, что $f_{P}$ - действительно поток.

# 10.1.1 Теорема Форда-Фалкерсона 

Теорема 10.1. (L. R. Ford, D. R. Fulkerson, 1956.)
В сети $G$ с пропускной способностью с задан поток $f$. Тогда следующие три утверждения равносильны.
$1^{\circ}$ Поток $f$ максимален.
$2^{\circ}$ Существует такой разрез $(S, T)$, что $|f|=c(S, T)$;
$3^{\circ}$ В остаточной сети $G_{f}$ нет дополняющего пути.
Доказательство. $2^{\circ} \Rightarrow 1^{\circ}$. Рассмотрим другой поток $f^{\prime}$. По условию $(F 1)$ и лемме 10.1 мы имеем

$$
\left|f^{\prime}\right|=f^{\prime}(S, T)=\sum_{x \in S, y \in T} f(x, y) \leq \sum_{x \in S, y \in T} c(x, y)=c(S, T)=|f|
$$

откуда следует максимальность $f$.
$1^{\circ} \Rightarrow 3^{\circ}$. Предположим противное, пусть в остаточной сети $G_{f}$ есть дополняющий путь $P$, а $f_{P}$ - поток вдоль пути $P$. По лемме 10.2 , тогда $f+f_{P}-$ поток в $G$, причём $\left|f+f_{P}\right|=|f|+\left|f_{P}\right|>|f|$, противоречие с максимальностью $f$.
$3^{\circ} \Rightarrow 2^{\circ}$. Пусть $S$ - множество всех вершин, достижимых из $s$ в остаточной сети $G_{f}$. Так как в $G_{f}$ нет дополняющего пути, то $t \notin S$. Тогда $(S, T=V \backslash S)-$ разрез в сетях $G$ и $G_{f}$. По построению $A_{G_{f}}(S, T)=\varnothing$, следовательно, $0=c_{f}(S, T)=c(S, T)-f(S, T)$, откуда $c(S, T)=f(S, T)$.

Следствие 10.1. Величина максимального потока в сети $G$ равна пропускной способности минимального разреза сети $G$.

# 10.1.2 Целочисленные сети 

Объект рассмотрения в этом разделе - сеть $G$ с целочисленной пропускной способностью $c$.

Теорема 10.2. В целочисленной сети $G$ существует максимальный поток, причем среди максимальных потоков данной сети найдется целочисленный.

Доказательство. Будем последовательно строить поток. Изначально положим $f=0$. Пусть в некоторый момент есть целочисленный поток $f$ в целочисленной сети $G$. Рассмотрим остаточную сеть $G_{f}$. Если в $G_{f}$ нет дополняющего пути $P$, то по теореме 10.1 поток $f$ - максимальный.

Если же в $G_{f}$ есть дополняющий путь $P$, то рассмотрим поток $f_{P}$ вдоль пути $P$ в остаточной сети $G_{f}$ и положим $f:=f+f_{p}$. Получился новый целочисленный поток, причем его пропускная способность на $c$ больше, чем у предыдущего. Так как с каждым шагом величина потока возрастает на целую величину, процесс обязательно закончится, в результате мы получим целочисленный максимальный поток в сети $G$.

Именно теорему 10.2 можно применить для доказательства многих фактов из теории графов, что мы и сделаем в следующем разделе.

### 10.1.3 Рёберная теорема Менгера

Именно так обычно называют следующую теорему. Несмотря на то, что эта теорема имеет много общего с теоремой Менгера (теорема 5.1) и даже может быть из нее выведена, впервые она была доказана Фордом и Фалкерсоном в качестве примера применения разработанного ими метода.

Определение 10.6. Пусть $G$ - неориентированный граф без петель, кратные рёбра допускаются.

Для $x, y \in V(G)$ обозначим через $\lambda_{G}(x, y)$ размер минимального множества рёбер, отделяющего $x$ от $y$. Назовем $\lambda_{G}(x, y)$ рёберной связностью вершин $x$ и $y$.

Замечание 10.3. Очевидно, рёберная связность графа может быть задана как $\lambda(G)=\min _{x, y \in V(G)} \lambda_{G}(x, y)$.
Теорема 10.3. (L. R. Ford, D. R. Fulkerson, 1956.)

1) Пусть $s, t \in V(G)$. Тогда существует $\lambda_{G}(s, t)$ путей из $s$ в $t$, не имеющих общих рёбер.
2) В рёберно $k$-связном графе $G$ для любых двух вершин $s, t$ существует $k$ путей из $s$ в $t$, не имеющих общих рёбер.

Доказательство. 1) Построим сеть $\vec{G}$ на множестве вершин $V(G)$. Входом будет $s$, выходом будет $t$. Определим пропускные способности: $c(x, y)$ равняется кратности ребра $x y$ в графе $G$ (то есть, 0 , если такого ребра нет, и $m$, если в графе $G$ есть $m$ кратных рёбер $x y$ ). Дополнительно определим $c(x, s)=c(t, x)=0$ для всех $x \in V(G)$. Отметим, что при $x, y \notin\{s, t\}$ мы имеем $c(x, y)=c(y, x)$.

Сеть $\vec{G}$ - целочисленная, поэтому по теореме 10.2 в ней есть целочисленный максимальный поток $f$. Пусть $|f|=k$. Докажем, что поток $f$ распадается на $k$ непересекающихся st-nyтей.

Построим новый орграф $G^{\prime}$ на тех же вершинах. Если $f(x, y)=\ell>0$ для $x, y \in V(G)$, мы проведем в $G^{\prime}$ ровно $\ell$ стрелок $x y$. Понятно, что $\ell \in \mathbb{Z}$ и в графе $G$ есть не менее $\ell$ ребер, соединяющих $x$ и $y$. Тогда из вершины $s$ выходит ровно $k$ стрелок, а в каждой отличной от $s$ и $t$ вершине $v$ по свойству потока ( $F 3$ ) количества входящих и выходящих стрелок равны. Теперь очевидно, что поток распадается на $k$ непересекающихся по рёбрам $s t$-путей в графе $G$ (не обязательно простых) и, возможно, нескольких циклов, не проходящих по $s$ и $t$. Эти циклы нас не интересуют.

Воспользуемся теоремой 10.1. В силу максимальности потока $f$ существует разрез $(S, T)$ нашей сети пропускной способности $c(S, T)=k$. Тогда из $S$ в $T$ направлено $k$ стрелок нашей сети (пропускная способность каждой стрелки равна 1). Для каждой стрелки $x y$ из $S$ в $T$ поместим в множество $R$ ребро $x y$ графа $G$. Тогда $|R|=k$ и нетрудно понять, что $R$ отделяет $S$ от $T$, а стало быть, и $s$ от $t$ в графе $G$. Следовательно, $k \geq \lambda_{G}(s, t)$ и утверждение пункта 1 доказано.
1) Утверждение пункта 2 непосредственно следует из пункта 1.

Вообще-то, можно вывести предыдущую теорему из аналогичного факта для вершинной связности - теоремы Менгера (следствие 5.1), известного с 1927 года. Удивительно, что это не было замечено до 1956 года, когда теорему с помощью сетей и потоков доказали Форд и Фалкерсон. Сформулируем несколько задач на вывод доказательства классических фактов теории графа из теоремы Форда-Фалкерсона.

Задача 10.1. Докажитете с помощью теоремы Форда-Фалкерсона следующие утверждения:
a) теорему Холла (теорема 2.2 );
б) теорему Кёнига (теорема 2.3 );
в) теорему Менгера (следствие 5.1, пункт 1).

# 10.1.4 Максимальный поток в произвольной сети 

Теорема 10.4. В сети $G$ существует максимальный поток.
Доказательство. План доказательства такой же, как и в теореме 10.2: мы будем постепенно увеличивать максимальный поток, добавляя к нему поток вдоль дополняющего пути. Однако, на этот раз нам нельзя произвольно выбирать дополняющий путь.

Итак, пусть в некоторый момент построен поток $f$ в сети $G$. Рассмотрим остаточную сеть $G_{f}$. Если в $G_{f}$ нет дополняющего пути $P$, то по теореме 10.1 поток $f$ - максимальный. Пусть в $G_{f}$ есть дополняющие пути.

Мы выберем самый короткий дополняющий путь $P$ в $G_{f}$, рассмотрим путь $f_{P}$ вдоль пути $P$ и положим $f^{\prime}:=f+f_{P}$. Почему же этот процесс когда-нибудь закончится?

Лемма 10.3. Пусть $Q$ - простой st-путь в остаточной сети $G_{f^{\prime}}$, которого нет в остаточной сети $G_{f}$. Тогда $Q$ длиннее, чем $P$.

Доказательство. Пусть $s=x_{0} x_{1} \ldots x_{k}=t$ - это путь $P$. Понятно, что путь $P$ - простой, а значит, все его вершины различны.

Сначала поймем, какие же стрелки могут входить в $A\left(G_{f^{\prime}}\right) \backslash A\left(G_{f}\right)$. Такая стрелка $y z$ имеет $c_{f}(y, z)=0$, но

$$
0<c_{f^{\prime}}(y, z)=c_{f}(y, z)-f_{p}(y, z)
$$

Значит, $z y \in A(P)$, то есть, $z=x_{i}$ и $y=x_{i+1}$ для некоторого $i$. По условию, путь $P$ содержит хотя бы одну такую стрелку.

Напомним, что трансверсаль пути $P$ - это путь между двумя его вершинами, внутренние вершины которого не принадлежат $P$. Назовём $x_{i} x_{j}$-трансверсаль $L$ пути $P$ правильной, если $i<j$ и неправильной в противном случае. Стрелку $x_{i} x_{i+1}$, мы будем считать правильной трансверсалью пути $P$, а стрелку $x_{i+1} x_{i}$ - неправильной. Таким образом, весь путь $Q$ разбивается на трансверсали пути $P$ - пусть это $L_{1}, \ldots, L_{m}$. Как показано выше, среди них есть хотя бы одна неправильная трансверсаль.

Пусть $L$ - правильная $x_{i} x_{j}$-трансверсаль пути $P$. Отметим, что все стрелки трансверсали $L$, как показано выше, лежат в $A\left(G_{f}\right)$. Если $L$ короче, чем $x_{i} P x_{j}$, то мы могли бы заменить этот участок пути $P$ на трансверсаль $L$ и найти в $G_{f}$ более короткий путь, чем $P$, противоречие с выбором пути $P$.

Таким образом, каждая правильная трансверсаль $L$ пути $P$ не короче участка пути $P$ между ее концами. Тогда заменим каждую правильную

трансверсаль на соответствующий участок между ее концами - в результате получится путь $Q^{\prime}$, который не длиннее чем $Q$. Поскольку оба пути $P$ и $Q^{\prime}$ ведут из $s$ в $t$, путь $Q^{\prime}$ содержит все рёбра пути $P$. Так как $Q$ (а стало быть, и $Q^{\prime}$ ) содержит хотя бы одну неправильную трансверсаль пути $P$, путь $Q^{\prime}$ (а следовательно, и $Q$ ) строго длиннее чем $P$.

Таким образом, после каждого шага взамен одного из кратчайших путей из $s$ в $t$ в остаточной сети могут появиться лишь строго более длинные пути. Значит, в результате каждого шага либо увеличивается длина кратчайшего $s t$-пути, либо эта длина сохраняется, но уменьшается количество кратчайших $s t$-путей. Отметим, что кратчайший путь всегда простой, а длина простого пути из $s$ в $t$ ограничена количеством вершин сети. Значит, процесс построения закончится, и в результате получится остаточная сеть без дополняющих путей. По теореме 10.1 это означает, что будет построен максимальный поток.

# 10.2 Поток в графе 

В этом разделе речь пойдет о потоках в произвольном графе, который может иметь петли и кратные рёбра. Поэтому не совсем корректно обозначать ребро как пару его концов. Запись $e=x y$ для ребра $e$ будет обозначать, что $x$ и $y$ - его концы. При этом, возможно, существуют и другие ребра с такой же парой концов. Везде в этом разделе мы будем писать $V$ вместо $V(G)$ и $E$ вместо $E(G)$.

Определение 10.7. Пусть $G=(V, E)$ - неориентированный граф.

1) Мы определим $H$-циркуляцию как функцию $f: V \times V \times E \rightarrow H$ (где $H$ - некоторая абелева группа) со следующими свойствами:
$(f 1)$ если $f(x, y, e)=0$, то $e=x y \in E(G)$;
$(f 2)$ если $x, y \in V(G)$ - две различные вершины, то

$$
f(x, y, e)=-f(y, x, e)
$$

$(f 3)$ Для любой вершины $x \in V(G)$ выполнено

$$
\sum_{y \in V(G-x), e \in E(G)} f(x, y, e)=0
$$

1) Мы будем говорить, что $H$-циркуляция $f$ графа $G$ невырождена на ребре $e=x y \in E(G)$, если $f(x, y, e) \neq 0$ (и вырождена в противном случае). $H$-циркуляция называется $H$-потоком, если она невырождена на всех рёбрах графа $G$.

Замечание 10.4. 1) Каждая петля в вершине $x$ в некотором смысле инцидентна вершине $x$ два раза. Если учитывать в сумме из $(f 3)$ такую петлю, то это нужно делать два раза - с противоположным знаком. Поэтому, петли в $(f 3)$ не учитываются, а $H$-циркуляция на петле может быть равна любому элементу группы $H$.
1) Конечно же, циркуляцию можно определить на рёбрах. Но тогда нужно фиксировать ориентацию рёбер и каждый раз выяснять, что от выбора ориентации ничего не зависит. В некоторых случаях - например, когда имеешь дело с плоскими графами и их двойственными - это технически непросто.
2) Наконец, гораздо проще было бы определить поток на парах вершин, рассматривая графы без петель и кратных рёбер, во всех результатах раздела доказательства только упростились бы. Но в этом случае возникают проблемы с потоковым многочленом (раздел 13.2).

Определение 10.8. Для цикркуляции $f$ в графе $G$ мы будем использовать следующие обозначения.

1) Для вершин $x, y \in V$ пусть $f(x, y)=\sum_{e \in E(G)} f(x, y, e)$ (то есть, сумма циркуляций из $x$ в $y$ по всем соединяющим их рёбрам).
2) Для вершины $x \in V$ и множеств $S, T \subset V$ мы будем использовать обозначения

$$
f(x, T)=\sum_{y \in T} f(x, y), \quad f(S, x)=\sum_{y \in S} f(y, x), \quad f(S, T)=\sum_{z \in S, y \in T} f(z, y)
$$

В некотором смысле, циркуляция в графе - это поток в сети без входа и выхода и без ограничения на парах вершин, соответствующих рёбрам графа. Нелюбителям алгебры не стоит пугаться абелевой группы $H$, которая в этом разделе - либо $\mathbb{Z}$ (группа целых чисел по сложению), либо $\mathbb{Z}_{k}$ (группа вычетов по модулю $k$ по сложению). Аналогично лемме 10.1 , получаем следующее свойство.

Лемма 10.4. Пусть $V(G)=S \cup T, S \cap T=\varnothing$. Тогда для любой циркуляиии $f$ в графе $G$ выполняется $f(S, T)=0$.

Доказательство. Как и в доказательстве леммы 10.1, достаточно сложить условия $(f 3)$ для всех $x \in S$ :

$$
0=\sum_{x \in S} f(x, V \backslash\{x\})=f(S, T)
$$

(в левой части поток на всех рёбрах между парами вершин из $S$ сократится и останется $f(S, T)$ ).

Следствие 10.2. Если $e=x y \in E(G)-$ мост, а $f-$ циркуляция в графе $G$, то $f(x, y, e)=0$.

Доказательство. Нужно применить лемму 10.4 к компонентам связности $S, T$ графа $G-x y$, тогда $0=f(S, T)=f(x, y, e)$.

# 10.2.1 $K$-поток и $\mathbb{Z}_{k}$-поток 

Определение 10.9. 1) Пусть $k \in \mathrm{~N}$. Тогда $k$-поток в графе $G-$ это такой $\mathbb{Z}$-поток $f$, что $|f(x, y, e)|<k$ для всех $x, y$ и $e$.
1) Потоковое число $\varphi(G)$ графа $G$ - это минимальное такое натуральное $k$, что в графе $G$ существует $k$-поток. Если такого числа нет, то будем считать, что $\varphi(G)=\infty$.

В силу следствия 10.2 , граф $G$ с мостом не имеет $k$-потока ни для какого $k$, а значит, $\varphi(G)=\infty$ для такого графа. Потоки в графах начал изучать в 1950-е года Татт. Один из вопросов, который он поставил: верно ли, что граф $G$ без мостов имеет $\varphi(G)<\infty$ ? Татт сформулировал следующую гипотезу.

Гипотеза 10.1. (W.T.Tutte, 1954.) Любой граф без мостов имеет 5 -поток.

Эта гипотеза пока остается нерешенной, но в 1981 году Сеймур доказал, что любой граф без мостов имеет 6 -поток. Мы докажем эту теорему позже, в разделе 10.2.3.

На первый взгляд, $k$-поток и $\mathbb{Z}_{k}$-поток - это почти что одно и то же. Но не совсем. Понятно, что каждый $k$-поток легко превращается в $\mathbb{Z}_{k}$-поток, если заменить его значения на их вычеты по модулю $k$. А вот наоборот это не совсем очевидно: если заменить вычеты на остатки от деления на $k$, условие ( $f 3$ ) для полученного $\mathbb{Z}$-потока может быть не выполнено, так как это же условие для $\mathbb{Z}_{k}$-потока гарантирует делимость суммы на $k$, а не равенство 0 . Между тем, с $\mathbb{Z}_{k}$-потоками и циркуляциями гораздо легче работать, чем с $k$-потоками: например, их можно складывать. Все это подчеркивает важность следующей теоремы.

Теорема 10.5. (W.T.Tutte, 1950.) Граф имеет $Z_{k}$-поток, если и только если он имеет $k$-поток.

Доказательство. $\Leftarrow$. Если $f$ - это $k$-поток в графе $G$, то, заменив его значения их вычетами по модулю $k$, получим $\mathbb{Z}_{k}$-поток.
$\Rightarrow$. Пусть $G$ - граф, имеющий $\mathbb{Z}_{k}$-поток $g$. Рассмотрим множество $F$, состоящее из всех функций $f: V \times V \times E \rightarrow[-k+1 . . k-1]$, удовлетворяющих условиям $(f 1),(f 2)$ и еще двум:

(*) $f(x, y, e) \neq 0$, если $e=x y \in E$;
( $\left.f 3^{\prime}\right) \quad f(x):=f(x, V \backslash\{x\}) \vdots k$ для любой вершины $x \in V$.
Как мы уже писали выше, если заменить в $\mathbb{Z}_{k}$-потоке $g$ вычеты по модулю $k$ остатками от деления на $k$ (соблюдая правило ( $f 2$ ), чего нетрудно добиться), получится функция $g^{\prime} \in F$, значит, $F \neq \varnothing$. Остается найти в $F$ поток, то есть, функцию, удовлетворяющую ( $f 3$ ).

Положим $f(G)=\sum_{x \in V(G)}|f(x)|$. Рассмотрим поток $f \in F$ с минимальным значением $f(G)$ и докажем, что $f(G)=0$. Тогда $f(x)=0$ для любой вершины $x \in V(G)$ и теорема доказана. Предположим, что $f(G)>0$. Так как $\sum_{x \in V} f(x)=0$ (в этой сумме все слагаемые разбиваются на равные 0 пары вида $f(x, y, e)+f(y, x, e))$, то существует вершина $x$ с $f(x)>0$. Построим множество $M$, состоящее из всех отличных от $x$ вершин $y$, для которых есть $x y$-путь $P_{y}$ вида $x=x_{1} \ldots x_{n}=y$ (не обязательно простой), вдоль которого поток $f$ положителен (а именно, для всех $i \in[1 . . n-1]$ выполнено $\left.f\left(x_{i}, x_{i+1}, e_{i}\right)>0\right.$, где $\left.e_{i}=x_{i} x_{i+1}\right)$. Пусть $N=V(G) \backslash\{M \cup\{x\}\})$.

Понятно, что для любых $u \in\{x\} \cup M$ и $v \in N$ мы имеем $f(u, v) \leq 0$ (иначе вершина $v$ попала бы в $M$ ). Значит, $f(x, N) \leq 0$, откуда следует, что $f(x, M)=f(x)-f(x, N)>0$. В силу условия $(f 2)$ мы имеем $f(M, x)=-f(x, M)<0$. Кроме того отметим, что $f(M, N) \leq 0$ как сумма нескольких неположительных слагаемых. Следовательно,

$$
\sum_{v \in M} f(v)=f(M, N)+f(M, M)+f(M, x)<0
$$

а значит, существует вершина $y \in M$ с $f(y)<0$. Пусть $P$ - это $x y$-путь $x=x_{1} \ldots x_{n}=y$, вдоль которого поток положителен. Построим новый поток $f^{\prime}$, изменив $f$ вдоль пути $P$. А именно, пусть $e_{i}=x_{i} x_{i+1}$. Для всех $i \in[1 . . n-1]$ положим

$$
f^{\prime}\left(x_{i}, x_{i+1}, e_{i}\right)=f^{\prime}\left(x_{i}, x_{i+1}, e_{i}\right)-k \quad \text { и } \quad f^{\prime}\left(x_{i+1}, x_{i}, e_{i}\right)=f^{\prime}\left(x_{i+1}, x_{i}, e_{i}\right)+k
$$

В остальных случаях положим $f^{\prime}(u, v, e)=f(u, v, e)$. При вычитании $k$ из положительного числа, лежащего в $[1 . . k-1]$ получается число из $[1-k . .-1]$, поэтому, $f^{\prime}$ принимает целые значения из допустимого для $k$-потока интервала. Так как $f^{\prime}(x, y, e) \equiv f(x, y, e)(\bmod k)$, из $f \in F$ следует $f^{\prime} \in F$. В то же время, $f^{\prime}(x)=f(x)-k, f^{\prime}(y)=f(y)+k$, $f^{\prime}(z)=f(z)$ для всех остальных вершин $z$. Из $f(x) \vdots k$ и $f^{\prime}(x) \vdots k$ следует $f(x) \geq k$ и $f^{\prime}(x) \geq 0$, то есть $\left|f^{\prime}(x)\right|<|f(x)|$. Аналогично, $\left|f^{\prime}(y)\right|<|f(y)|$. Следовательно, $f^{\prime}(G)<f(G)$, противоречие с выбором потока $f$.

# 10.2.2 $2, \mathbb{Z}_{2}, 3$ и $\mathbb{Z}_{3}$-потоки 

Ограниченность потокового числа графа стимулирует изучение графов, имеющих $k$-поток при малых $k$. Мы исследуем графы с 2 и 3 -потоками. Начнем с очевидного следствия определения потока.

Следствие 10.3. Граф имеет 2-поток, если и только если все степени его вершин четны.

Доказательство. По теореме 10.5 существование 2 -потока равносильно существованию $\mathbb{Z}_{2}$-потока. В $\mathbb{Z}_{2}$ на всех рёбрах поток должен быть равен 1 и $1+1=0$, так что условие $(f 2)$ выполнено автоматически. Условие же $(f 3)$ для вершины $v$ равносильно четности ее степени.

Чем больше $k$, тем меньше известно про граф, имеющий $k$-поток, что и понятно: не известно ни одного графа без мостов, не имеющего 5 -потока. Мы расскажем о некоторых известных условиях существования 3 -потока.

Теорема 10.6. Кубический граф $G$ имеет 3-поток если и только если он двудолен.

Доказательство. $\Rightarrow$. Пусть в графе $G$ есть 3 -поток. Тогда в нем есть и $\mathbb{Z}_{3}$-поток $f$. Предположим, что в $G$ есть нечетный цикл $x_{1} \ldots x_{n}$ (нумерация циклическая по модулю $n$ ). Пусть $e_{i}=x_{i} x_{i+1}$. По определению $\mathbb{Z}_{3}$-потока, все числа $f\left(x_{1}, x_{2}, e_{1}\right), \ldots, f\left(x_{n-1}, x_{n}, e_{n-1}\right), f\left(x_{n}, x_{1}, e_{n}\right)-$ это 1 и 2 . Тогда есть два таких последовательных ребра этого цикла, что $f\left(x_{i-1}, x_{i}, e_{i-1}\right)=f\left(x_{i}, x_{i+1}, e_{i}\right)$, откуда следует, что $f\left(x_{i} x_{i-1}, e_{i-1}\right)+$ $f\left(x_{i}, x_{i+1}, e_{i}\right)=0$. Пусть $e^{\prime}=x_{i} y \in E(G)$ - третье инцидентное вершине $x_{i}$ ребро. Тогда из $(f 3)$ следует, что $f\left(x_{i}, y, e^{\prime}\right)=0$, что невозможно. Следовательно, в $G$ нет нечетных циклов, то есть, этот граф двудолен.
$\Leftarrow$. Пусть $G=\left(V_{1}, V_{2}, E\right)$ - двудольный граф. Достаточно построить $\mathbb{Z}_{3}$-поток в $G$. Для любого ребра $e$ с концами $x \in V_{1}$ и $y \in V_{2}$ положим $f(x, y, e)=1$, а $f(y, x, e)=2$. Тогда для любой вершины из $V_{1}$ все три значения потока на инцидентных ей рёбрах равны 1 , а их сумма равна 0 , для вершин из $V_{2}$ аналогично.

Мы уже знаем, что $\varphi\left(K_{2}\right)=\infty$ и $\varphi\left(K_{2 n+1}\right)=2$ при $n \geq 1$ (этот граф имеет четные степени вершин). Нетрудно проверить, что $\varphi\left(K_{4}\right)=4$. (Этот граф - кубический и недвудольный, а значит, не может по теореме 10.6 иметь 3 -поток. Сконструировать 4 -поток в $K_{4}$ несложно.) Следующая теорема определит потоковое число остальных полных графов.

Теорема 10.7. Для всех $n \geq 3$ выполнено $\varphi\left(K_{2 n}\right)=3$.
Доказательство. Так как граф $K_{2 n}$ имеет нечетные степени вершин, он не может иметь 2 -поток, то есть, $\varphi\left(K_{2 n}\right) \geq 3$.

Построим $\mathbb{Z}_{3}$-поток по индукции, начнем с базы для $n=3$. Граф $K_{6}$ нетрудно представить как объединение двух графов $K_{3}$ и одного $K_{3,3}$ без общих рёбер. Во всех этих трёх графах есть $\mathbb{Z}_{3}$-потоки (в $K_{3}$ есть даже 2 -поток, а значит, есть и $\mathbb{Z}_{3}$-поток). Каждый из этих потоков является $\mathbb{Z}_{3}$-циркуляцией, невырожденной ровно на своем множестве рёбер, поэтому, их сумма является $\mathbb{Z}_{3}$-потоком в $K_{6}$.

Предположим, что $\mathbb{Z}_{3}$-поток уже построен в $K_{2 n}$. Выделим в $K_{2 n+2}$ подграф $K_{2 n}$ с множеством вершин $U$, пусть в нем есть $\mathbb{Z}_{3}$-поток $f$, он же задает $\mathbb{Z}_{3}$-циркуляцию в $K_{2 n+2}$, невырожденную в точности на рёбрах выделенного подграфа $K_{2 n}$. Пусть $x$ и $y$ - две оставшихся вершины $K_{2 n+2}$. Нужно определить $\mathbb{Z}_{3}$-поток на всех рёбрах, инцидентных $x$ и $y$. Через $e_{a b}$ будем обозначать ребро нашего полного графа с концами $a$ и $b$.

Для каждой вершины $z \in U$ определим $\mathbb{Z}_{3}$-циркуляцию $f_{z}$ на треугольнике $x y z$ :

$$
\begin{aligned}
g_{z}\left(x, y, e_{x y}\right)=g_{z}\left(y, z, e_{y z}\right)= & g_{z}\left(z, x, e_{x z}\right)=1 \\
& g_{z}\left(y, x, e_{x y}\right)=g_{z}\left(z, y, e_{y z}\right)=g_{z}\left(x, z, e_{x z}\right)=2
\end{aligned}
$$

Положим $g(a, b, e)=\sum_{z \in U} g_{z}(a, b, e)$. Тогда циркуляция $g$ равна нулю на всех рёбрах между вершинами из $U$ и отлична от 0 на всех рёбрах, соединяющих $U$ с $\{x, y\}$. Следовательно $\mathbb{Z}_{3}$-циркуляция $f+g$ невырождена на всех рёбрах, кроме $e_{x y}$. Если же $(f+g)\left(x, y, e_{x y}\right)=0$, то нам, очевидно, подойдет циркуляция $f+g+g_{w}$ для любой вершины $w \in U$ (на рёбрах $e_{x w}$ и $e_{y w}$ циркуляция будет равна $2 g_{w}\left(x, w, e_{x w}\right) \neq 0$ и $2 g_{w}\left(y, w, e_{y w}\right) \neq 0$, соответственно, на ребре $e_{x y}$ новая циркуляция будет совпадать с $g_{w}$ ). В любом случае, мы построили $\mathbb{Z}_{3}$-поток в $K_{2 n+2}$.

Напомним, что ориентация графа называется эйлеровой, если в каждой вершине число входящих стрелок равняется числу исходящих стрелок.

Теорема 10.8. Пусть $G-4$-регулярный граф. Тогда количество его $\mathbb{Z}_{3}$-потоков равно количеству его эйлеровых ориентаций.

Доказательство. Покажем, как по $\mathbb{Z}_{3}$-потоку $f$ строить ориентацию $\vec{G}_{f}$. Если $f(x, y, e)=1$, то ориентируем ребро $e$ от $x$ к $y$, а если $f(x, y, e)=2$,

то ориентируем ребро $e$ от $y$ к $x$. Нужно лишь доказать, что в каждой вершине есть два входящих и два исходящих ребра. Пусть вершина $x \in V(G)$ инцидента рёбрам $e_{1}=x y_{1}, \ldots, e_{4}=x y_{4}$. Тогда

$$
\sum_{i=1}^{4} f\left(x, y_{i}, e_{i}\right)=0
$$

а каждое из четырёх слагаемых равно 1 или 2. Легко видеть, что это возможно только в случае, когда два слагаемых равны 1 , а два других равны 2 , что сооответствует двум входящим и двум исходящим рёбрам в $x$.

Наоборот, пусть $\vec{G}$ - эйлерова ориентация графа $G$. Построим $\mathbb{Z}_{3}$-поток $f$ : пусть $f(x, y, e)=1$, если ребро $e=x y$ ориентировано в $\vec{G}$ от $x$ к $y$ и $f(x, y, e)=2$, если ребро $e=x y$ ориентировано от $y$ к $x$ (все остальные значения потока будут 0 ). Нужно лишь проверить, что соблюдается правило $(f 3)$. Пусть вершина $x \in V$ инцидента рёбрам $e_{1}=x y_{1}, \ldots, e_{4}=x y_{4}$. Тогда в эйлеровой ориентации $\vec{G}$ два из них входят в $x$, а два выходят из $x$, следовательно,

$$
\sum_{i=1}^{4} f\left(x, y_{i}, e_{i}\right)=1+1+2+2=0
$$

# 10.2.3 Существование 6-потока 

В этом разделе мы докажем теорему Сеймура о существовании 6-потока в графе без мостов. Вместо 6 -потока мы будем, конечно же, доказывать существвание $\mathbb{Z}_{6}$-потока. При этом вспомним, что $\mathbb{Z}_{6} \simeq \mathbb{Z}_{2} \times \mathbb{Z}_{3}$ (это навряд ли можно считать сложным знанием из теории групп или теории чисел - в конце концов, нетрудно проверить вручную). Поэтому, вместо $\mathbb{Z}_{6}$-потока мы будем строить $\mathbb{Z}_{2} \times \mathbb{Z}_{3}$-поток $f$ и записывать его значения как $f(x, y, e)=(a, b)$, где $a \in \mathbb{Z}_{2}$ и $b \in \mathbb{Z}_{3}$.

Теорема 10.9. (P. Seymour, 1981.) Любой граф без мостов имеет 6 -поток.

Доказательство. Пусть $G(V, E)$ - граф без мостов. Можно считать граф связным (с каждой компонентой можно разобраться отдельно). Так как граф не имеет мостов и связен, он рёберно двусвязен, то есть, любые две вершины графа $G$ лежат на цикле (не обязательно простом).

Мы будем повсеместно использовать это соображение в доказательстве. Доказательство будет разбито на две части.

1. Начнем с построения подграфов $H_{1}, \ldots, H_{n}$ в графе $G$.

Пусть $H_{i}=\left(V_{i}, E_{i}\right)$. Степени всех вершин каждого подграфа $H_{i}$ будут четными, множества $V_{1}, \ldots, V_{n}$ будут попарно не пересекаться и в объединении давать $V$. Введем обозначение $V^{k}=\cup_{i=1}^{k} V_{i}$.

Последовательность непустых множеств рёбер $F_{1}, \ldots, F_{n-1}$ такова, что $F_{i} \subset E\left(V_{i+1}, V^{i}\right)$ и $\left|F_{i}\right| \leq 2$. Пусть $H^{k}$ - граф, полученный из $\cup_{i=1}^{k} H_{i}$ добавлением всех рёбер множества $\cup_{i=1}^{k-1} F_{i-1}$. Мы будем строить наши графы и множества так, что граф $H^{k}$ будем связным. В результате, $H^{n}$ окажется связным остовным подграфом $G$.

В качестве $H_{i}$ возьмем любой цикл в графе $G$. Пусть $H_{1}, \ldots, H_{k}$ и $F_{1}, \ldots, F_{k-1}$ уже построены. Опишем шаг построения $H_{k+1}$ и $F_{k}$. Пусть

$$
W^{k}=V \backslash V^{k} \quad \text { и } \quad \mathcal{U}=\left\{U \subset W^{k}:\left|E\left(U, W^{k} \backslash U\right)\right| \leq 1\right\}
$$

Отметим, что $W^{k} \in \mathcal{U}$, а значит, $\mathcal{U} \neq \varnothing$ и можно выбрать минимальное множество $X_{k} \in \mathcal{U}$. Из минимальности $X_{k}$ следует, что граф $G\left(X_{k}\right)$ связен и не имеет мостов - то есть, либо рёберно двусвязен, либо имеет одну вершину. Если $\left|E\left(X_{k}, V^{k}\right)\right| \geq 2$, то выберем в качестве $F_{k}$ два ребра из $E\left(X_{k}, V^{k}\right)$ (см. рисунок 10.1a). В противном случае положим $F_{k}=E\left(X_{k}, V^{k}\right)$, тогда ввиду двусвязности графа $G$ множество $F_{k}$ состоит из одного ребра (см. рисунок 10.1 b ).


Рис. 10.1: Построение $F_{k}$ и $H_{k+1}$
В качестве $H_{k+1}$ выберем любой связный подграф $G\left(X_{k}\right)$ с четными степенями вершин, содержащий концы всех рёбер из $F_{k}$. Если $\left|X_{k}\right|=1$, то $H_{k+1}$ - одновершинный граф, а если $G\left(X_{k}\right)$ рёберно двусвязен, то пусть $H_{k+1}$ - это цикл (не обязательно простой) в $G\left(X_{k}\right)$, содержащий концы всех рёбер из $F_{k}$ (такой цикл существует, так как $\left|F_{k}\right| \leq 2$ ). Из связности графа $H^{k}$ очевидно следует, что граф $H^{k+1}$ связен: этот граф

получен из $H^{k} \cup H_{k+1}$ добавлением рёбер множества $F_{k}$, соединяющих эти две связные части.

Построение заканчивается, когда после очередного шага мы получим $V^{n}=V$. Положим $E^{*}=E \backslash E\left(H^{n}\right)$.
1. Теперь построим $\left(\mathbb{Z}_{2} \times \mathbb{Z}_{3}\right)$-поток $f$ в графе $G$.

Начнем с построения $\mathbb{Z}_{3}$-циркуляции $g_{k}$, невырожденной на

$$
F^{k}=F_{k} \cup \ldots F_{n-1} \cup E^{*}
$$

Будем строить ее индукцией по $k$ (параметр будет убывать).
Начнем с базы для $k=n$. Циркуляция $g_{n}$ должна быть отлична от 0 на $E^{*}$. Так как $H^{n}$ - связный остовный подграф $G$, для каждого ребра $r \in E^{*}$ существует цикл $C_{r}$ в графе $H^{k}+r$, проходящий по этому ребру. Построим $\mathbb{Z}_{3}$-циркуляцию $g_{n, r}$ вдоль этого цикла: если $C_{r}=v_{1} \ldots v_{m}$ и $e_{i}=v_{i} v_{i+1}$ (нумерация циклическая по модулю $m$ ), то положим $g_{n, r}\left(v_{i}, v_{i+1}, e_{i}\right)=1$ и $g_{n, r}\left(v_{i+1}, v_{i}, e_{i}\right)=2$ для всех $i \in[1 . . m]$, все остальные значения этой циркуляции - нулевые. Положим

$$
g_{n}(x, y, e)=\sum_{r \in E^{*}} g_{n, r}(x, y, e)
$$

Каждое ребро $e=x y \in E^{*}$ входит только в один цикл $C_{r}$ (при $r=e$ ), поэтому, $g_{n, r}(x, y, e) \neq 0$ ровно в случае $r=e$, а значит, $g_{n}(x, y, e) \neq 0$.

Переход $k+1 \rightarrow k$. Нам нужно исправить циркуляцию $f_{k+1}$ так, чтобы получилась невырожденная на рёбрах из $F_{k}$ циркуляция. Рассмотрим два случая.
a. $\left|F_{k}\right|=1$.

В этом случае $F_{k}=\{e\}$, пусть $e=x y$. Докажем, что $f_{k+1}(x, y, e) \neq 0$, после чего можно положить $f_{k}=f_{k+1}$. По построению, $\left|F_{k}\right|=1$ означает, что $F_{k}=E\left(X_{k}, V^{k}\right)$. Так как граф $G$ рёберно двусвязен, существует ребро $e^{\prime}=x^{\prime} y^{\prime} \in E\left(X_{k}, W^{k} \backslash X_{k}\right)$, причем такое ребро единственно по выбору $X_{k}$ (см. рисунок 10.1 b ). Значит, $e^{\prime}$ - мост графа $G\left(W^{k}\right)$, поэтому, $e^{\prime}$ не могло попасть ни в какой из графов $H_{k+1}, \ldots, H_{n}$ на последующих этапах построения (эти графы не имеют мостов). В графе $H^{k}$ ребро $e^{\prime}$ также не может оказаться, так как оба его конца не лежат в $V_{k}$. Значит, $e^{\prime} \in F^{k+1}$, а тогда по индукционному предположению $g_{k+1}\left(x^{\prime}, y^{\prime}, e^{\prime}\right) \neq 0$. Так как $\left\{e, e^{\prime}\right\}-$ разрез графа $G$ с компонентами связности $X_{k}$ и $V \backslash X_{k}$, по лемме 10.4 мы имеем

$$
g_{k+1}\left(x^{\prime}, y^{\prime}, e^{\prime}\right)+g_{k+1}(x, y, e)=g_{k+1}\left(X_{k}, V \backslash X_{k}\right)=0
$$

а значит, $g_{k+1}(x, y, e) \neq 0$, что и требовалось доказать.

b. $\left|F_{k}\right|=2$.

Пусть $F_{k}=\left\{e, e^{\prime}\right\}$, причем $e=x y$ и $e^{\prime}=x^{\prime} y^{\prime}$. Если циркуляция $g_{k+1}$ невырождена на обоих рёбрах $e$ и $e^{\prime}$, то положим $g_{k}=g_{k+1}$. Остается случай, когда, скажем, $g_{k+1}(x, y, e)=0$. Так как оба графа $H_{k+1}$ и $H^{k}$ связны, существует цикл $Z=v_{1} \ldots v_{m}$, проходящий по ребрам $e$ и $e^{\prime}$. Пусть $e_{i}=v_{i} v_{i+1}$ (где $i \in[1 . . m]$, нумерация циклическая) - ребра этого цикла, причем $e^{\prime}=e_{1}$. Не умаляя общности можно считать, что $g_{k+1}\left(v_{1}, v_{2}, e_{1}\right) \neq 2$. Тогда пусть $g^{\prime}$ - циркуляция вдоль цикла $Z$, заданная формулой

$$
g^{\prime}\left(x_{i}, x_{i+1}, e_{i}\right)=1, \quad g^{\prime}\left(x_{i+1}, x_{i}, e_{i}\right)=2, \quad \text { и } \quad g_{k}:=g_{k+1}+g^{\prime}
$$

Тогда $g_{k}(x, y, e)=g^{\prime}(x, y, e) \neq 0$ и

$$
g_{k}\left(x^{\prime}, y^{\prime}, e^{\prime}\right)= \pm g_{k}\left(v_{1}, v_{2}, e_{1}\right)= \pm\left(g_{k+1}\left(v_{1}, v_{2}, e_{1}\right)+1\right) \neq 0
$$

Все рёбра из $F^{k+1}$ не лежат в $E\left(H_{k+1}\right) \cup E\left(H^{k}\right)$, а потому на них $g_{k}$ совпадает с $g_{k+1}$, то есть, отлична от 0 .

Итак, в результате будет построена $\mathbb{Z}_{3}$-циркуляция $g_{1}$, невырожденная на $F^{1}=E(G) \backslash \cup_{i=1}^{n} E\left(H_{i}\right)$. Так как каждый граф $H_{i}$ имеет четные степени, по следствию 10.3 существует $\mathbb{Z}_{2}$-циркуляция $g$, невырожденная на рёбрах из $\cup_{i=1}^{n} E\left(H_{i}\right)$. Тогда $f(x, y, e):=\left(g(x, y, e), g_{1}(x, y, e)\right)-$ это $\left(\mathbb{Z}_{2} \times \mathbb{Z}_{3}\right)$-циркуляция, невырожденная на всех рёбрах графа $G$, то есть, $\left(\mathbb{Z}_{2} \times \mathbb{Z}_{3}\right)$-поток.

# 10.3 Комментарии 

Это короткая и достаточно простая глава. В первом разделе теория сетей и потоков (небольшая ее часть) изложена как часть теории графов. В теории алгоритмов сети, потоки и алгоритмы на них играют важную роль, но разговор об этом вне задач нашей книги. Можно почитать, например, книгу [58].

В этой главе записано исторически первое доказательство так называемой рёберной теоремы Менгера, которую на самом деле доказали Форд и Фалкерсон как пример применения разработанной ими техники.

Отмечу, что поток в сети в нашем изложении - функция от пары вершин (как в [58]), а не от ребра (как в [8]). Такое определение упрощает многие доказательства.

Во втором разделе излагается часть теории потоков в графе, не требующая применения потокового многочлена. В замечании 10.4 уже сказано о разных возможностях для определения потока. Выбранная версия

$f(x, y, e)$ - функция от пары вершин и ребра, ненулевая ровно в случае, если эти вершины являются концами ребра - кажется автору разумной.

Изложен этот материал в целом примерно как в книге Дистеля [8], но некоторые доказательства благодаря нашему определению потока становятся технически проще. Начиначется изложение с теоремы Татта об эквивалентности существования $k$-потока и $\mathbb{Z}_{k}$-потока, ведь с $k$-потоками крйне неудобно работать, а $\mathbb{Z}_{k}$-потоки и циркуляции, напротив, исключительно удобны.

В разделе 10.2.2 доказан ряд условий существования 2 и 3 -потоков в графах и найдены потоковые числа полных графов. Там же доказывается, что количество 3 -потоков регулярного графа степени 4 равняется числу его эйлеровых ориентаций. Мысль включить в книгу этот несложный результат появилась после прочтения обзора Велша [41], где ошибочно сказано, что количество эйлеровых ориентаций таких графов равняется количеству $\mathbb{Z}_{2} \times \mathbb{Z}_{2}$-потоков. Разговор об эйлеровых ориентациях 4-регулярного графа будет продолжен при изучении значений многочлена Татта, в разделе 13.3.3.

Наиболее сложным и сильным результатом главы является теорема Сеймура о существовании 6-потока в любом графе без мостов. Мы используем очевиный факт $\mathbb{Z}_{6} \simeq \mathbb{Z}_{2} \times \mathbb{Z}_{3}$. В принципе, можно вместо него воспользоваться тем, что количество $H$-потоков для всех абелевых групп $H$ одинаково, это будет доказано в разделе 13.2, где продолжится разговор о потоках, но уже с использованием потокового многочлена. Так, в разделе 13.2.2 станет возможным привлечь к изучению 4 -потоков группу $\mathbb{Z}_{2} \times \mathbb{Z}_{2}$ (не изоморфную $\mathbb{Z}_{4}$ !) и мы докажем несколько критериев существования 4 -потока в графе.



# Глава 11 

## Теория Рамсея

Всё началось с классической работы Рамсея (Р. Ramsey) 1930 года, в которой было доказано, что в графе на достаточно большом количестве вершин без больших клик обязательно есть большое независимое множество вершин.

## 11.1 Числа Рамсея

Основным объектом изучения в этой главе будут полные графы, рёбра которых покрашены в несколько цветов. Напомним, что множество вершин, образующих полный подграф, а также сам этот подграф мы называем кликой.

Определение 11.1. Пусть $m, n \in \mathbb{N}$. Число Рамсея $r(m, n)$ - это наименьшее из всех таких чисел $x \in \mathbb{N}$, что при любой раскраске рёбер полного графа на $x$ вершинах в два цвета обязательно найдётся клика на $n$ вершинах с рёбрами цвета 1 или клика на $m$ вершинах с рёбрами цвета 2 .

### 11.1.1 Существование. Оценки сверху

В 1930 году Рамсей доказал, что число $r(m, n)$ существует (то есть, конечно). Несмотря на современные вычислительные мощности, известно немного точных значений чисел Рамсея. Очевидно,

$$
r(n, 1)=r(1, n)=1, \quad r(n, 2)=r(2, n)=n, \quad r(m, n)=r(n, m)
$$

Мы приведём оценки сверху и снизу на числа Рамсея. Начнём с простейших оценок сверху.

Теорема 11.1. (P. Erdös, G. Szekeres, 1935.) Пусть $n, m \geq 2$ - натуральные числа. Тогда выполнены следующие утверждения.

1) $r(n, m) \leq r(n, m-1)+r(n-1, m)$.
2) Если оба числа $r(n, m-1)$ и $r(n-1, m)$ - чётные, то

$$
r(n, m) \leq r(n, m-1)+r(n-1, m)-1
$$

Замечание 11.1. Из утверждения теоремы 11.1 в частности следует, что число Рамсея $r(m, n)$ для любых натуральных $m$ и $n$ существует (то есть, конечно).

Доказательство. 1) Рассмотрим клику на $r(n, m-1)+r(n-1, m)$ вершинах с рёбрами цветов 1 и 2 и ее произвольную вершину $a$. Тогда либо от вершины $a$ отходит хотя бы $r(n, m-1)$ рёбер цвета 2 , либо от вершины $a$ отходит хотя бы $r(n-1, m)$ рёбер цвета 1 . Случаи аналогичны, рассмотрим первый случай и клику на $r(n, m-1)$ вершинах, соединенных с $a$ рёбрами цвета 2 . На этих вершинах есть либо клика на $n$ вершинах с рёбрами цвета 1 , либо клика на $m-1$ вершинах с рёбрами цвета 2 . Во втором случае добавим вершину $a$ и получим клику на $m$ вершинах с рёбрами цвета 2. Теперь из определения $r(n, m)$ следует утверждение пункта 1.
1) Рассмотрим клику на $r(n, m-1)+r(n-1, m)-1$ вершинах с рёбрами цветов 1 и 2 и её произвольную вершину $a$. Если вершине $a$ инцидентны хотя бы $r(n, m-1)$ рёбер цвета 2 или хотя бы $r(n-1, m)$ рёбер цвета 1 , то мы найдём в графе клику на $n$ вершинах с рёбрами цвета 1 или клику на $m$ вершинах с рёбрами цвета 2. Остаётся лишь случай, когда вершине $a$ инцидентны ровно $r(n, m-1)-1$ рёбер цвета 2 , то же самое для всех остальных вершин. Это означает, что в графе из рёбер цвета 2 всего $r(n, m-1)+r(n-1, m)-1$ вершин и степень каждой вершины равна $r(n, m-1)-1$. Однако, тогда в графе нечётное количество вершин нечётной степени. Противоречие завершает доказательство пункта 2.

Следствие 11.1. Для натуральных чисел $m, n$ выполняется неравенство $r(n, m) \leq \mathrm{C}_{n+m-2}^{n-1}$.

Доказательство. Очевидно, $\mathrm{C}_{n+m-2}^{n-1}=1$ при $n=1$ или $m=1$, как и соответствующие числа Рамсея. Индукцией по $n$ и $m$ при $n, m \geq 2$ получаем

$$
r(n, m) \leq r(n, m-1)+r(n-1, m) \leq \mathrm{C}_{n+m-3}^{n-1}+\mathrm{C}_{n+m-3}^{n-2}=\mathrm{C}_{n+m-2}^{n-1}
$$

Как это ни странно, с помощью неравенства из теоремы 11.1 мы можем получить несколько точных значений чисел Рамсея. Отметим, что $r(3,3) \leq 2 r(2,3)=6$. Так как числа $r(3,3)$ и $r(2,4)$ четны, можно вывести неравенства $r(3,4) \leq r(3,3)+r(2,4)-1 \leq 9$. И, наконец, $r(3,5) \leq r(2,5)+r(3,4) \leq 14$, а также $r(4,4) \leq 2 r(3,4) \leq 18$. Все эти значения являются точными.

# 11.1.2 Экстремальные примеры и оценки снизу 

Задача нахождения точных значений чисел Рамсея чрезвычайно трудна, этих значений известно немногим больше, чем перечислено выше. Графом Рамсея $R(n, m)$ назовём граф на $r(n, m)-1$ вершинах, не содержащий ни клики на $n$ вершинах, ни независимого множества на $m$ вершинах (то есть, граф на рёбрах цвета 1 из раскраски в два цвета рёбер графа $K_{r(m, n)-1}$, не содержащей ни клики на $n$ вершинах с рёбрами цвета 1 , ни клики на $m$ вершинах с рёбрами цвета 2 ).

Граф $R(3,3)$ - это цикл на пяти вершинах. Экстремальный граф $R(3,4)$ - это цикл на 8 вершинах с проведёнными четырьмя главными диагоналями. Графы $R(3,5)$ и $R(4,4)$ имеют интересную числовую природу.

Так, если ассоциировать 13 вершин графа $R(3,5)$ с элементами поля вычетов по модулю 13 , то рёбра будут соединять вычеты, разность которых - кубический вычет по модулю 13 (то есть, $1,5,8$ или 12).

Если считать 17 вершин графа $R(4,4)$ элементами поля вычетов по модулю 17 , то рёбра будут соединять вычеты, разность которых - квадратичный вычет по модулю 17 (то есть, $1,2,4,8,9,13,15$ или 16).


Рис. 11.1: Графы Рамсея.
Существует гипотеза, что любой граф $R(k, k)$ изоморфен своему дополнению (или что в раскраске полного графа на $r(k, k)-1$ вершинах

в два цвета граф с рёбрами цвета 1 обязательно изоморфен графу с рёбрами цвета 2). Однако, это не более чем красивое предположение, в обоснование которого можно положить лишь немногие известные примеры.

Теорема 11.2. (P. Erdös, 1947.) Для любого натурального числа $k \geq 2$ выполняется неравенство $r(k, k) \geq 2^{k / 2}$.

Доказательство. Так как $r(2,2)=2$, достаточно рассмотреть случай, когда $k \geq 3$.

Зафиксируем множество различных помеченных вершин $v_{1}, \ldots, v_{n}$. Пусть $g(n, k)$ - доля среди всех графов на вершинах $v_{1}, \ldots, v_{n}$ тех графов, что содержат клику на $k$ вершинах. Всего графов на наших вершинах, очевидно, $2^{\mathrm{C}_{n}^{2}}$ (каждое из возможных $\mathrm{C}_{n}^{2}$ рёбер можно провести или не провести).

Посчитаем графы с кликой на $k$ вершинах так: существует $\mathrm{C}_{n}^{k}$ способов выбрать $k$ вершин для клики в нашем множестве, после чего все рёбра между ними будем считать проведёнными, а остальные рёбра выбираются произвольным образом. Таким образом, каждый граф с кликой на $k$ вершинах будет посчитан, причём некоторые даже более одного раза. Количество графов с кликой размера $k$ оказывается не более, чем $\mathrm{C}_{n}^{k} \cdot 2^{\mathrm{C}_{n}^{2}-\mathrm{C}_{k}^{2}}$. Следовательно,

$$
g(n, k) \leq \frac{\mathrm{C}_{n}^{k}}{2^{\mathrm{C}_{k}^{2}}}<\frac{n^{k}}{k!\cdot 2^{\mathrm{C}_{k}^{2}}}
$$

Подставив $n<2^{k / 2}$ в неравенство (11.1), мы получаем

$$
g(n, k)<\frac{2^{k^{2} / 2} \cdot 2^{-\mathrm{C}_{k}^{2}}}{k!}=\frac{2^{k / 2}}{k!}<\frac{1}{2} \quad \text { при } k \geq 3
$$

Предположим, что $r(k, k)=n<2^{k / 2}$ и разобьём все графы на $n$ вершинах на пары $G, \bar{G}$ (граф и его дополнение). Так как $g(n, k)<\frac{1}{2}$, то существует пара, в которой ни $G$, ни $\bar{G}$ не содержат клики на $k$ вершинах. Рассмотрим раскраску рёбер $K_{n}$ в два цвета, в которой рёбра цвета 1 образуют граф $G$. В такой раскраске нет клики на $k$ вершинах ни цвета 1 , ни цвета 2 , противоречие. Следовательно, $r(k, k) \geq 2^{k / 2}$.

Следствие 11.2. Для любых $k, m \in \mathbb{N}$ таких, что $2 \leq k \leq m$, выполняется неравенство $r(k, m) \geq 2^{k / 2}$.

Удивительно, но известные конструкции не могут ни дать более точную оценку на $r(k, k)$, чем в теореме 11.2 , ни дать более точную оценку на $r(k, m)$, чем в следствии 11.2 .

# 11.1.3 Числа Рамсея для раскрасок в несколько цветов 

Естественным обобщением классических чисел Рамсея является случай, когда рёбра полного графа красятся не в два, а в произвольное число цветов.

Определение 11.2. Пусть $k, n_{1}, \ldots, n_{k} \in \mathbb{N}$. Число Рамсея $r\left(k ; n_{1}, \ldots, n_{k}\right)$ - это наименьшее из всех таких чисел $x \in \mathbb{N}$, что при любой раскраске рёбер полного графа на $x$ вершинах в $k$ цветов для некоторого $i \in[1 . . k]$ обязательно найдётся клика на $n_{i}$ вершинах с рёбрами цвета $i$.

Замечание 11.2. Отметим, что $r(2 ; n, m)$ - это определённое ранее число Рамсея $r(n, m)$.

Обобщение оказывается настолько естественным, что по сути не добавляет нам ничего нового: полностью аналогично теореме 11.1 и следствию 11.1 можно доказать следующие факты.

Теорема 11.3. Пусть $k, n_{1}, \ldots, n_{k} \geq 2$ - натуральные числа. Тогда выполняются следующие утверждения.

1) 

$$
\begin{aligned}
& r\left(k ; n_{1}, \ldots, n_{k}\right) \leq r\left(k ; n_{1}-1, n_{2}, \ldots n_{k}\right)+r\left(k ; n_{1}, n_{2}-1, \ldots n_{k}\right)+ \\
& \quad+r\left(k ; n_{1}, n_{2}, \ldots n_{k}-1\right)-k+2
\end{aligned}
$$

1) 

$$
r\left(k ; n_{1}, \ldots, n_{k}\right) \leq \frac{\left(n_{1}+n_{2}+\ldots n_{k}\right)!}{n_{1}!\cdot n_{2}!\cdots \cdots n_{k}!}
$$

Доказательство. 1) Доказательство полностью аналогично пункту 1 теоремы 11.1.
1) Доказательство аналогично следствию 11.1. Нужно лишь убедиться в очевидном неравенстве для случая, когда хотя бы одно из чисел $n_{1}, \ldots, n_{k}$ равно 1 (левая часть в этом случае равна 1 , а правая, очевидно, не меньше 1) и заметить, что полиномиальные коэффициенты из очевидных комбинаторных соображений удовлетворяют соотношению

$$
\frac{\left(n_{1}+n_{2}+\ldots n_{k}\right)!}{n_{1}!\cdot n_{2}!\cdots \cdots n_{k}!}=\sum_{i=1}^{k} \frac{\left(n_{1}+\cdots+\left(n_{i}-1\right)+\cdots+n_{k}\right)!}{n_{1}!\cdots \cdots\left(n_{i}-1\right)!\cdots \cdots n_{k}!}
$$

Следовательно, неравенство (11.3) выводится из неравенства (11.2) по индукции.

# 11.2 Числа Рамсея больших размерностей 

Результат этого раздела не относится к классической теории графов, но тесно с ней связан. Даже формулировать определения и результаты мы будем не на языке графов.

Определение 11.3. Пусть $m, k, n_{1}, \ldots, n_{k} \in \mathbb{N}$, причём $n_{1}, \ldots, n_{k} \geq m$. Число Рамсея $r_{m}\left(k ; n_{1}, \ldots, n_{k}\right)$ - это наименьшее из всех таких чисел $x \in \mathbb{N}$, что при любой раскраске $m$-элементных подмножеств $x$-элементного множества $M$ в $k$ цветов для некоторого $i \in[1 . . k]$ обязательно найдётся такое множество $W_{i}$, что $\left|W_{i}\right|=n_{i}$ и все $m$-элементные подмножества множества $W_{i}$ имеют цвет $i$.

Число $m$ называется размерностью числа Рамсея $r_{m}\left(k ; n_{1}, \ldots, n_{k}\right)$.
Замечание 11.3. 1) Нетрудно понять, что числа Рамсея размерности 2 это определённые выше числа Рамсея для клик.
1) При количестве цветов, равном 2 , этот параметр мы будем опускать и писать $r_{m}\left(n_{1}, n_{2}\right)$ вместо $r_{m}\left(2 ; n_{1}, n_{2}\right)$.

Определение 11.4. Для каждого множества $M$ через $M^{k}$ мы будем обозначать множество всех $k$-элементных подмножеств $M$.

Теорема 11.4. Пусть $m, k, n_{1}, \ldots, n_{k}$ - натуральные числа, причём $k \geq 2$, а $n_{1}, \ldots, n_{k} \geq m$. Тогда число Рамсея $r_{m}\left(k ; n_{1}, \ldots, n_{k}\right)$ существует (то есть, конечно).

Доказательство. 1. Мы будем доказывать теорему по индукции. Начнем со случая $k=2$. Приступая к доказательству для числа $r_{m}\left(n_{1}, n_{2}\right)$ мы будем считать доказанным утверждение теоремы для чисел Рамсея всех меньших размерностей и чисел Рамсея размерности $m$ с меньшей суммой $n_{1}+n_{2}$. В качестве базы будем использовать случай чисел Рамсея размерности 2 , разобранный выше.

Итак, мы докажем, что

$$
r_{m}\left(n_{1}, n_{2}\right)-1 \leq p=r_{m-1}\left(r_{m}\left(n_{1}-1, n_{2}\right), r_{m}\left(n_{1}, n_{2}-1\right)\right)
$$

Рассмотрим $(p+1)$-элементное множество $M$ и выделим в нём элемент $a$. Пусть $M_{0}=M \backslash\{a\}$, а $\rho: M^{m} \rightarrow\{1,2\}-$ произвольная раскраска в два цвета. Рассмотрим раскраску $\rho^{\prime}: M_{0}^{m-1} \rightarrow\{1,2\}$, определённую следующим образом: для каждого множества $B \in M_{0}^{m-1}$ положим $\rho^{\prime}(B)=\rho(B \cup\{a\})$.

Так как $\left|M_{0}\right|=p$, либо существует $r_{m}\left(n_{1}-1, n_{2}\right)$-элементное подмножество $M_{1} \subset M_{0}$, для которого $\rho^{\prime}(B)=1$ на всех $B \in M_{1}^{m-1}$, либо

существует $r_{m}\left(n_{1}, n_{2}-1\right)$-элементное подмножество $M_{2} \subset M_{0}$, для которого $\rho^{\prime}(B)=2$ на всех $B \in M_{2}^{m-1}$. Случаи аналогичны, рассмотрим первый случай и множество $M_{1}$.

По индукционному предположению из $\left|M_{1}\right|=r_{m}\left(n_{1}-1, n_{2}\right)$ следует, что либо существует $n_{1}-1$ элементное подмножество $N_{1} \subset M_{1}$, для которого $\rho(A)=1$ на всех $A \in N_{1}^{m}$, либо существует $n_{2}$-элементное подмножество $N_{2} \subset M_{1}$, для которого $\rho(A)=2$ на всех $A \in N_{2}^{m}$. Во втором случае искомое подмножество найдено (это $N_{2}$ ), рассмотрим первый случай и множество $N=N_{1} \cup\{a\}$. Пусть $A \in N^{m}$. Если $A \not \ni a$, то $A \in N_{1}^{m}$ и, следовательно, $\rho(A)=1$. Если же $A \ni a$, то множество $A \backslash\{a\} \in N_{1}^{m-1} \subset M_{1}^{m-1}$ и потому $\rho(A)=\rho^{\prime}(A \backslash\{a\})=1$. Учитывая, что $|N|=n_{1}$, мы нашли искомое подмножество и в этом случае.
1. При $k>2$ будем вести индукцию по $k$ с доказанной выше базой $k=2$. Докажем неравенство

$$
r_{m}\left(k ; n_{1}, \ldots, n_{k}\right) \leq q=r_{m}\left(r_{m}\left(k-1 ; n_{1}, \ldots, n_{k-1}\right), n_{k}\right)
$$

Рассмотрим множество $M$ на $q$ вершинах и произвольную раскраску $\rho: M^{m} \rightarrow[1 . . k]$ в $k$ цветов. Рассмотрим раскраску $\rho^{\prime}: M^{m} \rightarrow\{0, k\}$, в которой цвета $1, \ldots, k-1$ раскраски $\rho$ склеены в цвет 0 . Тогда существует либо такое подмножество $M_{0} \subset M$, что $\left|M_{0}\right|=r_{m}\left(k-1 ; n_{1}, \ldots, n_{k-1}\right)$ и $\rho^{\prime}(A)=0$ на всех $A \in M_{0}^{m}$, либо существует такое $n_{k}$-элементное подмножество $M_{k} \subset M$, что $\rho(A)=\rho^{\prime}(A)=k$ на всех $A \in M_{k}^{m}$. Во втором случае $M_{k}$ - искомое подмножество, а в первом случае заметим, что на любом подмножестве $A \in M_{0}^{m}$ из $\rho^{\prime}(A)=0$ следует $\rho(A) \in[1 . . k-1]$. Исходя из размера множества $M_{0}$, по индукционному предположению получаем, что найдётся искомое подмножество множества $M$ для одного из цветов $1, \ldots, k-1$.

# 11.3 Числа Рамсея для произвольных графов 

Ещё один способ обобщения классической теории Рамсея - замена клик на произвольные графы-шаблоны.

Определение 11.5. Пусть $H_{1}, H_{2}$ - два данных графа. Число Рамсея $r\left(H_{1}, H_{2}\right)$ - это наименьшее из всех таких чисел $x \in \mathbb{N}$, что при любой раскраске рёбер полного графа на $x$ вершинах в два цвета обязательно найдётся подграф, изоморфный $H_{1}$, с рёбрами цвета 1 или подграф, изоморфный $H_{2}$, с рёбрами цвета 2.

В принципе, из результатов классической теории Рамсея понятно, что числа $r\left(H_{1}, H_{2}\right)$ обязательно существуют (то есть, конечны). Интересно, что иногда их можно точно вычислить.

Лемма 11.1. Пусть $m>1$, а граф $H$ таков, что $v(H) \geq(m-1)(n-1)+1$ $u \alpha(H) \leq m-1$. Тогда граф $H$ содержит в качестве подграфа любое дерево на $n$ вершинах.

Доказательство. Зафиксируем $m$ и проведём индукцию по $n$. База для $n=1$ очевидна. Докажем индукционный переход $n-1 \rightarrow n(n>1)$. Рассмотрим произвольное дерево $T_{n}$ на $n$ вершинах, пусть дерево $T_{n-1}$ получено из $T_{n}$ удалением висячей вершины. Пусть $U$ - максимальное независимое множество вершин графа $H$. Тогда $|U|=\alpha(H) \leq m-1$, следовательно, $v(H-U) \geq(m-1)(n-2)+1$ и, очевидно, $\alpha(H-U) \leq m-1$.

По индукционному предположению граф $H-U$ содержит в качестве подграфа дерево $T_{n-1}$. Пусть $a$ - вершина этого дерева, присоединив к которой висячую вершину, мы получим дерево $T_{n}$. Заметим, что множество $U \cup\{a\}$ не является независимым ввиду максимальности $U$, следовательно, вершина $a$ смежна хотя с одной вершиной $x \in U$. Так как $x \notin V\left(T_{n-1}\right)$, можно присоединить вершину $x$ к вершине $a$ дерева $T_{n-1}$. В результате мы получим дерево $T_{n}$ в качестве подграфа графа $H$.

Теорема 11.5. (V. Chvatal, 1977.) Пусть $T_{n}$ - дерево на $n$ вершинах. Тогда $r\left(T_{n}, K_{m}\right)=(m-1)(n-1)+1$.

Доказательство. 1) Докажем, что $r\left(T_{n}, K_{m}\right) \geq(m-1)(n-1)+1$. Для этого предъявим раскраску рёбер графа $K_{(m-1)(n-1)}$, в которой нет ни одного связного подграфа на $n$ вершинах с рёбрами цвета 1 и нет клики на $m$ вершинах с рёбрами цвета 2 . Разобьём вершины графа на $m-1$ клику по $n-1$ вершине и покрасим все рёбра этих клик в цвет 1 . Тогда любой связный подграф с рёбрами цвета 1 содержит не более $n-1$ вершины, в частности, нет подграфа с рёбрами цвета 1 , изоморфного $T_{n}$. Рёбра цвета 2 (то есть, все оставшиеся рёбра) образуют ( $m-1$ )-дольный граф, в котором, очевидно, нет клики на $m$ вершинах.
1) Рассмотрим произвольную раскраску рёбер полного графа $K_{(m-1)(n-1)+1}$ в два цвета и его остовный подграф $G_{1}$ с рёбрами первого цвета. Предположим, что не существует клики на $m$ вершинах с рёбрами цвета 2. Тогда $m>1$ и $\alpha\left(G_{1}\right) \leq m-1$. По лемме 11.1, граф $G_{1}$ содержит в качестве подграфа любое дерево на $n$ вершинах, в частности, дерево, изоморфное $T_{n}$.

# 11.4 Индуцированная теорема Рамсея 

В этом разделе мы докажем похожее на теорему Рамсея, но значительно более сложное утверждение.

Определение 11.6. Пусть $H$ - граф. Граф $G$ называется рамсеевским графом для $H$, если при любой раскраске рёбер графа $G$ в два цвета существует одноцветный по рёбрам индуцированный подграф графа $G$, изоморфный $H$.

При замене произвольного графа $H$ на клику мы получаем частный случай классической теоремы Рамсея. Для клики добавленное слово "индуцированный" ничего не меняет. Но значительно усложняет ситуацию для произвольного графа $H$. В 1973 году независимо несколькими авторами было доказано, что для любого графа существует рамсеевский граф. Это сделали Deuber, Erdös, Hajnaj и Posa, Rödl. Утверждение получило название индуцированной теоремы Рамсея. Мы приведём доказательство, которое придумали J. Nešetřil и V. Rödl в 1981 году.

### 11.4.1 Случай двудольного графа

Мы будем рассматривать двудольный граф как $G=\left(V_{1}(G), V_{2}(G), E(G)\right)$, где $V_{1}(G)$ и $V_{2}(G)$ - разбиение множества вершин $V(G)$ на две доли, а рёбра соединяют вершины из разных долей.

Определение 11.7. Пусть $H, G$ - двудольные графы. Инъективное отображение $\varphi: V(H) \rightarrow V(G)$ назовём погружением, если оно удовлетворяет двум условиям.
$1^{\circ} \varphi\left(V_{1}(H)\right) \subset V_{1}(G), \varphi\left(V_{2}(H)\right) \subset V_{2}(G)$.
$2^{\circ} \varphi(u) \varphi(v) \in E(G)$ тогда и только тогда, когда $u v \in E(H)$.
В этом случае будем говорить, что двудольный граф $H$ погружён в двудольный граф $G$ и использовать обозначение $\varphi(H)=G(\varphi(V(H)))$.

Замечание 11.4. Отметим, что если существует погружение $\varphi$ двудольного графа $H$ в двудольный граф $G$, то индуцированный подграф $\varphi(H)$ графа $G$ изоморфен $H$.

Напомним, что для множества $X$ через $X^{k}$ мы обозначаем множество всех $k$-элементных подмножеств множества $X$.

Определение 11.8. Назовём особым двудольный граф вида

$$
H=\left(V, V^{k}, E\right), \quad \text { где } \quad E=\left\{x Y: x \in V, Y \in V^{k}, x \in Y\right\}
$$

Лемма 11.2. Любой двудольный граф может быть погружен в особый двудольный граф.

Доказательство. Рассмотрим произвольный двудольный граф $P$, пусть $V_{1}(P)=\left\{a_{1}, \ldots a_{n}\right\}, V_{2}(P)=\left\{b_{1}, \ldots b_{m}\right\}$. Положим

$$
V=\left\{x_{1}, \ldots, x_{n}, y_{1}, \ldots, y_{n}, z_{1}, \ldots, z_{m}\right\}
$$

Построим погружение $P$ в особый двудольный граф $H=\left(V, V^{n+1}, E\right)$.
Изначально положим $\varphi\left(a_{i}\right)=x_{i}$. Попробуем построить такое множество $Y_{j} \in V^{n+1}$, что $\varphi\left(b_{j}\right)=Y_{j}$. По определению погружения и особого двудольного графа должно выполняться условие

$$
Y_{j} \cap\left\{x_{1}, \ldots, x_{n}\right\}=\varphi\left(\mathrm{N}_{P}\left(b_{j}\right)\right)
$$

Условие (11.4) оставляет незаполненными $n+1-d_{P}\left(b_{j}\right) \geq 1$ элементов множества $Y_{j}$ (единственное ограничение: эти элементы не могут быть вершинами $x_{1}, \ldots, x_{n}$ ). Поместим в $Y_{j}$ элемент-индекс $z_{j}$ (чтобы $Y_{j} \neq Y_{\ell}$ при $j \neq \ell$ ) и дополним произвольно элементами из $y_{1}, \ldots, y_{n}$, чтобы в множестве $Y_{j}$ было ровно $n+1$ элементов.

Лемма 11.3. Для любого двудольного графа $H$ существует такой двудольный граф $G$, что для любой раскраски рёбер $G$ в два ивета обязательно существует погружение $\varphi$ графа $H$ в граф $G$, в котором все рёбра графа $\varphi(H)$ одноцветны.
Замечание 11.5. Разумеется, указанный в условии леммы 11.3 граф $G$ будет рамсеевским графом для $H$. Утверждение леммы более сильное: мы дополнительно требуем, чтобы все вершины одной доли $H$ можно было погрузить в одну долю графа $G$.

Доказательство. Ввиду леммы 11.2 достаточно доказать утверждение для особого двудольного графа $H=\left(V, V^{k}, E(H)\right)$. Пусть $|V|=n$. Докажем, что рамсеевским графом для $H$ будет особый двудольный граф $G=\left(U, U^{2 k-1}, E(G)\right)$, где

$$
|U|=r_{2 k-1}\left(2 \mathrm{C}_{2 k-1}^{k} ; k n+k-1, \ldots, k n+k-1\right)
$$

Рассмотрим произвольную раскраску рёбер графа $G$ в два цвета 1 и 2 . Каждое множество $Y \in U^{2 k-1}$ смежно как вершина особого двудольного графа $G$ с $2 k-1$ вершиной, хотя бы $k$ из этих рёбер имеет одинаковый цвет. Выберем и зафиксируем для каждого множества $Y$ его подмножество $S(Y)$, состоящее из $k$ вершин доли $U$, соединённых с $Y$ рёбрами

одинакового цвета. Пусть $c(Y) \in\{1,2\}$ - это цвет рёбер, соединяющий $Y$ с вершинами из $S(Y)$.

Можно считать, что элементы $U$ упорядочены. Тогда элементы каждого множества $Y \in U^{2 k-1}$ будут упорядочены. Обозначим через $\sigma(Y)$ множество номеров $k$ элементов множества $S(Y)$ в порядке элементов множества $Y$. Тогда $\sigma(Y)$ может принимать ровно $\mathrm{C}_{2 k-1}^{k}$ значений.

Покрасим множество $U^{2 k-1}$ в $2 \mathrm{C}_{2 k-1}^{k}$ цветов: цветом подмножества $Y$ будет пара $(\sigma(Y), c(Y))$. Из условия (11.5) следует, что существует такое подмножество $W \subset U$, что $|W|=k n+k-1$ и все подмножества $Y \subset W^{2 k-1}$ имеют одинаковый цвет $(\sigma(Y), c(Y))$ (не умаляя общности будем считать, что $\sigma(Y)=\sigma, c(Y)=1$ ). Мы найдём погружение графа $H$ в $G(W)$, все рёбра в котором покрашены в исходной раскраске в цвет 1 и тем самым докажем лемму.

Занумеруем элементы множества $W$ в порядке их следования в $U$ : пусть $W=\left\{w_{1}, \ldots, w_{k n+k-1}\right\}$. Введем обозначения

$$
t_{j}=w_{k j}, \quad T=\left\{t_{1}, \ldots, t_{n}\right\}, \quad V=\left\{a_{1}, \ldots, a_{n}\right\}
$$

Положим $\varphi\left(a_{i}\right)=t_{i}$. Остаётся корректно определить $\varphi(Z)$ для каждого множества $Z \in V^{k}$. Прежде чем построить $\varphi(Z)=Y \in U^{2 k-1}$ мы положим $S(Y)=\{\varphi(x): x \in Z\}$. Из определения погружения понятно, что тогда должно выполняться условие $S(Y)=Y \cap T$, а следовательно, нам нужно дополнить множество $Y$ ещё $k-1$ элементами, не входящими в множество $T$. Мы сделаем это так, чтобы множество порядков номеров элементов множества $S(Y)$ среди элементов множества $Y$ было $\sigma(Y)=\sigma$ : так как $t_{i}=w_{k i}$, не входящих в $T$ элементов $W$ хватит, чтобы обеспечить это.

Так как по выбору множества $W$ мы имеем $\sigma(Y)=\sigma$, множество $S(Y)$ выбрано корректно и, опять же в силу выбора $W$, все рёбра особого двудольного графа $G$ между вершинами из $S(Y)=\{\varphi(x): x \in Z\}$ и $Y=\varphi(Z)$ покрашены в цвет 1 . В завершение остается лишь добавить, что при $Z \neq Z^{\prime}$ мы по построению имеем $S(\varphi(Z)) \neq S\left(\varphi\left(Z^{\prime}\right)\right)$, поэтому $\varphi(Z) \neq \varphi\left(Z^{\prime}\right)$. Таким образом, искомое погружение построено.

# 11.4.2 Случай произвольного графа 

Теорема 11.6. Для произвольного графа $H$ существует рамсеевский граф.

Доказательство. Пусть $k=v(H), n=r(k, k)$. Пронумеруем вершины графа $H$. Построим граф $G^{0}$ следующим образом: разместим его вершины в виде таблицы $n \times \mathrm{C}_{n}^{k}$. Таким образом, в каждом столбце вершины

окажутся пронумерованы числами от 1 до $n$, как соответствующие строки таблицы. В каждом столбце одним из $\mathrm{C}_{n}^{k}$ способов разместим граф $H$ (каждый столбец соответствует одному из возможных способов размещения). Все рёбра графа $G^{0}$ будут рёбрами указанных копий графа $H$.

Граф $G^{0}$ является $n$-дольным, его естественное разбиение на доли задаётся таблицей: $V_{i}\left(G^{0}\right)$ - это вершины, соответствующие $i$ строке таблицы. Мы последовательно в несколько шагов будем перестраивать наш граф с помощью леммы 11.3 , так, чтобы вершины последующих графов также разбивались на $n$ долей и записывались в виде таблицы. Каждый шаг будет соответствовать одной паре строк таблицы.

# Шаг перестройки графа. 

Итак, пусть мы имеем $n$-дольный граф $G^{\ell}$, доли которого $V_{i}=V_{i}\left(G^{\ell}\right)$ (где $i \in[1 . . n]$ ) соответствуют строкам таблицы. Пусть с парой строк (и, соответственно, долей) $i, j$ мы еще не выполняли шаг. Очевидно, граф $G_{i, j}=G^{\ell}\left(V_{i} \cup V_{j}\right)$ двудолен и для него по лемме 11.3 существует двудольный рамсеевский граф $P_{i, j}$ с долями $W_{i}$ и $W_{j}$. Для любой раскраски рёбер $P_{i, j}$ в два цвета существует одноиветное погружение $\varphi$ графа $G_{i, j}$ в $P_{i, j}$, в котором $\varphi\left(V_{i}\right) \subset W_{i}$ и $\varphi\left(V_{j}\right) \subset W_{j}$.

Перейдём к построению $G^{\ell+1}$. Заменим $V_{i}$ на $W_{i}$ и $V_{j}$ на $W_{j}$, проведём между этими долями все рёбра графа $P_{i, j}$. Наша цель в том, чтобы для любого погружения $G_{i, j}$ в $P_{i, j}$ была содержащая его копия $G^{\ell}$ (причём доли этой копии лежали в соответствующих строках таблицы графа $G^{\ell+1}$ ).

Пусть $\varphi_{1}, \ldots, \varphi_{m}$ - это все возможные погружения $G_{i, j}$ в $P_{i, j}$, положим $G_{i, j}(s)=\varphi_{s}\left(G_{i, j}\right)$. Каждому погружению $G_{i, j}(s)$ мы поставим в соответствие отдельные копии всех отличных от $V_{i}$ и $V_{j}$ долей: $V_{1}(s), \ldots, V_{n}(s)$. Положим $V_{i}(s)=V\left(G_{i, j}(s)\right) \cap W_{i}$ и $V_{j}(s)=V\left(G_{i, j}(s)\right) \cap W_{j}$. На этих долях построим копию графа $G^{\ell}$. В результате для каждого погружения графа $G_{i, j}$ в $P_{i, j}$ мы построили свою копию графа $G^{\ell}$.

## Выделение одноцветного индуцированного подграфа.

Итак, докажем, что $G=G^{C_{n}^{2}}$ и есть рамсеевский граф для $H$. Пусть $p_{1}, \ldots, p_{C_{n}^{2}}$ - нумерация пар строк в нашей таблице, в порядке которой совершались шаги перестройки графа. Рассмотрим произвольную раскраску рёбер $\rho$ графа $G$ в два цвета и докажем следующий факт.

Для каждого $\ell \in\left[0 . . \mathrm{C}_{n}^{2}\right]$ существует иломорфный $G^{\ell}$ индуцированный подграф графа $G$, в котором для пар строк $p_{\ell+1}, \ldots, p_{C_{n}^{2}}$ все рёбра между вершинами соответствующих пар строк в раскраске $\rho$ одноцветны.

Доказательство. Индукция с обратным ходом от $\ell=\mathrm{C}_{n}^{2}$ к $\ell=0$. База для $\ell=\mathrm{C}_{n}^{2}$ очевидна. Докажем переход $\ell \rightarrow \ell-1$.

Итак, рассмотрим изоморфный $G^{\ell}$ индуцированный подграф графа $G$, который мы для простоты будем обозначать $G^{\ell}$ и пару строк $p_{\ell}$ в нём: пусть это строки $i$ и $j$, а $P_{i, j}$ и $G_{i, j}$ - те двудольные графы между этими строками, что описаны в шаге построения. Так как $P_{i, j}$ (подграф графа $G^{\ell}$ ) - рамсеевский граф для $G_{i, j}$, мы можем выбрать одноцветное в раскраске $\rho$ погружение $G_{i, j}$ в $P_{i, j}$ и соответствующая ему по построению копия $G^{\ell-1}$ будет искомым (из построения очевидно, что индуцированным!) подграфом $G^{\ell}$, а значит, и $G$.

Таким образом, существует изоморфный $G^{0}$ индуцированный подграф графа $G$, в котором для каждой пары строк $i, j$ все рёбра между вершинами соответствующих строк одноцветны в раскраске $\rho$. Будем обозначать этот граф просто $G^{0}$. Рассмотрим граф $K_{n}$, вершины которого соответствуют строкам таблицы и покрасим каждое ребро в цвет, в который покрашены рёбра $G^{0}$ между соответствующими строками. Так как $n=r(k, k)$, существуют $k$ вершин, между которыми все рёбра одноцветны. Рассмотрим столбец графа $G^{0}$, в котором $H$ размещён именно в строчках, соответствующих этим $k$ вершинам. Подграф $H^{\prime}$ графа $G^{0}$ на вершинах этого столбца и соответствующих строчках изоморфен $H$, по построению является индуцированным подграфом графа $G^{0}$ и все его рёбра одноцветны в раскраске $\rho$. Остаётся лишь заметить, что $H^{\prime}$ - индуцированный подграф графа $G$.

# 11.5 Комментарии 

Начало главы содержит классические теоремы - оценки на двумерные числа Рамсея и доказательство существования многомерных чисел Рамсея - с классическими доказательствами.

В разделе 11.3 представлено несколько менее известное понятие обобщение числа Рамсея с полных графов на произвольные и доказана несложная (и достаточно красивая) теорема Хватала [7]. В этой науке очень редки, и потому интересны случаи, когда какое-то число (в данном случае, $r\left(T_{n}, K_{m}\right)$ ) можно точно посчитать, причем для произвольных параметров $n$ и $m$. Тему чисел Рамсея для произвольных графов продолжает задача ??.

В разделе 11.4 доказывается совсем не элементарное утверждение индуцированная теорема Рамсея. Известны несколько доказательств этой теоремы, еще одно можно найти в книге Дистеля [8].

ГЛАВА 11. ТЕОРИЯ РАМСЕЯ

# Глава 12 

## Экстремальные графы

Это сравнительно новая область теории графов, истоки которой уходят в середину XX века к работам Турана, Эрдеша и других венгерских математиков. В принципе, экстремальная теория графов интересуется произвольными вопросами типа: "Какое наибольшее количество рёбер может быть в графе, обладающим некоторым свойством $P$ ?" Наиболее классический вид свойства, с которого начиналась эта область - это свойство не содержать подграфа, изоморфного данному графу (или графу из данного списка). Именно так называвемой задаче о запрещенных подграфах в основном и будет посвящена эта глава.

## 12.1 Наследственное свойство

Определение 12.1. Назовем свойство $P$ графа наследственным, если для любого графа $G$, удовлетворяющего свойству $P$, любой индуцированный подграф $H$ графа $G$ также удовлетворяет свойству $P$.

Обозначим через $P(n)$ наибольшее возможное количество рёбер в графе на $n$ вершинах, удовлетворяющем свойству $P$.

Наследственных свойств довольно много. Например, свойства "граф не содержит подграфа, изоморфного данному" или "хроматическое число графа не превосходит $k$ " являются наследственными.

Теорема 12.1. Пусть $P$ - наследственное свойство графов. Тогда $P(n) \leq \frac{n}{n-2} P(n-1)$.

Доказательство. Рассмотрим удовлетворяющий свойству $P$ граф $G$ на $n$ вершинах с $e(G)=P(n)$. Пусть $V(G)=\left\{v_{1}, \ldots, v_{n}\right\}$. Так как граф $G_{i}=G-v_{i}$ также удовлетворяет свойству $P$, мы имеем неравенство

$e(G)-d_{G}\left(v_{i}\right)=e\left(G_{i}\right) \leq P(n-1)$. Сложив такие неравенства для всех $i \in[1 . . n]$, мы получим

$$
(n-2) P(n)=(n-2) e(G)=n e(G)-\sum_{i=1}^{n} d_{G}\left(v_{i}\right) \leq n \cdot P(n-1)
$$

откуда немедленно следует утверждение теоремы.
Даже с помощью столь простой и, казалось бы, примитивной техники можно вывести ряд точных оценок в экстремальной теории графов. Предоставим читателю возможность решить несложное техническое упражнение, не используя последующих результатов.
Задача 12.1. а) Докажите при помощи теоремы о наследственном свойстве, что в графе на $v$ вершинах без треугольников не более чем $\left[\frac{\sqrt{2}}{4}\right]$ рёбер.
б) Докажите при помощи теоремы о наследственном свойстве, что в графе на $v$ вершинах без подграфа, изоморфного $K_{n}$, не более чем $\frac{(n-2)\left(v^{2}-r^{2}\right)}{2(n-1)}+\mathrm{C}_{r}^{2}$ рёбер, где $r$ - остаток от деления $v$ на $n-1$.

# 12.2 Задача о запрещенном подграфе 

Определение 12.2. Пусть $H$ - некоторый фиксированный граф. Через $\operatorname{ex}(v, H)$ мы обозначим наибольшее возможное количество рёбер в графе на $v$ вершинах, не содержащем подграфа, изоморфного $H$.

### 12.2.1 Теорема Турана

Исторически первым был результат Турана (Pál Turán), в 1941 году нашедшего $\operatorname{ex}\left(v, K_{n}\right)$. Мы приведем усиленную версию теоремы Турана, заодно доказав единственность экстремального графа (то есть, графа с максимальным числом рёбер, не содержащего $K_{n}$ ).

Пусть $v=q(n-1)+r$, где $r-$ остаток от деления $v$ на $n-1$. Обозначим через $T_{v, n}$ полный $(n-1)$-дольный граф на $v$ вершинах с $r$ долями размера $q+1$ и $n-1-r$ долями размера $q$. Туран доказал, что $\operatorname{ex}\left(v, K_{n}\right)$ равно количеству рёбер графа $T_{v, n}$ (это количество нетрудно подсчитать, см. следствие 12.1).

Определение 12.3. Пусть $G$ и $G^{\prime}$ - два графа на $n$ вершинах со степенными последовательностями $d_{n} \geq d_{n-1} \geq \cdots \geq d_{1}$ и $d_{n}^{\prime} \geq d_{n-1}^{\prime} \geq \cdots \geq d_{1}^{\prime}$. Мы будем говорить, что граф $G$ мажорирует граф $G^{\prime}$, если $d_{i} \geq d_{i}^{\prime}$ для всех $i \in[1 . . n]$.

Теорема 12.2. (Р. Erdös, 1970.) Пусть $n \geq 2$ - натуральное число. Если граф $G$ не содержит подграфа, изоморфного $K_{n}$, то существует ( $n-1$ )-дольный граф $H$, который мажорирует $G$. Более того, если степенные последовательности графов $G$ и $H$ совпадают, то граф $G$ изоморфен $H$.

Доказательство. Докажем теорему индукцией по $n$. База для $n=2$ очевидна. Предположим, что утверждение выполняется для $n-1$. Рассмотрим такую вершину $u \in V(G)$, что $d_{G}(u)=\Delta(G)$. Поскольку $G$ не содержит $K_{n}$, то граф $G_{1}=G\left(N_{G}(u)\right)$ не содержит $K_{n-1}$ и по индукционному предположению существует ( $n-2$ )-дольный граф $H_{1}$ на множестве вершин $\mathrm{N}_{G}(u)$, мажорирующий $G_{1}$. Можно построить граф $H_{1}$ так, чтобы $d_{H_{1}}(y) \geq d_{G_{1}}(y)$ для любой вершины $y \in \mathrm{~N}_{G}(u)$.


Рис. 12.1: Графы $G$ и $H$.
Рассмотрим граф $H$ с множеством вершин $V(G)$, в котором между вершинами множества $\mathrm{N}_{G}(u)$ проведены рёбра графа $H_{1}$, между вершинами множества $V^{\prime}=V \backslash \mathrm{~N}_{G}(u)$ рёбер нет и каждая вершина из множества $V^{\prime}$ смежна с каждой вершиной множества $\mathrm{N}_{G}(u)$. Очевидно, граф $H$ является ( $n-1$ )-дольным. Для каждой вершины $x \in V^{\prime}$ мы имеем

$$
d_{H}(x)=\left|\mathrm{N}_{G}(u)\right|=\Delta(G) \geq d_{G}(x)
$$

Для каждой вершины $y \in \mathrm{~N}_{G}(u)$ по построению графа $H$ мы имеем

$$
d_{H}(y)=\left|V^{\prime}\right|+d_{H_{1}}(y) \geq\left|V^{\prime}\right|+d_{G_{1}}(y) \geq d_{G}(y)
$$

Таким образом, граф $H$ мажорирует граф $G$.
Предположим, что степенные последовательности графов $H$ и $G$ совпадают. Тогда неравенство (12.1) обращается в равенство на всех вершинах множества $\mathrm{N}_{G}(u)$, следовательно, степенные последовательности графов $H_{1}$ и $G_{1}$ совпадают, откуда по индукционному предположению следует изоморфность этих графов. Отсюда же следует, что каждая вершина множества $\mathrm{N}_{G}(u)$ смежна в графе $G$ со всеми вершинами множества $V^{\prime}$. Но тогда каждая вершина множества $V^{\prime}$ смежна в графе $G$ со

всеми вершинами множества $\mathrm{N}_{G}(u)$. Из $\left|\mathrm{N}_{G}(u)\right|=\Delta(G)$ следует, что рёбер между вершинами множества $V^{\prime}$ в графе $G$ нет, то есть, графы $G$ и $H$ изоморфны.

Следствие 12.1. При $n \geq 3$

$$
e x\left(v, K_{n}\right)=\frac{(n-2)\left(v^{2}-r^{2}\right)}{2(n-1)}+\mathrm{C}_{r}^{2}
$$

где $r$ - остаток от деления $v$ на $n-1$. Если граф $G$ на $v$ вершинах не содержит полного подграфа на $n$ вершинах и имеет ех $\left(v, K_{n}\right)$ рёбер, то $G$ изоморфен $T_{v, n}$.

Доказательство. Пусть $G$ - граф на $v$ вершинах с $e(G)=e x\left(v, K_{n}\right)$. Тогда по теореме 12.2 существует $(n-1)$-дольный граф $H$ на $n$ вершинах, мажорирующий $G$. Так как $H$, очевидно, не содержит изоморфного $K_{n}$ подграфа, то $e(H) \leq e x\left(v, K_{n}\right)=e(G)$, следовательно, по теореме 12.2 графы $G$ и $H$ изоморфны. Нетрудно проверить, что из всех $(n-1)$-дольных графов на $v$ вершинах граф $T_{v, n}$ имеет строго наибольшее число рёбер, следовательно, $H$ изоморфен $T_{v, n}$. Несложно убедиться, что в графе $T_{v, n}$ ровно $\frac{(n-2)\left(v^{2}-r^{2}\right)}{2(n-1)}+\mathrm{C}_{r}^{2}$ рёбер.

# 12.2.2 Графы без $K_{m, n}:$ оценка 

Для неполного графа $H$ редко удается не то что найти все экстремальные примеры, но даже найти точное значение $\operatorname{ex}(v, H)$. Иногда удается найти асимптотику ех $(v, H)$ при $v \rightarrow \infty$.

Рассмотрим случай $H=K_{m, n}$. Он много сложнее случая полного графа. Сначала мы докажем оценку сверху на $e x\left(v, K_{m, n}\right)$, потом в ряде случаев приведем серии примеров графов, в которых количество рёбер близко к экстремальному. Для построения примеров нам понадобятся числовые и алгебраические конструкции.

Теорема 12.3. (T. Kővari, V. T. Sós, P. Turán, 1954.) Для натуральных $m, n \geq 2, v \geq m+n$ выполняется неравенство

$$
e x\left(v, K_{m, n}\right) \leq \frac{1}{2} \cdot\left((m-1)^{1 / n} v^{(2-1 / n)}+n v\right)
$$

Доказательство. Пусть $G$ - граф на $v$ вершинах, не содержащий $K_{m, n}$, $d_{1}, \ldots, d_{v}$ - степени вершин графа $G$, а $d=\frac{1}{v} \cdot \sum_{i=1}^{v} d_{i}-$ средняя степень вершины графа $G$. Введем обозначение $x^{\mathrm{n}}=x(x-1) \ldots(x-n+1)$.

Лемма 12.1. Для графа $G$ на $v \geq m+n$ вершинах, не содержащего подграфа $K_{m, n}$, выполняется неравенство

$$
d^{\mathrm{n}} \leq(m-1) \cdot(v-1)^{\frac{n-1}{m}}
$$

Доказательство. Если $d \leq n-1$, то несложно понять, что

$$
d^{\mathrm{n}}<(n-1)!<(v-1)^{\frac{n-1}{m}}
$$

и доказываемое неравенство очевидно. Далее пусть $d>n-1$.

1. Докажем, что $\sum_{i=1}^{v} d_{i}^{\mathrm{n}} \leq(m-1) v^{\mathrm{n}}$.

Для каждого множества $S \subset V(G),|S|=n$, количество таких вершин $x \in V(G)$, что $\mathrm{N}_{G}(x) \supset S$ не превосходит $m-1$ (иначе в графе будет подграф, изоморфный $K_{m, n}$ ). Таким образом, сложив по всем вершинам $x \in V(G)$ количество $n$-элементных подмножеств множества $\mathrm{N}_{G}(x)$, мы получим не более, чем $(m-1) \cdot \mathrm{C}_{v}^{n}$. Следовательно, $\sum_{i=1}^{v} \mathrm{C}_{d_{i}}^{n} \leq(m-1) \mathrm{C}_{v}^{n}$, откуда домножением на $n$ ! получаем доказываемое неравенство.
1. Остаётся доказать, что

$$
v \cdot d^{\mathrm{n}} \leq \sum_{i=1}^{v} d_{i}^{\mathrm{n}}
$$

Мы будем менять числа $d_{1}, d_{2}, \ldots d_{v}$ так, чтобы их сумма не изменялась и правая часть неравенства (12.3) не увеличивалась. Конечной целью этого процесса изменений будет замена каждого из этих чисел на их среднее арифметическое $d$.

Сначала добьемся того, чтобы все эти числа были не менее, чем $n-1$. Пусть это не так, рассмотрим наименьшее из них $d_{i}$, тогда $d_{i}<n-1$. Так как $d \geq n-1$, то существует такое $j$, что $d_{j}>n-1$. Заметим, что при $d_{i} \in[0 . . n-1]$ имеет место $d_{i}^{\mathrm{n}}=0$. Значит,

$$
d_{i}^{\mathrm{n}}+d_{j}^{\mathrm{n}}=d_{j}^{\mathrm{n}} \geq\left(d_{j}+d_{i}-n+1\right)^{\mathrm{n}}=\left(d_{i}+d_{j}-n+1\right)^{\mathrm{n}}+(n-1)^{\mathrm{n}}
$$

так как все рассматриваемые числа - целые неотрицательные и $x^{\mathrm{n}}$ возрастает при $x \geq n-1$ и равно 0 при $x \in[0 . . n-1]$. Следовательно, замена $d_{i}$ и $d_{j}$ на $(n-1)$ и $\left(d_{i}+d_{j}-n+1\right)$ уменьшает правую часть неравенства (12.3). После нескольких таких замен все числа будут не меньше чем $n-1$. Поскольку при $x \geq n-1$ функция $x^{\mathrm{n}}$ выпукла вниз, то, заменив $v$ чисел на их среднее арифметическое $d$, мы не увеличим сумму значений $x^{\mathrm{n}}$ в них, то есть, неравенство (12.3) верно. Разделив это неравенство на количество вершин $v$, мы завершим доказательство леммы.

Вернемся к доказательству теоремы. Так как $e(G)=\frac{v \cdot d}{2}$, для доказательства теоремы достаточно доказать неравенство

$$
d \leq d_{0}=(m-1)^{1 / n} v^{(1-1 / n)}+n
$$

Так как $d_{0}>n-1$, ввиду монотонности функции $x^{\underline{n}}$ при $x \geq n-1$ достаточно доказать, что при $d=d_{0}$ неравенство (12.2) не выполняется. Проверим это:

$$
\begin{aligned}
d_{0}^{\underline{n}}=\prod_{i=0}^{n-1}((m-1)^{1 / n} v^{(1-1 / n)}+n & -i)>\left((m-1)^{1 / n} v^{(1-1 / n)}\right)^{n}= \\
& =(m-1) \cdot v^{n-1}>(m-1) \cdot(v-1)^{\underline{n-1}}
\end{aligned}
$$

Отдельно остановимся на случае $n=m=2$.
Следствие 12.2. Для $v \geq 4$ выполняется неравенство

$$
e x\left(v, K_{2,2}\right) \leq \frac{v(1+\sqrt{1+4(v-1)})}{4}
$$

Доказательство. При $n=m=2$ неравенстве (12.2) - квадратное и его легко решить, получив неравенство (12.4).

Квадратный корень в неравенстве (12.4) извлекается нацело в точности при $v=p^{2}+p+1$ и оказывается, что $\operatorname{ex}\left(p^{2}+p+1, K_{2,2}\right) \leq \frac{(p+1)\left(p^{2}+p+1\right)}{2}$. Неспроста возникают ассоциации с конечной проективной плоскостью. Именно на основе проективной плоскости над конечным полем мы построим пример серии экстремальных графов без $K_{2,2}$.

В следующих разделах мы расскажем о известных сериях графов без подграфов $K_{2,2}, K_{2, n}$ и $K_{3,3}$ с большим количеством рёбер. Все эти серии требуют небольших знаний из теории чисел (квадратичные вычеты и невычеты), конечных полей и линейной алгебры (системы уравнений, линейные и аффинные подпространства, ранг матрицы). Тем, кому алгебра и теория чисел даже в таком объеме не нравится, рекомендую в следующих трёх разделах просмотреть хотя бы формулировки и принципы построения примеров.

# 12.2.3 Проективная плоскость и графы без $K_{2,2}$ 

Итак, что же такое проективная плоскость над полем $\mathbb{F}_{p}$ (полем вычетов по модулю простого числа $p$ )? Рассмотрим множество $M_{p}$ всех упорядоченных троек $(x, y, z)$ элементов $\mathbb{F}_{p}$, не все из которых равны 0 . Введем

на $M_{p}$ отношение эквивалентности: $(x, y, z) \sim\left(x_{1}, y_{1}, z_{1}\right)$ тогда и только тогда, когда существует такой ненулевой вычет $\lambda \in \mathbb{F}_{p}$, что $x_{1}=\lambda x$, $y_{1}=\lambda y, z_{1}=\lambda z$. Легко понять, что $\sim-$ отношение эквивалентности, все множество $M_{p}$ разбивается на классы эквивалентности. Так как ненулевой элемент $\lambda \in \mathbb{F}_{p}$ можно выбрать $p-1$ способом, в каждом классе эквивалентности по отношению $\sim$ ровно $p-1$ элемент множества $M_{p}$. Точками проективной плоскости $R_{p}$ будут как раз классы эквивалентности, количество которых, что нетрудно понять, равно $\frac{p^{3}-1}{p-1}=p^{2}+p+1$. Точки проективной плоскости будем записывать однородными координатами $(x: y: z)$ (такая запись подразумевает, что от домножения всех трех координат на ненулевой элемент $\lambda \in \mathbb{F}_{p}$ точка не меняется).

Двойственными к точкам объектами на проективной плоскости являются прямые. Каждой точке $(a: b: c) \in R_{p}$ соответствует прямая $\ell_{a: b: c}-$ множество всех таких точек $(x: y: z) \in R_{p}$, что

$$
a x+b y+c z=0
$$

Легко понять, что от выбора $(a, b, c)$ в одном классе эквивалентности (то есть, умножения всех этих чисел на произвольный ненулевой элемент $\lambda \in \mathbb{F}_{p}$ ) решения уравнения (12.5) не меняется, а элементы класса $(x: y: z)$ либо все являются решениями (12.5), либо все не являются. Таким образом, определение прямой корректно. Прямые и точки на проективной плоскости имеют много интересных свойств, которые мы сформулируем в следующей лемме.

Лемма 12.2. Для любого $p \in \mathbb{P}$ выполняются следующие утверждения.

1) Точка $(x: y: z)$ лежит на прямой $\ell_{a: b: c}$ тогда и только тогда, когда прямая $\ell_{x: y: z}$ проходит через точку $(a: b: c)$.
2) На любой прямой $\ell_{a: b: c}$ лежит ровно $p+1$ точка.
2a) Через любую точку $(a: b: c)$ проходит ровно $p+1$ прямая.
1) Любые две прямые на проективной плоскости имеют ровно одну общую точку.

За) Через любые две точки на проективной плоскости проходит ровно одна прямая.

Доказательство. 1) И то, и другое означает, что $a x+b y+c z=0$. Благодаря такой двойственности объектов проективной плоскости пункт 2 эквивалентен пункту 2 a , а пункт $3-$ пункту 3 a .
1) и 2a) Зафиксируем точку $(a: b: c)$. Нам нужно доказать, что количество таких точек $(x: y: z)$, что $a x+b y+c z=0$, равно $p+1$. Так как $a, b, c$ можно умножать на любой ненулевой вычет (не выходя из класса

эквивалентности-точки проективной плоскости), можно считать, что одно из чисел равно 1 , пусть это будет $c$. Тогда $z=-(a x+b y)$. Понятно, что при $x=y=0$ мы получаем $z=0$, а тройке $(0,0,0)$ не соответствует ни одной точки проективной плоскости. Каждой из $p^{2}-1$ остальных пар $(x, y)$ соответствует единственное $z$. Поделив $p^{2}-1$ пар на $p-1-$ размер класса эквивалентности - мы получим $p+1$ точку $(x: y: z)$.
1) и За) Зафиксируем различные точки $\left(a_{1}: b_{1}: c_{1}\right)$ и $\left(a_{2}: b_{2}: c_{2}\right)$. Нам нужно найти количество таких точек $(x: y: z)$, что

$$
a_{1} x+b_{1} y+c_{1} z=a_{2} x+b_{2} y+c_{2} z=0
$$

Разберём два случая.
а. У точек $\left(a_{1}: b_{1}: c_{1}\right)$ и $\left(a_{2}: b_{2}: c_{2}\right)$ существуют две одноименные ненулевые координаты, например, $c_{1} \neq 0, c_{2} \neq 0$.
В этом случае домножением на подходящие множители можно добиться того, что $c_{1}=c_{2}=1$. Итак, у нас есть система уравнений в поле $\mathbb{F}_{p}$ :

$$
a_{1} x+b_{1} y=-z, \quad a_{2} x+b_{2} y=-z
$$

Предположим, что определитель системы $a_{1} b_{2}-a_{2} b_{1} \neq 0$. Тогда для любого $z$ существует единственное решение $\left(x_{z}, y_{z}\right)$. системы (12.6). Для $z=0$ очевидно, единственным решением будет $x_{z}=y_{z}=0$, но тройке $(0,0,0)$ не соответствует ни одной точки проективной плоскости. Таким образом, получается $p-1$ тройка $\left(x_{z}, y_{z}, z\right)$, которым как раз соответствует единственный класс эквивалентности - единственная точка проективной плоскости.

Пусть определитель системы (12.6) равен 0 . Тогда существует такое $\lambda$, что $a_{2}=\lambda a_{1}$ и $b_{2}=\lambda b_{1}$. Так как $\left(a_{1}: b_{1}: 1\right) \neq\left(a_{2}: b_{2}: 1\right)$, мы имеем $\lambda \neq 1$. Значит, при $z \neq 0$ система (12.6) не имеет решений. При $z=0$ каждому $x$ соответствует единственное $y=-\frac{a_{1} x}{b_{1}}$. Очевидно, $x=0$ соответствует $y=0$, а остальные решения образуют один класс эквивалентности точку проективной плоскости.
б. У точек $\left(a_{1}: b_{1}: c_{1}\right)$ и $\left(a_{2}: b_{2}: c_{2}\right)$ нет двух одноименных ненулевых координат.
Тогда домножением на подходящие множители и перестановкой координат можно привести наши точки к виду $(a: 1: 0)$ и $(0: 0: 1)$, а уравнения принимают вид $z=0$ и $a x=-y$. Легко понять, что единственным решением системы в этом случае будет точка $(1:-a: 0)$.

Нам понадобится лемма из теории чисел о количестве решений некоторого уравнения в $\mathbb{F}_{p}$. В этом разделе можно было бы ограничиться простой оценкой, но для изложения конструкции графов без $K_{3,3}$ все равно

нужен полный вариант. Подразумеваются известными знания о том, что такое квадратичные вычеты (их можно найти в книге И. М. Виноградова "Основы теории чисел" [48]). Если Вы не любите теорию чисел, лучше следующую лемму пропустить.

Лемма 12.3. Для нечетного $p \in \mathbb{P}$ рассмотрим уравнение в $\mathbb{F}_{p}$

$$
x^{2}+y^{2}+z^{2}=\alpha
$$

относительно $x, y, z$. Тогда выполняются слежуюшие утверждения.

1) Если $p \equiv 1(\bmod 4)$, то уравнение (12.7) имеет :

- $p^{2}$ решений при $\alpha=0$;
- $p^{2}+p$ решений, если $\alpha-$ квадратичный вычет;
- $p^{2}-p$ решений, если $\alpha-$ квадратичный невычет.

1) Если $p \equiv 3(\bmod 4)$, то уравнение (12.7) имеет :

- $p^{2}$ решений при $\alpha=0$;
- $p^{2}-p$ решений, если $\alpha-$ квадратичный вычет;
- $p^{2}+p$ решений, если $\alpha-$ квадратичный невычет.

Доказательство. Начнем с двух утвержений для произвольного нечетного $p$.
a. Уравнение $x^{2}-y^{2}=\beta$ имеет в $\mathbb{F}_{p}$ ровно $2 p-1$ решений при $\beta=0$ и по $p-1$ решению для всех $\beta \neq 0$.

Доказательство. Случай $\beta=0$ тривиально проверяется, а в остальных случаях уравнение принимает вид $(x-y)(x+y)=\beta$, тогда для каждого $x-y=\gamma \neq 0$ однозначно находится $x+y=\frac{\beta}{\gamma}$, после чего однозначно находятся $x$ и $y$.
b. Уравнение

$$
x^{2}+y^{2}-z^{2}=\alpha \quad \Longleftrightarrow \quad x^{2}=\alpha-\left(y^{2}-z^{2}\right)
$$

имеет $p^{2}$ решений при $\alpha=0, p(p-1)$ решений, если $\alpha-$ квадратичный невычет и $p(p+1)$ решений, если $\alpha-$ квадратичнй вычет.

Доказательство. Отметим, что при любом нечетном $p$ количество решений уравнения (12.8) одинаково для всех квадратичных вычетов $\alpha$ и одинаково для всех квадратичных невычетов $\alpha$. В само деле, частное двух квадратиных вычетов или двух квадратичных невычетов является квадратичным вычетом, а значит, при любом $\alpha$ и $\alpha^{\prime}$ в одном из этих классах решения уравнения для этих параметров получаются друг из друга домножением на квадратный корень из $\frac{\alpha}{\alpha^{\prime}}$.

Если $\alpha=0$, то существует $2 p-1$ пара $(y, z)$, для которой $x^{2}=0$ и для каждого квадратичного вычета $\gamma$ по $p-1$ паре $(y, z)$, для которых $x^{2}=\gamma$ (каждая такая пара дает по 2 решения). Так как есть $\frac{p-1}{2}$ квадратичных вычетов, мы получаем $2 p-1+2(p-1)\left(\frac{p-1}{2}\right)=p^{2}$ решений.

Пусть $\alpha$ - квадратичный невычет. Тогда $\alpha-\left(y^{2}-z^{2}\right)$ принимает значения 0 и квадратичного вычета только при ненулевых значениях $y^{2}-z^{2}$, каждое из которых принимается $p-1$ раз. Так как 0 даст нам одно решение, а каждый из $\frac{p-1}{2}$ квадратичных вычетов - по два решения, мы получим $p(p-1)$ решений уравнения (12.8).

Так как для всех квадратичных вычетов $\alpha$ решений поровну, нетрудно подсчетом проверить, что их будет ровно по $p(p+1)$.

Перейдём к доказательствам утверждений леммы.

1) Так как $(-1)$ - квадратичный вычет по модулю $p \equiv 1(\bmod 4)$, то $z^{2}=-t^{2}$ и уравнение можно переписать в виде

$$
x^{2}+\left(y^{2}-t^{2}\right)=\alpha \quad \Longleftrightarrow \quad x^{2}=\alpha-\left(y^{2}-t^{2}\right)
$$

а это уравнение вида (12.8). Теперь утверждения пункта 1 напрямую следуют из утверждения b.
1) Случай $p=4 k+3$ более сложен. Пусть сначала $\alpha=0$. Существует всего $p^{2}$ вариантов подставить $x$ и $y$ в $f(x, y)=x^{2}+y^{2}$. Ровно в одном случае $x=y=0$ получается $f(x, y)=0$ (так как $(-1)$ - квадратичный невычет). Нам нужно, чтобы было $f\left(x^{2}, y^{2}\right)=-z^{2}$ - а это квадратичный невычет.

Сначала найдем количество таких пар $(x, y)$, что $f(x, y)$ - квадратичный вычет. Для этого решим уравнение $x^{2}+y^{2}=z^{2}$ : оно приводится к виду $(x-z)(x+z)=-y^{2}$. Как уже сказано выше, при $y=0$ мы имеем $2 p-1$ решение, при всех остальных $y$ - по $p-1$ решению, всего получается $p^{2}$ решений. Ровно в одном случае (при $x=y=0$ ) получаем $z=0$, в остальных $p^{2}-1$ случаях получается, что $z$ - квадратичный вычет, причем каждое решение уравнения $x^{2}+y^{2}=\beta$, где $\beta-$ квадратичный вычет, посчитано дважды (если $z^{2}=\beta$, то и $(-z)^{2}=\beta$ ). Значит, ровно в $\frac{p^{2}-1}{2}$ случаях $f(x, y)$ принимает значение - квадратичный вычет. Тогда ровно в $p^{2}-1-\frac{p^{2}-1}{2}=\frac{p^{2}-1}{2}$ случаях $f(x, y)$ равняется квадратичному невычету. Если $\beta-$ квадратичный невычет, то $\beta=-z^{2}=-(-z)^{2}$ ровно для одного $z$, поэтому, интересующее нас уравнение $x^{2}+y^{2}=-z^{2}$ имеет ровно $1+2 \cdot \frac{p^{2}-1}{2}=p^{2}$ решений.

Пусть теперь $\alpha=t^{2}$ - квадратичный вычет. Для всех квадратичных вычетов $\alpha$ количество решений уравнения (12.8) одинаково, поэтому, до-

статочно решить уравнение

$$
x^{2}+y^{2}+z^{2}=t^{2} \quad \Longleftrightarrow \quad x^{2}=-z^{2}+(t-y)(t+y)
$$

для ненулевых $t$ и поделить количество решений на $p-1$. Сначала забудем об условии $t \neq 0$ и зафиксируем $z$. По утверждению b, при $z=0$ мы имеем $p^{2}$ решений, а при $z \neq 0$ мы имеем $p(p-1)$ решений (так как $\left(-z^{2}\right)$ - квадратичный невычет при $z \neq 0$ ). Всего получаем $p^{2}+p(p-1)^{2}$ решений уравнения (12.9). По доказанному выше, из них ровно $p^{2}$ решений имеют $t=0$, остается $p(p-1)^{2}$ решений с $t \neq 0$. Поделив на $p-1$, получим нужное нам количество.

Так как для всех квадратичных невычетов $\alpha$ решений поровну, нетрудно подсчетом проверить, что их будет ровно по $p(p+1)$.

Следствие 12.3. Для любого нечетного р существует ровно $p+1$ такая точка $(a: b: c)$ на проективной плоскости $R_{p}$, что $(a: b: c) \in \ell_{a: b: c}$.

Доказательство. На этот раз нам надо оценить количество таких точек проективной плоскости, что $a^{2}+b^{2}+c^{2}=0$. По лемме 12.3 это уравнение имеет $p^{2}$ решений в $\mathbb{F}_{p}$. Одно из них - это $x=y=z=0$, его не нужно рассматривать. Ясно, что все остальные $p^{2}-1$ решений разбиваются на классы эквивалентности (точки проективной плоскости), поэтому мы получаем $p+1$ точку.

Перейдем к построению примера графа $G_{p}$ без $K_{2,2}$ на основе проективной плоскости $R_{p}$ для нечетного $p$. Впервые эта серия примеров была опубликована Ковари, Шош и Тураном в 1954 году [17]. Поставим в соответствие каждой точке проективной плоскости ( $a: b: c$ ) вершину $v_{a: b: c}$. Соединим ребром вершины $v_{a: b: c}$ и $v_{x: y: z}$ при $a x+b y+c z=0$ (кроме случаев, в которых образуются петли). Тогда вершина $v_{a: b: c}$ соединена с $p+1$ вершинами, соответствующими точкам прямой $\ell_{a: b: c}$. По свойству 3 из леммы 12.2 две прямые проективной плоскости имеют ровно одну общую точку (а никак не две!), следовательно, $G_{p}$ не содержит $K_{2,2}$. Отметим, что непроведенные нами петли соответствуют таким точкам $(a: b: c)$, что $(a: b: c) \in \ell_{a: b: c}$, а таких точек на проективной плоскости по следствию 12.3 ровно $p+1$. Таким образом,

$$
v\left(G_{p}\right)=p^{2}+p+1, \quad e\left(G_{p}\right)=\frac{\left(p^{2}+p+1\right)(p+1)-p-1}{2}=\frac{p(p+1)^{2}}{2}
$$

Мы получили классический пример графа без $K_{2,2}$, в котором количество ребер очень близко к оптимальной оценке (12.4). Подставив $v=p^{2}+p+1$ в неравенство (12.4), мы получим для $v=p^{2}+p+1$ разность между верхней и нижней оценками всего лишь $\frac{p+1}{2}$, что по порядку

примерно $\sqrt{v}$. С помощью теоретико-числовых фактов о плотности расположения простых чисел и приведенного примера мы можем вывести асимптотику ех $\left(v, K_{2,2}\right)$ при $v \rightarrow \infty$. Однако, сначала мы построим серию примеров графов без $K_{2, n}$.

# 12.2.4 Корни из единицы в $\mathbb{F}_{q}$ и графы без $K_{2, n+1}$ 

Мы опишем несложную алгебраическую конструкцию, дающую серию примеров графов без $K_{2, n+1}$. Эту конструкцию придумал Фюреди в 1996 году. Пусть $p \in \mathbb{P}, n \in \mathbb{N}, q=p^{\varphi(n)}$ (через $\varphi(n)$, как обычно, мы обозначаем функцию Эйлера).

Рассмотрим конечное поле $\mathbb{F}_{q}$. Поскольку $q-1=\left(p^{\varphi(n)}-1\right) \vdots n$, а $\mathbb{F}_{q}$ - поле разложения многочлена

$$
x^{q}-x=x\left(x^{q-1}-1\right) \vdots x^{n}-1
$$

в этом поле многочлен $x^{n}-1$ раскладывается на линейные множители. Значит, в $\mathbb{F}_{q}$ содержатся все корни $n$-й степени из единицы. Обозначим эти корни через $\varepsilon_{1}, \varepsilon_{2}, \ldots, \varepsilon_{n}$.

Рассмотрим множество упорядоченных пар $(x, y)$ ненулевых элементов поля $\mathbb{F}_{q}$. Введем на этих парах отношение $\sim$ : будем считать, что $\left(x_{1}, y_{1}\right) \sim\left(x_{2}, y_{2}\right)$, если существует такое $i \in[1 . . n]$, что $x_{1}=\varepsilon_{i} x_{2}, y_{1}=\varepsilon_{i} y_{2}$. Легко видеть, что $\sim$ - отношение эквивалентности. В каждом классе эквивалентности будет ровно $n$ пар. Мы будем обозначать класс эквивалентности пары $(a, b)$ через $\langle a, b\rangle$. Обозначим через $M_{n}(p)$ множество всех таких классов эквивалентности. Нетрудно видеть, что в $M_{n}(p)$ ровно $\frac{(q-1)^{2}}{n}$ элементов. Элементы $M_{n}(p)$ мы будем называть точками.

Каждой точке $\langle a, b\rangle$ поставим в соответствие множество $T_{\langle a, b\rangle}$ точек $\langle x, y\rangle$ таких, что $(a x+b y)^{n}=1$. Нетрудно видеть, что определение $T_{\langle a, b\rangle}$ корректно, то есть не зависит от выбора представителя в классе эквивалентности.

Лемма 12.4. 1) Для любой точки $\langle a, b\rangle$ множество $T_{\langle a, b\rangle}$ состоит ровно из $q-2$ точек.
1) Для любых двух разных точек $\langle a, b\rangle u\langle c, d\rangle$ пересечение множеств $T_{\langle a, b\rangle} u T_{\langle c, d\rangle}$ содержит не более $n$ точек.

Доказательство. 1) Рассмотрим произвольный элемент $x \in \mathbb{F}_{q}$. Отметим, что $(a x+b y)^{n}=1$, если и только если $a x+b y=\varepsilon_{i}$ для некоторого $i$. Следовательно, элементы $y_{i}=\frac{\varepsilon_{i}-a x}{b}$ дают $n$ пар $\left(x, y_{i}\right)$ - решений уравнения $(a x+b y)^{n}=1$, и других пар с элементом $x$ на первом месте нет. Аналогично, с каждым фиксированным $y$ на втором месте получится

ровно $n$ пар решений. Поскольку $x=y=0$, очевидно, не является решением нашего уравнения, мы имеем ровно $n(q-2)$ пар решений, в которых оба числа не равны 0 . Очевидно, эти пары разбиваются на $q-2$ класса эквивалентности и дают нам $q-2$ точки.
1) Пусть $\langle x, y\rangle \in T_{\langle a, b\rangle} \cap T_{\langle c, d\rangle}$. Это означает, что

$$
(a x+b y)^{n}=(c x+d y)^{n}=1
$$

Тогда $a x+b y=\varepsilon_{i}(c x+d y)$, откуда

$$
\left(\varepsilon_{i} c-a\right) x=\left(b-\varepsilon_{i} d\right) y
$$

Если одно из этих выражений равно нулю, то второе также равно нулю, и это означает, что $(a, b) \sim(c, d)$, то есть $\langle a, b\rangle=\langle c, d\rangle$. Значит, эти выражения не равны нулю, тогда определено и не равно нулю

$$
k_{i}=\frac{\varepsilon_{i} c-a}{b-\varepsilon_{i} d}
$$

Подставив $y=k_{i} x$ в уравнение (12.10), мы получим $\left(\left(a+b k_{i}\right) x\right)^{n}=1$, что равносильно существованию такого $j \in[1 . . n]$, что $\left(a+b k_{i}\right) x=\varepsilon_{j}$. Это уравнение при $a+b k_{i} \neq 0$ имеет $n$ решений, образующих один класс эквивалентности, при $a+b k_{i}=0$ решений нет. Поскольку есть $n$ вариантов коэффициента $k_{i}$, в пересечении $T_{\langle a, b\rangle} \cap T_{\langle c, d\rangle}$ не более $n$ точек.

Для $v=\frac{(q-1)^{2}}{n}$ мы построим не содержащий подграфа $K_{2, n+1}$ граф $G_{n}(p)$ с $v$ вершинами и количеством ребер, близким к оценке (12.4).

Вершинами $G_{n}(p)$ будут соответствовать точкам из $M_{n}(p)$, и каждую вершину $v_{\langle a, b\rangle}$ мы соединим со всеми такими вершинами $v_{\langle x, y\rangle}$, что $\langle x, y\rangle \in T_{\langle a, b\rangle}$, исключая петли. Количество исключенных петель не превосходит количества таких точек $\langle a, b\rangle$, что $\langle a, b\rangle \in T_{\langle a, b\rangle}$. Это означает, что $\left(a^{2}+b^{2}\right)^{n}=1$, то есть, существует такое $j \in[1 . . n]$, что $a^{2}+b^{2}=\varepsilon_{j}$. Для каждого ненулевого $a \in \mathbb{F}_{q}$ есть не более $2 n$ вариантов выбора $b$, следовательно, количество решений уравнения $\left(a^{2}+b^{2}\right)^{n}=1$ не превосходит $2 n(q-1)$, и они, очевидно, разбиваются на не более, чем $2(q-1)$ точек.

Таким образом, с помощью пункта 1 леммы 12.4 мы получаем

$$
\begin{gathered}
v\left(G_{n}(p)\right)=\frac{(q-1)^{2}}{n} \\
e\left(G_{n}(p)\right) \geq \frac{1}{2} \cdot\left(\frac{(q-2)(q-1)^{2}}{n}-2(q-1)\right)>\frac{1}{2} \cdot\left(n^{1 / 2} \cdot v^{3 / 2}-v\right)
\end{gathered}
$$

Построенный граф $G_{n}(p)$ не будет содержать подграфа $K_{2, n+1}$, так как для любых двух вершин $\langle a, b\rangle$ и $\langle c, d\rangle$ по лемме 12.4 мы имеем

$$
T_{\langle a, b\rangle} \cap T_{\langle c, d\rangle} \leq n
$$

Теорема 12.4. При $v \rightarrow \infty$ и фиксированном $n \in \mathbb{N}$

$$
e x\left(v, K_{2, n+1}\right)=\frac{1}{2} \cdot n^{1 / 2} \cdot v^{3 / 2}+o\left(v^{3 / 2}\right)
$$

Доказательство. Классический результат теории чисел [62, стр.364] говорит нам, что для любого $\varepsilon>0$ и любого достаточно большого $x$, между $x$ и $x+\varepsilon x^{2 / 3}$ есть простое число $p$. Воспользуемся этим фактом.

Тогда для любого $\varepsilon>0$, существует такое $v_{\varepsilon}$, что для любого $v>v_{\varepsilon}$ существует такое $p \in \mathbb{P}$, что

$$
(\sqrt{n v}+1)^{1 / \varphi(n)}>p>(\sqrt{n v(1-\varepsilon)}+1)^{1 / \varphi(n)}
$$

Пусть $v_{p}=\frac{\left(p^{\varphi(n)}-1\right)^{2}}{n}$. Поскольку $v>v_{p}>v(1-\varepsilon)$ и $\operatorname{ex}\left(v, K_{2, n+1}\right)$ не убывает по $v$, выполняется цепочка неравенств

$$
\begin{aligned}
& e x\left(v, K_{2, n+1}\right) \geq e x\left(v_{p}, K_{2, n+1}\right)>\frac{\left(n v_{p}\right)^{3 / 2}}{2}-\left(n v_{p}\right)^{1 / 2}> \\
& \frac{(n v(1-\varepsilon))^{3 / 2}}{2}-(n v)^{1 / 2}>\frac{(n v)^{3 / 2}(1-4 \varepsilon)}{2}-(n v)^{1 / 2}
\end{aligned}
$$

Учитывая оценку сверху из теоремы 12.3 , при переходе к пределу при $\varepsilon \rightarrow 0$ получается доказываемая оценка.

# 12.2.5 Графы без $K_{3,3}$ 

Мы построим серию примеров графов без $K_{3,3}$ на $n$ вершинах с количеством рёбер примерно $\frac{1}{2} n^{5 / 3}$ - то есть, имеющим правильный порядок по $n$ (совпадающий с верхней оценкой из 12.3), но, увы, с другой мультипликативной константой. Эту серию придумал W. G. Brown в 1966 году. Как всегда, поенадобятся небольшие познания из алгебра и теории чисел.

Построим граф $G_{p}$ на $p^{3}$ вершинах, где $p$ - нечетное простое число. Множеством вершин $G_{p}$ будет трёхмерное линейное пространство $\mathbb{F}_{p}^{3}$, мы будем называть элементы этого пространства точками и представлять в виде $x=\left(x_{1}, x_{2}, x_{3}\right)\left(\right.$ где $x_{1}, x_{2}, x_{3} \in \mathbb{F}_{p}$ ). Мы будем применять обозначение $\lambda x=\left(\lambda x_{1}, \lambda x_{2}, \lambda x_{3}\right)$.

Выберем элемент $\alpha$ следующим образом:

- если $p \equiv 1(\bmod 4)$, то $\alpha-$ квадратичный невычет;
- если $p \equiv 3(\bmod 4)$, то $\alpha-$ квадратичный вычет.

Для каждой точки $x \in \mathbb{F}_{p}^{3}$ определим сферу

$$
S(x)=\left\{y \in \mathbb{F}_{p}^{3}: \sum_{i=1}^{3}\left(x_{i}-y_{i}\right)^{2}=\alpha\right\}
$$

По лемме 12.3 в $S(x)$ ровно $p^{2}-p$ элементов, причем, очевидно, $x \notin S(x)$. Положим $x y \in E\left(G_{p}\right)$, если и только если $y \in S(x)$ (или, что то же самое, $x \in S(y))$. Таким образом, степень кадой вершины $x$ в графе $G$ равна $p^{2}-p$ и $e\left(G_{p}\right)=\frac{1}{2} p^{4}(p-1)$, что при $v\left(G_{p}\right)=p^{3}$ имеет порядок $(v(G))^{5 / 3}$.

Проверим, что $G_{p}$ не имеет подграфа $K_{3,3}$.
Определение 12.4. Прямая в $\mathbb{F}_{p}^{3}$ - это множество точек вида $\lambda a+b$, где $\lambda \in \mathbb{F}_{p}, a, b \in \mathbb{F}_{p}^{3}$ и $a \neq 0$.
Замечание 12.1. Таким образом, прямая - это аффинное подпространство размерности 1 пространства $\mathbb{F}_{p}$ (то есть, сдвиг на вектор линейного подпространства размерности 1). Прямая, проходящая через 0 - это линейное подпространство размерности 1.
Лемма 12.5. Ни для какого $x \in \mathbb{F}_{p}^{3}$ сфера $S(x)$ не содержит трёх точек, лежащих на одной прямой.
Доказательство. Пусть сфера $S(x)$ и прямая $\lambda a+b$ пересекаются хотя бы по трем точкам (здесь $x, a, b \in \mathbb{F}_{p}^{3}, \lambda \in \mathbb{F}_{p}$ ). Тогда сфера $S(x-b)$ и прямая $\lambda a$ пересекаются по трем точкам, поэтому, достаточно рассмотреть только случай $b=0$.

Итак, пусть прямая $\lambda a$ и сфера $S(x)$ имеют три общие точки. Тогда квадратное уравнение относительно $\lambda$

$$
\left(a_{1}^{2}+a_{2}^{2}+a_{3}^{2}\right) \lambda^{2}-2\left(a_{1} x_{1}+a_{2} x_{2}+a_{3} x_{3}\right) \lambda+\left(x_{1}^{2}+x_{2}^{2}+x_{3}^{2}\right)=\alpha
$$

имеет хотя бы три решения. Это возможно только в случае, когда

$$
a_{1}^{2}+a_{2}^{2}+a_{3}^{2}=a_{1} x_{1}+a_{2} x_{2}+a_{3} x_{3}=0 \quad \text { и } \quad x_{1}^{2}+x_{2}^{2}+x_{3}^{2}=\alpha
$$

Так как $a \neq 0$, можно не умаляя общности предположить, что $a_{1} \neq 0$. Тогда в силу (12.11) мы имеем

$$
\begin{aligned}
a_{1}^{2} \alpha=a_{1}^{2}\left(x_{1}^{2}\right. & \left.+x_{2}^{2}+x_{3}^{2}\right)=\left(-a_{2} x_{2}-a_{3} x_{3}\right)^{2}+a_{1}^{2}\left(x_{2}^{2}+x_{3}^{2}\right) \\
& =\left(-a_{2} x_{2}-a_{3} x_{3}\right)^{2}-\left(a_{2}^{2}+a_{3}^{2}\right)\left(x_{2}^{2}+x_{3}^{2}\right)=-\left(a_{2} x_{3}-a_{3} x_{2}\right)^{2}
\end{aligned}
$$

откуда следует, что $(-\alpha)$ - квадратичный вычет по модулю $p$. Это противоречит выбору $\alpha$ : при $p \equiv 1(\bmod 4)$ мы знаем, что $(-1)$ - квадратичный вычет, а $\alpha$ - квадратичный вычет, а при $p \equiv 3(\bmod 4)$ известно, что $(-1)$ - квадратичный невычет, а $\alpha$ - квадратичный вычет. В обоих случаях получается, что $(-\alpha)$ - квадратичный невычет по модулю $p$, пртиворечие.

Лемма 12.6. Граф $G_{p}$ не содержит подграфа $K_{3,3}$.
Доказательство. Предположим противное, пусть существует подграф $K_{3,3}$ с долями $\{a, b, c\}$ и $\{x, y, z\}$. Тогда три точки $x, y, z$ являются решениями уравнения (относительно $w$ ):

$$
\sum_{i=1}^{3}\left(w_{i}-a_{i}\right)^{2}=\sum_{i=1}^{3}\left(w_{i}-b_{i}\right)^{2}=\sum_{i=1}^{3}\left(w_{i}-c_{i}\right)^{2}=\alpha
$$

Вычитая эти равенства друг из друга, мы получим, что $x, y$ и $z$ - решения системы
$2 A \cdot\left(\begin{array}{l}w_{1} \\ w_{2} \\ w_{3}\end{array}\right)=\sum_{i=1}^{3}\left(\begin{array}{c}a_{i}^{2}-b_{i}^{2} \\ b_{i}^{2}-c_{i}^{2} \\ c_{i}^{2}-a_{i}^{2}\end{array}\right), \quad$ где $A=\left(\begin{array}{llll}a_{1}-b_{1} & a_{2}-b_{2} & a_{3}-b_{3} \\ b_{1}-c_{1} & b_{2}-c_{2} & b_{3}-c_{3} \\ c_{1}-a_{1} & c_{2}-a_{2} & c_{3}-a_{3}\end{array}\right)$.
Как известно, решения системы линейных уравнений (12.12) с тремя неизвестными образуют аффинное подпространство $W$ пространства $\mathbb{F}_{p}^{3}$ размерности $3-\operatorname{rk}(A)$. По лемме 12.5 , точки $x, y, z \in W$ не лежат на одной прямой (аффинном подпространстве размерности 1), а значит, $\operatorname{dim} W \geq 2$ и $\operatorname{rk} A \leq 1$. Так как точки $a, b, c$ попарно различны, строки матрицы $A$ - ненулевые, значит, $\operatorname{rk}(A)=1$. Это означает, что векторастроки матрицы $A$ (а это $a-b, b-c$ и $c-a$ ) лежат в линейном подпространстве размерности 1 - на проходящей через 0 прямой $\lambda d$ для некоторой ненулевой точки $d \in \mathbb{F}_{p}^{3}$. Тогда точки $a, b, c$ лежат на прямой $\lambda d+a$, что пртиворечит лемме 12.5 .

Аналогично теореме 12.4 докажем оценку на порядок $\operatorname{ex}\left(v, K_{3, n}\right)$.
Теорема 12.5. При $v \rightarrow \infty$ и фиксированном $n \in \mathbb{N}, n \geq 3$, выполнено неравенство

$$
\frac{1}{2} v^{5 / 3}+o\left(v^{5 / 3}\right) \leq e x\left(v, K_{3, n}\right) \leq \frac{1}{2} \cdot(n-1)^{1 / 3} \cdot v^{5 / 3}+o\left(v^{5 / 3}\right)
$$

Доказательство. Классический результат теории чисел [62, стр.364] говорит нам, что для любого $\varepsilon>0$ и любого достаточно большого $x$, между $x$ и $x+\varepsilon x^{2 / 3}$ есть простое число $p$. Следовательно, для любого достаточно большого $v$ существует такое простое число $p$, что

$$
v^{1 / 3}-v^{2 / 9}<p<v
$$

Тогда $v-3 v^{8 / 9}<p^{3}<v$. Из построенной выше серии примеров мы знаем, что $\operatorname{ex}\left(p^{3}, K_{3, n}\right) \geq \operatorname{ex}\left(p^{3}, K_{3,3}\right) \geq \frac{1}{2}\left(p^{5}-p^{4}\right)$. Следовательно,

$$
\begin{aligned}
& \operatorname{ex}\left(v, K_{3, n}\right)>\operatorname{ex}\left(p^{3}, K_{3, n}\right)>\frac{1}{2}\left(p^{5}-p^{4}\right)> \\
& \qquad \frac{1}{2}\left(v-3 v^{8 / 9}\right)^{5 / 3}-\frac{1}{2} v^{4 / 3}=\frac{1}{2} v^{5 / 3}+o\left(v^{5 / 3}\right)
\end{aligned}
$$

при фиксированном $n$ и $v \rightarrow \infty$. Тем самым, первое неравенство теоремы доказано, а второе несложно вывести из оценки, доказанной в теореме 12.3 .

# 12.3 Комментарии 

Начинается глава с элементарного раздела 12.1, в котором доказывается теорема об оценке количества рёбер в графе, удовлетворяющем наследственному свойству. Столь элементраная теорема, как это не удивительно, может дать точную оценку в случае, когда количество рёбер квадратично относительно количества вершин. Пример использования этой техники можно найти в задаче ??: с помощью теоремы о наследственном свойстве можно доказать теорему Турана, правда, это доказательство для произвольного $n$ будет не слишком изящным.

Мы же в разделе 12.2 приводим теорему Турана с гораздо более изящным доказательством Эрдеша, который заодно доказал и единственность экстремального примера.

В задачах о запрещенном подграфе редко можно найти точный максимум количества рёбер, часто удается лишь оценить его. Следующая классическая задача - о запрещенном подграфе $K_{m, n}$. Оценка (см. теорему 12.3) была доказана в [17] еще в 1955 году, там же была описана классическая серия экстремальных примеров для графов без $K_{2,2}$ - на основе проективной плоскости, все это есть в нашей книге. Мне кажется правдоподобным, что эта оценка асимптотически точная (то есть, имеет правильный порядок по количеству вершин $v$ и правильную мультипликативную константу). Много позже, в 1996 году Фюреди [11] построил серию экстремальных примеров для графов без $K_{2, n}$, которая также имеет тот же порядок по количеству вершин и ту же мультипликативную константу при старшем члене, что и оценка из теоремы 12.3). Кроме того, Браун [4] построил в 1966 серию примеров графов без $K_{3,3}$, показывающую, что оценка $\operatorname{ex}\left(v, K_{3, n}\right)$ (где $n \geq 3$ ) из теоремы 12.3 имеет правильный порядок по $v$. При $m, n>3$ серий примеров для графов без $K_{m, n}$, потверждающих хотя бы точность порядка по $v$ в оценке на $\operatorname{ex}\left(v, K_{m, n}\right)$,

на настойщий момент не построено. Таким образом, описание всех трёх известных серий примеров приведено в этой книге. Мне все эти серии представляются очень красивыми. Для построения примеров используется классическая теория чисел (нужно знать, что такое квадратичные вычеты и невычеты), а также элементарная линейная алгебра (системы линейных уравнений и ранг матрицы), но по-моему это не мешает рассказать о них в книге по теории графов. Отмечу, что серия примеров графов без $K_{2, n}$ излагается в книге не по статье Фюреди, а по тексту С. Л. Берлова, который независимо придумал эту серию на четыре года позже. Также можно построить серию экстремальных примеров для графов без $K_{2, n}$ на основе проективной плоскости, см. задачу ?? и статью $[46]$.

# Глава 13 

## Графы и многочлены

## 13.1 Хроматический многочлен

Определение 13.1. Для любого натурального числа $k$ обозначим через $\chi_{G}(k)$ количество правильных раскрасок вершин графа $G$ в $k$ цветов. Функция $\chi_{G}(k)$ называется хроматическим многочленом графа $G$.

Таким образом, $\chi_{G}(\chi(G)) \neq 0$, и $\chi_{G}(k)=0$ для любого натурального числа $k<\chi(G)$.
Лемма 13.1. Пусть графы $G$ и $H$ таковы, что $V(G)=V(H)$, а $E(H)=$ $\{x y: x, y \in V(G), E_{G}(x, y) \neq \varnothing\}$. Тогда $\chi_{G}(k)=\chi_{H}(k)$ для любого $k \in \mathbb{N}$.
Доказательство. Две вершины смежны в $H$, если и только если они смежны в $G$. Поэтому, раскраска вершин является правильной для графа $H$, если и только если она является правильной для $G$.
Лемма 13.2. Пусть $G$ - непустой граф, а $e=u v-$ его ребро. Тогда выполняются следующие утверждения.

1) Если $G$ не имеет кратных рёбер, то $\chi_{G-u v}(k)=\chi_{G}(k)+\chi_{G \cdot u v}(k)$.
2) $\chi_{G-u v}(k)=\chi_{G}(k)+\chi_{G * u v}(k)$.

Доказательство. 1) Разобьем правильные раскраски графа $G-e$ в $k$ цветов на два типа: те, в которых вершины $u$ и $v$ одного цвета (тип 1) и те, в которых вершины $u$ и $v$ разных цветов (тип 2). Нетрудно видеть, что количество раскрасок первого типа равно $\chi_{G \cdot e}(k)$, а количество раскрасок второго типа равно $\chi_{G}(k)$.
1) Как и в доказательстве пункта 1 , разобьем все правильные раскраски графа в $k$ цветов на два типа: те, в которых вершины $u$ и $v$ одного цвета (тип 1) и те, в которых вершины $u$ и $v$ разных цветов (тип 2). Тогда количество раскрасок первого типа равно $\chi_{G * e}(k)$, а количество раскрасок второго типа равно $\chi_{G}(k)$.

Замечание 13.1. Как видно из леммы 13.1, добавление кратных рёбер между парой смежных вершин $u$ и $v$ не имеет значения для количества правильных раскрасок графа. Казалось бы, а зачем вообще рассматривать кратные рёбра при обсуждении правильных раскрасок и хроматического многочлена? Это станет видно дальше, когда мы найдем связь между раскрасками и потоками, хроматическим многочленом и многочленом Татта. Там без кратных ребер не обойтись.

А в этом разделе кратные рёбра нам не нужны. Между тем, все следующие факты верны и для графов с кратными рёбрами. Благодаря лемме 13.1, в доказательствах будет достаточно рассмотреть лишь случай, когда кратных рёбер и петель в графе нет.

Теорема 13.1. Для любого графа $G$ без петель выполнены следующие утверждения.

1) Функиия $\chi_{G}(k) \in \mathbb{Z}[k]$ - унитарный многочлен с целыми коэффиииентами, степени $v(G)$.
2) Знаки коэффиииентов $\chi_{G}(k)$ чередуются (то есть, старший коэффиииент не меньше нуля, следующий не больше нуля, далее опять не меньше нуля и так далее).

Доказательство. Мы будем доказывать оба утверждения индукцией по количеству вершин и ребер графа $G$. А именно, доказывая утверждение для графа $G$, мы будем считать его справедливым для всех графов с меньшим числом вершин и для графов на $v(G)$ вершинах с меньшим чем $e(G)$ количеством ребер. Как сказано выше, можно считать, что кратных рёбер в графе нет.

Базу докажем для пустого графа $\bar{K}_{n}$ : понятно, что $\chi_{\bar{K}_{n}}(k)=k^{n}$, а значит, все утверждения теоремы выполнены. Пусть $G$ - непустой граф, а $e$ - его ребро. Тогда по лемме 13.2 мы имеем $\chi_{G}(k)=\chi_{G-e}(k)-\chi_{G e}(k)$. Так как $e(G \cdot e)=v(G)-1, v(G-e)=v(G)$ и $e(G-e)<e(G)$, для графов $G \cdot e$ и $G-e$ уже доказаны все утверждения теоремы: $\chi_{G-e}(k)-$ унитарный многочлен степени $v(G)$, а $\chi_{G \cdot e}(k)$ - унитарный многочлен степени $v(G)-1$. Из чередования знаков коэффициентов этих двух многочленов очевидно следует утверждение про чередование знаков коэффициентов $\chi_{G}(k)$.

Замечание 13.2. Как видно из утверждения теоремы 13.1, функция $\chi_{G}(k)$ совершенно справедливо называется хроматическим многочленом графа $G$.

# 13.1.1 Корни хроматического многочлена 

Лемма 13.3. Пусть $G_{1}, \ldots, G_{n}$ - все компоненты графа $G$. Тогда

$$
\chi_{G}(k)=\prod_{i=1}^{n} \chi_{G_{i}}(k)
$$

Доказательство. Очевидно ввиду того, что при правильной раскраске вершин графа вершины разных компонент можно красить независимо друг от друга. Следовательно, произведение количеств правильных раскраскок графов $G_{1}, \ldots, G_{n}$ в $k$ цветов есть количество правильных раскрасок вершин графа $G$ в $k$ цветов.
Теорема 13.2. Для любого графа $G$ число 0 является корнем $\chi_{G}(k)$ кратности, равной количеству компонент связности графа $G$.
Доказательство. Легко видеть, что 0 является корнем хроматического многочлена любого графа. Это очевидно из определения: правильных раскрасок в 0 цветов не бывает. Ввиду леммы 13.3 достаточно доказать, что для связного графа $G$ кратность корня 0 у $\chi_{G}(k)$ равна 1.

Пусть $v(G)=n$. Индукцией по количеству вершин докажем для связного графа $G$, что коэффициент при $k$ многочлена $\chi_{G}(k)$ не равен 0 и имеет такой же знак как $(-1)^{n-1}$. База для $n=1$ очевидна.

Докажем переход. Пусть $G$ - связный граф с $v(G)=n \geq 2$, для меньшего количества вершин утверждение доказано, а $T$ - остовное дерево графа $G$. Нетрудно понять, что $\chi_{T}(k)=k(k-1)^{n-1}$ (задача ??).

Тогда существует последовательность графов $G_{0}=T, \ldots G_{n}=G$, в которой граф $G_{i+1}$ получается из $G_{i}$ добавлением ребра $e_{i}$. Пусть $a_{i}-$ коэффициент при $k$ многочлена $\chi_{G_{i}}(k)$. Докажем по индукции, что $a_{i} \neq 0$ и имеет такой же знак, как $(-1)^{n-1}$. База для $i=0$ очевидна из приведенной выше формулы.

Докажем переход. Пусть коэффициент $a_{i} \neq 0$ и имеет знак $(-1)^{n-1}$. По лемме 13.2 мы имеем

$$
\chi_{G_{i+1}}(k)=\chi_{G_{i}}(k)-\chi_{G_{i} \cdot e_{i}}(k)
$$

Отметим, что у многочлена $\chi_{G_{i} \cdot e_{i}}(k)$ по индукционному предположению знак коэффициента $b$ при $k$ такой же, как у $(-1)^{n-2}$, то есть, отличается от знака $a_{i}$. Поэтому $a_{i+1}=a_{i}-b$ имеет такой же знак, как $a_{i}$ и отличен от 0 .

Лемма 13.4. Пусть $G$ - связный граф с п блоками $B_{1}, \ldots, B_{n}$. Тогда

$$
\chi_{G}(k)=\left(\frac{1}{k}\right)^{n-1} \cdot \prod_{i=1}^{n} \chi_{B_{i}}(k)
$$

Доказательство. Докажем утверждение индукцией по количеству блоков в графе $G$. База для двусвязного графа, который является своим единственным блоком, очевидна.

Докажем переход. Пусть в графе $G$ хотя бы два блока. Тогда по замечанию 1.9 у графа $G$ есть крайний блок, содержащий ровно одну точку сочленения - пусть это блок $B_{n}$ и содержит он точку сочленения $a$. В графе $G^{\prime}=G-\operatorname{Int}\left(B_{n}\right)$ ровно на один блок меньше: исчез блок $B_{n}$, остальные блоки не изменились. По индукционному предположению, доказываемая формула верна для графа $G^{\prime}$ :

$$
\chi_{G^{\prime}}(k)=\left(\frac{1}{k}\right)^{n-2} \cdot \prod_{i=1}^{n-1} \chi_{B_{i}}(k)
$$

Докажем, что $\chi_{G}(k)=\frac{1}{k} \cdot \chi_{G^{\prime}}(k) \cdot \chi_{B_{n}}(k)$, откуда немедленно следует доказываемое утверждение для графа $G$. Рассмотрим любую правильную раскраску $\rho$ графа $G^{\prime}$ в $k$ цветов и попробуем докрасить вершины блока $B_{n}$ с соблюдением правильности. Единственное ограничение, которое накладывается на раскраску блока $B_{n}$ - зафиксирован цвет вершины $a$, что уменьшает количество раскрасок блока $B_{n}$ ровно в $k$ раз. Эти соображения немедленно доказывают нужную нам формулу.

Теорема 13.3. (E. G. Whitehead, L.-C. Zhao, 1984.) Пусть $G$ - связный граф с более чем одной вершиной. Тогда число 1 является корнем многочлена $\chi_{G}(k)$ кратности, равной количеству блоков графа $G$.

Доказательство. В каждом блоке графа $G$, очевидно, хотя бы две вершины. Ввиду леммы 13.4 достаточно доказать, что у хроматического многочлена двусвязного графа $H$ число 1 является корнем кратности ровно 1. Тогда из доказанной в лемме 13.4 формулы будет следовать утверждение теоремы.

Сначала отметим, что двусвязный граф $H$ на хотя бы двух вершинах невозможно правильно покрасить в 1 цвет, следовательно, 1 является корнем хроматического многочлена такого графа. Остается показать, что кратность этого корня равна 1. Для этого достаточно доказать, что $\chi_{H}^{\prime}(1) \neq 0$. Точнее, мы покажем, что для двусвязного графа $H$ на $m$ вершинах знак $\chi_{H}^{\prime}(1)$ такой же, как у $(-1)^{m}$.

Доказательство будет индукцией по количеству рёбер графа $H$. Приступая к доказательству для графа с $m$ вершинами мы будем считать утверждение доказанным для всех двусвязных графов с меньшим числом вершин.

Если $H$ - это полный граф на трёх вершина, то утверждение несложно проверить. Пусть $H$ неизоморфен $K_{3}$. Тогда по теореме 5.15 существу-

ет такое ребро $e \in E(H)$, что граф $H \cdot e$ двусвязен. Применим доказанную в лемме 13.2 формулу:

$$
\chi_{H}^{\prime}(1)=\chi_{H-e}^{\prime}(1)-\chi_{H \cdot e}^{\prime}(1)
$$

Так как $v(H \cdot e)=m-1$ и граф $H \cdot e$ двусвязен, мы можем утверждать, что $\chi_{H \cdot e}^{\prime}(1) \neq 0$ и имеет тот же знак, что и $(-1)^{m-1}$. Граф $H-e$ имеет меньше рёбер, чем $H$, поэтому, если граф $H-e$ двусвязен, то уже доказано, что $\chi_{H-e}^{\prime}(1)$ имеет тот же знак, что и $(-1)^{m}$.

Если же граф $H-e$ не двусвязен, то он связен и имеет хотя бы два блока и для него верна формула из леммы 13.4. Однако, как показано выше, хроматический многочлен каждого блока имеет своим корнем 1 и поэтому для недвусвязного графа $H-e$ его хроматический многочлен имеет 1 корнем кратности хотя бы 2 , то есть, в этом случае $\chi_{H-e}^{\prime}(1)=0$. Все доказанное выше позволяет сделать вывод, что $\chi_{H}^{\prime}(1) \neq 0$ и имеет тот знак, что нам нужен.

Следствие 13.1. Пусть $G$ - граф с более чем одной вершиной. Тогда число 1 является корнем $\chi_{G}(k)$ кратности, равной количеству блоков графа $G$, состоящих более чем из одной вершины.

Доказательство. В каждой компоненте графа $G$, содержащей хотя бы две вершины, любой блок содержит хотя бы две вершины. Поэтому доказываемое утверждение следует из леммы 13.3 и теоремы 13.3.

# 13.2 Потоковый многочлен 

В этом разделе $G$ - граф, в котором возможны петли и кратные рёбра. Будут использоваться определения циркуляции и потока, данные в разделе 10.2 .

### 13.2.1 Существование потокового многочлена

Определение 13.2. Пусть $G$ - граф, а $H$ - абелева группа. Через $\Phi_{G}(H)$ обозначим количество $H$-потоков графа $G$.

Следующая лемма, перекликающаяся с пунктом 2 леммы 13.2, совсем не удивительна. Однако, доказать аналогичный результат для графов без кратных рёбер (то есть, для стягивания, игнорирующего кратные рёбра), как в пункте 1 леммы 13.2 , на этот раз не получается.

Лемма 13.5. Пусть $G$ - граф, а е $=u v \in E(G)$ - не петля. Тогда

$$
\Phi_{G}(H)=\Phi_{G * e}(H)-\Phi_{G-e}(H)
$$

Доказательство. Для графа Г обозначим через $P_{\Gamma}$ множество всех $H$-потоков в Г. Определим два множества $H$-циркуляций в графе $G$. Пусть $S_{0}$ - множество всех $H$-циркуляций графа $G$, равных 0 на ребре $e$ и невырожденных на остальных рёбрах графа $G$, а $S$ - множество всех $H$-циркуляций графа $G$, невырожденных на всех отличных от $e$ рёбрах (и, возможно, равных 0 на ребре $e$ ). Понятно, что $P_{G}=S \backslash S_{0}$. Таким образом, достаточно доказать, что $|S|=\left|P_{G * e}\right|$ и $\left|S_{0}\right|=\left|P_{G-e}\right|$. Вспомним, что фактически циркуляции определены на рёбрах, то есть, на всех тройках $(u, v, r)$, где $u$ и $v$ - концы $r$ (именно значения на таких тройках нужно указывать), а на остальных тройках автоматически равны 0 . Мы не будем об этом лишний раз напоминать.

Утверждение $\left|S_{0}\right|=\left|P_{G-e}\right|$ очевидно следует из определения потока и циркуляции. Действительно, $V(G)=V(G-e)$, а $E(G-e)=E(G) \backslash\{e\}$. Поэтому, каждый поток $f \in P_{G-e}$ можно доопределить на ребре $e$ (положить $f(x, y, e)=f(y, x, e)=0)$ и получить циркуляцию из $S_{0}$. Наоборот, в каждой такой циркуляции нужно просто убрать значения с ребром $e$.

Докажем, что $|S|=\left|P_{G * e}\right|$. Как уже говорилось, существует естественная биекция между $E(G) \backslash\{e\}$ и $E(G * e)$, мы будем похоже обозначать соответствующие друг другу ребра этих множеств: пусть всегда рёбра $r \in E(G) \backslash\{e\}$ и $r^{\prime} \in E(G * e)$ соответствуют друг другу. Для каждой вершины $v \in V(G)$ обозначим через $v^{\prime}$ соответствующую вершину графа $G^{*}$. А именно, если $u \notin\{x, y\}$, то $u^{\prime}=u$. Если же $u \in\{x, y\}$, то $u^{\prime}=x * y$. (В случае, когда $\{u, v\}=\{x, y\}$, ребру $r=x y$, отличному от $e$, соответствует петля в $G * e$ на вершине $x * y$.)

Пусть $f^{\prime} \in P_{G * e}$. Поставим в соответствие потоку $f^{\prime}$ циркуляцию $f$ графа $G$, определив ее на всех отличных от $e$ рёбрах так же как $f^{\prime}$. А именно, если $r=u v \in E(G)$ и $r \neq e$, то положим $f(u, v, r)=f^{\prime}\left(u^{\prime}, v^{\prime}, r^{\prime}\right)$. Пусть $f(w)=\sum_{u \neq w} f(w, u)$ и $f^{\prime}\left(w^{\prime}\right)=\sum_{u^{\prime} \neq w^{\prime}} f\left(w^{\prime}, u^{\prime}\right)$. (Пока что $f(x, y, e)$ и $f(y, x, e)$ не определены и во всех следующих суммах не учитываются!) Из условия ( $f 3$ ) для графа $G * e$ и потока $f^{\prime}$ следует, что $f(u)=f^{\prime}(u)=0$ для всех $u \in V(G) \backslash\{x, y\}$ и $0=f^{\prime}(x * y)=f(x)+f(y)$. Значит, $f(x)=-f(y)$. Тогда, положив $f(x, y, e)=-f(x)$ и $f(y, x, e)=-f(y)$, мы добьемся выполнения условия $(f 3)$ в вершинах $x$ и $y$ и получим циркуляцию $f \in S$.

Обратное отображение строится проще. Для $f \in S$ нужно просто убрать из определения все тройки, имеющие ребро $e$ и положить для остальных троек $f^{\prime}\left(u^{\prime}, v^{\prime}, r\right)=f(u, v, r)$. Условие $(f 3)$ для $f^{\prime}$ во всех вершинах, кроме $u * v$, следует из условия $(f 3)$ в графе $G$. Сумма из условия $(f 3)$ для $f^{\prime}$ в вершине $x * y$ получается суммированием соответствующих сумм потока $f$ в вершинах $x$ и $y$ : слагаемые $f(x, y, e)$ и $f(y, x, e)$ в сумме дают 0 и сокращаются, остальные остаются. Таким образом, $f$ - цирку-

ляция, причем невырожденная на всех рёбрах, то есть, поток в $G * e$.
Для $k$-потоков аналогичная лемма, к сожалению, неверна.
Следующая теорема покажет нам, что количество $H$-потоков зависит только от размера абелевой группы $H$.

Теорема 13.4. (W. T. Tutte, 1954.) Для графа $G$ существует такой многочлен $\varphi_{G} \in \mathbb{Z}[k]$, что для любой конечной абелевой группы $H$ выполнено $\Phi_{G}(H)=\varphi_{G}(|H|)$.

Доказательство. Индукция по размеру графа $G$. Доказывая утверждение для $G$, будем считать его доказанным для всех меньших графов. Пусть $e \in E(G)$ - не петля. Для графов $G-e$ и $G * e$ теорема доказана, а по лемме 13.5 мы имеем

$$
\Phi_{G}(H)=\Phi_{G * e}(H)-\Phi_{G-e}(H)=\varphi_{G * e}(|H|)-\varphi_{G-e}(|H|)
$$

а последние две функции по индукционному предположению являются многочленами с целыми коэффициентами. Значит, нам подойдет многочлен $\varphi_{G}(k)=\left(\varphi_{G * e}-\varphi_{G-e}\right)(k)$.

Остается доказать базу - рассмотреть случай, когда все рёбра $G$ петли. Значение потока на петле может быть каким угодно, то есть, одним из $|H|-1$. Поэтому $\Phi_{G}(H)=(|H|-1)^{e(G)}$, в этом случае нам подходит многочлен $\varphi_{G}(k)=(k-1)^{e(G)}$. Теорема доказана.

Непосредственно из доказательства теоремы 13.4 следует, что потоковые многочлены удовлетворяют следующему соотношению.

Следствие 13.2. Пусть $G-$ граф, а е $=u v \in E(G)-$ не петля. Тогда

$$
\varphi_{G}(k)=\varphi_{G * e}(k)-\varphi_{G-e}(k)
$$

Определение 13.3. Многочлен $\varphi_{G}(k)$ из теоремы 13.4 называется потоковым многочленом графа $G$.

Следствие 13.3. Пусть $G-$ граф, а $H-$ абелева группа порядка $k$. Тогда $\Phi_{G}(H)>0$, если и только если $G$ имеет $k$-поток.

Доказательство. По теореме 13.4 мы имеем $\Phi_{G}(H)=\varphi(k)=\Phi_{G}\left(\mathbb{Z}_{k}\right)$. По теореме 10.5 , граф $G$ имеет $\mathbb{Z}_{k}$-поток, если и только если он имеет $k$-поток.

Отметим, что количество $k$-потоков в графе $G$, как правило, не равно $\varphi_{G}(k-1)$.

# 13.2.2 4 и $\mathbb{Z}_{2} \times \mathbb{Z}_{2}$-потоки 

В разделе 10.2.3 мы строили $\left(\mathbb{Z}_{2} \times \mathbb{Z}_{5}\right)$-поток вместо $\mathbb{Z}_{6}$-потока. Это можно было сделать, так как $\mathbb{Z}_{6} \simeq \mathbb{Z}_{2} \times \mathbb{Z}_{3}$. Точно так же, вместо $\mathbb{Z}_{4}$-потока удобно строить $\left(\mathbb{Z}_{2} \times \mathbb{Z}_{2}\right)$-потоки и циркуляции. Однако, $\mathbb{Z}_{4} \not \approx \mathbb{Z}_{2} \times \mathbb{Z}_{2}$, поэтому мы не могли использовать эту группу без доказательства следствия 13.3. Теперь, используя $\left(\mathbb{Z}_{2} \times \mathbb{Z}_{2}\right)$-потоки мы можем доказать три условия существования 4 -потока в графе. Мы будем применять обозначения $V=V(G)$ и $E=E(G)$.

Теорема 13.5. 1) Граф $G$ имеет 4-поток, если и только если

$$
G=G_{1} \cup G_{2}
$$

а оба графа $G_{1}$ и $G_{2}$ имеют только четные степени вершин.
1) Кубический граф $G$ имеет 4 -поток, если и только если $\chi^{\prime}(G)=3$.

Доказательство. В доказательстве будет использоваться эквивалентность существования 4 -потока и $\left(\mathbb{Z}_{2} \times \mathbb{Z}_{2}\right)$-потока, элементы которого можно обозначать как $f(x, y, e)=(a, b)$, где $a, b \in\{0,1\}$. В этом случае будем писать $f(x, y, e)_{1}=a$ и $f(x, y, e)_{2}=b$.

1) $\Rightarrow$. Положим

$$
\begin{aligned}
& E_{1}=\left\{e=x y \in E: f(x, y, e)_{1}=1\right\}, \quad G_{1}=\left(V, E_{1}\right) \\
& \quad E_{2}=\left\{e=x y \in E(G): f(x, y, e)_{2}=1\right\}, \quad G_{2}=\left(V(G), E_{2}\right)
\end{aligned}
$$

Так как $f(x, y) \neq(0,0)$ для любого ребра $x y \in E$, мы имеем $E_{1} \cup E_{2}=E$ и $G_{1} \cup G_{2}=G$. Отметим, что $f(x, y, e)_{1}$ - это $\mathbb{Z}_{2}$-поток в графе $G_{1}$, а значит, граф $G_{1}$ имеет только четные степени вершин по следствию 10.3. Аналогично для графа $G_{2}$.
$\Leftarrow$. По следствию 10.3 , в графах $G_{1}$ и $G_{2}$ существуют $\mathbb{Z}_{2}$-потоки $f_{1}$ и $f_{2}$, соответственно. Дополним эти потоки нулевыми значениями до циркуляций в графе $G$ и положим $f(x, y, e)=\left(f_{1}(x, y, e), f_{2}(x, y, e)\right)$. Так как $e$ принадлежит хотя бы одному из множеств $E_{1}$ и $E_{2}$, мы имеем $f(x, y, e) \neq(0,0)$, то есть, $f-$ это $\left(\mathbb{Z}_{2} \times \mathbb{Z}_{2}\right)$-поток в графе $G$.
1) И на этот раз мы будем считать, что поток принимает значения из $\mathbb{Z}_{2} \times \mathbb{Z}_{2}$. Три цвета реберной раскраски будут тремя ненулевыми элементами $\mathbb{Z}_{2} \times \mathbb{Z}_{2}$.
$\Rightarrow$. Пусть существует поток $f$, тогда для каждого ребра $e=x y \in E$ покрасим это ребро в цвет $f(x, y)$. Так как

$$
f(x, y, e)=-f(x, y, e)=f(y, x, e)
$$

получится корректно определенная рёберная раскраска. Предположим, что она неправильная, то есть, существуют такие рёбра $e=x y$ и $e^{\prime}=x z$, что $f\left(x, y, e_{1}\right)=f\left(x, z, e_{2}\right)$. Пусть $r=x w$ - третье инцидентное $x$ ребро. Тогда из $f(x, y, e)+f\left(x, z, e^{\prime}\right)=0$ и $(f 3)$ следует, что $f(x, w, r)=0$, противоречие.
$\Leftarrow$. Пусть $f(x, y, e)$ равняется числу из $\mathbb{Z}_{2} \times \mathbb{Z}_{2}$, соответствующему цвету ребра $e$. Так как сумма трёх ненулевых элементов из $\mathbb{Z}_{2} \times \mathbb{Z}_{2}$ равна 0 , мы получили $\left(\mathbb{Z}_{2} \times \mathbb{Z}_{2}\right)$-поток.

Теорема 13.6. Каждый 4-рёберно связный граф имеет 4-поток.
Доказательство. Мы будем строить $\left(\mathbb{Z}_{2} \times \mathbb{Z}_{2}\right)$-поток $f$ в 4-реберно связном графе $G$.

По следствию 9.3 существует два непересекающихся остовных дерева $T_{1}$ и $T_{2}$ в графе $G$. Для каждого ребра $e \notin E\left(T_{i}\right)$ граф $T_{i}+e$ имеет единственный цикл $C_{i, e}$, который мы назовем $T_{i}$-циклом (здесь $i \in\{1,2\}$ ). Пусть $C_{i, e}=x_{1} x_{2} \ldots x_{n}$ (нумерация вершин - циклическая по модулю $n$ ), а $e_{j}=x_{j} x_{j+1}$ - ребро этого цикла. Определим $\mathbb{Z}_{2}$-циркуляции: положим $f_{i, e}\left(x_{j}, x_{j+1}, e_{j}\right)=f_{i, e}\left(x_{j+1}, x_{j}, e_{j}\right)=1$ (на остальных рёбрах значения равны 0 ). Пусть

$$
f_{i}(x, y, e)=\sum_{r \notin E\left(T_{i}\right)} f_{i, r}(x, y, e) \quad \text { и } \quad f(x, y, e)=\left(f_{1}(x, y, e), f_{2}(x, y, e)\right)
$$

Очевидно, $f$ - это $\left(\mathbb{Z}_{2} \times \mathbb{Z}_{2}\right)$-циркуляция в графе $G$. Остается доказать, что $f(x, y, e) \neq 0$ для любого ребра $e=x y \in E(G)$. Действительно, из $E\left(T_{1}\right) \cap E\left(T_{2}\right)=\varnothing$ следует, что $e$ не может принадлежать обоим этим множествам. Пусть, скажем, $e=x y \notin E\left(T_{1}\right)$. Тогда ребро $e$ входит ровно в один $T_{1}$-цикл (а именно, в цикл $C_{1, e}$ ), следовательно, $f_{1}(x, y, e)=f_{1, e}(x, y, e)=1$ и $f(x, y, e) \neq 0$.

# 13.2.3 Двойственность потоков и раскрасок 

В этом разделе мы изучим соответствие между правильными раскрасками плоского графа $G$ в $k$ цветов и $\mathbb{Z}_{k}$-потоками двойственного графа $G^{*}$ (см. определения в разделе 6.5).

Лемма 13.6. Пусть $e=x y \in E(G)$. Тогда выполнены следующие утверждения.

1) Если $e-$ мост, то $\varphi_{G}(k)=0$, а $\chi_{G}(k)=(k-1) \cdot \chi_{G * e}(k)$.
2) Если $e-$ петля, то $\varphi_{G}(k)=(k-1) \cdot \varphi_{G-e}(k)$, а $\chi_{G}(k)=0$.

Доказательство. 1) По следствию 10.2 , потоков в графе с мостом нет, поэтому, первое утверждение очевидно. Мост $x y$ - блок графа $G$, а блоки $G * x y$ - все остальные блоки графа $G$ (кроме $G(\{x, y\}$ ). Поэтому, второе утверждение пункта 1 следует из леммы 13.4.
1) Поток на петле может принимать любое значение, кроме 0 - а таких значений ровно $k-1$. Отсюда следует первое утверждение. Правильных раскрасок в графе с петлей не бывает, поэтому, второе утверждение очевидно.

Теорема 13.7. (W. T. Tutte, 1954.) Пусть $G$ - плоский граф, $G^{*}-$ его двойственный граф, а $k \in \mathrm{~N}$. Тогда $\chi_{G}(k)=k^{e(G)} \cdot \varphi_{G^{*}}(k)$.

Доказательство. Так как и потоки, и раскраски в разных компонентах графа независимы, их количества перемножаются. В виду определения двойственного графа для несвязного плоского графа, утверждение теоремы для несвязного плоского графа следует из утверждения для всех его компонент. Поэтому достаточно рассмотреть случай, когда графы $G$ и $G^{*}$ связны, что мы и сделаем. В этом случае нам нужно доказать, что $\chi_{G}(k)=k \cdot \varphi_{G^{*}}(k)$.

1. Сначала предположим, что граф $G$ имеет петлю $e$. Тогда двойственный ему граф $G^{*}$ имеет мост $e^{*}$, а значит, по лемме 13.6 мы имеем $\chi_{G}(k)=0=k \cdot \varphi_{G^{*}}(k)$.

Будем считать, что для всех меньших чем $G$ связных плоских графов утверждение доказано. Пусть граф $G$ имеет мост $e$. Тогда по лемме 6.6 мы имеем $(G * e)^{*} \simeq G^{*}-e^{*}$. Применив утверждение теоремы для меньшего графа $G * e$, мы получим

$$
\chi_{G * e}(k)=k \cdot \varphi_{G^{*}-e^{*}}(k)
$$

В силу леммы 13.6, доказываемое утверждение получается из (13.1) умножением обеих частей на $k-1$.
1. После доказанного выше остается разобрать случай, когда графы $G$ и $G^{*}$ не имеют ни петель, ни мостов.

Тогда граница каждой грани графов $G$ и $G^{*}$ - цикл (не обязательно простой), а по каждому ребру граничат две разные грани.

Пусть $C_{k}$ - множество всех правильных раскрасок вершин $G$ в $k$ цветов, в которых фиксированная вершина $a$ имеет цвет 1 , а $F_{k}$ - множество всех $\mathbb{Z}_{k}$-потоков в $G^{*}$. Тогда $\left|C_{k}\right|=\frac{1}{k} \chi_{G}(k)$ и нам нужно доказать, что $\left|C_{k}\right|=\left|F_{k}\right|$.

Построим биекцию между $C_{k}$ и $F_{k}$. Пусть $\gamma \in C_{k}$, а $e^{*}=x^{*} y^{*} \in E\left(G^{*}\right)$. Вспомним, как строился двойственный граф $G^{*}$ и ребро $e^{*}$ (раздел 6.5): на соответствующем ему ребре $e=u v \in E(G)$, разделяющем грани $x$ и $y$

графа $G$, была отмечена середина $s$, после чего точки $x^{*}$ и $y^{*}$ на гранях были соединены с $s$. Таким образом, из $s$, чередуясь, выходят половинки ребер $e$ и $e^{*}$. Не умаляя общности будем считать, что порядок выходов по часовой стрелке $s u, s x^{*}, s v, s y^{*}$. Тогда положим

$$
f_{\gamma}\left(x^{*}, y^{*}, e^{*}\right):=\gamma(u)-\gamma(v) \quad \text { и } \quad f_{\gamma}\left(y^{*}, x^{*}, e^{*}\right)=\gamma(v)-\gamma(u)
$$

(см. рисунок 13.1a.) Отметим, что условие ( $f 2$ ) для $f_{\gamma}$ выполнено, а значения $f_{\gamma}$ - ненулевые вычеты из $\mathbb{Z}_{k}$.

Остается проверить условие $(f 3)$ в вершине $x^{*}$. Пусть $e_{1}^{*}=x^{*} y_{1}^{*}, \ldots$, $e_{n}^{*}=x^{*} y_{n}^{*}$ - все рёбра графа $G^{*}$, инцидентные $x^{*}$. Соответствующие им рёбра $e_{1}, \ldots, e_{n}$ различны и образуют цикл - границу грани $x$. Пусть это цикл $v_{1} \ldots v_{n}$ (некоторые вершины могут повторяться). Тогда можно считать, что $e_{i}=v_{i} v_{i+1}$, а вершины цикла указаны в порядке обхода вокруг $x^{*}$ по часовой стрелке (см. рисунок 13.1b). Следовательно,
$f_{\gamma}\left(x^{*}, y_{i}^{*}, e_{i}^{*}\right)=\gamma\left(v_{i}\right)-\gamma\left(v_{i+1}\right) \quad$ и $\sum_{i=1}^{n} f_{\gamma}\left(x^{*}, y_{i}^{*}, e_{i}^{*}\right)=\sum_{i=1}^{n} \gamma\left(v_{i}\right)-\gamma\left(v_{i+1}\right)=0$, что и требовалось доказать.

a

b


C

Рис. 13.1: Поток и раскраска на двойственных парах рёбер
Построим обратное соответствие: пусть $f \in F_{k}$. Нам нужно построить правильную раскраску $\gamma \in C_{k}$. Рассмотрим ребро $e=u v \in E(G)$ и соответствующее ему ребро $e^{*}=x^{*} y^{*} \in E\left(G^{*}\right)$. Сначала построим вспомогательную функцию $\gamma(u, v, e)$ со значениями из $\mathbb{Z}_{k}$ в графе $G$. Зная $f\left(x^{*}, y^{*}, e^{*}\right)$, мы можем восстановить $\gamma(u, v, e)$ : опять отметим общую "середину" $s$ рёбер $e$ и $e^{*}$ и поступим почти так же, как выше: на этот раз $\gamma(u, v, e)=f\left(x^{*}, y^{*}, e^{*}\right)$, если порядок выходов по часовой стрелке $s u, s x^{*}$, $s v, s y^{*}$ (см. рисунок 13.1a).

Докажем вспомогательное утверждение.

Лемма 13.7. Для любого простого цикла $C=u_{1} \ldots u_{m}$ в графе $G$ выполнено

$$
\gamma\left(u_{1}, u_{2}, e_{1}\right)+\cdots+\gamma\left(u_{m}, u_{1}, e_{m}\right)=0
$$

(здесь $e_{i}=u_{i} u_{i+1}-$ ребро иикла). В частности, если $e=u v$ и $e^{\prime}=u v$ - два кратных ребра графа $G$, то $\gamma(u, v, e)=\gamma\left(u, v, e^{\prime}\right)$.

Доказательство. Цикл $C$ делит грани $G$ на два непересекающихся множества $U$ и $W$ (внутри и вне цикла, соответственно). Пусть цикл $C$ обходит вокруг граней из $U$ по часовой стрелке. Тогда для двойственных множеств вершин графа $G^{*}$ мы имеем $E_{G^{*}}\left(U^{*}, W^{*}\right)=\left\{e_{1}^{*}, \ldots, e_{m}^{*}\right\}$. Пусть $e_{i}^{*}=x_{i}^{*} y_{i}^{*}$, где $x_{i}^{*} \in U^{*}, y_{i}^{*} \in W^{*}$ (см. рисунок 13.1c). По нашему построению $\gamma\left(u_{i}, u_{i+1}, e_{i}\right)=f\left(x_{i}^{*}, y_{i}^{*}, e_{i}^{*}\right)$, а значит,

$$
\begin{aligned}
& \gamma\left(u_{1}, u_{2}, e_{1}\right)+\cdots+\gamma\left(u_{m}, u_{1}, e_{m}\right)= \\
& \quad f\left(x_{1}^{*}, y_{1}^{*}, e_{1}^{*}\right)+\cdots+f\left(x_{m}^{*}, y_{m}^{*}, e_{m}^{*}\right)=f\left(U^{*}, W^{*}\right)=0
\end{aligned}
$$

Вернемся к построению раскраски $\gamma$. Построим в графе $G$ нормальное дерево $T$ с корнем $a$. Для любой вершины $w$ рассмотрим $a w$-путь $a=v_{0} \ldots v_{n}=w$ по $T$ (пусть $e_{i}=v_{i} v_{i+1}-$ ребро этого пути, $i \in[0 . . n-1]$ ) и положим

$$
\gamma(w)=1+\gamma\left(v_{0}, v_{1}, e_{0}\right)+\cdots+\gamma\left(v_{n-1}, v_{n}, e_{n-1}\right)
$$

Докажем, что $\gamma(u)-\gamma(w)=\gamma(u, w, e)$ для любого ребра $e=u w \in E(G)$. Тогда, во-первых, $\gamma$ - правильная раскраска из $C_{k}$, а во-вторых, $f=f_{\gamma}$. Из определения нормального дерева следует, что одна из вершин $u$ и $w$ (пусть $u$ ) лежит на пути по $T$ от корня $a$ до другой. Тогда $a w$-путь $a=v_{0} \ldots v_{n}=w$ проходит через вершину $u=v_{i}$, а значит, $v_{i} \ldots v_{n}-$ цикл в графе $G$ (пусть $e_{n}=v_{n} v_{j}$ - последнее ребро этого цикла) и по доказанному выше

$$
\gamma(u, w, e)=\gamma\left(v_{i}, v_{n}, e_{n}\right)=\sum_{j=i}^{n-1} \gamma\left(v_{j}, v_{j+1}, e_{j}\right)=\gamma(u)-\gamma(w)
$$

что и треовалось доказать. Биекция построена.
Отметим важное непосредственное следствие теоремы 13.7.
Следствие 13.4. Для плоского графа $G$ выполнены следуюшие утверждения.

1) $k^{c(G)} \cdot \varphi_{G}(k)=\chi_{G^{*}}(k)$.
2) $\chi(G)=\varphi\left(G^{*}\right) \quad u \quad \varphi(G)=\chi\left(G^{*}\right)=\chi^{*}(G)$.

Доказательство. 1) Следует из теоремы 13.7 для графа $G^{*}$ и его двойственного графа $\left(G^{*}\right)^{*}$, изоморфного $G$. Напомним, что $c(G)=c\left(G^{*}\right)$ по определению двойственного графа.
1) Прямое следствие пункта 1.

Это далеко не единственное следствие теоремы о двойственности потоков и раскрасок. Часто бывает проще построить поток в двойственном графе, чем раскраску в данном плоском графе. Так, из теоремы 13.7 и теоремы 10.6 очевидно следует классическая теорема 6.5 о раскраске вершин триангуляции с четными степенями в 3 цвета (см. упражнение ??).

# 13.2.4 Вычисление хроматического многочлена через потоковый 

В этом разделе мы докажем еще одну теорему о связи хроматического многочлена и потокового - на этот раз, для произвольных графов. Получится формула, позволяющя вычислить хроматический многочлен графа $G$ через потоковые многочлены подграфов, индуцированных на всех подмножествах $E(G)$. Графы могут иметь петли и кратные рёбра.
Теорема 13.8. (Ю. В. Матиясевич, 1977.) Для любого графа $G$ выполнено равенство

$$
\chi_{G}(k)=\frac{(k-1)^{e(G)}}{k^{e(G)-v(G)}} \sum_{A \subseteq E(G)} \frac{\varphi_{G(A)}(k)}{(1-k)^{|A|}}
$$

(подграф $G(\varnothing)$ считаем пустым, а его потоковый многочлен - равным 1).
Доказательство. Докажем теорему по индукции: доказывая утверждение для графа $G$, считаем его верным для всех меньших графов. Начнем с индукционного перехода в случае, когда граф $G$ имеет ребро $e$, не являющееся петлёй. Мы будем пользоваться формулами для хроматического и потокового многочленов через стягивание и удаление ребра. Пусть

$$
X_{G}(k)=\frac{k^{e(G)-v(G)}}{(k-1)^{e(G)}} \cdot \chi_{G}(k), \quad F_{G}(k)=\sum_{A \subseteq E(G)} \frac{\varphi_{G(A)}(k)}{(1-k)^{|A|}}
$$

Мы хотим доказать, что $X_{G}(k)=F_{G}(k)$ для графа $G$. Для меньших графов $G * e$ и $G-e$ это утверждение уже известно. Отметим очевидные, но нужные нам соотношения

$$
v(G * e)=v(G)-1, \quad v(G-e)=v(G), \quad e(G * e)=e(G-e)=e(G)-1
$$

По лемме 13.2 мы знаем, что $\chi_{G}(k)=\chi_{G-e}(k)-\chi_{G * e}(k)$. Вместе с (13.2) это дает

$$
\begin{aligned}
X_{G}(k)=\frac{k}{k-1} X_{G-e}(k)- & \frac{1}{k-1} X_{G * e}(k)= \\
& X_{G-e}(k)-\frac{1}{1-k} \cdot\left(X_{G * e}(k)-X_{G-e}(k)\right)
\end{aligned}
$$

Разобьём все подмножества $E(G)$ на пары $\left(A, A^{\prime}\right)$, где $A \subset E(G-e)$ и $A^{\prime}=A \cup\{e\}$. Пусть $A^{*} \subset E(G * e)$ - двойственное $A$ множество рёбер. Отметим, что

$$
G(A) * e=(G * e)\left(A^{*}\right), \quad(G-e)\left(A^{\prime}\right)=G\left(A^{\prime}\right) \quad \text { и } \quad\left|A^{*}\right|=\left|A^{\prime}\right|=|A|-1
$$

Тогда

$$
\begin{aligned}
& F_{G}(k)=\sum_{E \subseteq E(G)} \frac{\varphi_{G(E)}(k)}{(1-k)^{|E|}}=\sum_{A \subset E(G-e)} \frac{\varphi_{(G-e)(A)}(k)}{(1-k)^{|A|}}+\sum_{A^{\prime} \subset E(G), e \in A^{\prime}} \frac{\varphi_{G\left(A^{\prime}\right)}(k)}{(1-k)^{|A^{\prime}|}} \\
& =F_{G-e}(k)+\sum_{A^{\prime} \subset E(G), e \in A} \frac{\varphi_{G\left(A^{\prime}\right)}(k)}{(1-k)^{|A^{\prime}|}}=X_{G-e}(k)+\sum_{A^{\prime} \subset E(G), e \in A} \frac{\varphi_{G\left(A^{\prime}\right)}(k)}{(1-k)^{|A^{\prime}|}}
\end{aligned}
$$

(в последнем переходе мы воспользовались индукционным предположением для графа $G-e$ ). В силу (13.3), остается доказать, что

$$
\sum_{A^{\prime} \subset E(G), e \in A^{\prime}} \frac{\varphi_{G(A)}(k)}{(1-k)^{|A^{\prime}|}}=-\frac{1}{1-k} \cdot\left(X_{G * e}(k)-X_{G-e}(k)\right)
$$

Для этого воспользуемся формулой $\varphi_{G}(k)=\varphi_{G * e}(k)-\varphi_{G-e}(k)$ из следствия 13.2 , индукционным предположением для графов $G-e$ и $G * e$, а также формулами (13.4).

$$
\begin{gathered}
\sum_{A^{\prime} \subset E(G), e \in A^{\prime}} \frac{\varphi_{G\left(A^{\prime}\right)}(k)}{(1-k)^{|A^{\prime}|}}=\sum_{A^{*} \subset E\left(G^{*} e\right)} \frac{\varphi_{\left(G^{*} e\right)\left(A^{*}\right)}(k)}{(1-k)^{|A^{*}|+1}}-\sum_{A \subset E(G-e)} \frac{\varphi_{(G-e)(A)}(k)}{(1-k)^{|A|+1}}= \\
\quad-\frac{1}{1-k} \cdot\left(F_{G * e}(k)-F_{G-e}(k)\right)=-\frac{1}{1-k} \cdot\left(X_{G * e}(k)-X_{G-e}(k)\right)
\end{gathered}
$$

что и требовалось доказать.
Остается доказать балу для случая, когда все рёбра графа $G$ - петли. Если рёбер нет, то $\chi_{G}(k)=k^{e(G)}$, единственный граф $G(A)$ пуст и его потоковый многочлен равен 1 , откуда очевидно следует доказываемая формула.

Пусть $E(G) \neq \varnothing$. Тогда $\chi_{G}(k)=0$ и нам нужно проверить, что равна нулю и правая часть формулы. Мы воспользуемся тем, что для графа $G$, множество рёбер которого состоит из $m$ петель, $\varphi_{G}(k)=(k-1)^{m}$. Также учтем, что в $E(G)$ можно выбрать подмножество из $m$ петель ровно $\mathrm{C}_{e(G)}^{m}$ способами. Тогда

$$
\sum_{A \subseteq E(G)} \frac{\varphi_{G(A)}(k)}{(1-k)^{|A|}}=\sum_{m=0}^{e(G)} \mathrm{C}_{e(G)}^{m} \frac{(k-1)^{m}}{(1-k)^{m}}=\sum_{m=0}^{e(G)} \mathrm{C}_{e(G)}^{m}(-1)^{m}=0
$$

Утверждение теоремы 13.8 для плоских графов можно переписать, избавившись от потокового многочлена.

Следствие 13.5. Для плоского графа $G$ выполнено равенство

$$
\chi_{G}(k)=\frac{(k-1)^{e(G)}}{k^{e(G)-e(G)}} \sum_{A^{*} \subseteq E\left(G^{*}\right)} \frac{\chi_{G^{*}\left(A^{*}\right)}(k)}{(1-k)^{|A|} \cdot k^{e\left(G^{*}\left(A^{*}\right)\right)}}
$$

Доказательство. Для $A \subset E(G)$ пусть $A^{*} \subset E\left(G^{*}\right)$ - двойственное множество рёбер. Тогда нетрудно заметить, что $G(A)^{*}=G^{*}\left(A^{*}\right)$. По теореме 13.7 мы знаем, что

$$
\varphi_{G(A)}(k)=\frac{\chi_{G(A)^{*}}(k)}{k^{e\left(G(A)^{*}\right)}}=\frac{\chi_{G^{*}\left(A^{*}\right)}(k)}{k^{e\left(G^{*}\left(A^{*}\right)\right)}}
$$

Теперь, заменив в формуле из теоремы 13.8 потоковые многочлены хроматическими многочленами двойственных графов, получим доказываемое утверждение.

# 13.3 Многочлен Татта 

В этом разделе мы будем работать с графами, содержащими петли и кратные рёбра. У графа есть немало характеристик, удовлетворяющих так называемой формуле стягивания-удаления ребер: характеристика графа $G$ выражается как линейная комбинация характеристик графов $G * e$ и $G-e$ (где $e \in E(G)$ ). Например, мы рассматривали хроматический и потоковый многочлены графа, а также количество остовных деревьев связного графа $G$.

Татт определил многочлен $T(G ; x, y)$, как функцию, удовлетворяющую следующим условиям.
$1^{\circ}$ Если $G$ - пустой граф (без рёбер), то $T(G ; x, y)=1$.

$2^{\circ}$ Если $e \in E(G)$ - мост, то $T(G ; x, y)=x \cdot T(G * e ; x, y)$.
$3^{\circ}$ Если $e \in E(G)$ - петля, то $T(G ; x, y)=y \cdot T(G-e ; x, y)$.
$4^{\circ}$ Если ребро $e \in E(G)$ - не мост и не петля, то

$$
T(G ; x, y)=T(G * e ; x, y)+T(G-e ; x, y)
$$

Сразу же понятно, что если функция $T(G ; x, y)$ определена корректно, то для каждого графа $G$ она является многочленом от двух переменных. Корректность определения мы проверим ниже. Отметим, что многочлен Татта содержит много информации о графе $G$, которую можно извлечь, подставляя различные значения переменных $x$ и $y$. Несколько примеров нас ожидают в конце раздела.

# 13.3.1 Многочлен Татта и ранговый многочлен 

Определение 13.4. 1) Подграф графа $G$ назовём остовным лесом, если он состоит из остовных деревьев всех компонент графа $G$. В частности, остовный лес связного графа - это его остовное дерево.
1) Пусть $A \subseteq E(G)$. Рангом множества рёбер $A$ мы назовём $\rho(A)=$ $v(G)-c(G[A])$ - количество рёбер в остовном лесе графа $G[A]$.
2) Для множества рёбер $A \subseteq E(G)$ введём обозначение $p(G, A ; u, v)=$ $u^{\rho(E(G))-\rho(A)} v^{|A|-\rho(A)}$. Определим ранговый многочлен графа $G$ так:

$$
R(G ; u, v)=\sum_{A \subseteq E(G)} u^{\rho(E(G))-\rho(A)} v^{|A|-\rho(A)}=\sum_{A \subseteq E(G)} p(G, A ; u, v)
$$

Этот многочлен придумал Хасслер Уитни, иногда он называется Whitney rank polynomial, в некоторых источниках - corank-nullity polynomial. Мы представим вниманию читателей удобную для применения интерпретацию параметров рангового многочлена.

Определение 13.5. Пусть $A \subseteq E(G)$. Зафиксируем любой остовный лес $F$ графа $G$, содержащий в качестве подграфа остовный лес графа $G[A]$. Назовём все рёбра из $E(F) \backslash A$ важными рёбрами $A$, а все рёбра из $A \backslash E(F)$ лишними рёбрами $A$. Пусть $\rho^{*}(A)$ - количество важных рёбер $A$, а $\bar{\rho}(A)$ - количество лишних рёбер $A$.

Замечание 13.3. Вне зависимости от выбора остовного леса $F$ мы имеем $\rho^{*}(A)=\rho(E(G))-\rho(A)$ и $\bar{\rho}(A)=|A|-\rho(A)$. Таким образом,

$$
p(G, A ; u, v)=u^{\rho^{*}(A)} v^{\bar{\rho}(A)}
$$

Мы будем выбирать остовный лес $F$ так, как это удобно.

Итак, пусть $e \in E(G)$. Как уже отечалось выше, существует биекция стягивания $\varphi: E(G-e) \rightarrow E(G * e)$ (см. определение 1.12). Мы будем отождествлять соответствующие при этой биекции рёбра множеств $E(G-e)$ и $E(G * e)$. Для простоты мы будем обозначать такие рёбра одинаково и считать, что $E(G-e)=E(G * e)$. В свете таких обозначений отметим достаточно очевидный и полезный факт.
Замечание 13.4. Пусть $e \in A^{\prime} \subset E(G), A=A^{\prime} \backslash\{e\}$, а $F_{A^{\prime}}-$ остовный лес графа $G\left[A^{\prime}\right]$. Тогда $\left(F_{A^{\prime}}\right) * e-$ остовный лес графа $G\left[A^{\prime}\right] * e=(G * e)[A]$.

Для множества рёбер $A \subset E(G-e)$ пусть $\rho(A), \rho^{*}(A)$ и $\bar{\rho}(A)$ - это ранги $A$ в графе $G, \rho_{1}(A), \rho_{1}^{*}(A)$ и $\bar{\rho}_{1}(A)$ - ранги в графе $G * e$, а $\rho_{2}(A)$, $\rho_{2}^{*}(A)$ и $\bar{\rho}_{2}(A)$ - ранги в графе $G-e$.

Лемма 13.8. Пусть $e \in A^{\prime} \subset E(G), A=A^{\prime} \backslash\{e\}$. Тогда выполняются следующие утверждения.

1) Если е - не петля, то $\rho^{*}\left(A^{\prime}\right)=\rho_{1}^{*}(A)$ и $\bar{\rho}\left(A^{\prime}\right)=\bar{\rho}_{1}^{*}(A)$.
2) Если е - не мост, то $\rho^{*}(A)=\rho_{2}^{*}(A)$ и $\bar{\rho}(A)=\bar{\rho}_{2}^{*}(A)$.
3) Если е - мост, то $\rho^{*}(A)=1+\rho^{*}\left(A^{\prime}\right)$ и $\bar{\rho}(A)=\bar{\rho}\left(A^{\prime}\right)$.
4) Если е - петля, то $\rho^{*}\left(A^{\prime}\right)=\rho^{*}(A)$ и $\bar{\rho}\left(A^{\prime}\right)=1+\bar{\rho}(A)$.

Доказательство. 1) Так как $e-$ не петля, существует остовный лес $F_{A^{\prime}}$ графа $G\left[A^{\prime}\right]$, содержащий ребро $e$. Пусть $F$ - содержащий $F_{A^{\prime}}$ остовный лес графа $G$. По замечанию 13.4 тогда то $F * e-$ остовный лес графа $G * e$, который содержит остовный лес графа $(G * e)[A]$. При таком выборе остовных лесов важные и лишние рёбра $A^{\prime}$ в графе $G$ соответственно являются важными и лишними рёбрами $A$ в графе $G * e$.
1) Пусть $F_{A}$ - произвольный остовный лес графа $G[A]$. Так как $e-$ не мост, $F_{A}$ можно дополнить до остовного леса $F$ графа $G$, не включая в $F$ ребро $e$. Таким образом, важные и лишние рёбра множества $A$ в графе $G$ те же, что в графе $G-e$.
2) Пусть $F_{A}-$ остовный лес графа $G[A]$. Так как $e-$ мост, то граф $F_{A^{\prime}}=F_{A}+e-$ остовный лес графа $G\left[A^{\prime}\right]$, который можно дополнить до остовного леса графа $G$. Поэтому, множество $A$ имеет на одно важное ребро больше, чем $A^{\prime}$, а лишних рёбер у $A^{\prime}$ и $A$ поровну.
3) Так как $e-$ петля, то у графов $G[A]$ и $G\left[A^{\prime}\right]$ - один и тот же остовный лес $F_{A}$, который можно дополнить до остовного леса графа $G$. Поэтому, множество $A^{\prime}$ имеет на одно лишнее ребро больше, чем $A$, а важных рёбер у $A^{\prime}$ и $A$ поровну.

Следующая теорема покажет связь между $T(G ; x, y)$ и $R(G ; x, y)$. Тем самым, будет доказана корректность определения многочлена Татта.

Теорема 13.9. (W. T. Tutte.) Для произвольного графа $G$ выполняется равенство $T(G ; u+1, v+1)=R(G ; u, v)$.

Доказательство. Нетрудно понять, что для пустого графа $G$ мы имеем $R(G ; u, v)=1$. Нужно проверить, что $R(G ; u, v)$ удовлетворяет условиям $2^{\circ}-4^{\circ}$ из определения многочлена Татта.

Разобьем все подмножества $E(G)$ на пары $\left(A, A^{\prime}\right)$, где $A \subseteq E(G-e)$ и $A^{\prime}=A \cup\{e\}$. Тогда

$$
R(G ; u, v)=\sum_{A \subseteq E(G-e)}\left(p(G, A ; u, v)+p\left(G, A^{\prime} ; u, v\right)\right)
$$

Поэтому нам достаточно для каждого множества $A \subseteq E(G-e)$ проверить выполнение следующих трёх условий.
$(R 2)$ Если $e \in E(G)$ - мост, то

$$
p(G, A ; u, v)+p\left(G, A^{\prime} ; u, v\right)=(u+1) \cdot p(G * e, A ; u, v)
$$

$(R 3)$ Если $e \in E(G)$ - петля, то

$$
p(G, A ; u, v)+p\left(G, A^{\prime} ; u, v\right)=(v+1) \cdot p(G-e, A ; u, v)
$$

$(R 4)$ Если ребро $e \in E(G)$ - не мост и не петля, то

$$
p(G, A ; u, v)+p\left(G, A^{\prime} ; u, v\right)=p(G * e, A ; u, v)+p(G-e, A ; u, v)
$$

Проверка (R2).
Пусть ребро $e \in E(G)$ - мост. Рассмотрим пару множеств рёбер $\left(A, A^{\prime}\right)$. Применив пункты 1 и 3 леммы 13.8 мы получим, что

$$
p\left(G, A^{\prime} ; u, v\right)=p(G * e, A ; u, v) \text { и } p(G, A ; u, v)=u \cdot p\left(G, A^{\prime} ; u, v\right)
$$

откуда следует $(R 2)$.

# Проверка ( $R 3$ ). 

Пусть ребро $e \in E(G)$ - петля. Рассмотрим пару множеств рёбер $\left(A, A^{\prime}\right)$. Применив пункты 2 и 4 леммы 13.8 мы получим, что

$$
p(G, A ; u, v)=p(G-e, A ; u, v) \text { и } p\left(G, A^{\prime} ; u, v\right)=v \cdot p(G, A ; u, v)
$$

откуда следует $(R 3)$.

## Проверка ( $R 4$ ).

Пусть ребро $e \in E(G)$ - не петля и не мост. Рассмотрим пару множеств рёбер $\left(A, A^{\prime}\right)$. Применив пункты 1 и 2 леммы 13.8 мы получим, что

$$
p\left(G, A^{\prime} ; u, v\right)=p(G * e, A ; u, v) \text { и } p(G, A ; u, v)=p(G-e, A ; u, v)
$$

откуда следует $(R 4)$.
Многие значения многочлена Татта (то есть, функции вида $T(G ; \alpha, \beta)$ при фиксированных $\alpha$ и $\beta$ ) имеют комбинаторный смысл, подсчитывая количество каких-либо объектов в графе $G$. Смысл некоторых значений можно понять непостредственно с помощью теоремы 13.9.

Определение 13.6. 1) Обозначим через $s t(G)$ количество остовных лесов графа $G$, у которых $c(H)=c(G)$.
1) Обозначим через $s c(G)$ - количество таких остовных подграфов $H$ графа $G$, у которых $c(H)=c(G)$.
2) Обозначим через $a c(G)$ количество ациклических подграфов $G$ (то есть, таких подмножеств $A \subset E(G)$, что $G[A]$ - лес).

Замечание 13.5. Отметим, что если граф $G$ - связный, то $s t(G)$ количество остовных деревьев графа $G$ (см. раздел 9.1), а $s c(G)$ - количество связных остовных подграфов графа $G$.

Следствие 13.6. Для графа $G$ выполняются следующие утверждения.

1) $s t(G)=T(G ; 1,1)$.
2) $s c(G)=T(G ; 1,2)$.
3) $a c(G)=T(G ; 2,1)$.

Доказательство. По теореме 13.9,

$$
T(G ; x+1, y+1)=R(G ; x, y)=\sum_{A \subseteq E(G)} x^{\rho^{*}(A)} y^{\bar{\rho}(A)}
$$

1) Подставим $x=y=0$ в формулу (13.5) и получим, что $T(G ; 1,1)=$ $R(G ; 0,0)$ - количество подмножеств $A \subseteq E(G)$, удовлетворяющих условию $\rho^{*}(A)=\bar{\rho}(A)=0$. Равенство $0=\rho^{*}(A)=\rho(E(G))-\rho(A)$ означает, что $c(G)=c(G[A])$, а равенство $\bar{\rho}(A)=0$ означает, что у множества $A$ нет лишних рёбер, то есть, $G[A]$ - лес. Таким образом, $T(G ; 1,1)$ равно $s t(G)$.
2) Подставим $x=0, y=1$ формулу (13.5) и получим, что $T(G ; 1,2)=$ $R(G ; 0,1)$ - количество тех подмножеств $A \subseteq E(G)$, у которых $\rho^{*}(A)=0$, что означает $c(G)=c(G[A])$. Таким образом, $T(G ; 1,2)$ равно $s c(G)$.
3) Подставим $x=1, y=0$ в формулу (13.5) и получим, что $T(G ; 2,1)=$ $R(G ; 1,0)$ - количество тех подмножеств $A \subseteq E(G)$, у которых $\bar{\rho}(A)=0$, то есть, $G[A]$ - лес. Таким образом, $T(G ; 1,1)$ равно $a c(G)$.

# 13.3.2 Многочлен Татта и компоненты графа 

Теперь мы знаем, что многочлен Татта определен корректно и можем доказать его важное свойство.

Определение 13.7. Мы будем говорить, что граф $G$ является несвязным объединением графов $G_{1}, \ldots, G_{n}$, если $G=\cup_{i=1}^{n} G_{i}$, причем при $i \neq j$ выполнены условия $V\left(G_{i}\right) \cap V\left(G_{j}\right)=\varnothing$ и $E_{G}\left(V_{i}, V_{j}\right)=\varnothing$.

Замечание 13.6. Очевидно, граф является несвязным объединением своих компонент.

Лемма 13.9. Пусть граф $G$ является несвязным объединением графов $G_{1}, \ldots, G_{n}$. Тогда $T(G ; x, y)=\prod_{i=1}^{n} T\left(G_{i} ; x, y\right)$.

Доказательство. Доказательство будет индукцией по размеру графа, база для пустого графа на любом количестве вершин очевидна.

Докажем переход. Пусть $e \in E(G)$, тогда не умаляя общности можно считать, что $e \in E\left(G_{1}\right)$. Разберём три случая.

1. Ребро $e-$ петля.

Тогда граф $G-e-$ несвязное объединение графов $G_{1}-e, G_{2}, \ldots G_{n}$. Для меньшего графа $G-e$ утверждение выполнено, а значит,

$$
\begin{aligned}
T(G ; x, y)=y \cdot T(G-e ; x, y)= & \left(y \cdot T\left(G_{1}-e ; x, y\right)\right) T\left(G_{2} ; x, y\right) \ldots T\left(G_{n} ; x, y\right) \\
& =T\left(G_{1} ; x, y\right) T\left(G_{2} ; x, y\right) \ldots T\left(G_{n} ; x, y\right)
\end{aligned}
$$

1. Ребро $e-$ мост.

Тогда граф $G * e-$ несвязное объединение графов $G_{1} * e, G_{2}, \ldots G_{n}$. Для меньшего графа $G * e$ утверждение выполнено, а значит,

$$
\begin{aligned}
T(G ; x, y)=x \cdot T(G * e ; x, y)= & \left(x \cdot T\left(G_{1} * e ; x, y\right)\right) T\left(G_{2} ; x, y\right) \ldots T\left(G_{n} ; x, y\right) \\
& =T\left(G_{1} ; x, y\right) T\left(G_{2} ; x, y\right) \cdots \cdots T\left(G_{n} ; x, y\right)
\end{aligned}
$$

1. Ребро $e-$ не петля и не мост.

Тогда граф $G * e-$ несвязное объединение графов $G_{1} * e, G_{2}, \ldots G_{n}$, а граф $G-e-$ несвязное объединение графов $G_{1}-e, G_{2}, \ldots G_{n}$. Для меньших графов $G * e$ и $G-e$ утверждение выполнено, а значит,

$$
\begin{aligned}
& T(G ; x, y)=T(G * e ; x, y)+T(G-e ; x, y)= \\
& T\left(G_{1} * e ; x, y\right) T\left(G_{2} ; x, y\right) \cdots \cdots T\left(G_{n} ; x, y\right)+ \\
& T\left(G_{1}-e ; x, y\right) T\left(G_{2} ; x, y\right) \cdots \cdots T\left(G_{n} ; x, y\right)= \\
& \left(T\left(G_{1} * e ; x, y\right)+T\left(G_{1}-e ; x, y\right)\right) T\left(G_{2} ; x, y\right) \cdots \cdots T\left(G_{n} ; x, y\right)= \\
& T\left(G_{1} ; x, y\right) T\left(G_{2} ; x, y\right) \cdots \cdots T\left(G_{n} ; x, y\right)
\end{aligned}
$$

Из замечания 13.6 и леммы 13.9 напрямую следует аналогичное утверждение для компонент графа.

Следствие 13.7. Если $G_{1}, \ldots, G_{n}$ - компоненты графа $G$, то

$$
T(G ; x, y)=\prod_{i=1}^{n} T\left(G_{i} ; x, y\right)
$$

# 13.3.3 Универсальное свойство многочлена Татта 

Теорема 13.10. (W. T. Tutte) Пусть $f(G)$ удовлетворяет следуюшим свойствам (здесь $a, b, x_{0}, y_{0}$ - константы, причём $a \neq 0$ и $b \neq 0$ ).
(f1) Если $G$ - пустой граф, то $f(G)=1$.
(f2) Если $e \in E(G)$ - мост, то $f(G)=x_{0} \cdot f(G * e)$.
(f3) Если $e \in E(G)$ - петля, то $f(G)=y_{0} \cdot f(G-e)$.
(f4) Если ребро $e \in E(G)$ - не мост и не петля, то

$$
f(G)=a \cdot f(G * e)+b \cdot f(G-e)
$$

Тогда $f(G)=a^{\rho(E(G))} b^{\rho(G)-\rho(E(G))} \cdot T\left(G ; \frac{x_{0}}{a}, \frac{y_{0}}{b}\right)$.
Доказательство. Очевидно, многочлен $a^{\rho(E(G))} b^{\bar{\rho}(E(G))} \cdot T\left(G ; \frac{x_{0}}{a}, \frac{y_{0}}{b}\right)$ удовлетворяет условию ( $f 1$ ). Остаётся проверить, что он удовлетворяет условиям $(f 2)-(f 4)$, тогда мы убедимся в справедливости утверждения теоремы.

Зафиксируем ребро $e \in E(G)$. Пусть $E^{\prime}=E(G), E=E(G-e)=$ $E(G * e)$. Отметим, что если ребро $e-$ не петля, то

$$
\rho\left(E^{\prime}\right)=\rho_{1}(E)+1, \quad \bar{\rho}\left(E^{\prime}\right)=\bar{\rho}_{1}(E)
$$

Если ребро $e-$ не мост, то

$$
\rho\left(E^{\prime}\right)=\rho_{2}(E), \quad \bar{\rho}\left(E^{\prime}\right)=\bar{\rho}_{2}(E)+1
$$

Проверка ( $f 2$ ).
Пусть ребро $e \in E(G)$ - мост. По условию (13.6) и свойству $2^{\circ}$ многочлена Татта

$$
a^{\rho\left(E^{\prime}\right)} b^{\bar{\rho}\left(E^{\prime}\right)} \cdot T\left(G ; \frac{x_{0}}{a}, \frac{y_{0}}{b}\right)=\left(a \cdot \frac{x_{0}}{a}\right) \cdot a^{\rho_{1}(E)} b^{\bar{\rho} \bar{\rho}(E)} \cdot T\left(G * e ; \frac{x_{0}}{a}, \frac{y_{0}}{b}\right)
$$

Проверка ( $f 3$ ).
Пусть ребро $e \in E(G)$ - петля. По условию (13.7) и свойству $3^{\circ}$ многочлена Татта

$$
a^{\rho\left(E^{\prime}\right)} b^{\bar{\rho}\left(E^{\prime}\right)} \cdot T\left(G ; \frac{x_{0}}{a}, \frac{y_{0}}{b}\right)=\left(b \cdot \frac{y_{0}}{b}\right) \cdot a^{\rho_{2}(E)} b^{\bar{\rho} \bar{\rho}(E)} \cdot T\left(G-e ; \frac{x_{0}}{a}, \frac{y_{0}}{b}\right)
$$

Проверка ( $f 4$ ).
Пусть ребро $e \in E(G)$ - не мост и не петля. По условиям (13.6), (13.7) и свойству $4^{\circ}$ многочлена Татта

$$
a^{\rho\left(E^{\prime}\right)} b^{\bar{\rho}\left(E^{\prime}\right)} \cdot T\left(G ; \frac{x_{0}}{a}, \frac{y_{0}}{b}\right)=
$$

$$
=a \cdot a^{\rho_{1}(E)} b^{\overline{\rho_{1}}(E)} \cdot T\left(G * e ; \frac{x_{0}}{a} ; \frac{y_{0}}{b}\right)+b \cdot a^{\rho_{2}(E)} b^{\overline{\rho_{2}}(E)} \cdot T\left(G-e ; \frac{x_{0}}{a} ; \frac{y_{0}}{b}\right)
$$

С помощью этой теоремы можно расшифровывать информацию, скрытую в значениях многочлена Татта. В качестве примеров мы выразим через многочлен Татта количества ациклических и сильно связных ориентаций графа, а также два уже обсуждавшихся выше связанных друг с другом многочлена - потоковый и хроматический.

В разделе 8.7 мы уже обсуждали ориентации графа - разные способы ориентировать его рёбра. Теорема Лас Вергнаса выражает количество ациклических (то есть, не имеющих циклов) и сильно связных ориентаций графа $G$ как значения многочлена Татта. Доказательства обоих пунктов почти одинаковы.

Определение 13.8. Пусть $G$ - неориентированный граф.

1) Обозначим через $a o(G)$ количество ациклических ориентаций графа $G$.
2) Обозначим через $\operatorname{sco}(G)$ количество ориентаций графа $G$, в которых ориентация каждой компоненты графа $G$ является сильно связным орграфом.

Отметим, что если $G$ - связный граф, то $\operatorname{sco}(G)$ - количество его сильно связных ориентаций.

Теорема 13.11. (M. Las Vergnas, 1980.) Для графа $G$ выполнены следующие равенства:

1) $T(G ; 2,0)=a o(G)$
2) $T(G ; 0,2)=\operatorname{sco}(G)$.

Доказательство. Пусть $e=x y \in E(G)$ - не петля. Напомним, что существует естественная биекция между рёбрами графов $G-e$ и $G * e$. Тогда для каждой ориентации рёбер $A$ графа $G-e$ обозначим через $A^{*}$ соответствующую ориентацию рёбер графа $G * e$. Пусть $A_{1}$ и $A_{2}$ - две ориентации рёбер графа $G$, совпадающие с $A$ на отличных от $e$ рёбрах, в которых $e$ ориентировано по-разному (например, от $x$ к $y$ в $A_{1}$ и от $y$ к $x$ в $A_{2}$ ). Перейдем к доказательству. В обоих случаях, мы проверим выполнение универсального свойства многочлена Татта для соответствующих коэффициентов.

1) Для пустого графа количество ациклических ориентаций равно 1 (во всяком случае, так можно считать), так что условие ( $f 1$ ) выполнено. Проверим свойства $(f 2)-(f 4)$ для $a o(G)$.

Проверка $(f 2)$.

Пусть ребро е $\in E(G)$ - мост. Тогда $a o(G)=2 \cdot a o(G * e)$. Действительно, рассмотрим каждую тройку ориетаций $A^{*}, A_{1}$ и $A_{2}$. Очевидно, от ориентации моста не зависит наличие циклов, поэтому, $A_{1}$ и $A_{2}$ могут быть ациклическими только одновременно - ровно в тех случаях, когда $A^{*}$ такова. Таким образом, $x_{0}=2$.

Проверка ( $f 3$ ). Пусть ребро $e \in E(G)$ - петля.
Тогда граф не имеет ациклических ориентаций, то есть, $y_{0}=0$.
Проверка $(f 4)$.
Пусть ребро $e \in E(G)$ - не петля и не мост.
Докажем, что нам подойдут $a=b=1$, то есть,

$$
a o(G)=a o(G * e)+a o(G-e)
$$

Разобьем все ориентации указанных графов на четверки вида $A, A^{*}, A_{1}$ и $A_{2}$. Если $A^{*}$ - ациклическая ориентация $G * e$, то, очевидно, и все три остальные ориентации - ациклические. Если $A$ имеет цикл, то и все три остальных тоже. Остается рассмотреть случай, когда $A$ - ациклическая, а $A^{*}$ - нет. По лемме 8.3 все вершины ациклической ориентации $A$ можно занумеровать так, что рёбра ориентированы от меньшего номера к большему. Пусть $x$ имеет меньший номер чем $y$. Тогда ориентация $A_{1}$, в которой ребро $e$ ориентировано от $x$ к $y$ - ациклическая. Так как склеив в одну вершину $x$ и $y$, мы получим имеющую цикл ориентацию $A^{*}$, в ориентации $A$ существует $x y$-путь (хотя бы один). Следовательно, ориентация $A_{2}$ со стрелкой от $y$ к $x$ имеет цикл.

В любом случае, среди пары ориентаций $A_{1}$ и $A_{2}$ графа $G$ столько же ациклических, сколько среди ориентаций $A$ и $A^{*}$ графов $G-e$ и $G^{*}$, соответственно, что доказывает формулу (13.8).

Подставив в формулу из теоремы 13.10 полученные значения $a=1$, $b=1, x_{0}=2$ и $y_{0}=0$, получим утверждение пункта 1 теоремы.
1) Для пустого графа количество сильно связных ориентаций также равно 1 , условие ( $f 1$ ) выполнено. Проверим свойства $(f 2)-(f 4)$ для $\operatorname{sco}(G)$.

# Проверка $(f 2)$. 

Пусть ребро $e \in E(G)$ - мост. Тогда компонента графа $G$, содержащая ребро $e$, не имеет сильно связных ориентаций. Следовательно, $\operatorname{sco}(G)=0$ и $x_{0}=0$.

Проверка $(f 3)$.
Пусть ребро $e \in E(G)$ - петля. Тогда $\operatorname{sco}(G)=2 \cdot \operatorname{sco}(G * e)$. Действительно, рассмотрим каждую ориетацию $A$ графа $G-e$. Очевидно, от ориентации петли не зависит сильная связность поэтому, две получающиеся

ориентации графа $G$ могут быть сильно связными только одновременно - ровно в тех случаях, когда $A$ такова. Таким образом, $y_{0}=2$.

Проверка $(f 4)$.
Пусть ребро $e \in E(G)$ - не петля и не мост. Докажем, что нам подойдут $a=b=1$, то есть,

$$
\operatorname{sco}(G)=\operatorname{sco}(G * e)+\operatorname{sco}(G-e)
$$

Разобьем все ориентации указанных графов на четверки вида $A, A^{*}, A_{1}$ и $A_{2}$. Если $A$ - сильно связная ориентация $G-e$, то, очевидно, и все три остальные ориентации - сильно связные. Если $A^{*}$ не является сильно связной, то и все три остальных ориентации - тоже (если $A_{1}$ или $A_{2}$ сильно связна, то $A^{*}$ - тоже, так как сильная связность не теряется при стягивании стрелки). Остается рассмотреть случай, когда $A^{*}$ - сильно связная, а $A$ - нет. Значит, в ориентации $A$ более одной компоненты сильной связности. Так как склеив вершины $x$ и $y$ в одну, мы получим сильно связный орграф (ориентацию $A^{*}$ ), в $A$ ровно две крайние компоненты сильной связности: $X \ni x$ и $Y \ni y$, и между ними есть путь скажем, от $X$ к $Y$. Тогда ориентация $A_{1}$, в которой ребро $e$ ориентировано от $x$ к $y$, не является сильно связной, а ориентация $A_{2}$, где это ребро ориентировано от $y$ к $x$ - сильно связная.

В любом случае, среди пары ориентаций $A_{1}$ и $A_{2}$ графа $G$ столько же сильно связных, сколько среди ориентаций $A$ и $A^{*}$ графов $G-e$ и $G^{*}$, соответственно, что доказывает формулу (13.9).

Подставив в формулу из теоремы 13.10 полученные значения $a=1$, $b=1, x_{0}=0$ и $y_{0}=2$, получим утверждение пункта 2 теоремы.

С помощью того, что мы знаем о потоковом многочлене, выразить его через многочлен Татта с помощью универсального свойства совсем просто.

Теорема 13.12. Для любого графа $G$ и натурального числа $k$ выполняется соотношение $\varphi_{G}(k)=(-1)^{e(G)+v(G)+c(G)} \cdot T(G ; 0,1-k)$.

Доказательство. Так как в пустом графе возможен только пустой поток, мы имеем $\varphi_{\overline{K_{0}}}(k)=1$, как того требует условие ( $f 1$ ). Проверим свойства $(f 2)-(f 4)$ для $\varphi_{G}(k)$.

Проверка $(f 2)$.
Пусть ребро $e \in E(G)$ - мост. Тогда $\varphi_{G}(k)=0$ и соотношение ( $f 2$ ) выполнено для $x_{0}=0$.

# Проверка $(f 3)$. 

Пусть ребро $e \in E(G)$ - петля. Тогда $\varphi_{G}(k)=(k-1) \cdot \varphi_{G-e}(k)$ по лемме 13.6. Таким образом, соотношение ( $f 3$ ) выполнено для $y_{0}=k-1$.

## Проверка $(f 4)$.

Пусть ребро $e \in E(G)$ - не петля и не мост. Тогда по лемме 13.5 мы знаем, что $\varphi_{G}(k)=\varphi_{G * e}(k)-\varphi_{G-e}(k)$. Следовательно, соотношение ( $f 4$ ) выполнено для $a=1, b=-1$.

Подставим в утверждение теоремы 13.10 полученные значения $a=1$, $b=-1, x_{0}=0$ и $y_{0}=k-1$ :
$\varphi_{G}(\lambda)=(-1)^{e(G)-\rho(E(G))} \cdot T(G ; 0,1-k)=(-1)^{e(G)+v(G)+e(G)} \cdot T(G ; 0,1-k)$, так как $\rho(E(G))=v(G)-c(G)$.
Следствие 13.8. Пусть $G$ - регулярный граф степени 4. Тогда количество эйлеровых ориентаций графа $G$ равняется $(-1)^{v(G)+e(G)} T(G ; 0,-2)$.
Доказательство. По теореме 10.8 количество эйлеровых ориентаций графа $G$ равно $\varphi_{G}(3)$. По теореме 13.12 мы имеем

$$
\varphi_{G}(3)=(-1)^{v(G)+e(G)+e(G)} T(G ; 0,-2)=(-1)^{v(G)+e(G)} T(G ; 0,-2)
$$

так как для 4 -регулярного графа $G$ выполнено $e(G)=2 v(G)$.
Исторически именно хроматический многочлен графа послужил отправной точкой для изобретения многочлена Татта (который сам Татт называл дихроматом графа). В следующей теореме мы выразим хроматический многочлен графа $\chi_{G}(k)$ через многочлен Татта.
Теорема 13.13. Для любого графа $G$ и натурального числа $k$ выполняется соотношение

$$
\chi_{G}(k)=(-1)^{v(G)-e(G)} k^{e(G)} \cdot T(G ; 1-k, 0)
$$

Доказательство. Воспользуемся теоремой 13.10. Пусть

$$
P(G ; k)=\frac{1}{k^{v(G)}} \cdot \chi_{G}(k)
$$

Отметим, что для пустого графа $G$ очевидно $P(G ; k)=1$. Проверим свойства $(f 2)-(f 4)$ для $P(G ; k)$.

## Проверка $(f 2)$.

Пусть ребро $e \in E(G)$ - мост. Тогда $\chi_{G}(k)=(k-1) \cdot \chi_{G * e}(k)$ по лемме 13.6. Следовательно, соотношение ( $f 2$ ) выполнено для $x_{0}=\frac{k-1}{k}$ :

$$
P(G ; k)=\frac{1}{k^{v(G)}} \cdot \chi_{G}(k)=\frac{k-1}{k} \cdot \frac{1}{k^{v(G * e)}} \cdot \chi_{G * e}(k)=\frac{k-1}{k} \cdot P(G * e ; k)
$$

# Проверка $(f 3)$. 

Пусть ребро $e \in E(G)$ - петля. Тогда у графа $G$ не существует правильных раскрасок в $k>0$ цветов, следовательно, $P(G ; k)=0$, то есть, соотношение $(f 3)$ выполняется для $y_{0}=0$.

Проверка $(f 4)$.
Пусть ребро $e \in E(G)$ - не петля и не мост. Тогда по лемме 13.2 мы знаем, что $\chi_{G}(k)=\chi_{G-e}(k)-\chi_{G * e}(k)$. Так как $v(G)=v(G-e)=$ $v(G * e)+1$, мы получаем

$$
P(G ; k)=-\frac{1}{k} P(G * e ; k)+P(G-e ; k)
$$

В случае, когда ребро $e-$ не мост, мы немедленно получаем соотношение $(f 4)$ для $a=-\frac{1}{k}, b=1$.

Подставим в утверждение теоремы 13.10 найденные значения $a=-\frac{1}{k}$, $b=1, x_{0}=\frac{k-1}{k}$ и $y_{0}=0$ :

$$
\begin{aligned}
& \chi_{G}(k)=k^{v(G)} \cdot P(G ; k)=k^{v(G)} \cdot\left(\frac{-1}{k}\right)^{\rho(E(G))} \cdot T(G ; 1-k, 0)= \\
& =(-1)^{v(G)-c(G)} k^{c(G)} \cdot T(G ; 1-k, 0), \quad \text { так как } \quad \rho(E(G))=v(G)-c(G) .
\end{aligned}
$$

Замечание 13.7. Разумеется, утверждения теорем 13.12 и 13.13 верны не только для натуральных $k$, но и для любых $k \in \mathrm{C}$ (многочлены из $\operatorname{Bound}[x]$ или $\mathrm{C}[x]$, совпадающие на всех натуральных числах, имеют одинаковые коэффициенты).

Применим разработанную технику.
Следствие 13.9. Для графа $G$ выполнены следующие равенства:

1) $a o(G)=(-1)^{v(G)} \chi_{G}(-1)$;
2) $\operatorname{sco}(G)=(-1)^{e(G)+v(G)+c(G)} \varphi_{G}(-1)$.

Доказательство. В силу замечания 13.7, в формулы из теорем 13.12 и 13.13 можно подставлять не только натуральные значения.

1) Воспользуемся теоремами 13.11 и 13.13 :

$$
\begin{aligned}
a o(G)=T(G ; 2,0) & =T(G ; 1-(-1), 0) \\
& =(-1)^{v(G)-c(G)} \cdot(-1)^{c(G)} \cdot \chi_{G}(-1)=(-1)^{v(G)} \chi_{G}(-1)
\end{aligned}
$$

1) Воспользуемся теоремами 13.11 и 13.12 :

$$
\operatorname{sco}(G)=T(G ; 0,2)=T(G ; 0,1-(-1))=(-1)^{e(G)+v(G)+c(G)} \cdot \varphi_{G}(-1)
$$

Разумеется, формулы из следствия 13.9 могут быть получены и без многочлена Татта (задача ??).

# 13.3.4 Многочлен Татта двойственного графа 

Теорема 13.14. Пусть $G$ - плоский граф, а $G^{*}$ - его двойственный граф. Тогда $T(G ; x, y)=T\left(G^{*} ; y, x\right)$.

Доказательство. По следствию 13.7 многочлен Татта графа равен произведению многочленов Татта его компонент. Поэтому, в силу определения двойственного графа достаточно рассмотреть случай, когда графы $G$ и $G^{*}$ связны.

Докажем утверждение для связного графа индукцией по размеру графа. База для пустого графа очевидна на одной вершине очевидна. Докажем индукционный переход, в котором достаточно проверить редукционные условия из определения многочлена Татта, а именно, что происходит при удалении и стягивании ребер. Отметим, что при этих операциях связность графа не нарушается, так как мы не удаляем мосты.

Пусть $e \in E(G)$ и $e^{*} \in E\left(G^{*}\right)$ - двойственные рёбра. Рассмотрим два случая.

1. Пусть $e-$ мост, или, что равносильно, $e^{*}-$ петля.

По лемме 6.6 мы имеем $(G * e)^{*}=G^{*}-e^{*}$. Следовательно, по индукционному предположению

$$
T(G ; u, v)=u \cdot T(G * e ; u, v)=u \cdot T\left(G^{*}-e^{*} ; v, u\right)=T\left(G^{*} ; v, u\right)
$$

Случае, когда $e$ - петля, а $e^{*}$ - мост, разбирается аналогично, только графы $G$ и $G^{*}$ меняются местами (вспомним, что $\left(G^{*}\right)^{*}=G$ ).
1. Оба ребра е и $e^{*}$ не являются ни мостами, ни петлями.

По лемме 6.6 мы имеем $(G-e)^{*}=G^{*} * e^{*}$ и $(G * e)^{*}=G^{*}-e^{*}$. Следовательно, по индукционному предположению

$$
\begin{aligned}
T(G ; u, v)=T(G * e ; u, v)+ & T(G-e ; u, v)= \\
& T\left(G^{*}-e^{*} ; v, u\right)+T\left(G^{*} * e^{*} ; v, u\right)=T(G ; v, u)
\end{aligned}
$$

Из теоремы 13.14 , а также теорем 13.6 и 13.11 немедленно следует равенство ряда характеристик для двойственных плоских графов.

Следствие 13.10. Пусть $G$ - плоский граф, а $G^{*}$ - его двойственный граф. Тогда выполняются следующие утверждения.

1) $s t(G)=s t\left(G^{*}\right)$.
2) $s c(G)=a c\left(G^{*}\right), \quad s c\left(G^{*}\right)=a c(G)$.
3) $\operatorname{sco}(G)=a o\left(G^{*}\right), \quad \operatorname{sco}\left(G^{*}\right)=a o(G)$.

Кроме того, из теоремы 13.14 следует весьма нетривиальный результат - теорема 13.7, доказанная выше без применения многочлена Татта.

Следствие 13.11. Пусть $G$ - плоский граф, $G^{*}$ - его двойственный граф. Тогда $\chi_{G}(k)=k^{c(G)} \cdot \varphi_{G^{*}}(k)$.

Доказательство. Как и вдоказательстве теоремы 13.7, мы рассмотрим случай связного графа, из которого очевидно следует общее утверждение. Тогда $c(G)=c\left(G^{*}\right)=1$ и $v(G)=f\left(G^{*}\right)$. В силу формулы Эйлера выполнено $e\left(G^{*}\right)+v\left(G^{*}\right) \equiv f\left(G^{*}\right) \equiv v(G)(\bmod 2)$. Воспользовавшись теоремами $13.12,13.13$ и 13.14 , напишем цепочку равенств:

$$
\begin{gathered}
\chi_{G}(k)=(-1)^{v(G)-1} \cdot k \cdot T(G ; 1-k, 0)=(-1)^{v(G)-1} \cdot k \cdot T\left(G^{*} ; 0,1-k\right)= \\
(-1)^{v(G)-1} \cdot k \cdot(-1)^{e\left(G^{*}\right)+v\left(G^{*}\right)+1} \cdot \varphi_{G^{*}}(k) .=k \varphi_{G^{*}}(k)
\end{gathered}
$$

что и требовалось доказать.
Замечание 13.8. В доказательстве следствия 13.11 нельзя применить аналогичные рассуждения для несвязного графа $G$, так как в этом случае $f\left(G^{*}\right) \neq v(G)$. Нетрудно понять, что $f\left(G^{*}\right)=v(G)-(G)+1$ (задача ??).

# 13.4 Дискриминант графа 

В этом разделе от читателя потребуется чуть больше знаний по алгебре - нужно знать, что такое кольцо многочленов от нескольких переменных и идеал.

Определение 13.9. Пусть дан граф $G$ с $V(G)=\left\{x_{1}, \ldots, x_{n}\right\}$, а каждой вершине соответствует независимая переменная, которую мы будем обозначать так же, как и вершину. Пусть $\mathbb{C}_{G}=\mathbb{C}\left[x_{1}, \ldots, x_{n}\right]$ - это кольцо многочленов с комплексными коэффициентами от переменных, соответствующих вершинам графа. Назовём дискриминантом графа $G$ многочлен

$$
D_{G}=\prod_{x_{i} x_{j} \in E(G)}\left(x_{i}-x_{j}\right)
$$

Сразу же отметим, что дискриминант определен с точностью до знака, который в каждом сомножителе $x_{i}-x_{j}$ можно выбрать произвольно. Это нам нисколько не помешает.

Определение 13.10. 1) Рассмотрим многочлен $f(x) \in \mathbb{C}[x]$ степени $k$ без кратных корней. Пусть $A_{f}=\left\{\alpha_{1}, \ldots, \alpha_{k}\right\}$ - множество всех комплексных корней многочлена $f$. Определим идеал

$$
I_{f}=\left(f\left(x_{1}\right), f\left(x_{2}\right), \ldots f\left(x_{n}\right)\right)
$$

(идеал в кольце $\mathbb{C}_{G}$, порожденный многочленами $f\left(x_{i}\right)$ для всех переменных).
1) Пусть $\overline{D_{G}}-$ класс вычетов многочлена $D_{G}$ по модулю идеала $I_{f}$ (то есть, множество всех многочленов кольца $\mathbb{C}_{G}$, сравнимых с $D_{G}$ по модулю $I_{f}$.)

В следующих леммах мы определим остаток от деления $D_{G}$ на идеал $I_{f}$.

Лемма 13.10. Пусть многочлен $P \in \mathbb{C}_{G}$ имеет степень по каждой переменной менее $k$ и $P\left(a_{1}, \ldots, a_{n}\right)=0$ для любых чисел $a_{1}, \ldots, a_{n} \in A_{f}$. Тогда $P\left(x_{1}, \ldots, x_{n}\right) \equiv 0$.

Доказательство. Докажем утверждение индукцией по $n$. База для многочлена от одной переменной очевидна: ненулевой многочлен от одной переменной не может иметь больше корней, чем его степень. Докажем переход.

Пусть $P_{i}\left(x_{2}, \ldots, x_{n}\right)=P\left(\alpha_{i}, x_{2}, \ldots, x_{n}\right)$. По индукционному предположению мы имеем $P_{i}\left(x_{2}, \ldots, x_{n}\right) \equiv 0$. Зафиксируем набор значений $b_{2}, \ldots, b_{n}$ (не обязательно из $A_{f}$ ) и положим $P_{b_{2}, \ldots, b_{n}}(x)=P\left(x, b_{2}, \ldots, b_{n}\right)$. Мы знаем, что $P_{b_{2}, \ldots, b_{n}}(x) \in \mathbb{C}[x]$ - многочлен степени не более $k-1$, имеющий $k$ корней $\alpha_{1}, \ldots, \alpha_{k}$, а потому равный 0 при всех $x$. Таким образом, мы доказали, что $P\left(x_{1}, \ldots, x_{n}\right)=0$ при любых значениях переменной, то есть, в этом многочлене все коэффициенты равны 0.

Лемма 13.11. 1) Для любых чисел $a_{1}, \ldots, a_{n} \in A_{f}$ и многочлена $P \in \overline{D_{G}}$ выполняется $P\left(a_{1}, \ldots, a_{n}\right)=D_{G}\left(a_{1}, \ldots, a_{n}\right)$.
1) В классе вычетов $\overline{D_{G}}$ существует единственный многочлен $D_{G, f}$, степень которого по каждой переменной не превосходит $k-1$.

Доказательство. 1) Заметим, что $P\left(a_{1}, \ldots, a_{n}\right)-D_{G}\left(a_{1}, \ldots, a_{n}\right)$ лежит в $I_{f}$ и потому существуют такие многочлены $H_{1}, \ldots, H_{k} \in \mathbb{C}_{G}$, что

$$
P\left(a_{1}, \ldots, a_{n}\right)-D_{G}\left(a_{1}, \ldots, a_{n}\right)=\sum_{i=1}^{k} f\left(a_{i}\right) H_{i}\left(a_{1}, \ldots, a_{k}\right)=0
$$

так как $f\left(a_{i}\right)=0$ для всех $i \in[1 . . n]$.
1) Существование. Произведем деление с остатком многочлена $D_{G}$ на $f\left(x_{1}\right)$, остаток $D_{G, 1} \in \overline{D_{G}}-$ многочлен, чья степень по переменной $x_{1}$ менее $k$. Затем поделим $D_{G, 1}$ с остатком на $f\left(x_{2}\right)$ - получим остаток $D_{G, 2} \in \overline{D_{G}}-$ многочлен, чья степень и по $x_{1}$, и по $x_{2}$ менее $k$. И так далее, в результате после всех делений получим многочлен $D_{G, f}=D_{G, n} \in \overline{D_{G}}$, чья степень по каждой переменной менее $k$.

Единственность. Предположим, что есть два многочлена $P_{1}$ и $P_{2}$, обладающих такими свойствами. Ввиду пункта 1 , многочлен $P=P_{1}-P_{2}$ таков, что $P\left(a_{1}, \ldots, a_{n}\right)=0$ для любых $a_{1}, \ldots, a_{n} \in A_{f}$ и его степень по каждой переменной не превосходит $k$. Тогда $P\left(x_{1}, \ldots, x_{n}\right) \equiv 0$ по лемме 13.10 , то есть, многочлены $P_{1}$ и $P_{2}$ совпадают.

Теорема 13.15. (Ю. В. Матиясевич, 1974.) Пусть $f \in \mathbb{C}(x)$ - многочлен степени $k$ без кратных корней, а $G$ - граф. Тогда следующие два утверждения равносилъны:
$1^{\circ} \chi(G) \leq k$
$2^{\circ} D_{G} \notin I_{f}$ или, что то же самое, $D_{G, f} \not \equiv 0$.
Доказательство. $1^{\circ} \Rightarrow 2^{\circ}$. Рассмотрим правильную раскраску вершин графа $G$ в $k$ цветов. Пусть цвета - множество $A_{f}$ корней многочлена $f$. Обозначим через $a_{i}$ цвет вершины $v_{i}$. Тогда числа $a_{1}, \ldots, a_{n} \in A_{f}$ таковы, что $D_{G, f}\left(a_{1}, \ldots, a_{n}\right)=D_{G}\left(a_{1}, \ldots, a_{n}\right) \neq 0$, то есть, выполняется условие $2^{\circ}$.
$2^{\circ} \Rightarrow 1^{\circ}$. Пусть $D_{G, f} \not \equiv 0$. Тогда по леммам 13.10 и 13.11 существуют такие $a_{1}, \ldots, a_{n} \in A_{f}$, что $D_{G}\left(a_{1}, \ldots, a_{n}\right)=D_{G, f}\left(a_{1}, \ldots, a_{n}\right) \neq 0$. Покрасив каждую вершину $v_{i}$ в цвет $a_{i}$, мы получим правильную раскраску в $k$ цветов.

# 13.4.1 Дискриминант плоской триангуляции 

Пусть $G$ - триангуляция, то есть, двусвязный плоский граф без петель, все грани которого - треугольники. Напомним, что Тэйтова раскраска $G$ - это раскраска рёбер в три цвета, в которой три ребра каждой грани покрашены в разные цвета. Тэйтовы раскраски изучались в разделе 6.7 и тесно связаны с гипотезой четырёх красок, чем и вызван большой интерес к ним.

Пусть $G^{\prime}$ - граф, вершины которого соответствуют рёбрам $G$ (и обозначаются так же), а две вершины смежны тогда и только тогда, когда соответствующие рёбра лежат в одной грани. Тогда Тэйтовы раскраски триангуляции $G$ - это правильные раскраски графа $G^{\prime}$. Мы покажем,

как связано количество Тэйтовых раскрасок триангуляции $G$ с дискриминантом графа $G^{\prime}$.

Напомним, что в дискриминанте графа $G^{\prime}$ мы используем для переменных такие же обозначения, как для соответствующих вершин графа $G^{\prime}$, а значит, рёбер триангуляции $G$. Пусть $T(G)$ - множество всех троек рёбер триангуляции $G$, образующих её треугольные грани. Запись $x y z \in T(G)$ будет обозначать, что $x, y, z$ - рёбра треугольной грани $G$. Итак,

$$
\begin{aligned}
& D_{G^{\prime}}=\prod_{x y \in E\left(G^{\prime}\right)}(x-y)=\prod_{x_{1} x_{2} x_{3} \in T(G)}\left(x_{1}-x_{2}\right)\left(x_{2}-x_{3}\right)\left(x_{3}-x_{1}\right)= \\
& \prod_{x_{1} x_{2} x_{3} \in T(G)}\left(x_{1} x_{2}^{2}+x_{2} x_{3}^{2}+x_{3} x_{1}^{2}-x_{2} x_{1}^{2}-x_{3} x_{2}^{2}-x_{1} x_{3}^{2}\right)
\end{aligned}
$$

Выбор знака в каждой скобке не имеет значения. Мы определимся с выбором знака, чтобы нам было удобнее. Граф $G$ изображен на плоскости, поэтому всегда будем считать, что в записи $x_{1} x_{2} x_{3} \in T(G)$ подразумевается, что рёбра треугольной грани указаны по часовой стрелке.

Пусть $f(x)=x^{3}-1$. Очевидно, этот многочлен не имеет кратных корней. Положим $D_{G}^{\prime}=D_{G^{\prime}, f}$ - остаток от деления дискриминанта $D_{G^{\prime}}$ на идеал $I_{f}$. При $f(x)=x^{3}-1$ этот остаток строится очень просто: нужно в каждом одночлене дискриминанта $D_{G^{\prime}}$ заменить показатель степени каждой переменной на его остаток от деления на 3.

Пусть триангуляция $G$ имеет $n+2$ вершины. По формуле Эйлера нетрудно вывести, что тогда $G$ имеет $2 n$ граней и $3 n$ рёбер. В произвольном порядке занумеруем рёбра триангуляции $y_{0}, \ldots, y_{3 n-1}$. Тогда каждый одночлен $D_{G}^{\prime}$ представляется в виде $\prod_{i=0}^{3 n-1} y_{i}^{\ell_{i}}$. Для удобства будем записывать такой одночлен в виде $y^{\ell}$, где $\ell=\sum_{i=0}^{3 n-1} \ell_{i}$. Таким образом,

$$
D_{G}^{\prime}=\sum_{\ell=0}^{3^{3 n}-1} \alpha_{\ell} \cdot y_{0}^{\ell_{0}} \ldots y_{3 n-1}^{\ell_{3 n-1}}=\sum_{\ell=0}^{3^{3 n}-1} \alpha_{\ell} \cdot y^{\ell}
$$

Назовем многочлен $D_{G}^{\prime}$ дискриминантом плоской триангуляиии $G$.
Теорема 13.16. (Ю. В. Матиясевич.) Коэффиииент $\alpha_{0}$ равен количеству Тэйтовых раскрасок триангуляции $G$.

Доказательство. Для доказательства нам понадобится новый объект. Мы изобразим вершины определенного выше графа $G^{\prime}$, как середины рёбер $G$, а рёбра - как средние линии граней-треугольников.

Определение 13.11. 1) Мы будем говорить, что ребро графа $G^{\prime}$ лежит на грани $a$ графа $G$, если оно изображено как средняя линия этой грани.
1) Назовём подграф $H$ графа $G^{\prime}$ системой ииклов, если каждая его компонента - простой цикл, и $H$ содержит ровно по одному ребру на каждой грани триангуляции $G$. Если все циклы - компоненты $H$ - четны, то $H$ - система четных ииклов.
2) Вес системы циклов $H$ - это $w(H)=2^{k}$, где $k-$ количество компонент связности графа $H$.
3) Назовём системой ориентированных ииклов орграф, получающийся из системы циклов $H$ транзитивной ориентацией каждого цикла.

Замечание 13.9. Очевидно, существует ровно $w(H)$ способов сделать из системы циклов $H$ систему ориентированных циклов (по два способа ориентировать каждый цикл).

Перейдём к доказательству теоремы, которое мы разобьём на две части. Пусть $s$ - это сумма весов всех систем четных циклов графа $G^{\prime}$.

1. Докажем, что количество Тэйтовых раскрасок триангуляиии $G$ равно $s$.
Для каждой Тэйтовой раскраски $\rho$ рассмотрим подграф $H_{\rho}$ графа $G^{\prime}$ на вершинах, имеющих цвета 1 и 2 в $\rho$. Так как на каждой грани $G$ ровно по одному ребру цветов 1 и 2 , а каждое ребро $G$ входит ровно в две грани, то $H_{\rho}$ - система циклов, причём четных, так как этот граф двудолен.

Наоборот, каждой системе четных циклов $H$ можно поставить в соответствие Тэйтову раскраску, покрасив не входящие в $H$ рёбра в цвет 3 и раскрасив каждый из четных циклов правильным образом в два цвета. Количество таких раскрасок будет как раз $w(H)$, так как каждый из циклов системы $H$ можно покрасить ровно двумя способами.
1. Докажем, что $\alpha_{0}=s$.

Какие именно одночлены дискриминанта $D_{G^{\prime}}$ при редукции становятся равны $y^{0}$ (назовем их хорошими)? Несложно понять, что те, в которых степень каждого ребра $G$ (то есть, соответствующей ему переменной, но мы их не различаем) кратна 3. Рассмотрим любой хороший одночлен и изобразим его следующим образом. На каждой грани $x_{1} x_{2} x_{3} \in T(G)$ выбор одночлена в правой части формулы (13.10) будем изображать стрелочкой от середины ребра, входящего в степени 1 к середине ребра, входящего в степени 2. Например, выбор $x_{1}^{2} x_{2}$ соответствует стрелке от $x_{1}$ к $x_{2}$ (см. рисунок 13.2 a ). Из (13.10) ясно, что стрелка, задающая вращение по часовой стреке, будет учитываться со знаком + , а задающая вращение против часовой стрелки - со знаком -. Знаки стрелок определяют итоговый знак одночлена.



Рис. 13.2: Изображение одночлена стрелками.

Напомним, что в (13.10) мы выбираем на каждой грани по одной стрелке. Так как каждое ребро входит ровно в две грани, его степень не превосходит 4. Поэтому, в интересующих нас одночленах степень каждого ребра должна быть равна 0 или 3 . Таким образом, в каждое ребро, середина которого инцидентна хотя бы одной стрелке, одна стрелка входит и одна стрелка выходит. Это означает, что хороший одночлен представляет собой систему ориентированных циклов, определенную выше.

Рассмотрим систему циклов $H$ и все способы ориентации этих циклов. Очевидно, все полученные системы ориентированных циклов - это хорошие одночлены. Каждый четный цикл не меняет знак от переориентации, а нечетный - меняет. Поэтому, если в системе циклов $H$ есть хотя бы один нечетный цикл, то суммарный вклад в $\alpha_{0}$ всех одночленов, являющихся ориентациями $H$, равен 0 .

Теперь рассмотрим систему четных циклов $H$. Количество ориентаций этой системы есть её вес $w(H)$ и у всех ориентаций - одинаковый знак. Для доказательства утверждения теоремы нам остается доказать, что этот знак всегда + .

Расмотрим любой четный цикл $C$ системы $H$, ориентируем его и докажем, что его ориентация положительна, то есть, содержит четное число положительных стрелок и четное число отрицательных стрелок. Разрежем плоскую триангуляцию $G$ по циклу $C$ на две части и рассмотрим часть слева от цикла. Она представляет из себя плоский граф $M$. Все нетронутые разрезом грани - треугольники, и их количество четно, так как они покрыты четными циклами системы $H$ (которые, очевидно, не могут пересекать $C$ ). Сам четный цикл $C$ образует четную грань в $M$. Остаются грани, образованные при разрезе треугольных граней по $C$. Среди этих граней четное число треугольников, так как число нечетных граней в $M$ должно быть четно. Остается лишь заметить, что мы отрезали от грани $G$ треугольник слева от цикла $C$ ровно в том случае, когда стрелка, по которой производился разрез, задает направление вращения

по часовой стрелке, то есть, положительна (см. рисунок 13.2b). Таким образом, ориентация $C$ положительна, как и любого другого цикла из $H$.

Значит, любая ориентация $H$ положительна, что нам и оставалось доказать.

# 13.5 Комментарии 

Это одна из двух "алгебраических" глав книги. Начинается она разделом, в котором изложены свойства хроматического многочлена - от самых классических (нужно все же доказать, что это многочлен!) до несколько более современных. Доказаны формулы вычисления хроматического многочлена через многочлены компонент и блоков графа, рассказано о смысле кратностей корней 0 и 1 хроматического многочлена. Наиболее интересное из этих свойств - теорема Вайтхеда и Жао [42] о кратности корня 1 хроматического многочлена. Продолжение темы о хроматическом многочлене и его свойствах - в задачах ??-??.

Следующий раздел 13.2 посвящен потоковому многочлену и его связи с хроматическим многочленом. Этот раздел продолжает разговор о потоках, начатый в разделе 10.2. Начинается он с теоремы Татта о существовании потокового многочлена, откуда следует, что количество $H$-потоков одинаково для всех абелевых групп $H$. С помощью этой теоремы удается использовать для изучения 4 -потоков группу Клейна $\mathbb{Z}_{2} \times \mathbb{Z}_{2}$ (в разделе 10.2 мы использовали для 6 -потоков группу $\mathbb{Z}_{3} \times \mathbb{Z}_{2}$, но она изоморфна $\mathbb{Z}_{6}$, а группа Клейна не изоморфна $\mathbb{Z}_{4}$ ). Группа Клейна исключительно удобна тем, что каждый элемент в сумме с собой дает 0 , мы уже использовали ее для раскрасок плоских графов и триангуляций, доказывая теорему об эквивалентности Тэйта.

Далее следует теорема Татта о двойственности потоков и раскрасок. В доказательствах мы используем свойства двойственных графов и, как и ранее, не обращаем внимания на топологические подробности, сосредоточившись на комбинаторных.

Заканчивает раздел теорема Ю. В. Матиясевича о вычислении хроматического многочлена графа через потоковые многочлены подграфов, доказанная в [60]. Однако, здесь приведено совсем другое доказательство, основанное на стягивании и удалении рёбер - технике, повсеместно применяемой в этой главе. На мой взгляд, это доказательство проще и демонстрирует силу метода.

Рассказывая о применении многочленов для работы с графами нельзя обойти многочлен Татта - так много информации о графе в нем заключено. В разделе представлены стандартные факты о многочлене

Татта. Начинается изложение со связи с ранговым многочленом Уитни. Изложение доказательств через остовные леса, важные и лишние рёбра рассказал мне мой ученик А. Л. Глазман и мне оно кажется максимально наглядным из известных мне. Далее идут простейшие значения многочлена Татта - выражение через него количества остовных лесов, связных остовных подграфов и ациклических подграфов. Рассказано об универсальном свойстве многочлена Татта и в качестве применения этой теоремы представлены выражения через многочлен Татта хроматического и потокового многочленов, о которых уже говорилось в разделе, а также еще два известных значения теоремы Татта, найденных Лас Вергнасом [18] - количества ациклических и сильно связных ориентаций. Все эти факты являются хорошо известной классикой, их доказательства несложны, но содержат немало технических деталей. В этой книге перечислены далеко не все значения многочлена Татта, имеющие комбинаторную интерпретацию на данный момент. Так, в статье [19] содержится изящная комбинаторная интерпретация $2 T(G ; 3,3)$ для планарного графа $G$. Смысл некоторых других значений многочлена Татта можно найти в обзоре [41].

В конце главы идет рассказ о менее известном многочлене - дискриминанте графа. Мне кажется, что этот многочлен, придуманный Ю.В. Матиясевичем в 1974 году [59], еще найдет свое применение. В разделе 13.4.1 доказывается еще одна теорема Ю.В.Матиясевича [61] о связи коэффициентов дискриминанта плоской триангуляции и количества ее Тэйтовых раскрасок (см. раздел 6.7).



# Литература 

[1] B. BollobÁs. Extremal Graph Theory. Academic Press, London, 1978.
[2] B. BollobÁs, A. Saito, N. Wormald. Regular factors of regular graphs. Journal of Graph Theory v. 9 (1985), p.97-103.
[3] J. A. Bondy, U.S.R.Murity. Graph Theory With Applications. Elsevier Science, 1976.
[4] W. G. Brown (1966) On graphs that do not contain a Thomsen graph. Canadian Mathematical Bulletin, v. 9 (1966), p. 281-285.
[5] A. H. Busch. A note on the number of hamiltonian paths in strong tournaments. Electron. J. Comb. 13 (2006), No. 3.
[6] G. Chartrand, A. Kaugars, D. R. Lick. Critically n-connected graphs. Proc. Amer. Math. Soc., v. 32 (1972), i.1, p.63-68.
[7] V. Chvatal. Tree- Complete Graph Ramsey Numbers. Journal of Graph Theory, v. 1 (1977), p. 93.
[8] R. Diestel. Graph Theory. Springer, 1997-2016 (издания 1-5).
[9] H. Enomoto, B. Jackson, P. Katerinis, A. Saito. Toughness and the existence of $k$-factors. J. Graph Theory v. 9 (1985) p.87-95.
[10] P. Erdős, A. L. Rubin, H. Taylor. Choosability in graphs Proc. WestCoast Conf. on Combinatorics, Graph Theory and Computing, Arcata, California, Congr. Numer. XXVI (1979) p.125-157.
[11] Z. Füredi. New asymptotics for bipartite Turán numbers. J Comb. Theory, Ser. A, v. 75 (1996), p. 141-144.
[12] J. R. Griggs, M. Wu. Spanning trees in graphs of minimum degree 4 or 5. Discrete Math. 104 (1992) p.167-183.

[13] A. GyÁrfÁs, G. Simony. Edge colorings of complete graphs without tricolored triangles., Journal of Graph Theory, v. 46 2004, i.3, p. 211-216.
[14] E. Györi. On division of graphs to connected subgraphs. Colloq. Math. Soc. Janos Bolyai, 18. Combinatorics, Keszthely (Hungary) (1976), p.485-494.
[15] A. Hoyer, R. Thomas. The Györi-Lovász problem. arXiv:1605.01474v2.
[16] D. J. Kleitman, D. B. West. Spanning trees with many leaves. SIAM J. Discrete Math. 4 (1991), i. 1, p. 99-106.
[17] T. Kővari, V.T. Sós, P. Turán. On a problem of K. Zarankiewicz. Colloq. Math. Vol. 3 (1955), p.50-57.
[18] M. Las Vergnas. Convexity in oriented matroids. Journal of Combinatorial Theory, Series B, v.29, i. 2 (1980), p. 231-243.
[19] M. Las Vergnas. On the evaluation at $(3,3)$ of the Tutte polynomial of a graph. Journal of Combinatorial Theory, Series B, v.45, i. 3 (1988), p.367-372.
[20] N. Linial. A lower bound on the circumference of a graph., Discrete Math. v. 15 (1976) p.297-300.
[21] L. LovÁsz. A homology theory for spanning trees of a graph. Acta Math. Acad. Sci. Hungaricae 30 (1977), p.241-251.
[22] L. LovÁsz, M. D. Plummer. Matching Theory. North-Holland, 1986.
[23] H.-J.Lui, B. Montgomery, H. Poon. Upper bounds of dynamic chromatic number. Ars Combinatoria 68 (2003), 193-201.
[24] S. MacLane. A structural characterizations of planar combinatorial graphs. // Duke Math. J., 1937, vol. 3, p. 460-472.
[25] W. MADER. On vertices of degree $n$ in minimally $n$-connected graphs and digraphs. Combinatorics, Paul Erdös is Eighty, Budapest, 1996. Vol.2, p.423- 449.
[26] N. Martinov. A recursive characterization of the 4-connected graphs. Discrete Math. 84 (1990), No.1, p.105-108.
[27] J.W. Moon, On subtournaments of a tournament. Canadian Mathematical Bulletin, v.9, i.3, (1966) p.297-301.

[28] J.Pach, G.Tóth. Graphs drawn with few crossing per edge. Combinatorica 17 (1997), no. 3, p. 427-439.
[29] P. Seymour. On the Two-Colouring of Hypergraphs. The Quarterly Journal of Mathematics 25 (1974) p.303-312.
[30] P. Seymour, C. Thomassen Characterization of Even Directed Graphs. J. Comb. Theory, Ser.B, v. 42, (1987), p. 36-45.
[31] C. Thomassen. A remark on the factor theorems of Lovász and Tutte. J. Graph Theory 5 (1981), no. 4, 441-442.
[32] C. Thomassen. The 2-linkage problem for acyclic dighraphs. Discrete Math. 55 (1985), p. 73-87.
[33] C. Thomassen. Even cycles in directed graphs. Europ. J. Combinatorics 6(1985), p. 85-89.
[34] C. Thomassen. The even cycle problem for directed graphs. Journal of the American Mathematical Society, V. 5, N. 2, 1992, p. 217-229.
[35] C. Thomassen. A short list color proof Grötzsch's theorem. J. Combin. Theory, Series B, 88 (2003), p. 189-192
[36] C. Thomassen. A theorem on paths in planar graphs. J. Graph Theory 7 (1983), no. 2, p.169-176.
[37] M.-T. Tsai, D. B. West. A new proof of 3-colorability of Eulerian triangulations. https://faculty.math.illinois.edu/ west/pubs/eultri.pdf
[38] W. T. Tutte. Connectivity in graphs. Toronto, Univ. Toronto Press, 1966.
[39] W. T. Tutte. A theorem on planar graphs. Trans. Amer. Math. Soc. 82 (1956) p.99-116.
[40] A. Urquhart. The graph constructions of Hajós and Ore. J. Graph Theory, 26 (1997), p. 211-215.
[41] D. Welsh The Tutte polynomial., Random Structures and Algorithms, Wiley, v. 15 i.3-4 (1999), p. 210-228.
[42] E. G. Whitehead, L.-C. Zhao. Cutpoints and the chromatic polynomial. J. Graph Theory 8 (1984), no. 3, p.371-377.

[43] A. YeO. A Note on Alternating Cycles in Edge-Coloured Graphs. Journal of Combinatorial Theory, Series B, v. 69 (1997), i.2, p. 222-225.
[44] А. В. Банкевич, Д. В. Карпов. Оченки количества висячих вершин в остовных деревъях. Записки научных семинаров ПОМИ, том 391 (2011), стр. 18-34.
[45] С. Л. БЕРЛов. Хроматические числа слоистых графов с ограниченной максимальной кликой. Записки научных семинаров ПОМИ, том 381 (2010), стр. 5-30.
[46] С. Л. БЕРлов, Д. В. Карпов. Факторизация проективной плоскости и экстремальные графы без полного двудольного подграфа $K_{2, n}$. Моделирование и Анализ Информационных систем, т. 8 (2001г), вып. 2 (2001г.), стр. 10-12, Изд. Ярославского Университета.
[47] О. В. Бородин. Критерий хроматичности степенного предписания. Труды IV Всесоюзной конференции по теор. кибернетике, Новосибирск, 1977, стр. 127-128.
[48] И. М. Виноградов. Основы теории чисел. М.-Л., Гостехиздат, 1952.
[49] Л. И. Головина, И. М. Яглом. Индукиия в геометрии. Москва, ФизМатГИЗ, 1961 г.
[50] Н. В. ГрАвин, Д. В. Карпов. О правильных раскрасках гиперерабов. Записки научных семинаров ПОМИ, том 391 (2011 г.), стр. 7989 .
[51] Д. В. Карпов. Разделяющие множества в $k$-связном графе. Записки научных семинаров ПОМИ, том 340 (2006 г.), стр. 33-60. (http://www.pdmi.ras.ru/znsl/2006/v340.html)
[52] Д. В. Карпов. Остовное дерево с большим количеством висячих вершин. Записки научных семинаров ПОМИ т. 381 (2010г.) стр.7887 .
[53] Д. В. Карпов. Верхняя оченка количества рёбер в двудольном почти планарном графе. Записки научных семинаров ПОМИ, том 406 (2012 г.), стр. 12-30.
[54] Д. В. Карпов. Дерево разбиения двусвязного графа. Записки научных семинаров ПОМИ, том 417 (2013 г.), стр. 86-105.

[55] Д. В. КАРПОв. Удаление вершин из двусвязного графа с сохранением двусвязности. Записки научных семинаров ПОМИ, том 427 (2014 г.), стр. 66-73.
[56] Д. В. КАРПОв. Связность графов.
http://logic.pdmi.ras.ru/ dvk/connectivity.pdf.
[57] Д. В. КАРПОв, А. В. ПАСТОР. O структуре $k$-связного графа. Записки научных семинаров ПОМИ, т. 266 (2000), стр. 76-106.
[58] Т. КОРМЕН, Ч. ЛЕЙЗЕРСОН, Р. РИВЕСТ. Алгоритмы: Построение и анализ. М.: МЦИМО, 2001. - 960 с.
[59] Ю. В. МАТИЯСЕВИЧ. Один критерий раскрашиваемости вершин графа, формулируемый в терминах ориентаиий ребер. Дискретный анализ, т. 26 (1974) стр.65-71. Английский перевод: https://arxiv.org/abs/0712.1884.
[60] Ю. В. МАТИЯСЕВИЧ. Об одном представлении хроматического многочлена. Дискретный анализ, т. 31 (1977) стр.61-70. Английский перевод: https://arxiv.org/abs/0903.1213.
[61] Ю. В. МАТИЯСЕВИЧ. Некоторые алгебраические методы вычисления количества раскрасок графов. Записки научных семинаров ПОМИ т. 283 (2001), стр.193-205.
[62] К. Прахар. Распределение простых чисел. Москва, "Мир 1967. (Перевод с немецкого. K.Prachar. Primzahlverteilung. Springer-Verlag, 1957.)
[63] Ф. ХАРАРИ. Теория графов. // Москва, "Мир", 1973. (Перевод с английского. F.Harary, Graph theory, Addison-Wesley, 1969.)